[{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"load-packages","dir":"Articles","previous_headings":"Setup","what":"Load Packages","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"library(ETAS.inlabru) library(ggplot2)  library(rnaturalearth) library(terra) library(sf) library(ggspatial) library(rnaturalearthdata)  library(lubridate)  ## This is just the EPSG equivalent of WGS84 crs_wgs84 <- st_crs('EPSG:4326')"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"load-an-earthquake-catalogue","dir":"Articles","previous_headings":"","what":"Load an earthquake catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"Earthquake data stored -called earthquake catalogues. Many different catalogues exists region easy way decide one better. , provide HOmogenized instRUmental Seismic (HORUS) catalogue 1960 2020. can downloaded http://horus.bo.ingv./. subset (see data-raw/horus.R subset created) information Horus catalogue can loaded using data reports earthquake time string (time_string), longitude (lon) latitude (lat) epicentre, depth kilometres (depth), moment magnitude (M).","code":"# load ISIDE catalogue data(horus, package = \"ETAS.inlabru\")  # transform time string in Date object horus$time_date <- as.POSIXct(   horus$time_string,   format = \"%Y-%m-%dT%H:%M:%OS\" )  head(horus) #>           time_string     lon     lat depth    M           time_date #> 1 1960-01-03T20:19:34 15.3000 39.3000   290 6.34 1960-01-03 20:19:34 #> 2 1960-01-04T09:20:00 13.1667 43.1333     0 3.94 1960-01-04 09:20:00 #> 3 1960-01-06T15:17:34 12.7000 46.4833     4 4.69 1960-01-06 15:17:34 #> 4 1960-01-06T15:20:53 12.7000 46.4667     0 4.14 1960-01-06 15:20:53 #> 5 1960-01-06T15:31:00 12.7500 46.4333     0 3.00 1960-01-06 15:31:00 #> 6 1960-01-06T15:45:00 12.7500 46.4333     0 3.00 1960-01-06 15:45:00  df_cat <- horus  # add event number df_cat$event_num <- seq.int(nrow(df_cat))  # sf version of the catalogue df_cat.sf<- st_as_sf(df_cat,                      coords = c(\"lon\", \"lat\"),                      crs = crs_wgs84)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"get-map-and-extract-crs-for-the-map","dir":"Articles","previous_headings":"Load an earthquake catalogue","what":"Get map and extract crs for the map","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"italy.map <- ne_countries(country = 'Italy', returnclass = \"sf\", scale = 'medium') italy.crs <- crs(italy.map) print(italy.crs) #> [1] \"BOUNDCRS[\\n    SOURCECRS[\\n        GEOGCRS[\\\"unknown\\\",\\n            DATUM[\\\"World Geodetic System 1984\\\",\\n                ELLIPSOID[\\\"WGS 84\\\",6378137,298.257223563,\\n                    LENGTHUNIT[\\\"metre\\\",1]],\\n                ID[\\\"EPSG\\\",6326]],\\n            PRIMEM[\\\"Greenwich\\\",0,\\n                ANGLEUNIT[\\\"degree\\\",0.0174532925199433],\\n                ID[\\\"EPSG\\\",8901]],\\n            CS[ellipsoidal,2],\\n                AXIS[\\\"longitude\\\",east,\\n                    ORDER[1],\\n                    ANGLEUNIT[\\\"degree\\\",0.0174532925199433,\\n                        ID[\\\"EPSG\\\",9122]]],\\n                AXIS[\\\"latitude\\\",north,\\n                    ORDER[2],\\n                    ANGLEUNIT[\\\"degree\\\",0.0174532925199433,\\n                        ID[\\\"EPSG\\\",9122]]]]],\\n    TARGETCRS[\\n        GEOGCRS[\\\"WGS 84\\\",\\n            DATUM[\\\"World Geodetic System 1984\\\",\\n                ELLIPSOID[\\\"WGS 84\\\",6378137,298.257223563,\\n                    LENGTHUNIT[\\\"metre\\\",1]]],\\n            PRIMEM[\\\"Greenwich\\\",0,\\n                ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n            CS[ellipsoidal,2],\\n                AXIS[\\\"geodetic latitude (Lat)\\\",north,\\n                    ORDER[1],\\n                    ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n                AXIS[\\\"geodetic longitude (Lon)\\\",east,\\n                    ORDER[2],\\n                    ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n            ID[\\\"EPSG\\\",4326]]],\\n    ABRIDGEDTRANSFORMATION[\\\"Transformation from unknown to WGS84\\\",\\n        METHOD[\\\"Geocentric translations (geog2D domain)\\\",\\n            ID[\\\"EPSG\\\",9603]],\\n        PARAMETER[\\\"X-axis translation\\\",0,\\n            ID[\\\"EPSG\\\",8605]],\\n        PARAMETER[\\\"Y-axis translation\\\",0,\\n            ID[\\\"EPSG\\\",8606]],\\n        PARAMETER[\\\"Z-axis translation\\\",0,\\n            ID[\\\"EPSG\\\",8607]]]]\"  ggplot() + geom_sf(data = italy.map) + theme_bw()"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"histogram-of-event-depths","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Histogram of event depths","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"hist(df_cat$depth, breaks=seq(650,-5,-1), xlim=c(-5,40), main=\"Histogram of depths\" )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"plot-of-event-magnitudes-using-natural-time","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Plot of event magnitudes using natural time","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"Natural time refers plot event evenly spaced along x-axis. advantage data occurs periods high activity spread , means can see structure data rates high. plot magnitude events y-axis natural time horizontal. observations : 40,000 events magnitude data cluster events \\(M=0\\) likely artefact catalogue generated period time data rounded 1 decimal place producing horizontal banding times, data rounded sensitivity lowest magnitudes varies time can seen changes lowest magnitudes","code":"ggplot(df_cat, aes(x=event_num, y=M))  +    geom_point(size = 0.1) +   ggtitle('Magnitude timeseries using natural time')"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"plot-of-event-magnitudes-using-date-time","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Plot of event magnitudes using date-time","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"ggplot(df_cat, aes(x=time_date, y=M)) +    geom_point(size = 0.1) +   ggtitle(\"Horus catalogue magnitude time series\") #> Warning: Removed 1 rows containing missing values (`geom_point()`). # Filtered for M>4 ggplot(df_cat[df_cat$M>4,], aes(x=time_date, y=M)) +    geom_point(size = 0.1) +   ggtitle(\"Whole catalogue magnitude timeseries for M>4\") #> Warning: Removed 1 rows containing missing values (`geom_point()`)."},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"frequency-magnitude-analysis-for-horus-catalogue","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Frequency-magnitude analysis for Horus catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"minMag <- 3 maxMag <- max(df_cat$M)  mags <- df_cat[df_cat$M>minMag,]$M  tmp <- hist(mags, breaks=seq(minMag-0.05,maxMag+0.1,0.1), plot=FALSE)  N.counts <- length( tmp$counts) tmp$cumulativeCounts <- cumsum(tmp$counts[N.counts:1])[N.counts:1]  m.min <- 4 bin_m.min <- which(tmp$mids==m.min) freq_m.min <- tmp$counts[bin_m.min] b <- 1.1 x <- tmp$mids y <- freq_m.min * 10^(-b*(x-m.min)) y.cum <- tmp$cumulativeCounts[bin_m.min] * 10^(-b*(x-m.min))  ggplot() +   geom_point( aes(x=tmp$mids, y=tmp$counts) ) +   geom_point( aes(x=tmp$mids, y=tmp$cumulativeCounts) , color='red', pch=\"+\", size=2) +   scale_y_log10() +   ggtitle(paste(\"Frequency-magnitude plot with arbitary GR dist: b =\", b)) +   xlab(\"Magnitude\") +   ylab(\"log10(Frequency)\") +   geom_line(aes(x=x, y=y)) +   geom_line(aes(x=x, y=y.cum), color='red') +   geom_vline( xintercept=m.min, lty=2 ) #> Warning: Transformation introduced infinite values in continuous y-axis"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"b-value-stability-plot-for-the-events-in-the-horus-catalogue","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"b-value stability plot for the events in the Horus catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"minMag <- 0 maxMag <- max(df_cat$M, na.rm=TRUE) mags <- df_cat[df_cat$M>=minMag,]$M  x <- seq(minMag,maxMag,0.1)  b.stability.list <- c() b.error.list <- c() m.mean <- c()  b_utsu <- c() b_guttorp <- c() b_elst <- c() delta_b_utsu <- c() b_elst_lower <- c() b_elst_upper <- c()  max.index.x <- length(x)-5  for( i in 1:max.index.x ){   mag.threshold <- x[i]   mags.subset <- mags[mags > mag.threshold]      N <- length(mags.subset)   b_utsu[i] <- 1/( log(10)*(mean(mags.subset)-mag.threshold+0.05))   delta_b_utsu[i] <- log(10)*b_utsu[i]**2 * sqrt( sum((mags.subset - mean(mags.subset))**2)/(N*(N-1)))        b_guttorp[i] = 1/( 2*0.05*log(10))*log((mean(mags.subset)-mag.threshold+2*0.05)/(mean(mags.subset)-mag.threshold))        deltaMags <- diff(mags.subset)   deltaMags_p <- deltaMags[deltaMags>0.1]   N <- length(deltaMags_p)   b_elst[i] <- 1/(2*0.05* log(10)) * log((mean(deltaMags_p))/(mean(deltaMags_p)-0.1))   c = 10**(0.1*b_elst[i])   b_elst_lower[i] <- 1/(0.1 * log(10)) * log((c+sqrt(c/N))/(1+sqrt(c/N)))   b_elst_upper[i] <- 1/(0.1 * log(10)) * log((c-sqrt(c/N))/(1-sqrt(c/N))) }  ggplot() +   geom_line( aes(x=x[1:max.index.x], y=b_utsu) ) +   geom_line( aes(x=x[1:max.index.x], y=b_utsu+delta_b_utsu), color=2, lty=2 ) +   geom_line( aes(x=x[1:max.index.x], y=b_utsu-delta_b_utsu), color=2, lty=2 ) +   geom_line( aes(x=x[1:max.index.x], y=b_guttorp), color=3, lty=1 ) +   xlab(\"Magnitude threshold\") +   ylab(\"b-value estimate\") +   geom_hline(yintercept = 1, lty=3) +   geom_hline(yintercept = 0.85, lty=3) +   ggtitle(\"b-value stability plot for Horus catalogue\")"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"heatmap-of-the-events-in-the-horus-catalogue","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Heatmap of the events in the Horus catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"ggplot() +   geom_hex(data = df_cat[df_cat$M>3,], aes(x = lon, y = lat), bins = 50) +   scale_fill_continuous(type = \"viridis\") +   geom_sf(data = italy.map, fill=alpha(\"lightgrey\", 0), color = 'orange', size=0.2) +    ggtitle(\"Density plot for M>3 events\") +   theme_bw()"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"map-of-the-events-in-the-italian-horus-catalogue","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Map of the events in the Italian Horus catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"ggplot() +   geom_sf(data = df_cat.sf[df_cat$M>3,], size = 0.05) +   geom_sf(data = italy.map, fill=alpha(\"lightgrey\", 0), color = 'green', linewidth=0.7) +   geom_sf(data = df_cat.sf[df_cat$M>5,], size = 0.5, color='orange') +   geom_sf(data = df_cat.sf[df_cat$M>6,], size = 0.5, color='red') +   ggtitle(\"Map of event locations\")"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"analysis-if-the-laquila-sequence","dir":"Articles","previous_headings":"","what":"Analysis if the L’Aquila Sequence","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"focus L Aquila seismic sequence sufficient retain observations specific space-time-magnitude region include sequence interest. L’Aquila sequence, retain events magnitude greater equal \\(2.5\\) happened 2009 longitude \\((10.5, 16)\\) latitude \\((40.5, 45)\\). L’Aquila sequence selected way composed 1024 events. seismic sequence can selected similarly. selection convenient transform time string Date object select rows Horus catalogue verifying conditions. start.date = “2009-04-06 00:00:00 BST” end.date = “2010-01-01 00:00:00 BST” magnitude.completeness = 2.49 min.longitude = 13.00 max.longitude = 13.75 min.latitude = 42.2 max.latitude = 42.5","code":"eventDate <- ymd_hms( '2009-04-06 00:00:00' ) endDate <- eventDate + days(400) startDate <- eventDate - days(50) deltaLat <- 2.4 latLims <- c( 42.2,42.5) longLims <- c( 13, 13.75)  minMAG <- 0  # Subset the main catalogue df_cat.subset <- df_cat[df_cat$M >= minMAG, ] df_cat.subset <- df_cat.subset[ (df_cat.subset$lat>latLims[1]), ] df_cat.subset <- df_cat.subset[ (df_cat.subset$lat<latLims[2]), ] df_cat.subset <- df_cat.subset[ (df_cat.subset$lon>longLims[1]), ] df_cat.subset <- df_cat.subset[ (df_cat.subset$lon<longLims[2]), ]  head(df_cat.subset) #>             time_string     lon     lat depth    M           time_date #> 243 1961-03-25T10:40:00 13.3167 42.4333     0 3.64 1961-03-25 10:40:00 #> 295 1961-10-05T19:59:35 13.0167 42.3500     3 0.00 1961-10-05 19:59:35 #> 302 1961-10-31T00:00:00 13.0167 42.3500    10 3.94 1961-10-31 00:00:00 #> 303 1961-10-31T00:00:00 13.0167 42.3500    10 3.94 1961-10-31 00:00:00 #> 304 1961-10-31T13:37:18 13.0833 42.4167     4 4.64 1961-10-31 13:37:18 #> 305 1961-10-31T13:41:59 13.0833 42.4167     0 4.14 1961-10-31 13:41:59 #>     event_num #> 243       243 #> 295       295 #> 302       302 #> 303       303 #> 304       304 #> 305       305"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"plot-of-the-event-magnitude-time-series-laquila","dir":"Articles","previous_headings":"Analysis if the L’Aquila Sequence","what":"Plot of the event magnitude time series: l’Aquila","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"ggplot() +    geom_point(data=df_cat.subset[df_cat.subset$M>3,], aes(time_date, lat), size=0.1) +   geom_point(data=df_cat.subset[df_cat.subset$M>5,], aes(time_date, lat), size=1.2, color='orange') +   geom_point(data=df_cat.subset[df_cat.subset$M>6,], aes(time_date, lat), size=1.5, color='red') +   ggtitle(\"L'Aquila latitude-time plot\") +   geom_rect(aes(xmin = as.POSIXct(startDate), xmax = as.POSIXct(endDate), ymin = latLims[1], ymax = latLims[2]), alpha = 0.4, fill='blue', color='blue') minMag <- 0 maxMag <- max(df_cat.subset$M, na.rm=TRUE)  mags <- df_cat.subset[df_cat.subset$M>=minMag,]$M  tmp <- hist(mags, breaks=seq(minMag-0.05,maxMag+0.4,0.1), plot=FALSE)  N.counts <- length( tmp$counts) tmp$cumulativeCounts <- cumsum(tmp$counts[N.counts:1])[N.counts:1]  m.min <- 4 bin_m.min <- which(tmp$mids==m.min) freq_m.min <- tmp$counts[bin_m.min] b <- 1. x <- tmp$mids y <- freq_m.min * 10^(-b*(x-m.min)) y.cum <- tmp$cumulativeCounts[bin_m.min] * 10^(-b*(x-m.min))  ggplot() +   geom_point( aes(x=tmp$mids, y=tmp$counts) ) +   geom_point( aes(x=tmp$mids, y=tmp$cumulativeCounts) , color='red', pch=\"+\") +   scale_y_log10() +   ggtitle(paste(\"Frequency-magnitude plot with arbitary GR dist: b =\", b)) +   xlab(\"Magnitude\") +   ylab(\"log10(Frequency)\") +   geom_line(aes(x=x, y=y)) +   geom_line(aes(x=x, y=y.cum), color='red') +   geom_vline( xintercept=m.min, lty=2 ) #> Warning: Transformation introduced infinite values in continuous y-axis #> Transformation introduced infinite values in continuous y-axis"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"b-value-stability-plot-laquila","dir":"Articles","previous_headings":"Analysis if the L’Aquila Sequence","what":"b-value stability plot: l’Aquila","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"minMag <- 0 maxMag <- max(df_cat.subset$M, na.rm=TRUE) mags <- df_cat.subset[df_cat.subset$M>=minMag,]$M  x <- seq(minMag,maxMag,0.1)  b.stability.list <- c() b.error.list <- c() m.mean <- c()  b_utsu <- c() b_guttorp <- c() b_elst <- c() delta_b_utsu <- c() b_elst_lower <- c() b_elst_upper <- c()  max.index.x <- length(x)-5  for( i in 1:max.index.x ){   mag.threshold <- x[i]   mags.subset <- mags[mags > mag.threshold]      N <- length(mags.subset)   b_utsu[i] <- 1/( log(10)*(mean(mags.subset)-mag.threshold+0.05))   delta_b_utsu[i] <- log(10)*b_utsu[i]**2 * sqrt( sum((mags.subset - mean(mags.subset))**2)/(N*(N-1)))        b_guttorp[i] = 1/( 2*0.05*log(10))*log((mean(mags.subset)-mag.threshold+2*0.05)/(mean(mags.subset)-mag.threshold))        deltaMags <- diff(mags.subset)   deltaMags_p <- deltaMags[deltaMags>0.1]   N <- length(deltaMags_p)   b_elst[i] <- 1/(2*0.05* log(10)) * log((mean(deltaMags_p))/(mean(deltaMags_p)-0.1))   c = 10**(0.1*b_elst[i])   b_elst_lower[i] <- 1/(0.1 * log(10)) * log((c+sqrt(c/N))/(1+sqrt(c/N)))   b_elst_upper[i] <- 1/(0.1 * log(10)) * log((c-sqrt(c/N))/(1-sqrt(c/N))) }  ggplot() +   geom_line( aes(x=x[1:max.index.x], y=b_utsu) ) +   geom_line( aes(x=x[1:max.index.x], y=b_utsu+delta_b_utsu), color=2, lty=2 ) +   geom_line( aes(x=x[1:max.index.x], y=b_utsu-delta_b_utsu), color=2, lty=2 ) +   geom_line( aes(x=x[1:max.index.x], y=b_guttorp), color=3, lty=1 ) +   xlab(\"Magnitude threshold\") +   ylab(\"b-value estimate\") +   geom_hline(yintercept = 1, lty=3) +   geom_hline(yintercept = 0.85, lty=3) +   ggtitle(\"b-value stability plot for Horus catalogue\") #> Warning: Removed 2 rows containing missing values (`geom_line()`). #> Removed 2 rows containing missing values (`geom_line()`)."},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/generateSyntheticCatalogues.html","id":"create-catalogue","dir":"Articles","previous_headings":"","what":"Create catalogue","title":"2a Temporal Model: Generating synthetic temporal ETAS catalogues","text":"define ETAS parameters define model domain specify history generate ETAS sample plot results","code":"mu <- 1070. / 365 K <- 0.089 alpha <- 2.29 c <- 0.011 p <- 1.08  modelledDuration <- 10 # [days]  M0 <- 2  theta_etas <- data.frame(mu = mu, K = K, alpha = alpha, c = c, p = p)  Ht <- data.frame(ts = c(0., 1.5), magnitudes = c(6.7, 7.))  samp.etas.list <- generate_temporal_ETAS_synthetic(theta = theta_etas, beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = Ht)  ggplot() +   geom_point(data = samp.etas.list[[1]], aes(x = ts, y = magnitudes), color = \"red\") +   geom_point(data = samp.etas.list[[2]], aes(x = ts, y = magnitudes), color = \"green\") +   xlim(0, modelledDuration) +   ggtitle(\"M7 plus background and ETAS\") combined.M7.ETAS.cat <- bind_rows(samp.etas.list)  combined.M7.ETAS.cat <- bind_rows(samp.etas.list) combined.M7.ETAS.cat <- combined.M7.ETAS.cat[order(combined.M7.ETAS.cat$ts), ]  combined.M7.ETAS.cat$ID <- seq(1, length(combined.M7.ETAS.cat$ts))  ggplot() +   geom_point(data = combined.M7.ETAS.cat, aes(x = ID, y = magnitudes), color = \"red\") #+ #  geom_ma(data = combined.M7.ETAS.cat, aes(x=ID, y=magnitudes), ma_fun = SMA, n = 10)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sampleFromETASpriors.html","id":"sampling-etas-priors","dir":"Articles","previous_headings":"","what":"Sampling ETAS Priors","title":"2b Temporal Model: Presenting samples drawn from the ETAS priors","text":"important check priors broad enough expect model parameterisation lie within . notebook shows draw samples priors present resulting triggering functions.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"multiple-analyses-of-two-catalogues-using-different-initial-values","dir":"Articles","previous_headings":"","what":"Multiple analyses of two catalogues using different initial values","title":"Sensitivity to starting point","text":"inlabru algorithm takes initial guess mode parameters inverting iteratively updates initial guess. potential may bad initial conditions find different solutions runtime differ depending upon solution converges. notebook, explore robustness posteriors two synthetic catalogues true parameters known. catalogues contain 2000 days data. One catalogue contain large event second contains M6.7 event day 1000.","code":"library(ETAS.inlabru)  library(tidyquant) library(gridExtra) library(grid) library(lemon) library(ggplot2) library(ggpubr) library(GGally)  library(inlabru) library(INLA) library(ETAS.inlabru)  # inla.setOption(pardiso.license=\"~/sys/licences/pardiso.lic\")  library(dplyr)  # Increase num.threads if you have more cores on your computer INLA::inla.setOption(num.threads = 2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"define-the-parameters-for-the-synthetic-catalogues-and-starting-values-for-inversion","dir":"Articles","previous_headings":"Multiple analyses of two catalogues using different initial values","what":"Define the parameters for the synthetic catalogues and starting values for inversion","title":"Sensitivity to starting point","text":"","code":"# Parameters we use to generate synthetics, which we will refer to as the 'true' parameters mu <- 0.1 K <- 0.089 alpha <- 2.29 c <- 0.11 p <- 1.08  # Format the true ETAS parameters for code to generate the synthetics theta_etas <- data.frame(mu = mu, K = K, alpha = alpha, c = c, p = p)  # A dataframe containing different starting values for the algorithm startingValues <- data.frame(   mu = c(5., mu),   K = c(1., K),   alpha = c(5., alpha),   c = c(0.3, c),   p = c(1.5, p) ) nRealisations <- length(startingValues$mu)   # Temporal duration of the synthetic catalogue in days modelledDuration <- 1000 # [days]  # The minimum magnitude that will be modelled M0 <- 2.5"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"generate-new-catalogues-and-save-them","dir":"Articles","previous_headings":"Multiple analyses of two catalogues using different initial values","what":"Generate new catalogues and save them","title":"Sensitivity to starting point","text":"vignette use Rmd caching, can save catalogues files explicitly:","code":"############ #### Generate the first catalogue with no large events  samp.etas.list <- generate_temporal_ETAS_synthetic(   theta = theta_etas,   beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = NULL )  quiet.ETAS.cat <- bind_rows(samp.etas.list) quiet.ETAS.cat <- quiet.ETAS.cat[order(quiet.ETAS.cat$ts), ] # quiet.ETAS.cat <- na.omit(quiet.ETAS.cat) ############ #### Generate the second catalogue with a M6.7 event on day 1000  Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) # Impose a M6.7 event on day 1000  samp.etas.list <- generate_temporal_ETAS_synthetic(theta = theta_etas, beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = Ht)  M6p7.ETAS.cat <- bind_rows(samp.etas.list) M6p7.ETAS.cat <- M6p7.ETAS.cat[order(M6p7.ETAS.cat$ts), ] # save(M6p7.ETAS.cat,file=\"M6p7_ETAS_cat.Rda\") # save(quiet.ETAS.cat,file=\"quiet.ETAS.cat.Rda\")"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"load-the-catalogues","dir":"Articles","previous_headings":"Present the catalogues","what":"Load the catalogues","title":"Sensitivity to starting point","text":"read saved object files:","code":"# load(\"M6p7_ETAS_cat.Rda\") # load(\"quiet.ETAS.cat.Rda\")"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-properties-of-the-catalogues","dir":"Articles","previous_headings":"Present the catalogues","what":"Plot properties of the catalogues","title":"Sensitivity to starting point","text":"","code":"plots <- list()  plots[[1]] <- ggplot() +   geom_point(data = quiet.ETAS.cat, aes(x = ts, y = magnitudes), size = 0.1, alpha = 0.5) +   xlim(0, modelledDuration) +   ggtitle(paste(\"A.  Unseeded catalog, nEvents =\", length(quiet.ETAS.cat$ts))) +   ylim(2, 7) +   xlab(\"Time [days]\") +   ylab(\"Magnitude\") +   theme_bw()  plots[[2]] <- ggplot() +   geom_point(data = M6p7.ETAS.cat, aes(x = ts, y = magnitudes), size = 0.1, alpha = 0.5) +   xlim(0, modelledDuration) +   ggtitle(paste(\"B.  Catalog seeded with M6.7 event on day 500, nEvents =\", length(M6p7.ETAS.cat$ts))) +   ylim(2, 7) +   xlab(\"Time [days]\") +   ylab(\"Magnitude\") +   theme_bw()   plt <- grid.arrange(plots[[1]], plots[[2]], ncol = 1, nrow = 2) # ggsave(\"initialConditionCats.png\", plt) # ggsave(\"initialConditionCats.pdf\", plt)"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"analysis-of-quiet-catalogue","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Analysis of quiet catalogue","title":"Sensitivity to starting point","text":"","code":"list.output.quietScenario <- list()  for (i in seq_len(nRealisations)) {   if (exists(\"list.input\")) remove(\"list.input\")    # Load a set of parameters that we will need to tweak for this application   fpath <- system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\")   list.input <- create_input_list_temporal_noCatalogue(fpath)    ####################   # Tweak the variables loaded from the input file   list.input$M0 <- M0   list.input$time.int <- c(0, modelledDuration)   list.input$T12 <- c(0, modelledDuration)    # Change the starting location, measured on the ETAS scale   list.input$mu.init <- startingValues$mu[i]   list.input$alpha.init <- startingValues$alpha[i]   list.input$K.init <- startingValues$K[i]   list.input$c.init <- startingValues$c[i]   list.input$p.init <- startingValues$p[i]    link.f <- list(     mu = \\(x) gamma_t(x, a_mu, b_mu),     K = \\(x) loggaus_t(x, a_K, b_K),     alpha = \\(x) unif_t(x, a_alpha, b_alpha),     c_ = \\(x) unif_t(x, a_c, b_c),     p = \\(x) unif_t(x, a_p, b_p)   )    # initial value - convert from ETAS scale to internal scale   list.input$th.init <- list(     th.mu = inv_gamma_t(list.input$mu.init, list.input$a_mu, list.input$b_mu),     th.K = inv_loggaus_t(list.input$K.init, list.input$a_K, list.input$b_K),     th.alpha = inv_unif_t(list.input$alpha.init, list.input$a_alpha, list.input$b_alpha),     th.c = inv_unif_t(list.input$c.init, list.input$a_c, list.input$b_c),     th.p = inv_unif_t(list.input$p.init, list.input$a_p, list.input$b_p)   )    # Define options for inlabru   if (is.null(list.input$max_step)) {     list.input$bru.opt.list <- list(       bru_verbose = 0, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       # bru_method = list(max_step = 0.5),       bru_initial = list.input$th.init     ) # parameters initial values   } else {     list.input$bru.opt.list <- list(       bru_verbose = 0, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       bru_method = list(max_step = list.input$max_step),       bru_initial = list.input$th.init     ) # parameters initial values   }    ## Add out catalogue to the input list   list.input$catalog <- data.frame(     time_diff = quiet.ETAS.cat$ts,     magnitudes = quiet.ETAS.cat$magnitudes   )    ## Add the catalogue formatted for bru   list.input$catalog.bru <- data.frame(     ts = quiet.ETAS.cat$ts,     magnitudes = quiet.ETAS.cat$magnitudes,     idx.p = seq_len(nrow(quiet.ETAS.cat))   )    ## Input list is now formatted   ####################    ## Run the model according to the input list   ETAS.model.fit <- Temporal.ETAS.fit(list.input)    ## Small bit of post processing   list.output.quietScenario[[i]] <- append(list.input, list(model.fit = ETAS.model.fit))   list.output.quietScenario[[i]]$runtime <- sum(list.output.quietScenario[[i]]$model.fit$bru_timings$Time)   list.output.quietScenario[[i]]$nEvents <- length(list.output.quietScenario[[i]]$catalog[, 1]) } #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  0.3745506  #> Finish model fitting  #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  0.3498616  #> Finish model fitting"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"analysis-of-m6-7-catalogue","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Analysis of M6.7 catalogue","title":"Sensitivity to starting point","text":"","code":"list.output.M6p7Scenario <- list()  for (i in seq_len(nRealisations)) {   if (exists(\"list.input\")) {     remove(list.input)   }    # Load a set of parameters that we will need to tweak for this application   fpath <- system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\")   list.input <- create_input_list_temporal_noCatalogue(fpath)    ####################   # Tweak the variables laoded from the input file   list.input$M0 <- M0   list.input$time.int <- c(0, modelledDuration)   list.input$T12 <- c(0, modelledDuration)    # Change the starting location, measured on the ETAS scale   list.input$mu.init <- startingValues$mu[i]   list.input$alpha.init <- startingValues$alpha[i]   list.input$K.init <- startingValues$K[i]   list.input$c.init <- startingValues$c[i]   list.input$p.init <- startingValues$p[i]    link.f <- list(     mu = \\(x) gamma_t(x, a_mu, b_mu),     K = \\(x) loggaus_t(x, a_K, b_K),     alpha = \\(x) unif_t(x, a_alpha, b_alpha),     c_ = \\(x) unif_t(x, a_c, b_c),     p = \\(x) unif_t(x, a_p, b_p)   )    # initial value - convert from ETAS scale to internal scale   list.input$th.init <- list(     th.mu = inv_gamma_t(list.input$mu.init, list.input$a_mu, list.input$b_mu),     th.K = inv_loggaus_t(list.input$K.init, list.input$a_K, list.input$b_K),     th.alpha = inv_unif_t(list.input$alpha.init, list.input$a_alpha, list.input$b_alpha),     th.c = inv_unif_t(list.input$c.init, list.input$a_c, list.input$b_c),     th.p = inv_unif_t(list.input$p.init, list.input$a_p, list.input$b_p)   )    # Define options for inlabru   if (is.null(list.input$max_step)) {     list.input$bru.opt.list <- list(       bru_verbose = 3, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       # bru_method = list(max_step = 0.5),       bru_initial = list.input$th.init     ) # parameters initial values   } else {     list.input$bru.opt.list <- list(       bru_verbose = 3, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       bru_method = list(max_step = list.input$max_step),       bru_initial = list.input$th.init     ) # parameters initial values   }    ## Add out catalogue to the input list   list.input$catalog <- data.frame(     time_diff = M6p7.ETAS.cat$ts,     magnitudes = M6p7.ETAS.cat$magnitudes   )    ## Add the catalogue formatted for bru   list.input$catalog.bru <- data.frame(     ts = M6p7.ETAS.cat$ts,     magnitudes = M6p7.ETAS.cat$magnitudes,     idx.p = seq_len(nrow(M6p7.ETAS.cat))   )    ## Input list is now formatted   ####################    ## Run the model according to the input list   ETAS.model.fit <- Temporal.ETAS.fit(list.input)    ## Small bit of post processing   list.output.M6p7Scenario[[i]] <- append(list.input, list(model.fit = ETAS.model.fit))   list.output.M6p7Scenario[[i]]$runtime <- sum(list.output.M6p7Scenario[[i]]$model.fit$bru_timings$Time)   list.output.M6p7Scenario[[i]]$nEvents <- length(list.output.M6p7Scenario[[i]]$catalog[, 1]) } #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  7.252917 #> iinla: Evaluate component inputs #> iinla: Evaluate component linearisations #> iinla: Evaluate component simplifications #> iinla: Evaluate predictor linearisation #> iinla: Construct inla stack #> iinla: Model initialisation completed #> iinla: Iteration 1 [max:100] #> iinla: Step rescaling: 89.98%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Iteration 2 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 1640% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 3 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 38.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 3880% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 4 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 71.43%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 208% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 5 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 112.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 1030% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 6 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 101.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 334% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 7 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 105.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 192% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 8 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.4%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 178% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 9 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 101.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 145% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 10 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.9%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 132% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 11 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.8%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 119% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 12 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.7%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 108% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 13 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.6%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 98.2% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 14 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.5%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 89.6% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 15 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.5%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 82% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 16 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.4%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 75.1% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 17 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.4%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 69% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 18 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 63.4% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 19 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 58.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 20 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 53.7% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 21 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 49.5% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 22 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 45.7% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 23 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 42.2% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 24 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 39% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 25 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 36% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 26 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 33.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 27 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 30.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 28 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 28.5% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 29 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 26.4% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 30 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 24.5% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 31 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 22.7% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 32 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 21% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 33 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 19.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 34 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 18.1% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 35 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 16.8% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 36 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 15.6% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 37 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 14.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 38 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 13.4% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 39 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 12.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 40 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 11.6% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 41 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 10.7% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 42 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 9.97% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Convergence criterion met, running final INLA integration with known theta mode. #> iinla: Iteration 43 [max:100] #> Finish model fitting  #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  7.048409 #> iinla: Evaluate component inputs #> iinla: Evaluate component linearisations #> iinla: Evaluate component simplifications #> iinla: Evaluate predictor linearisation #> iinla: Construct inla stack #> iinla: Model initialisation completed #> iinla: Iteration 1 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Iteration 2 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 14% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 3 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 11.9% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 4 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 10.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 5 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 10.1% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 6 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 9.41% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Convergence criterion met, running final INLA integration with known theta mode. #> iinla: Iteration 7 [max:100] #> Finish model fitting"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-posteriors-with-corresponding-starting-values","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions > Analysis of M6.7 catalogue","what":"Plot posteriors with corresponding starting values","title":"Sensitivity to starting point","text":"","code":"plots <- list()  trueParas <- data.frame(value = c(mu, K, alpha, c, p), param = c(\"mu\", \"K\", \"alpha\", \"c\", \"p\"))  post.list <- get_posterior_param(input.list = list.output.quietScenario[[1]]) post.df <- post.list[[1]] post.df$id <- 1  for (i in 2:nRealisations) {   post.list <- get_posterior_param(input.list = list.output.quietScenario[[i]])   post.df.tmp <- post.list[[1]]   post.df.tmp$id <- i    post.df <- rbind(post.df, post.df.tmp) }  plots[[1]] <- ggplot(post.df, aes(x = x, y = y, group = id, color = factor(id), lty = factor(id))) +   geom_line() +   # scale_x_discrete(guide = guide_axis(check.overlap = TRUE)) +   facet_wrap(facets = vars(param), scales = \"free\", labeller = label_parsed, nrow = 1) +   geom_vline(aes(xintercept = value),     data = trueParas, color = \"black\", linetype = 2,     label = \"True value\"   ) +   labs(color = \"Initial ETAS Para. Set\", linetype = \"Initial ETAS Para. Set\") +   ggtitle(paste(\"A.  Inversion of a 1000 day catalogue with no large events, nEvents =\", length(quiet.ETAS.cat$ts))) +   xlab(\"ETAS Posteriors\") +   theme_bw() +   theme(axis.text.x = element_text(angle = 45, hjust = 1)) +   theme(legend.position = \"hidden\") +   theme(plot.title = element_text(size = 12)) #> Warning in geom_vline(aes(xintercept = value), data = trueParas, color = #> \"black\", : Ignoring unknown parameters: `label` trueParas <- data.frame(value = c(mu, K, alpha, c, p), param = c(\"mu\", \"K\", \"alpha\", \"c\", \"p\"))  post.list <- get_posterior_param(input.list = list.output.M6p7Scenario[[1]]) post.df <- post.list[[1]] post.df$id <- 2  for (i in 2:nRealisations) {   post.list <- get_posterior_param(input.list = list.output.M6p7Scenario[[i]])   post.df.tmp <- post.list[[1]]   post.df.tmp$id <- i    post.df <- rbind(post.df, post.df.tmp) }  plots[[2]] <- ggplot(post.df, aes(x = x, y = y, group = id, color = factor(id), lty = factor(id))) +   geom_line() +   # scale_x_discrete(guide = guide_axis(check.overlap = TRUE)) +   facet_wrap(facets = vars(param), scales = \"free\", labeller = label_parsed, nrow = 1) +   geom_vline(aes(xintercept = value),     data = trueParas, color = \"black\", linetype = 2,     label = \"True value\"   ) +   labs(color = \"Initial ETAS Para. Set\", linetype = \"Initial ETAS Para. Set\") +   ggtitle(paste(\"B. Inversion of a 1000 day catalogue with a M6.7 on day 500, nEvents =\", length(M6p7.ETAS.cat$ts))) +   xlab(\"ETAS Posteriors\") +   theme_bw() +   theme(axis.text.x = element_text(angle = 45, hjust = 1)) +   theme(legend.position = \"hidden\") +   theme(plot.title = element_text(size = 12)) #> Warning in geom_vline(aes(xintercept = value), data = trueParas, color = #> \"black\", : Ignoring unknown parameters: `label` plt <- grid_arrange_shared_legend(plots[[1]], plots[[2]], ncol = 1, nrow = 2, position = \"bottom\") plt #> TableGrob (2 x 1) \"arrange\": 2 grobs #>   z     cells    name              grob #> 1 1 (1-1,1-1) arrange   gtable[arrange] #> 2 2 (2-2,1-1) arrange gtable[guide-box] # ggsave(\"initialCondition_posteriors.png\", plt) # ggsave(\"initialCondition_posteriors.pdf\", plt)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"explore-etas-triggering-function-using-posterior-samples","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Explore ETAS triggering function using posterior samples","title":"Sensitivity to starting point","text":"","code":"plot_triggering <- list() plot_triggering[[1]] <- triggering_fun_plot(list.output.quietScenario[[1]], magnitude = 4, n.samp = 100) +   ggtitle(\"C. M4 triggering function\") +   theme_bw() +   ylim(0, 5.5) +   theme(plot.title = element_text(size = 8))  plot_triggering[[2]] <- triggering_fun_plot(list.output.M6p7Scenario[[1]], magnitude = 4, n.samp = 100) +   ggtitle(\"D. M4 triggering function\") +   theme_bw() +   ylim(0, 5.5) +   theme(plot.title = element_text(size = 8))  plot_triggering[[3]] <- triggering_fun_plot(list.output.quietScenario[[1]], magnitude = 6.7, n.samp = 100) +   ggtitle(\"E. M6.7 triggering function\") +   theme_bw() +   ylim(0, 1700) +   theme(plot.title = element_text(size = 8))   plot_triggering[[4]] <- triggering_fun_plot(list.output.M6p7Scenario[[1]], magnitude = 6.7, n.samp = 100) +   ggtitle(\"F. M6.7 triggering function\") +   theme_bw() +   ylim(0, 1700) +   theme(plot.title = element_text(size = 8))   plt <- grid.arrange(plot_triggering[[1]], plot_triggering[[3]], plot_triggering[[2]], plot_triggering[[4]], ncol = 2, nrow = 2, top = \"Triggering function variability\") +   theme(plot.title = element_text(size = 8)) #> Warning: Removed 17 rows containing missing values (`geom_line()`). #> Warning: Removed 2 rows containing missing values (`geom_line()`). #> Warning: Removed 37 rows containing missing values (`geom_line()`). #> Warning: Removed 4 rows containing missing values (`geom_line()`). plt #> NULL  # ggsave(\"trigFuncVariability_runin.png\", plt) # ggsave(\"trigFuncVariability_runin.pdf\", plt) plot_omori <- list() plot_omori[[1]] <- omori_plot_posterior(list.output.quietScenario[[1]], n.samp = 100) +   ggtitle(\"A. Omori decay\") +   theme_bw() +   ylim(0, 1) +   theme(plot.title = element_text(size = 8))   plot_omori[[2]] <- omori_plot_posterior(list.output.M6p7Scenario[[1]], n.samp = 100) +   ggtitle(\"B. Omori decay\") +   theme_bw() +   ylim(0, 1) +   theme(plot.title = element_text(size = 8)) plt <- grid.arrange(plot_omori[[1]], plot_triggering[[1]], plot_triggering[[3]], plot_omori[[2]], plot_triggering[[2]], plot_triggering[[4]], ncol = 3, nrow = 2, top = \"Triggering  function variability\", left = \"M6.7 baseline            Unseeded baseline\") #> Warning: Removed 17 rows containing missing values (`geom_line()`). #> Warning: Removed 2 rows containing missing values (`geom_line()`). #> Warning: Removed 37 rows containing missing values (`geom_line()`). #> Warning: Removed 4 rows containing missing values (`geom_line()`). plt #> TableGrob (3 x 4) \"arrange\": 8 grobs #>   z     cells    name                 grob #> 1 1 (2-2,2-2) arrange       gtable[layout] #> 2 2 (2-2,3-3) arrange       gtable[layout] #> 3 3 (2-2,4-4) arrange       gtable[layout] #> 4 4 (3-3,2-2) arrange       gtable[layout] #> 5 5 (3-3,3-3) arrange       gtable[layout] #> 6 6 (3-3,4-4) arrange       gtable[layout] #> 7 7 (1-1,2-4) arrange text[GRID.text.1299] #> 8 8 (1-3,1-1) arrange text[GRID.text.1300]  # ggsave(\"trigFuncVariability_runin.png\", plt) # ggsave(\"trigFuncVariability_runin.pdf\", plt)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-the-samples-from-the-joint-posteriors-as-pairs-plots","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Plot the samples from the joint posteriors as pairs plots","title":"Sensitivity to starting point","text":"","code":"post_pairs_plot(list.output.quietScenario[[1]], n.samp = 1000)$pair.plot post_pairs_plot(list.output.M6p7Scenario[[1]], n.samp = 1000)$pair_plot #> NULL"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"inlabru-convergence-diagnostics","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"inlabru convergence diagnostics","title":"Sensitivity to starting point","text":"can also assess convergence inlabru method , using bru_convergence_plot() function. can reveal starting values inlabru estimation unreasonable, better starting values nonlinear iterations might speed computations.","code":"bru_convergence_plot(list.output.quietScenario[[1]]$model.fit) bru_convergence_plot(list.output.quietScenario[[2]]$model.fit) bru_convergence_plot(list.output.M6p7Scenario[[1]]$model.fit) bru_convergence_plot(list.output.M6p7Scenario[[2]]$model.fit)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"introduction-to-etas-model","dir":"Articles","previous_headings":"","what":"Introduction to ETAS model","title":"2d Temporal Model: Tutorial on real data","text":"tutorial, show use ETAS.inlabru R-package fit temporal ETAS model real earthquakes data. tutorial shows prepare data, fit model, retrieve posterior distribution parameters posterior distribution quantities interest, generate synthetic catalogues fitted model, produce forecasts seismicity. Epidemic-Type Aftershock Sequence (ETAS) model belongs family Hawkes () point processes. temporal Hawkes process point process model conditional intensity given \\[ \\lambda(t | \\mathcal H_t) = \\mu + \\sum_{t_h \\\\mathcal H_t} g(t- t_h) \\] \\(\\mathcal H_t\\) history process time \\(t\\). Generally speaking \\(\\mathcal H_t\\) contains events occurred \\(t\\). quantity \\(\\mu > 0\\) usually called , interpreted rate events occur spontaneously. function \\(g(t-t_h)\\) called function (excitation function, simply kernel) measures influence event \\(t_h\\) time \\(t\\). look \\(g(t-t_h)\\) function \\(t\\) intensity point process representing offspring event \\(t_h\\). seismology offspring event called , two terms used synonyms. essence, Hawkes process model can seen superposition background process intensity \\(\\mu\\) aftershock processes generated observations \\(\\mathcal H_t\\) one intensity \\(g(t-t_h)\\). makes Hawkes process model particularly suitable describe phenomena event ability trigger additional events, phenomena characterized cascades events earthquakes, infectious diseases, wildfires, financial crisis, similar. ETAS model particular instance Hawkes process model proven particularly suitable model earthquake occurrence. Earthquakes usually described modelled marked time points marking variable magnitude event. history process composed time-magnitude pairs, namely \\(\\mathcal H_t = \\{(t_h,m_h), h = 1,...,N_h\\}\\). Various slightly different ETAS formulations exist, usually characterized slightly different triggering functions, one implemented ETAS.inlabru R-package conditional intensity given \\[ \\lambda(t | \\mathcal H_t) = \\mu + \\sum_{t_h \\\\mathcal H_t} K \\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] \\(M_0\\) cutoff magnitude \\(m_h \\geq M_0\\) \\(h\\). value decided priori based quality catalogue used. parameters model : \\(\\mu \\geq 0\\), background rate \\(K \\geq 0\\) general productivity parameter, plays role determining average number aftershocks induced event catalogue. \\(\\alpha \\geq 0\\) magnitude scaling parameter, determines number aftershocks changes based magnitude event generating aftershocks. non-negative reflect fact stronger earthquakes generate aftershocks. \\(c > 0\\) time offset parameter, smaller values associated catalogues fewer missing events. \\(p > 1\\) aftershock decay parameter, determines rate aftershock activity decreases time. greater 1 otherwise event may generate infinite number aftershocks infinite interval time thought unphysical.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"priors","dir":"Articles","previous_headings":"","what":"Priors","title":"2d Temporal Model: Tutorial on real data","text":"Bayesian analysis need decide priors parameters. approximation method use considers parameters two different scales: original ETAS scale, internal scale. internal scale used package perform calculations. internal scale parameters constraint standard normal distribution prior. need set priors parameters ETAS scale. done considering copula transformation \\(\\eta(X)\\) \\(X \\sim N(0,1)\\) , \\(\\eta(X)\\) desired distribution. ETAS.inlabru R-package provides four different functions corresponding three different distributions: gamma_t(X, , b) Gamma distribution shape parameter \\(\\) rate \\(b\\). distribution mean \\(/b\\) variance \\(/b^2\\). unit_t(X, , b) Uniform distribution \\(\\) \\(b\\). exp_t(X, r) Exponential distribution rate \\(r\\). loggaus_t(X, m ,s) Log-Gaussian distribution mean logarithm \\(m\\) standard deviation logarithm \\(s\\). code generate 1000 observations normal distribution, transform using functions provided package, shows empirical density estimated sample.  package also provide inverse functions retrieve value parameter internal scale value ETAS scale provided. example decided priors going use analysis, need store corresponding copula transformations list. list one element parameter model (\\(5\\)), element list must name corresponding parameter. names fixed mu, K, alpha, c_, p. parameter \\(c\\) referred c_ avoid clashing names R function c(). useful inverse functions also, list used set initial value parameters later. code assumes parameter \\(\\mu\\) Gamma distribution prior parameters \\(0.3\\) \\(0.6\\), parameters \\(K, \\alpha,\\) \\(c\\) Uniform prior \\((0,10)\\), parameter \\(p\\) Uniform prior \\((1,10)\\).","code":"# obtain sample from standard normal distribution X <- rnorm(1000) # apply copula transformations gamma.X <- gamma_t(X, 1, 2) unif.X <- unif_t(X, 0, 1) exp.X <- exp_t(X, 1) loggaus.X <- loggaus_t(X, 0.5, 0.5)  # build data.frame for plotting df.to.plot <- rbind(   data.frame(     value = X,     distribution = \"Std Normal\"   ),   data.frame(     value = gamma.X,     distribution = \"Gamma\"   ),   data.frame(     value = unif.X,     distribution = \"Uniform\"   ),   data.frame(     value = exp.X,     distribution = \"Exponential\"   ),   data.frame(     value = loggaus.X,     distribution = \"Log-Gaussian\"   ) ) # plot them ggplot(df.to.plot, aes(value)) +   geom_histogram() +   theme_bw() +   facet_wrap(facets = ~distribution, scales = \"free\") #> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. inv_gamma_t(gamma_t(1.2, 1, 2), 1, 2) #> [1] 1.2 inv_unif_t(unif_t(1.2, 1, 2), 1, 2) #> [1] 1.2 inv_exp_t(exp_t(1.2, 1), 1) #> [1] 1.2 inv_loggaus_t(loggaus_t(1.2, 1, 2), 1, 2) #> [1] 1.2 # set copula transformations list link.f <- list(   mu = \\(x) gamma_t(x, 0.3, 0.6),   K = \\(x) unif_t(x, 0, 10),   alpha = \\(x) unif_t(x, 0, 10),   c_ = \\(x) unif_t(x, 0, 10),   p = \\(x) unif_t(x, 1, 10) )  # set inverse copula transformations list inv.link.f <- list(   mu = \\(x) inv_gamma_t(x, 0.3, 0.6),   K = \\(x) inv_unif_t(x, 0, 10),   alpha = \\(x) inv_unif_t(x, 0, 10),   c_ = \\(x) inv_unif_t(x, 0, 10),   p = \\(x) inv_unif_t(x, 1, 10) )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"laquila-seismic-sequence","dir":"Articles","previous_headings":"","what":"L’Aquila seismic sequence","title":"2d Temporal Model: Tutorial on real data","text":"Earthquake data stored -called earthquake catalogues. Many different catalogues exists region easy way decide one better. , provide subset HOmogenized instRUmental Seismic (HORUS) catalogue 1960 2020. can downloaded http://horus.bo.ingv./. See data-raw/horus.R details subset created original data set. HORUS catalogue subset can accessed directly using horus ETAS.inlabru::horus: documentation data set available via ?horus. data reports earthquake time string (time_string), longitude (lon) latitude (lat) epicentre, depth kilometres (depth), moment magnitude (M). focus L’Aquila seismic sequence sufficient retain observations specific space-time-magnitude region include sequence interest. L’Aquila sequence, retain events magnitude greater equal \\(2.5\\) happened 2009 longitude \\((10.5, 16)\\) latitude \\((40.5, 45)\\). L’Aquila sequence selected way composed 1024 events. seismic sequence can selected similarly. selection convenient transform time string Date object select rows Horus catalogue verifying conditions. data can visually represented plotting time event magnitude. shows clustering observations correspondance high magnitude events. L’Aquila seismic sequence, times versus magnitudes","code":"# load ISIDE catalogue head(horus) #>           time_string     lon     lat depth    M #> 1 1960-01-03T20:19:34 15.3000 39.3000   290 6.34 #> 2 1960-01-04T09:20:00 13.1667 43.1333     0 3.94 #> 3 1960-01-06T15:17:34 12.7000 46.4833     4 4.69 #> 4 1960-01-06T15:20:53 12.7000 46.4667     0 4.14 #> 5 1960-01-06T15:31:00 12.7500 46.4333     0 3.00 #> 6 1960-01-06T15:45:00 12.7500 46.4333     0 3.00 # transform time string in Date object horus$time_date <- as.POSIXct(   horus$time_string,   format = \"%Y-%m-%dT%H:%M:%OS\" )  # set up parameters for selection start.date <- as.POSIXct(\"2009-01-01T00:00:00\", format = \"%Y-%m-%dT%H:%M:%OS\") end.date <- as.POSIXct(\"2010-01-01T00:00:00\", format = \"%Y-%m-%dT%H:%M:%OS\") min.longitude <- 10.5 max.longitude <- 16 min.latitude <- 40.5 max.latitude <- 45 M0 <- 2.5  # set up conditions for selection aquila.sel <- (horus$time_date >= start.date) &   (horus$time_date < end.date) &   (horus$lon >= min.longitude) &   (horus$lon <= max.longitude) &   (horus$lat >= min.latitude) &   (horus$lat <= max.latitude) &   (horus$M >= M0)  # select aquila <- horus[aquila.sel, ] ggplot(aquila, aes(time_date, M)) +   geom_point() +   theme_bw()"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"data-preparation-to-model-fitting","dir":"Articles","previous_headings":"","what":"Data preparation to model fitting","title":"2d Temporal Model: Tutorial on real data","text":"need prepare data.frame used input data fit ETAS model. data.frame must three columns: ts time difference starting date occurrence time events (measured days example), magnitudes magnitude events, idx.p index column different value event. names fixed changed , need set initial values parameters list containing inlabru options used. initial values stored list elements th.mu, th.K, th.alpha, th.c, th.p corresponds ETAS parameters. initial values must provided internal scale therefore useful retrieve using inverse copula transformations set . way, can find values parameters internal scale given value parameters ETAS scale. example uses \\(\\mu = 0.5, K = 0.1, \\alpha = 1, c = 0.1,\\) \\(p = 1.1\\) initial values. crucial set initial values cause numerical problems, general achieved setting initial values zero. values provided worked well various examples. Lastly, need set list inlabru options. main elements list : bru_verbose: number indicating type diagnostic output. Set 0 output. bru_max_iter: maximum number iterations. set max_step inlabru algorithm stops stopping criterion met. However, setting max_step values smaller 1 forces algorithm run exactly bru_max_iter iterations. bru_method: relevant , thing may need set max_step argument. algorithm converge without fixing max_step suggest try fix value 1, experience \\(0.5\\) \\(0.2\\) works well. example line setting bru_method commented. bru_initial: list initial values created . Note: option list, one can also set number threads allowed INLA , e.g. num.threads = 8. override global option set beginning tutorial. code likely run many different systems, using global setting easier manage.","code":"# set up data.frame for model fitting aquila.bru <- data.frame(   ts = as.numeric(     difftime(aquila$time_date, start.date, units = \"days\")   ),   magnitudes = aquila$M,   idx.p = 1:nrow(aquila) ) # set up list of initial values th.init <- list(   th.mu = inv.link.f$mu(0.5),   th.K = inv.link.f$K(0.1),   th.alpha = inv.link.f$alpha(1),   th.c = inv.link.f$c_(0.1),   th.p = inv.link.f$p(1.1) ) # set up list of bru options bru.opt.list <- list(   bru_verbose = 3, # type of visual output   bru_max_iter = 70, # maximum number of iterations   # bru_method = list(max_step = 0.5),   bru_initial = th.init # parameters' initial values )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"model-fitting","dir":"Articles","previous_headings":"","what":"Model fitting","title":"2d Temporal Model: Tutorial on real data","text":"function Temporal.ETAS fit ETAS model returns bru object output. required inputs : total.data: data.frame containing observed events. format described previous Section. M0: cutoff magnitude. events total.data must magnitude greater equal number. T1: starting time time interval want fit model. T2: end time time interval want fit model. link.functions: list copula transformation functions format described previous sections. coef.t., delta.t., N.max.: parameters temporal binning. binning strategy described Appendix B paper Approximation Bayesian Hawkes process inlabru. parameters corresponds coef.t.\\(=\\delta\\), delta.t.\\(=\\Delta\\), N.max.\\(=n_{\\max}\\). bru.opt: list inlabru options described previous Section.","code":"# set starting and time of the time interval used for model fitting. In this case, we use the interval covered by the data. T1 <- 0 T2 <- max(aquila.bru$ts) + 0.2 # fit the model aquila.fit <- Temporal.ETAS(   total.data = aquila.bru,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  2.615894"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"create-input-list","dir":"Articles","previous_headings":"","what":"Create input list","title":"2d Temporal Model: Tutorial on real data","text":"model fitted package ETAS.inlabru offers various functions visually explore output. require input list. list must different elements depending function going use. retrieve posterior parameters sample posterior parameters need two elements: model.fit: output Temporal.ETAS link.functions: list copula transformations","code":"# create input list to explore model output input_list <- list(   model.fit = aquila.fit,   link.functions = link.f )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"check-marginal-posterior-distributions","dir":"Articles","previous_headings":"","what":"Check marginal posterior distributions","title":"2d Temporal Model: Tutorial on real data","text":"function get_posterior_param can use retrieve marginal posteriors parameters ETAS scale. function returns list elements: post.df: data.frame containing posterior parameters. data.frame three columns, x value parameter, y corresponding value posterior, param indicates ETAS parameter x y referring . post.plot: ggplot object containing plot marginal posteriors parameters","code":"# get marginal posterior information post.list <- get_posterior_param(input.list = input_list)  # plot marginal posteriors post.list$post.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"sample-the-joint-posterior-and-make-pair-plot","dir":"Articles","previous_headings":"","what":"Sample the joint posterior and make pair plot","title":"2d Temporal Model: Tutorial on real data","text":"function post_sampling generate samples joint posterior ETAS parameters. function takes input: input.list: list model.fit element link.functions elements described . n.samp: number posterior samples. max.batch: number posterior samples generated simultaneously. n.samp\\(>\\)max.batch, , samples generated parallel batches maximum size equal max.batch. Default \\(1000\\). ncore: number cores used parallel n.samp\\(>\\)max.batch. function returns data.frame columns corresponding ETAS parameters posterior samples can used analyse correlation parameters. function post_pairs_plot generate pair plot posterior samples taken input. function 4 arguments need specified. input : post.samp: data.frame samples joint posterior distribution parameters. NULL samples generated function . input.list: input list arguments model.fit link.functions used generate posterior samples. used post.samp = NULL. Default NULL. n.samp: number posterior samples. NULL, samples post.samp used. post.samp NULL, n.samp samples generated joint posterior. post.samp n.samp NULL n.samp samples randomly (uniformly replacement) selected post.samp. Default NULL max.batch number posterior samples generated simultaneously. used post.samp NULL. Default NULL function returns list two elements: post.samp posterior samples, pair.plot ggplot object containing pair plot.","code":"post.samp <- post_sampling(   input.list = input_list,   n.samp = 1000,   max.batch = 1000,   ncore = 1 )  head(post.samp) #>          mu         K    alpha          c        p #> 1 0.3282283 0.1460604 2.434796 0.05946488 1.149885 #> 2 0.2966876 0.1386325 2.481916 0.05572791 1.166887 #> 3 0.2783180 0.1560269 2.405695 0.06768972 1.187323 #> 4 0.3134860 0.1489655 2.430505 0.05733287 1.152310 #> 5 0.3097190 0.1629989 2.426325 0.06154389 1.183776 #> 6 0.3219381 0.1454345 2.436215 0.06304763 1.169743 pair.plot <- post_pairs_plot(   post.samp = post.samp,   input.list = NULL,   n.samp = NULL,   max.batch = 1000 ) #> Registered S3 method overwritten by 'GGally': #>   method from    #>   +.gg   ggplot2 pair.plot$pair.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"check-posterior-number-of-events","dir":"Articles","previous_headings":"","what":"Check posterior number of events","title":"2d Temporal Model: Tutorial on real data","text":"quantity interest posterior distribution number events. can accessed using function get_posterior_N requires input list. However, list needs additional elements respect one used now. Specifically, need add T12 extremes time interval want calculate number events, M0 cutoff magnitude, catalog.bru data.frame containing observed events. latter format total.data used Temporal.ETAS function. function returns list three elements: post.plot plot distribution, post.plot.shaded plot distribution shaded regions representing \\(95\\%\\) interval distribution, post.df data.frame used generate plots. vertical line plots represent number events catalog.bru element input list.","code":"# set additional elements of the list input_list$T12 <- c(T1, T2) input_list$M0 <- M0 input_list$catalog.bru <- aquila.bru N.post <- get_posterior_N(input.list = input_list) N.post$post.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"posterior-of-the-triggering-function-and-omori-law","dir":"Articles","previous_headings":"","what":"Posterior of the triggering function and Omori law","title":"2d Temporal Model: Tutorial on real data","text":"functions triggering_fun_plot triggering_fun_plot_prior plot, respectively, quantiles posterior prior distribution triggering function \\(g(t-t_h, mh)\\), namely, \\[ g(t - t_h, m_h) = K\\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] function takes input input.list: input list defined functions used previously. post.samp: data.frame samples posterior distribution parameters. NULL, n.samp samples generated posterior. n.samp: number posterior samples parameters used generated. magnitude: magnitude event (\\(m_h\\)). t.end: maximum value \\(t\\) plot. n.breaks: number breaks interval \\((0, \\texttt{t.end})\\) divided. function returns ggplot object. sample parameters triggering function \\(0\\) t.end calculated. black solid lines represents \\(95\\%\\) posterior interval function, grey lines represent triggering function calculated posterior samples, horizontal red lines represent \\(95\\%\\) posterior interval background rate \\(\\mu\\). function triggering_fun_plot_prior value parameters sampled according prior distribution rather posterior, therefore, need specify posterior samples data.frame.   functions omori_plot_posterior omori_plot_prior functions triggering_fun_plot triggering_fun_plot_prior considering \\[ \\left(\\frac{t- t_h}{c} + 1\\right)^{-p} \\] instead whole triggering function without background rate.","code":"triggering_fun_plot(   input.list = input_list,   post.samp = post.samp,   n.samp = NULL, magnitude = 4,   t.end = 5, n.breaks = 100 ) triggering_fun_plot_prior(input.list = input_list, magnitude = 4, n.samp = 1000, t.end = 10) omori_plot_posterior(input.list = input_list, post.samp = post.samp, n.samp = NULL, t.end = 5) omori_plot_prior(input.list = input_list, n.samp = 1000, t.end = 5)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"generate-synthetic-catalogues-from-model","dir":"Articles","previous_headings":"","what":"Generate synthetic catalogues from model","title":"2d Temporal Model: Tutorial on real data","text":"earthquake forecast usually composed collection synthetic catalogues model. package ETAS.inlabru provides function generate synthetic catalogues given set parameters. can used produce forecasts simply produce synthetic catalogues. function generate synthetic catalogues called generate_temporal_ETAS_synthetic takes input theta: list ETAS parameters names mu, K, alpha, c, p, corresponding ETAS parameters. beta.p: parameter magnitude distribution M0: cutoff magnitude, generated event magnitude greater M0. T1: starting time catalogue (unit measure depends unit used fit model). T2: end time catalogue (unit measure depends unit used fit model). Ht: set known events. can also T1 T2, useful want generate catalogues imposed events. Regarding magnitude distribution, exponential, specificically assume \\[ m - M_0 \\sim \\text{Exp}(\\beta) \\] parameter \\(\\beta\\) usually estimated independently ETAS parameters. use maximum likelihood estimator \\(\\beta\\) given \\[ \\hat\\beta = \\frac{1}{\\bar{m} - M_0} \\] \\(\\bar m\\) mean observed magnitudes values. function returns list data.frame, element output list corresponds different generation. data.frame three columns: occurence time (ts), magnitude (magnitudes), generation identifier (gen). generation identifier uses following convention, \\(-1\\) indicates events Ht time T1 T2, \\(0\\) indicates first generation offspring events gen equal \\(-1\\), \\(1\\) indicates background events, \\(2\\) offspring events gen equal \\(0\\) \\(1\\), \\(3\\) indicates offspring events gen equal \\(2\\), \\(4\\) indicates offspring events gen equal \\(3\\), . obtain unique data.frame containing simulated events sufficient bind rows generations. example generate 1 synthetic catalogue using parameters one posterior samples generated . catalogue covers time span L’Aquila catalogue impose greatest event sequence.  can easily generate multiple catalogues. code generates 8 catalogues using different samples posterior distribution parameters. red point indicates event imposed last panel represents observed L’Aquila sequence.","code":"# maximum likelihood estimator for beta beta.p <- 1 / (mean(aquila.bru$magnitudes) - M0) synth.cat.list <- generate_temporal_ETAS_synthetic(   theta = post.samp[1, ], # ETAS parameters   beta.p = beta.p, # magnitude distribution parameter   M0 = M0, # cutoff magnitude   T1 = T1, # starting time   T2 = T2, # end time   Ht = aquila.bru[which.max(aquila.bru$magnitudes), ] # known events ) # merge into unique data.frame synth.cat.df <- do.call(rbind, synth.cat.list) # order events by time synth.cat.df <- synth.cat.df[order(synth.cat.df$ts), ]  ggplot(synth.cat.df, aes(ts, magnitudes, color = as.factor(gen))) +   geom_point(size = 0.5) set.seed(2) n.cat <- 8 # generate catalogues as list of lists multi.synth.cat.list <- lapply(seq_len(n.cat), \\(x) generate_temporal_ETAS_synthetic(   theta = post.samp[x, ],   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = aquila.bru[which.max(aquila.bru$magnitudes), ] ))  # store catalogues as list of data.frames multi.synth.cat.list.df <- lapply(multi.synth.cat.list, \\(x) do.call(rbind, x)) # set catalogue identifier multi.synth.cat.list.df <- lapply(seq_len(n.cat), \\(x) cbind(multi.synth.cat.list.df[[x]],   cat.idx = x )) # merge catalogues in unique data.frame multi.synth.cat.df <- do.call(rbind, multi.synth.cat.list.df)  # we need to bing the synthetics with the observed catalogue for plotting cat.df.for.plotting <- rbind(   multi.synth.cat.df,   cbind(aquila.bru[, c(\"ts\", \"magnitudes\")],     gen = NA,     cat.idx = \"observed\"   ) )  # plot them ggplot(cat.df.for.plotting, aes(ts, magnitudes)) +   geom_point(size = 0.5) +   geom_point(     data = aquila.bru[which.max(aquila.bru$magnitudes), ],     mapping = aes(ts, magnitudes),     color = \"red\"   ) +   facet_wrap(facets = ~cat.idx)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"forecasting","dir":"Articles","previous_headings":"","what":"Forecasting","title":"2d Temporal Model: Tutorial on real data","text":"earthquake forecast usually collection synthetic catalogues generated model. bayesian models can reflect uncertainty parameters values generating synthetic catalogue composing forecast using different set parameters sampled join posterior distribution. can generate forecasts using function Temporal.ETAS.forecast. function takes input post.samp: data.frame samples posterior distribution parameters format described previous sections. n.cat: number synthetic catalogues composing forecast. n.cat greater nrow(post.samp), rows post.samp sampled uniformly replacement n.cat times. n.cat smaller nrow(post.samp), , rows post.samp sampled uniformly without replacement n.cat times. n.cat NULL equal nrow(post.samp), , post.samp used . ncore: number cores used generate synthetic catalogues parallel. remaining inputs (beta.p, M0, T1, T2, Ht) ones used generate_temporal_ETAS_synthetic. output function list two elements: fore.df n.cat. element fore.df data.frame synthetic catalogues binded together row, multi.synth.cat.df created . element n.cat just number catalogues generated. need n.cat zero-events catalogues appear fore.df, corresponding cat.idx value missing. Therefore need n.cat recover total number catalogues. code creates daily forecast 24 hours starting 1 minute event greatest magnitude sequence. starting date end date forecast expressed unit used catalogue fit model (days case). Day zero correspond start.date stated beginning document example \\(2009-01-01 00:00:00\\). forecast generated assuming known events catalogue occurred forecasting period. can easily retrieve predictive distribution number events forecasting period looking frequencies catalogue identifiers appears fore.df element. Indeed, number rows fore.df cat.idx value represents number events synthetic catalogue. , frequency catalogue identifier appears fore.df$cat.idx correspond number events catalogue. allows easily retrieve predictive distribution number events using code . remark case can use function table find frequencies elements fore.df$cat.idx. catalogue identifier zero-events catalogues present fore.df$cat.idx. using table lead zero probability zero events day, quantity crucial intersted probability earthquake activity (probability least one event).","code":"# express 1 minute in days min.in.days <- 1 / (24 * 60) # find time of the event with the greatest magnitude t.max.mag <- aquila.bru$ts[which.max(aquila.bru$magnitudes)] # set starting time of the forecasting period T1.fore <- t.max.mag + min.in.days # set forecast length fore.length <- 1 # set end time of the forecasting period T2.fore <- T1.fore + fore.length # set known data Ht.fore <- aquila.bru[aquila.bru$ts < T1.fore, ]  # produce forecast daily.fore <- Temporal.ETAS.forecast(   post.samp = post.samp, # ETAS parameters posterior samples   n.cat = nrow(post.samp), # number of synthetic catalogues   beta.p = beta.p, # magnitude distribution parameter   M0 = M0, # cutoff magnitude   T1 = T1.fore, # forecast starting time   T2 = T2.fore, # forecast end time   Ht = Ht.fore, # known events   ncore = 3 ) # number of cores # find number of events per catalogue N.fore <- vapply(   seq_len(daily.fore$n.cat),   \\(x) sum(daily.fore$fore.df$cat.idx == x), 0 ) # find number of observed events in the forecasting period N.obs <- sum(aquila.bru$ts >= T1.fore & aquila.bru$ts <= T2.fore) # plot the distribution ggplot() +   geom_histogram(aes(x = N.fore, y = after_stat(density)), binwidth = 1) +   geom_vline(xintercept = N.obs) +   xlim(100, 500) #> Warning: Removed 39 rows containing non-finite values (`stat_bin()`). #> Warning: Removed 2 rows containing missing values (`geom_bar()`)."},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"2c Temporal Model: Tutorial on synthetic data","text":"tutorial shows use ETAS.inlabru package generate synthetic catalogue temporal ETAS model fit ETAS model data. also show retrieve posterior distribution parameters quantity interest. brief introduction ETAS model refer tutorial real earthquake data.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"generate-a-synthetic-catalogue","dir":"Articles","previous_headings":"","what":"Generate a synthetic catalogue","title":"2c Temporal Model: Tutorial on synthetic data","text":"function generate_temporal_ETAS_synthetic() can used generate synthetic catalogues temporal ETAS model fixed parameters spanning given interval time. generate_temporal_ETAS_synthetic() takes input theta: list ETAS parameters names mu, K, alpha, c, p, corresponding ETAS parameters. beta.p: parameter magnitude distribution M0: cutoff magnitude, generated event magnitude greater M0. T1: starting time catalogue (unit measure depends unit used fit model). T2: end time catalogue (unit measure depends unit used fit model). Ht: set known events. can also T1 T2, useful want generate catalogues imposed events. NULL events imposed. function returns list data.frame, element output list corresponds different generation. data.frame three columns: occurence time (ts), magnitude (magnitudes), generation identifier (gen). generation identifier uses following convention, \\(-1\\) indicates events Ht time T1 T2, \\(0\\) indicates first generation offspring events gen equal \\(-1\\), \\(1\\) indicates background events, \\(2\\) offspring events gen equal \\(0\\) \\(1\\), \\(3\\) indicates offspring events gen equal \\(2\\), \\(4\\) indicates offspring events gen equal \\(3\\), . obtain unique data.frame containing simulated events sufficient bind rows generations. code generates synthetic catalogue events magnitude greater \\(2.5\\) according temporal ETAS model parameters equal vector true.param. value parameters equal posterior mean parameters obtained fitting model L’Aquila seismic sequence done tutorial real data. Also parameter \\(\\beta\\) magnitude distribution comes example. output function list data.frames convenient transform single data.frame binding rows data.frames list. synthetic catalogue composed total \\(288\\) events \\(112\\) background events \\(176\\) aftershocks. can easily retrieve numbers looking gen column data. code plot occurrence time events magnitude color indicating generation event time evolution cumulative number events. multiplot function provided inlabru R-package can used combine plots.","code":"set.seed(111) # set true ETAS parameters true.param <- list(mu = 0.30106014, K = 0.13611399, alpha = 2.43945301, c = 0.07098607, p = 1.17838741) # set magnitude distribution parameter beta.p <- 2.353157 # set cutoff magnitude M0 <- 2.5 # set starting time of the synthetic catalogue T1 <- 0 # set end time of the synthetic catalogue T2 <- 365 # generate the catalogue - it returns a list of data.frames synth.cat.list <- generate_temporal_ETAS_synthetic(   theta = true.param,   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = NULL,   ncore = 1 ) synth.cat.df <- do.call(rbind, synth.cat.list) head(synth.cat.df) #>           ts magnitudes gen #> 1 135.204031   2.661688   1 #> 2 187.947198   2.632073   1 #> 3 137.847074   3.073890   1 #> 4 152.693124   2.653628   1 #> 5   3.890113   2.686633   1 #> 6 194.287763   3.035756   1 c(N = nrow(synth.cat.df), N.bkg = sum(synth.cat.df$gen == 1), N.after = sum(synth.cat.df$gen > 1)) #>       N   N.bkg N.after  #>     288     112     176 pl1 <- ggplot(synth.cat.df, aes(ts, magnitudes, color = as.factor(gen))) +   geom_point() +   labs(color = \"gen\")  t.breaks <- T1:T2 N.cumsum <- vapply(t.breaks, \\(x) sum(synth.cat.df$ts < x), 0) df.to.cumsum.plot <- data.frame(ts = t.breaks, N.cum = N.cumsum) pl2 <- ggplot(df.to.cumsum.plot, aes(ts, N.cum)) +   geom_line() +   ylab(\"cumulative number of events\")  inlabru::multiplot(pl1, pl2, cols = 2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"prepare-data-for-model-fitting","dir":"Articles","previous_headings":"","what":"Prepare data for model fitting","title":"2c Temporal Model: Tutorial on synthetic data","text":"order fit model synthetic catalogue need set parameters priors set initial value parameters set inlabru options prepare data model fitting set priors need create list copula transformation (simply link) functions. method works internal representation parameters parameter Gaussian distribution. need function transform parameters original ETAS scale set prior . ETAS.inlabru package offers four different functions corresponding four different prior distributions. functions gamma_t, unif_t, exp_t, loggaus_t corresponds Gamma distribution, Uniform distribution, Exponential distribution Log-Gaussian distribution. also provide inverse functions retrieve value parameters internal scale given value ETAS scale. inv_gamma_t, inv_unif_t, exp_t, inv_loggaus_t. example going consider following priors parameters \\[\\begin{align*} \\mu & \\sim \\Gamma(0.3, 0.6) \\\\ K & \\sim \\text{Unif}(0,10) \\\\ \\alpha & \\sim \\text{Unif}(0,10) \\\\ c & \\sim \\text{Unif}(0,10) \\\\ p & \\sim \\text{Unif}(1,10) \\end{align*}\\] list link functions corresponding priors initial value parameters inlabru algorithm must specified internal scale parameters. reason, useful create list inverse link functions can specify initial value parameters ETAS scale easily retrieve corresponding value parameters internal scale. can done shown initial value parameters specified list names th.mu, th.K, th.alpha, th.c, th.p, , example, th.mu corresponds initial value parameter \\(\\mu\\) internal scale. initial value parameters important ensure algorithm able converge. Indeed, start algorithm values parameters causing numerical problems, may prevent algorithm converge. experience, setting initial values parameter (e.g. \\(< 10^{-5}\\)) (e.g. \\(> 10^2\\)) safe choice. code uses following initial values parameters \\(\\mu_{\\text{init}} = 0.5, K_{\\text{init}} = 0.1, \\alpha_{\\text{init}} = 1, c_{\\text{init}} = 0.1, p_{\\text{init}} = 1.1\\) Also inlabru options provided list, main elements list : bru_verbose: number indicating type visual output. Set 0 output. bru_max_iter: maximum number iterations. set max_step inlabru algorithm stops stopping criterion met. However, setting max_step values smaller 1 forces algorithm run exactly bru_max_iter iterations. bru_method: relevant , thing may need set max_step argument. algorithm converge without fixing max_step suggest try fix value 1, experience \\(0.5\\) \\(0.2\\) works well. example line setting bru_method commented. bru_initial: list initial values created . Lastly, need prepare data model fitting. data must provided data.frame least 3 columns names ts corresponding occurrence time events, magnitudes corresponding magnitude, idx.p event identifier. events data.frame must sorted respect occurrence time. synthetic catalogue generated beginning already columns ts magnitudes, sorted generation time. code sort rows data.frame adds event identifier","code":"# set copula transformations list link.f <- list(   mu = \\(x) gamma_t(x, 0.3, 0.6),   K = \\(x) unif_t(x, 0, 10),   alpha = \\(x) unif_t(x, 0, 10),   c_ = \\(x) unif_t(x, 0, 10),   p = \\(x) unif_t(x, 1, 10) ) # set inverse copula transformations list inv.link.f <- list(   mu = \\(x) inv_gamma_t(x, 0.3, 0.6),   K = \\(x) inv_unif_t(x, 0, 10),   alpha = \\(x) inv_unif_t(x, 0, 10),   c_ = \\(x) inv_unif_t(x, 0, 10),   p = \\(x) inv_unif_t(x, 1, 10) ) # set up list of initial values th.init <- list(   th.mu = inv.link.f$mu(0.5),   th.K = inv.link.f$K(0.1),   th.alpha = inv.link.f$alpha(1),   th.c = inv.link.f$c_(0.1),   th.p = inv.link.f$p(1.1) ) # set up list of bru options bru.opt.list <- list(   bru_verbose = 3, # type of visual output   bru_max_iter = 70, # maximum number of iterations   # bru_method = list(max_step = 0.5),   bru_initial = th.init ) # parameters initial values # sort catalogue by occurrence time synth.cat.df <- synth.cat.df[order(synth.cat.df$ts), ] # add event identifier synth.cat.df$idx.p <- seq_len(nrow(synth.cat.df))"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"model-fitting","dir":"Articles","previous_headings":"","what":"Model Fitting","title":"2c Temporal Model: Tutorial on synthetic data","text":"function Temporal.ETAS fit ETAS model returns bru object output. required inputs : total.data: data.frame containing observed events. format described previous Section. M0: cutoff magnitude. events total.data must magnitude greater equal number. T1: starting time time interval want fit model. T2: end time time interval want fit model. link.functions: list copula transformation functions format described previous sections. coef.t., delta.t., N.max.: parameters temporal binning. binning strategy described Appendix B paper Approximation Bayesian Hawkes process inlabru. parameters corresponds coef.t.\\(=\\delta\\), delta.t.\\(=\\Delta\\), N.max.\\(=n_{\\max}\\). bru.opt: list inlabru options described previous Section.","code":"synth.fit <- Temporal.ETAS(   total.data = synth.cat.df,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  0.7065003"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"check-marginal-posterior-distributions","dir":"Articles","previous_headings":"","what":"Check marginal posterior distributions","title":"2c Temporal Model: Tutorial on synthetic data","text":"order retrieve marginal posterior distributions parameter need provide list containing two elements: model.fit bru object containing fitted model, link.functions list link functions created . list created, function get_posterior_param returns marginal posterior distribution parameters ETAS scale. function returns list two elements: post.df data.frame three columns, x indicating value parameter, y indicating corresponding value marginal posterior distribution, param parameter identifier. output list also contains post.plot ggplot object containing plot marginal posterior distributions parameter. code retrieve marginal posterior distribution parameters plot along true value parameters represented vertical dashed lines.","code":"# create input list to explore model output input_list <- list(   model.fit = synth.fit,   link.functions = link.f ) # retrieve marginal posterior distributions post.list <- get_posterior_param(input.list = input_list)  # create data.frame of true value of parameters df.true.param <- data.frame(   x = unlist(true.param),   param = names(true.param) ) # add to the marginal posterior distribution of the parameters the true value of the parameters. post.list$post.plot +   geom_vline(     data = df.true.param,     mapping = aes(xintercept = x), linetype = 2   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"sampling-the-joint-posterior-distribution","dir":"Articles","previous_headings":"","what":"Sampling the joint posterior distribution","title":"2c Temporal Model: Tutorial on synthetic data","text":"function post_sampling generate samples joint posterior ETAS parameters. function takes input: input.list: list model.fit element link.functions elements described . n.samp: number posterior samples. max.batch: number posterior samples generated simultaneously. n.samp\\(>\\)max.batch, , samples generated parallel batches maximum size equal max.batch. Default \\(1000\\). ncore: number cores used parallel n.samp\\(>\\)max.batch. function returns data.frame columns corresponding ETAS parameters posterior samples can used estimate posterior distribution functions parameters.","code":"post.samp <- post_sampling(   input.list = input_list,   n.samp = 1000,   max.batch = 1000,   ncore = 1 ) head(post.samp) #>          mu          K    alpha         c        p #> 1 0.3122870 0.04013660 2.630955 0.3274550 1.540579 #> 2 0.3079233 0.08200960 2.384645 0.1582514 1.278572 #> 3 0.3292594 0.04479959 2.536350 0.2242436 1.299865 #> 4 0.3354071 0.03591444 2.559845 0.3581285 1.445378 #> 5 0.3750033 0.07840230 2.417388 0.1699829 1.280384 #> 6 0.3228809 0.04060325 2.564766 0.3583603 1.500958"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"triggering-function-and-omori-law","dir":"Articles","previous_headings":"","what":"Triggering function and Omori law","title":"2c Temporal Model: Tutorial on synthetic data","text":"Interesting functions parameters triggering function Omori law. can estimate posterior distribution functions using samples joint posterior distribution parameters obtained previous section. functions triggering_fun_plot provides plot quantiles posterior distribution triggering function \\(g(t-t_h, mh)\\), namely, \\[ g(t - t_h, m_h) = K\\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] function takes input input.list: input list defined functions used previously. post.samp: data.frame samples posterior distribution parameters. NULL, n.samp samples generated posterior. n.samp: number posterior samples parameters used generated. magnitude: magnitude event (\\(m_h\\)). t.end: maximum value \\(t\\) plot. n.breaks: number breaks interval \\((0, \\texttt{t.end})\\) divided. function returns ggplot object. sample parameters triggering function \\(0\\) t.end calculated. black solid lines represents \\(95\\%\\) posterior interval function, grey lines represent triggering function calculated posterior samples, horizontal red lines represent \\(95\\%\\) posterior interval background rate \\(\\mu\\). function triggering_plot_prior using parameters sampled priors parameters. code creates plot posterior triggering function adds triggering function calculated true parameter values blue. need add argument M0 input_list use function triggering_fun_plot.  functions omori_plot_posterior function triggering_fun_plot considering \\[ \\left(\\frac{t- t_h}{c} + 1\\right)^{-p} \\] instead whole triggering function without background rate.","code":"# add cutoff magnitude to input_list input_list$M0 <- M0  # generate triggering function plot trig.plot <- triggering_fun_plot(   input.list = input_list,   post.samp = post.samp,   n.samp = NULL, magnitude = 4,   t.end = 5, n.breaks = 100 )  # set times at which calculate the true triggering function t.breaks <- seq(1e-6, 5, length.out = 100) # calculate the function true.trig <- gt(unlist(true.param), t = t.breaks, th = 0, mh = 4, M0 = M0) # store in data.frame for plotting true.trig.df <- data.frame(ts = t.breaks, trig.fun = true.trig)  # add the true triggering function to the plot trig.plot +   geom_line(     data = true.trig.df,     mapping = aes(x = ts, y = trig.fun), color = \"blue\"   ) omori.plot <- omori_plot_posterior(input.list = input_list, post.samp = post.samp, n.samp = NULL, t.end = 5)  true.omori <- omori(theta = unlist(true.param), t = t.breaks, ti = 0) true.omori.df <- data.frame(ts = t.breaks, omori.fun = true.omori)  omori.plot +   geom_line(     data = true.omori.df,     mapping = aes(x = ts, y = omori.fun), color = \"blue\"   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"comparison-between-different-fitted-models","dir":"Articles","previous_headings":"","what":"Comparison between different fitted models","title":"2c Temporal Model: Tutorial on synthetic data","text":"interesting fit model multiple synthetic catalogues compare parameters posterior distributions obtained different catalogues. section, going generate second synthetic catalogue, fit model, compare posterior distributions ones obtained . second catalogue impose large event magnitude \\(6\\) happening midpoint time interval. first step set data.frame known events generate second synthetic catalogue Counting number background events aftershocks case slightly different . fact, count imposed event background event, aftershocks need include also event gen = 0 ones induced imposed event case 192. comparison number events two catalogues. Notice background events roughly expected given time interval . , just need set data.frame model fitting. inputs can use ones created first model fit. Now, extract marginal posterior distributions, need create input_list second model fit. Now, can retrieve marginal posterior distributions provided model fitted second catalogue compare ones obtained .  process shown can extended multiple (\\(>2\\)) input catalogues order study parameters identifiable. Also, using characteristics input catalogue catalogue identifier can study change posterior distribution characteristic input catalogue changes. interesting example number events catalogue, studying marginal posterior distributions change increase decrease number events.","code":"# set up data.frame of imposed events Ht.imposed <- data.frame(   ts = mean(c(T1, T2)),   magnitudes = 6 ) # generate second catalogue set.seed(1) synth.cat.list.2 <- generate_temporal_ETAS_synthetic(   theta = true.param,   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = Ht.imposed,   ncore = 1 ) # transform it in a data.frame synth.cat.df.2 <- do.call(rbind, synth.cat.list.2) sum(synth.cat.df.2$gen == 0) #> [1] 192 rbind(   first = c(     N = nrow(synth.cat.df),     N.bkg = sum(synth.cat.df$gen == 1),     N.after = sum(synth.cat.df$gen > 1)   ),   second = c(     N = nrow(synth.cat.df.2),     N.bkg = sum(synth.cat.df.2$gen == 1 | synth.cat.df.2$gen == -1),     N.after = sum(synth.cat.df.2$gen > 1 | synth.cat.df.2$gen == 0)   ) ) #>          N N.bkg N.after #> first  288   112     176 #> second 408   104     304 synth.cat.df.2 <- synth.cat.df.2[order(synth.cat.df.2$ts), ] synth.cat.df.2$idx.p <- seq_len(nrow(synth.cat.df.2))  synth.fit.2 <- Temporal.ETAS(   total.data = synth.cat.df.2,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  0.9914305 input_list.2 <- list(   model.fit = synth.fit.2,   link.functions = link.f ) # retrieve marginal posterior distributions post.list.2 <- get_posterior_param(input.list = input_list.2)  # set model identifier post.list$post.df$cat.used <- \"first catalogue\" post.list.2$post.df$cat.used <- \"second catalogue\"  # bind marginal posterior data.frames bind.post.df <- rbind(post.list$post.df, post.list.2$post.df)  # plot them ggplot(bind.post.df, aes(x = x, y = y, color = cat.used)) +   geom_line() +   facet_wrap(facets = ~param, scales = \"free\") +   xlab(\"param\") +   ylab(\"pdf\") +   geom_vline(     data = df.true.param,     mapping = aes(xintercept = x), linetype = 2   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Francesco Serafini. Author, maintainer. Mark Naylor. Author, thesis advisor. Finn Lindgren. Author, thesis advisor.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Mark Naylor, & Francesco Serafini (2023). edinburgh-seismicity-hub/ETAS.inlabru: Temporal Hawkes (v1.0.1).  Zenodo. https://doi.org/10.5281/zenodo.7515785 Mark Naylor, Francesco Serafini, Finn Lindgren (2023). doi:10.3389/fams.2023.1126759, https://www.frontiersin.org/articles/10.3389/fams.2023.1126759 Francesco Serafini, Finn Lindgren, Mark Naylor (2023). doi:10.1002/env.2798, https://onlinelibrary.wiley.com/doi/abs/10.1002/env.2798","code":"@Misc{,   title = {edinburgh-seismicity-hub/ETAS.inlabru: Temporal Hawkes},   author = {Mark Naylor and Francesco Serafini},   publisher = {Zenodo},   year = {2023},   number = {v1.0.1},   url = {https://doi.org/10.5281/zenodo.7515785},   doi = {10.5281/zenodo.7515785}, } @Article{,   title = {Bayesian modelling of the temporal evolution of seismicity using the ETAS.inlabru R-package},   author = {Mark Naylor and Francesco Serafini and Finn Lindgren},   journal = {Frontiers in Applied Mathematics and Statistics},   year = {2023},   doi = {10.3389/fams.2023.1126759},   url = {https://www.frontiersin.org/articles/10.3389/fams.2023.1126759}, } @Article{,   title = {Approximation of Bayesian Hawkes process with inlabru},   author = {{Serafini} and {Francesco} and {Lindgren} and {Finn} and {Naylor} and {Mark}},   journal = {Environmetrics},   year = {2023},   doi = {10.1002/env.2798},   url = {https://onlinelibrary.wiley.com/doi/abs/10.1002/env.2798}, }"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"etasinlabru","dir":"","previous_headings":"","what":"Bayesian ETAS model for modelling seismic sequences with inlabru","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"R package implements ETAS Hawkes process modelling seismicity Online documentation: https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"authors","dir":"","previous_headings":"","what":"Authors","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Dr Francesco Serafini Dr Mark Naylor , School GeoSciences, University Edinburgh Prof Finn Lindgren , School Mathematics, University Edinburgh Dr Kirsty Bayliss , Global Earthquake Model (GEM)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"funding","dir":"","previous_headings":"","what":"Funding","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"study funded yhe Real-Time Earthquake Risk Reduction Resilient Europe RISE project , received funding European Union’s Horizon 2020 Research Innovation Program grant Agreement 821115. Naylor additionally funded NSFGEO-NERC grant NE/R000794/1. Bayliss funded EPSRC Studentship.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"ETAS.inlabru work, need install R-INLA inlabru: inlabru (see https://inlabru-org.github.io/inlabru/): CRAN release, development version, R-INLA (see https://www.r-inla.org/download-install): can install development version ETAS.inlabru GitHub ","code":"install.packages(\"inlabru\") # install.packages(\"remotes\") remotes::install_github(\"inlabru-org/inlabru\") install.packages(   \"INLA\",   repos = c(getOption(\"repos\"), INLA=\"https://inla.r-inla-download.org/R/testing\"),   dep = TRUE ) # install.packages(\"remotes\") remotes::install_github(\"edinburgh-seismicity-hub/ETAS.inlabru\")"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"file-structure-in-package","dir":"","previous_headings":"Terminology and planning suggestions","what":"File structure in package","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"ETAS.triggering.function.R : Contains ETAS specific model functions HawkesProcess.R : Generic Hawkes code intended integration back inlabru generateSyntheticCatalogues.R : Contains iterative Hawkes functions generating triggered events actual triggering functions reside ETAS file introduce models temporalBinning.R : Code generate time bins make integration scheme efficient plottingFunctions.R : lets put standard plotting functions setupInlabruInputs.R : Put functions generating input.list ","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"terminology","dir":"","previous_headings":"","what":"Terminology","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Let’s specific just temporal clear function names spatial spatial-temporal later Might anything bad? tried modify just theta","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"implemented","dir":"","previous_headings":"","what":"Implemented","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Generation synthetic ETAS catalogues ETAS.inlabru demonstration notebook","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"in-development","dir":"","previous_headings":"","what":"In development","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Add inversion modelling based original code Modify implementation generic Hawkes code can go inlabru ETAS triggering function code stay package Implement time varying incompleteness model Farnaz Kamranzad","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"roadmap","dir":"","previous_headings":"","what":"Roadmap","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Implement incompleteness fix Integrate spatial modelling","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/ETAS.inlabru-package.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru — ETAS.inlabru-package","title":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru — ETAS.inlabru-package","text":"Modelling inversion ETAS model seismicity using inlabru Epidemic Type Aftershock Sequence (ETAS) model designed model earthquakes triggered previous events. statistics, referred Hawkes process. code can used generate synthetic ETAS catalogues can also include seeded events model specific sequences. also implement Bayesian inversion scheme using Integrated Nested Laplace Approximation (INLA) using inlabru. temporal model, given training catalogue times magnitudes, code returns joint posteriors ETAS parameters. future roadmap, include tools model spatial distribution spatio-temporal evolution seismic sequences.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/ETAS.inlabru-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru — ETAS.inlabru-package","text":"Maintainer: Francesco Serafini francesco.serafini@newcastle.ac.uk (ORCID) Authors: Mark Naylor mark.naylor@ed.ac.uk (ORCID) [thesis advisor] Finn Lindgren Finn.Lindgren@ed.ac.uk (ORCID) [thesis advisor]","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":null,"dir":"Reference","previous_headings":"","what":"Injection Rate function calculations — IntInjectionIntensity","title":"Injection Rate function calculations — IntInjectionIntensity","text":"Forward time integrated function exponential rate decay, inverse","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Injection Rate function calculations — IntInjectionIntensity","text":"","code":"IntInjectionIntensity(a = 50, V.i = 1, tau = 10, T.i, T2)  Inv_IntInjectionIntensity(   a = 50,   V.i = 1,   tau = 10,   T.i,   number.injected.events )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Injection Rate function calculations — IntInjectionIntensity","text":"Event rate per unit volume injected V.Injected volume tau Decay rate [days] T.Time injection event T2 End temporal model domain number.injected.events number expected injected events, used inverse.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Injection Rate function calculations — IntInjectionIntensity","text":"IntInjectionIntensity returns forward time integrated function exponential rate decay. Inv_IntInjectionIntensity returns end time corresponding given expected number injected events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":null,"dir":"Reference","previous_headings":"","what":"Integrated Omori's law — Int_ETAS_time_trig_function","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"Integrated Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"","code":"Int_ETAS_time_trig_function(theta, th, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p) th Time past event [days] start temporal domain, vector. T2 End temporal domain, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"Value integral Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"function returns integral Omori's law, namely $$\\int_{t_h}^{T_2} \\left(\\frac{t - t_h}{c} + 1\\right)^{-p} dt$$","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"Inverse integrated Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"","code":"Inv_Int_ETAS_time_trig_function(theta, omega, th)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p) omega Value integral inverted, vector th Time integral calculated scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"Value start temporal domain used calculate integral","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"Considering integral Omori's law $$\\omega = \\int_{t_h}^{T_2}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} dt$$ function applied value \\(\\omega\\) returns value \\(t_h\\).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to calculate the integral of Omori's law — It_df","title":"Function to calculate the integral of Omori's law — It_df","text":"Function calculate integral Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to calculate the integral of Omori's law — It_df","text":"","code":"It_df(param_, time.df)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to calculate the integral of Omori's law — It_df","text":"param_ ETAS parameters vector (\\(\\mu, K, \\alpha, c, p\\)), \\(c, p\\) used. time.df output function time_grid()","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to calculate the integral of Omori's law — It_df","text":"vector integral values bin provided time.df","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"Fits remporal ETAS model returns results. function decomposes input.list `Hawkes.bru2`` function.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"","code":"Temporal.ETAS.fit(input.list)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"input.list input data parameters passed inlabru via structured list. output function create_input_list_temporal_withCatalogue create_input_list_temporal_noCatalogue","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"fitted model bru object, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — Temporal.ETAS.forecast","title":"Title — Temporal.ETAS.forecast","text":"Title","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — Temporal.ETAS.forecast","text":"","code":"Temporal.ETAS.forecast(post.samp, n.cat, beta.p, M0, T1, T2, Ht, ncore = 1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — Temporal.ETAS.forecast","text":"post.samp data.frame containing samples posterior distribution ETAS parameters. row data.frame corresponds different sample parameters order \\(\\mu\\), \\(K\\), \\(\\alpha\\), \\(c\\), \\(p\\). n.cat number synthetic catalogues composing forecast. n.cat greater nrow(post.samp), , n.cat rows sampled uniformly replacement post.samp. n.cat smaller nrow(post.samp), , n.cat rows sampled uniformly without replacement post.samp. n.cat NULL equal nrow(post.samp), post.samp used nrow(post.samp) catalogues generated. beta.p parameter magnitude distribution M0 cutoff magnitude, synthetic events magnitude greater value. T1 starting time forecast T2 end time forecast Ht set known events ncore number cores used generate synthetic catalogues parallel.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — Temporal.ETAS.forecast","text":"list two elements: fore.df data.frame containing synthetic catalogues composing forecast. data.frame four columns, ts occurrence time, magnitudes magnitude, gen generation event, cat.idx catalogue identifier second element output list n.cat number synthetic catalogues generated.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to fit Hawkes process model — Temporal.ETAS","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"function fit temporal ETAS model using inlabru.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"","code":"Temporal.ETAS(   total.data,   M0,   T1,   T2,   link.functions = NULL,   coef.t.,   delta.t.,   N.max.,   bru.opt )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"total.data Observed events: data.frame columns time (ts), magnitude (magnitudes), event identifier (idx.p). Column names must changed. M0 Minimum magnitude threshold, scalar T1 Start temporal model domain, scalar [measure unit sample.s$ts]. T2 End temporal model domain, scalar [measure unit sample.s$ts]. link.functions Functions transform parameters internal INLA scale ETAS scale. must list functions names (mu, K, alpha, c_, p) coef.t. TimeBinning parameter: parameter regulating relative length successive bins, scalar. delta.t. TimeBinning parameter: parameter regulating bins' width, scalar. N.max. TimeBinning parameter: parameter regulating Number bins (= N.max + 2), scalar. bru.opt Runtime options inlabru: See https://inlabru-org.github.io/inlabru/reference/bru_call_options.html, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"fitted model 'bru' object, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":null,"dir":"Reference","previous_headings":"","what":"Find breaks point for 1D grid — breaks_exp","title":"Find breaks point for 1D grid — breaks_exp","text":"breaks_exp return breaks points one dimensional grid depending three parameters, see details","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find breaks point for 1D grid — breaks_exp","text":"","code":"breaks_exp(start.grid, end.grid, coef.t = 2, delta.t, N.exp. = 10)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find breaks point for 1D grid — breaks_exp","text":"start.grid Starting point grid, scalar. end.grid End point grid, scalar. coef.t TimeBinning parameter: \\(\\delta > 0\\) determines relative length subsequent intervals, scalar. delta.t TimeBinning parameter: \\(\\Delta > 0\\) determines length intervals, scalar. N.exp. TimeBinning parameter: \\(n_{max} >0\\) determines maximum number intervals, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find breaks point for 1D grid — breaks_exp","text":"vector containing grid points","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Find breaks point for 1D grid — breaks_exp","text":"grid calculated follows $$t, t + \\Delta, t + \\Delta(1 + \\delta), t + \\Delta(1 + \\delta)^2,...., T$$ \\(t\\) start.grid argument, \\(T\\) end.grid argument, \\(n_{max}\\) maximum value exponent","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find breaks point for 1D grid — breaks_exp","text":"","code":"breaks_exp(start.grid = 1, end.grid = 100, coef.t = 1, delta.t = 1, N.exp. = 3) #> [1]   1   2   3   5   9 100 breaks_exp(start.grid = 1, end.grid = 100, coef.t = 1, delta.t = 1, N.exp. = 10) #> [1]   1   2   3   5   9  17  33  65 100"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to compute the integral of Omori's law efficiently — compute_grid","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"Function compute integral Omori's law efficiently","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"","code":"compute_grid(param., list.input_)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"param. ETAS parameters vector (\\(\\mu, K, \\alpha, c, p\\)), \\(c, p\\) used. list.input_ list containing information calculate integrals efficiently. list created inside Temporal.ETAS function Two elements used time.sel selection rows output time_grid unique t.ref_layer value, data.frame. Imapping mapper unique names provided time.sel original rows output time_grid(), vector.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"vector length list.input_$Imapping integral Omori's law bin.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS conditional intensity - used by inlabru — cond_lambda","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"Function calculate value ETAS model conditional intensity specified time given history process.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"","code":"cond_lambda(theta, t, th, mh, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"theta ETAS parameters list names mu, K, alpha, c, p t Time conditional intensity evaluated, scalar th Time events history process, vector mh Magnitudes events history process, vector M0 Minimum magnitude threshold","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"Value ETAS conditional intensity calculated t history th, mh, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"function takes single value t returns ETAS conditional intensity calculated t history th, mh. ETAS conditional intensity given $$\\lambda(t | \\mathcal H_t) = \\mu + \\sum_{h: (t_h,m_h) \\\\mathcal H_t} K e^{\\alpha(m_h - M_0)} \\left( \\frac{t - t_h}{c} + 1\\right)^{-p}$$ use t vector.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"Function create default input list ETAS Hawkes temporal model catalogue specified input file","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"","code":"create_input_list_temporal_noCatalogue(input_path, num.threads = NULL)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"input_path Input file path string num.threads Optional argument number threads used parallel processing","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"formatted input.list elements required temporal Hawkes model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"","code":"create_input_list_temporal_noCatalogue(   system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\") ) #> $catalog #> NULL #>  #> $catalog.bru #> NULL #>  #> $time.int #> NULL #>  #> $T12 #> [1] \"T1\"  \" T2\" #>  #> $lat.int #> [1] -90  90 #>  #> $lon.int #> [1] -180  180 #>  #> $M0 #> NULL #>  #> $mu.init #> [1] 0.25 #>  #> $K.init #> [1] 0.3 #>  #> $alpha.init #> [1] 1.6 #>  #> $c.init #> [1] 0.2 #>  #> $p.init #> [1] 1.1 #>  #> $a_mu #> [1] 0.5 #>  #> $b_mu #> [1] 0.5 #>  #> $a_K #> [1] -1 #>  #> $b_K #> [1] 0.5 #>  #> $a_alpha #> [1] 0 #>  #> $b_alpha #> [1] 10 #>  #> $a_c #> [1] 0 #>  #> $b_c #> [1] 1 #>  #> $a_p #> [1] 1 #>  #> $b_p #> [1] 2 #>  #> $max_iter #> [1] 100 #>  #> $max_step #> NULL #>  #> $link.functions #> $link.functions$mu #> function (x)  #> gamma_t(x, a_mu, b_mu) #> <bytecode: 0x55bbc16c1aa0> #> <environment: 0x55bbc16c42f0> #>  #> $link.functions$K #> function (x)  #> loggaus_t(x, a_K, b_K) #> <bytecode: 0x55bbc16c17c8> #> <environment: 0x55bbc16c42f0> #>  #> $link.functions$alpha #> function (x)  #> unif_t(x, a_alpha, b_alpha) #> <bytecode: 0x55bbc16c14f0> #> <environment: 0x55bbc16c42f0> #>  #> $link.functions$c_ #> function (x)  #> unif_t(x, a_c, b_c) #> <bytecode: 0x55bbc16c1218> #> <environment: 0x55bbc16c42f0> #>  #> $link.functions$p #> function (x)  #> unif_t(x, a_p, b_p) #> <bytecode: 0x55bbc16c0f40> #> <environment: 0x55bbc16c42f0> #>  #>  #> $bru.opt.list #> $bru.opt.list$bru_verbose #> [1] 3 #>  #> $bru.opt.list$bru_max_iter #> [1] 100 #>  #> $bru.opt.list$num.threads #> NULL #>  #> $bru.opt.list$bru_initial #> $bru.opt.list$bru_initial$th.mu #> [1] -0.2978078 #>  #> $bru.opt.list$bru_initial$th.K #> [1] -0.4079456 #>  #> $bru.opt.list$bru_initial$th.alpha #> [1] -0.9944579 #>  #> $bru.opt.list$bru_initial$th.c #> [1] -0.8416212 #>  #> $bru.opt.list$bru_initial$th.p #> [1] -1.281552 #>  #>  #>  #> $coef.t #> [1] 1 #>  #> $delta.t #> [1] 0.1 #>  #> $Nmax #> [1] 8 #>  #> $n.periods #> [1] 120 #>  #> $period.length #> [1] 1 #>  #> $start.date.fore #> NULL #>  #> $magnitude.update #> [1] 5.5 #>  #> $output.name #> [1] \"report_ETAS\" #>"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"Function create default input file ETAS Hawkes temporal model catalogue specified input file.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"","code":"create_input_list_temporal_withCatalogue(input_path, num.threads = NULL)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"input_path path txt file containing experiment's information num.threads Optional argument number threads used parallel processing","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"formatted input.list elements required temporal Hawkes model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"Copula transformation standard Normal distribution Exponential distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"","code":"exp_t(x, r)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"x values standard Normal distribution, vector. r rate exponential distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"values Exponential distribution rate r, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"Copula transformation standard Normal distribution Gamma distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"","code":"gamma_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"x values standard Normal distribution, vector. shape parameter gamma distribution scalar. b rate parameter gamma distribution scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"values Gamma distribution shape rate b, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":null,"dir":"Reference","previous_headings":"","what":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"Generates synthetic catalogue using ETAS model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"","code":"generate_temporal_ETAS_synthetic(   theta,   beta.p,   M0,   T1,   T2,   Ht = NULL,   ncore = 1 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). M0 minimum magnitude synthetic catalogue. T1 start time synthetic catalogue [days]. T2 end time synthetic catalogue [days]. Ht catalogue history impose synthetic sequence. ncore Integer number compute cores use.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"data.frame temporal catalogue columns [t_i, M_i, gen_i] , t_i times,  M_i magnitudes, gen_i includes information generation number","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"","code":"## EXAMPLE 1: Generate a 1000 day synthetic ETAS catalogue  generate_temporal_ETAS_synthetic(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000 ) #> [[1]] #>           ts magnitudes gen #> 1  129.88661   2.704408   1 #> 2  356.95292   2.536402   1 #> 3  375.65855   3.930992   1 #> 4  334.39468   2.640394   1 #> 5  646.84637   2.878832   1 #> 6  789.31467   2.674439   1 #> 7  892.95358   3.585017   1 #> 8  348.16642   3.120380   1 #> 9  776.60850   2.604824   1 #> 10 835.16758   2.616431   1 #> 11  50.51851   3.189161   1 #> 12 115.55665   2.637038   1 #> 13 883.44049   2.911096   1 #> 14 575.56252   2.847869   1 #> 15 906.49859   2.833330   1 #> 16  34.69410   2.565426   1 #> 17 947.68125   2.611586   1 #> 18 830.62446   2.665123   1 #> 19 882.27719   2.811836   1 #> 20 790.56284   2.951727   1 #> 21 830.36049   3.155184   1 #> 22 222.78193   2.541007   1 #> 23 296.75439   2.931353   1 #> 24 129.96407   2.711660   1 #> 25 691.80974   2.603636   1 #> 26 274.16659   2.735393   1 #> 27 772.76257   2.985373   1 #> 28 571.31949   2.589138   1 #> 29 777.60004   2.645286   1 #> 30 487.33689   4.270584   1 #> 31 684.69948   3.794525   1 #> 32 523.78533   2.547704   1 #> 33 624.73138   2.862350   1 #> 34 628.70254   2.829558   1 #> 35 570.86294   2.813649   1 #> 36 390.19864   3.467316   1 #> 37  80.04958   2.532001   1 #> 38 921.38095   3.356930   1 #> 39 327.75440   2.590388   1 #> 40 970.44158   2.996904   1 #> 41 242.34385   2.915654   1 #> 42 419.80860   2.959061   1 #> 43  59.27998   2.536212   1 #> 44 749.67002   2.808300   1 #> 45  31.29998   2.965268   1 #> 46 494.64440   3.755277   1 #> 47 441.04932   2.757676   1 #> 48 359.31620   2.507971   1 #> 49 638.55254   2.702492   1 #> 50 142.82044   2.924477   1 #> 51 414.18074   2.613614   1 #> 52 265.18687   4.543701   1 #> 53 751.92988   2.889776   1 #> 54 575.96816   2.563335   1 #> 55 676.88252   2.955031   1 #> 56 763.01968   2.522066   1 #> 57 947.83803   2.512083   1 #> 58 788.80424   3.280411   1 #> 59 678.89432   3.387134   1 #> 60 766.10587   2.992310   1 #> 61 868.26097   2.500812   1 #> 62 456.36241   2.707670   1 #> 63 287.09889   2.910406   1 #> 64 721.90687   2.628674   1 #> 65 694.71725   4.488437   1 #> 66 868.92058   3.460041   1 #> 67 380.99742   3.221358   1 #> 68 116.81100   2.984608   1 #> 69 511.75782   3.041309   1 #> 70 872.78857   3.713281   1 #> 71 749.50202   2.510769   1 #> 72  94.74609   2.628176   1 #> 73 123.86551   2.873378   1 #> 74 811.43555   3.150381   1 #> 75 445.28719   3.095554   1 #> 76 309.54393   2.524868   1 #> 77 784.26981   2.832823   1 #> 78 408.09562   3.094445   1 #> 79 467.48565   2.745034   1 #> 80 271.97980   2.894438   1 #> 81 808.69047   3.017413   1 #> 82 629.08438   3.396231   1 #> 83 765.27891   4.114295   1 #> 84 589.64564   3.828368   1 #> 85 713.94570   3.635502   1 #>  #> [[2]] #>           ts magnitudes gen #> 1  375.75743   3.378247   2 #> 2  376.02110   2.501814   2 #> 3  428.31712   2.606446   2 #> 4  893.05046   2.675289   2 #> 5   50.63384   2.726752   2 #> 6  830.53748   3.186038   2 #> 7  964.32517   2.587917   2 #> 8  493.12920   2.820904   2 #> 9  533.53161   2.585247   2 #> 10 545.56594   2.841977   2 #> 11 809.75805   2.594559   2 #> 12 503.51007   3.460998   2 #> 13 539.71076   2.919853   2 #> 14 525.55865   2.644664   2 #> 15 508.98268   2.504800   2 #> 16 856.71820   2.941252   2 #> 17 693.31095   3.058788   2 #> 18 915.10420   2.506605   2 #> 19 629.41544   3.895403   2 #> 20 444.60342   2.530508   2 #> 21 265.44787   2.934837   2 #> 22 286.28982   2.652621   2 #> 23 267.15445   3.018437   2 #> 24 307.12233   2.515758   2 #> 25 313.09871   3.521540   2 #> 26 265.65465   2.811411   2 #> 27 266.81143   2.548494   2 #> 28 679.02432   2.711734   2 #> 29 982.91903   2.831666   2 #> 30 769.04763   3.175168   2 #> 31 287.35529   2.888629   2 #> 32 697.77059   2.544830   2 #> 33 817.29652   2.751737   2 #> 34 694.87281   2.885079   2 #> 35 730.59669   2.897740   2 #> 36 763.57672   2.563949   2 #> 37 961.24815   2.585605   2 #> 38 724.29854   3.127897   2 #> 39 705.73598   2.801519   2 #> 40 768.09658   2.920227   2 #> 41 777.86744   3.125620   2 #> 42 590.31874   3.145141   2 #> 43 589.68619   2.567560   2 #> 44 721.75649   3.226182   2 #>  #> [[3]] #>         ts magnitudes gen #> 1 375.8796   2.925808   3 #> 2 480.7228   3.078332   3 #> 3 632.2054   2.651519   3 #> 4 631.6808   2.998968   3 #> 5 411.6630   2.730822   3 #> 6 819.0460   2.740064   3 #>    ## EXAMPLE 2: To generate a 1000 day catalogue including a M6.7 event on day 500  Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) generate_temporal_ETAS_synthetic(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000,   Ht = Ht ) #> [[1]] #>    ts magnitudes gen #> 1 500        6.7  -1 #>  #> [[2]] #>             ts magnitudes gen #> 1    500.00658   3.383772   0 #> 2    501.16633   3.525120   0 #> 3    586.60016   2.628598   0 #> 4    519.93167   2.501896   0 #> 5    516.50564   2.814438   0 #> 6    500.03471   3.482218   0 #> 7    552.28219   2.861065   0 #> 8    506.93460   2.951671   0 #> 9    524.37668   3.150712   0 #> 10   502.98601   2.739496   0 #> 11   500.07565   3.304258   0 #> 12   551.09809   2.563639   0 #> 13   500.59024   2.689940   0 #> 14   518.06473   3.506329   0 #> 15   533.42278   2.647155   0 #> 16   510.23353   3.227117   0 #> 17   500.20090   2.938405   0 #> 18   523.11559   2.787056   0 #> 19   500.08121   3.055652   0 #> 20   984.41225   3.191103   0 #> 21   500.35298   2.514788   0 #> 22   500.29767   2.735145   0 #> 23   503.06395   2.666519   0 #> 24   503.50789   3.587968   0 #> 25   500.60192   2.503176   0 #> 26   526.04420   3.399649   0 #> 27   500.04251   2.885478   0 #> 28   551.26305   3.706240   0 #> 29   529.57267   3.339157   0 #> 30   516.70000   2.629146   0 #> 31   501.66676   3.230457   0 #> 32   587.69816   2.885943   0 #> 33   508.67398   3.131346   0 #> 34   500.02176   3.013692   0 #> 35   500.16736   3.587464   0 #> 36   550.09082   2.687475   0 #> 37   504.81084   2.885794   0 #> 38   500.94083   4.159521   0 #> 39   503.10803   3.211465   0 #> 40   500.07059   3.803285   0 #> 41   501.90699   2.659524   0 #> 42   501.29113   2.746793   0 #> 43   500.38739   2.940448   0 #> 44   500.64115   3.388653   0 #> 45   512.93638   2.568140   0 #> 46   502.21152   2.506059   0 #> 47   923.85263   3.027159   0 #> 48   523.09394   2.784188   0 #> 49   813.95638   2.516415   0 #> 50   500.16415   2.545951   0 #> 51   629.00805   2.922899   0 #> 52   500.05860   2.964208   0 #> 53   501.76742   3.077861   0 #> 54   500.27016   3.114799   0 #> 55   500.49018   3.289608   0 #> 56   500.01438   3.563616   0 #> 57   504.53601   3.185015   0 #> 58   517.34889   2.698213   0 #> 59   500.20311   2.994074   0 #> 60   528.81568   2.552226   0 #> 61   500.61252   2.806497   0 #> 62   500.54540   3.413386   0 #> 63   502.88047   2.714767   0 #> 64   501.15940   2.568601   0 #> 65   853.45150   2.672517   0 #> 66   608.65568   2.576805   0 #> 67   511.40133   3.091382   0 #> 68   500.18946   3.812271   0 #> 69   500.04967   2.991211   0 #> 70   506.88193   2.917015   0 #> 71   567.04468   2.524372   0 #> 72   500.04007   2.797155   0 #> 73   555.83687   2.729053   0 #> 74   526.21790   2.962667   0 #> 75   668.96638   2.749910   0 #> 76   500.22136   2.582836   0 #> 77   629.65480   3.953551   0 #> 78   602.68931   2.967486   0 #> 79   808.98034   3.403731   0 #> 80   590.31223   3.779496   0 #> 81   500.54204   2.881189   0 #> 82   501.09605   3.719420   0 #> 83   500.39618   2.540270   0 #> 84   501.20207   3.557574   0 #> 85   598.04607   4.214894   0 #> 86   512.64528   2.787236   0 #> 87   519.06118   2.922123   0 #> 88   500.05183   2.850104   0 #> 89   500.01154   3.208470   0 #> 90   524.30124   2.810557   0 #> 91   518.52010   3.149408   0 #> 92   502.50648   2.535314   0 #> 93   500.25231   2.520100   0 #> 94   505.40806   2.962893   0 #> 95   500.10869   3.357771   0 #> 96   500.27195   3.049193   0 #> 97   512.19735   2.591443   0 #> 98   526.05239   2.771976   0 #> 99   851.55316   2.889021   0 #> 100  534.88936   3.998274   0 #> 101  600.35060   2.829660   0 #> 102  614.00686   2.714096   0 #> 103  500.79203   2.873326   0 #> 104  946.57112   2.565219   0 #> 105  500.38855   2.650588   0 #> 106  500.54364   3.914862   0 #> 107  544.77995   2.503614   0 #> 108  515.15695   2.636811   0 #> 109  510.28897   2.637729   0 #> 110  502.14669   2.590907   0 #> 111  512.65831   2.603659   0 #> 112  501.86225   2.564911   0 #> 113  500.10850   2.603927   0 #> 114  569.92275   3.688985   0 #> 115  625.42164   3.321938   0 #> 116  608.95188   2.665484   0 #> 117  500.52672   3.068602   0 #> 118  504.43351   3.835996   0 #> 119  500.34523   3.031578   0 #> 120  811.61302   3.034174   0 #> 121  507.94598   2.721695   0 #> 122  505.11400   2.565724   0 #> 123  515.91696   3.413742   0 #> 124  500.00370   3.240568   0 #> 125  500.26306   2.803556   0 #> 126  500.90224   2.715151   0 #> 127  552.54915   3.383702   0 #> 128  504.78787   2.616785   0 #> 129  846.61372   4.063107   0 #> 130  500.21914   2.637628   0 #> 131  523.89796   3.494380   0 #> 132  862.73013   3.701686   0 #> 133  995.91857   2.847889   0 #> 134  983.54651   2.533439   0 #> 135  965.19421   3.090005   0 #> 136  512.98920   2.580855   0 #> 137  520.59239   3.296545   0 #> 138  500.00807   2.702417   0 #> 139  500.21293   3.011359   0 #> 140  500.04625   2.913598   0 #> 141  573.92206   3.238143   0 #> 142  500.20212   2.548404   0 #> 143  500.04408   2.640761   0 #> 144  502.50513   3.014464   0 #> 145  502.51727   3.438442   0 #> 146  565.00182   2.918417   0 #> 147  691.75811   2.847896   0 #> 148  568.99863   2.724278   0 #> 149  518.07663   2.589443   0 #> 150  501.35945   2.677569   0 #> 151  670.26636   3.849447   0 #> 152  512.98768   2.940270   0 #> 153  782.31375   3.292294   0 #> 154  808.51917   3.924276   0 #> 155  532.99822   2.707644   0 #> 156  500.35438   2.892380   0 #> 157  501.89415   2.620386   0 #> 158  540.52764   2.516702   0 #> 159  500.16715   2.619163   0 #> 160  500.23443   3.706172   0 #> 161  501.46372   3.021730   0 #> 162  500.92172   3.307041   0 #> 163  500.39240   2.599233   0 #> 164  504.82398   2.980943   0 #> 165  542.98232   2.814612   0 #> 166  523.15331   2.610590   0 #> 167  500.01914   2.627758   0 #> 168  508.28706   2.910794   0 #> 169  506.59226   2.945278   0 #> 170  517.10315   3.005703   0 #> 171  603.83849   4.165054   0 #> 172  510.12014   2.800973   0 #> 173  501.02285   2.833273   0 #> 174  503.51067   3.439388   0 #> 175  500.86681   3.060112   0 #> 176  529.82639   2.656224   0 #> 177  501.19944   2.600011   0 #> 178  500.86077   3.873330   0 #> 179  582.11581   3.351487   0 #> 180  584.27516   3.612517   0 #> 181  521.98981   4.317219   0 #> 182  510.10584   3.172488   0 #> 183  552.71774   2.945519   0 #> 184  593.41717   2.594532   0 #> 185  501.95992   2.512287   0 #> 186  541.82240   2.724508   0 #> 187  500.26524   3.197504   0 #> 188  500.28310   2.569919   0 #> 189  567.07619   3.191332   0 #> 190  500.40732   3.040465   0 #> 191  769.66317   3.320978   0 #> 192  504.30400   2.618088   0 #> 193  500.06795   2.505050   0 #> 194  500.96745   3.395309   0 #> 195  500.18749   2.597537   0 #> 196  504.58382   3.140666   0 #> 197  503.03118   2.638497   0 #> 198  729.18332   2.648620   0 #> 199  505.56304   2.732696   0 #> 200  852.17627   2.546567   0 #> 201  582.67781   3.846720   0 #> 202  501.94936   2.604898   0 #> 203  945.39603   2.561477   0 #> 204  508.18448   2.751219   0 #> 205  500.46392   2.664674   0 #> 206  500.20371   2.555232   0 #> 207  508.66722   2.660342   0 #> 208  500.74958   2.764901   0 #> 209  500.12919   3.418045   0 #> 210  500.76402   4.165329   0 #> 211  501.35868   3.378752   0 #> 212  522.70288   3.446390   0 #> 213  500.36455   2.530181   0 #> 214  500.35926   2.970416   0 #> 215  544.85835   3.341824   0 #> 216  504.46074   2.642666   0 #> 217  500.07385   3.236000   0 #> 218  501.13208   2.779896   0 #> 219  500.49204   2.822546   0 #> 220  500.32867   2.995554   0 #> 221  500.33546   2.765583   0 #> 222  500.11049   2.694651   0 #> 223  502.13768   2.804495   0 #> 224  507.09885   2.741796   0 #> 225  541.95433   3.261792   0 #> 226  500.05252   2.566600   0 #> 227  500.32403   2.990383   0 #> 228  501.17891   2.640360   0 #> 229  500.11783   2.717435   0 #> 230  516.07329   2.603409   0 #> 231  511.48003   2.530076   0 #> 232  526.53920   2.943322   0 #> 233  504.86580   2.877885   0 #> 234  501.06023   2.614742   0 #> 235  514.61818   2.556488   0 #> 236  549.60261   3.785823   0 #> 237  503.25397   2.940272   0 #> 238  500.29460   2.702240   0 #> 239  543.58174   3.620888   0 #> 240  626.43689   3.479436   0 #> 241  844.16162   2.808281   0 #> 242  500.99378   2.534054   0 #> 243  506.30676   2.524700   0 #> 244  727.46532   3.006642   0 #> 245  527.24841   3.076828   0 #> 246  505.38509   2.786739   0 #> 247  500.97640   2.745016   0 #> 248  503.59244   4.139745   0 #> 249  504.19968   2.585472   0 #> 250  500.73288   2.643159   0 #> 251  532.47535   2.638382   0 #> 252  594.75367   3.329574   0 #> 253  842.13377   2.568308   0 #> 254  506.78801   2.645351   0 #> 255  566.60390   2.623570   0 #> 256  509.96272   2.568659   0 #> 257  500.00150   2.509096   0 #> 258  500.02452   2.586419   0 #> 259  500.27576   2.608041   0 #> 260  500.01789   2.808754   0 #> 261  553.52159   2.672736   0 #> 262  530.97258   2.699403   0 #> 263  502.41047   2.599654   0 #> 264  501.18535   2.560228   0 #> 265  502.55475   2.792964   0 #> 266  500.02298   2.742138   0 #> 267  512.43507   3.100473   0 #> 268  500.33741   2.511978   0 #> 269  508.15655   2.611444   0 #> 270  500.10751   2.796186   0 #> 271  680.80445   2.584476   0 #> 272  973.03044   2.807010   0 #> 273  500.10183   3.627545   0 #> 274  720.24598   2.778976   0 #> 275  529.31242   2.965219   0 #> 276  500.02551   3.082511   0 #> 277  501.03246   2.827833   0 #> 278  716.67779   2.503296   0 #> 279  947.01398   2.549948   0 #> 280  585.39462   2.722977   0 #> 281  935.32320   2.781986   0 #> 282  529.84918   3.010676   0 #> 283  510.14814   2.789106   0 #> 284  515.01431   4.610571   0 #> 285  506.68870   2.830192   0 #> 286  500.31523   2.668951   0 #> 287  500.07412   3.928716   0 #> 288  502.31198   3.861112   0 #> 289  501.44092   3.126260   0 #> 290  811.94803   2.703118   0 #> 291  500.33623   2.539223   0 #> 292  500.05583   3.091377   0 #> 293  501.60148   2.850281   0 #> 294  500.01599   3.252170   0 #> 295  500.10077   2.682190   0 #> 296  500.56511   3.000984   0 #> 297  595.70766   2.501629   0 #> 298  500.01717   3.632748   0 #> 299  504.06819   3.333132   0 #> 300  501.59315   3.430922   0 #> 301  500.76832   3.012959   0 #> 302  501.42852   3.049151   0 #> 303  988.04902   4.164190   0 #> 304  536.83666   2.586122   0 #> 305  520.03671   3.740154   0 #> 306  500.41539   2.806836   0 #> 307  500.07639   2.565610   0 #> 308  500.27062   3.229601   0 #> 309  617.04935   2.674664   0 #> 310  500.10273   3.029571   0 #> 311  751.14094   2.504613   0 #> 312  798.35210   2.895897   0 #> 313  500.05519   2.824463   0 #> 314  516.97495   3.013880   0 #> 315  519.78743   3.028007   0 #> 316  533.30221   2.545773   0 #> 317  500.11987   4.126338   0 #> 318  520.08919   3.142523   0 #> 319  501.64086   2.680003   0 #> 320  500.77947   4.748912   0 #> 321  500.46932   2.510587   0 #> 322  518.35434   2.713668   0 #> 323  524.40790   2.932559   0 #> 324  531.91420   3.159273   0 #> 325  937.88582   3.249428   0 #> 326  501.06704   3.465485   0 #> 327  516.82493   2.745459   0 #> 328  501.40211   2.892198   0 #> 329  501.06411   2.864862   0 #> 330  501.19035   2.743381   0 #> 331  579.19531   3.098361   0 #> 332  598.76249   2.648642   0 #> 333  591.02382   3.181490   0 #> 334  502.13932   4.327810   0 #> 335  500.98853   3.063174   0 #> 336  500.43343   2.618245   0 #> 337  501.77864   4.173362   0 #> 338  503.44756   3.046460   0 #> 339  501.01714   2.661895   0 #> 340  534.41658   2.741061   0 #> 341  506.62366   4.342569   0 #> 342  535.15008   2.919321   0 #> 343  649.34747   2.697685   0 #> 344  500.47570   2.599468   0 #> 345  500.10514   2.607741   0 #> 346  500.31489   2.890160   0 #> 347  611.52876   2.575665   0 #> 348  515.52144   4.274360   0 #> 349  500.46559   3.238752   0 #> 350  641.68904   3.081786   0 #> 351  599.28161   2.737379   0 #> 352  500.82362   3.469898   0 #> 353  500.29737   2.937977   0 #> 354  734.92446   3.023875   0 #> 355  506.55679   2.859604   0 #> 356  502.64064   3.383159   0 #> 357  502.99692   2.673359   0 #> 358  500.02120   2.608321   0 #> 359  500.23602   2.656070   0 #> 360  500.25791   2.532160   0 #> 361  500.68009   2.649094   0 #> 362  551.02554   3.053725   0 #> 363  789.38687   2.955858   0 #> 364  502.51581   2.811209   0 #> 365  500.10511   2.505997   0 #> 366  500.55518   3.142517   0 #> 367  508.64973   2.506338   0 #> 368  543.43753   3.398558   0 #> 369  501.00359   2.589742   0 #> 370  617.90437   2.530297   0 #> 371  500.04957   3.059149   0 #> 372  500.01808   4.777475   0 #> 373  506.03007   2.568098   0 #> 374  500.35286   2.603611   0 #> 375  500.34255   2.563431   0 #> 376  621.98811   3.838694   0 #> 377  500.36800   2.516501   0 #> 378  500.11771   2.680373   0 #> 379  501.01460   2.507346   0 #> 380  500.08595   3.381556   0 #> 381  500.14421   2.714781   0 #> 382  559.32574   2.891557   0 #> 383  706.49826   2.721940   0 #> 384  500.40697   2.694086   0 #> 385  612.43443   2.755650   0 #> 386  501.73911   2.703081   0 #> 387  690.63560   2.718301   0 #> 388  501.34398   2.983562   0 #> 389  500.26325   2.666024   0 #> 390  500.46588   2.654175   0 #> 391  517.48108   3.034687   0 #> 392  515.72723   3.721042   0 #> 393  500.95538   2.985803   0 #> 394  500.14012   2.811788   0 #> 395  937.49807   2.580425   0 #> 396  635.56381   3.292672   0 #> 397  517.30145   3.126353   0 #> 398  500.01732   2.674370   0 #> 399  557.69147   2.520779   0 #> 400  501.60885   2.560827   0 #> 401  514.71328   2.669114   0 #> 402  533.48392   2.840547   0 #> 403  500.30349   2.929352   0 #> 404  500.99172   3.239165   0 #> 405  551.18046   2.522096   0 #> 406  910.86650   3.258312   0 #> 407  521.68466   2.698062   0 #> 408  566.97030   3.439359   0 #> 409  546.95581   3.594296   0 #> 410  500.32746   2.896202   0 #> 411  509.68462   3.025479   0 #> 412  525.03652   2.895670   0 #> 413  570.22872   2.998809   0 #> 414  501.28203   2.503242   0 #> 415  500.00068   2.794329   0 #> 416  500.07751   2.685306   0 #> 417  500.13260   2.543047   0 #> 418  500.14925   2.649565   0 #> 419  500.12470   3.404326   0 #> 420  501.03839   2.631633   0 #> 421  500.47308   2.560996   0 #> 422  514.18415   2.683421   0 #> 423  500.14830   2.515344   0 #> 424  501.83093   2.898649   0 #> 425  905.91189   2.596701   0 #> 426  575.29551   3.351736   0 #> 427  500.02423   2.617856   0 #> 428  637.12618   2.567955   0 #> 429  506.39810   2.637924   0 #> 430  516.92812   3.465921   0 #> 431  500.58371   4.073174   0 #> 432  500.19718   2.593486   0 #> 433  508.56777   2.994157   0 #> 434  550.89515   2.685438   0 #> 435  514.35891   2.579131   0 #> 436  511.59696   3.066798   0 #> 437  681.48162   2.604839   0 #> 438  534.35852   3.881267   0 #> 439  500.08992   2.766946   0 #> 440  500.01870   2.653481   0 #> 441  504.72146   3.392742   0 #> 442  500.33444   2.508946   0 #> 443  505.35862   2.770294   0 #> 444  575.13456   2.793750   0 #> 445  501.11698   2.559057   0 #> 446  504.16385   2.512394   0 #> 447  549.56456   2.714022   0 #> 448  500.32166   2.550891   0 #> 449  575.37335   3.188864   0 #> 450  806.43222   2.619105   0 #> 451  501.24170   2.553580   0 #> 452  515.89981   2.681121   0 #> 453  508.72836   3.048064   0 #> 454  506.60755   2.702771   0 #> 455  500.01228   2.518787   0 #> 456  532.73621   3.501384   0 #> 457  993.30645   3.183921   0 #> 458  653.74304   3.308767   0 #> 459  510.09510   2.705988   0 #> 460  500.56181   3.001901   0 #> 461  500.60116   2.888481   0 #> 462  772.18519   2.503082   0 #> 463  501.96262   2.531303   0 #> 464  502.47356   3.631318   0 #> 465  500.18674   2.541609   0 #> 466  500.55424   2.633950   0 #> 467  500.99891   2.588434   0 #> 468  500.08630   2.993265   0 #> 469  500.74416   2.584652   0 #> 470  508.10955   3.326215   0 #> 471  535.91991   2.546535   0 #> 472  509.05548   2.522201   0 #> 473  543.30003   2.563531   0 #> 474  557.32910   2.682763   0 #> 475  500.23485   2.697345   0 #> 476  508.89017   2.517974   0 #> 477  817.72301   2.524313   0 #> 478  501.32332   2.739861   0 #> 479  500.15474   2.568873   0 #> 480  501.58096   3.080167   0 #> 481  504.35314   2.657393   0 #> 482  545.59672   2.602449   0 #> 483  500.33494   2.576696   0 #> 484  585.42291   2.967239   0 #> 485  834.47344   2.545721   0 #> 486  500.07890   2.889800   0 #> 487  505.85698   3.023886   0 #> 488  500.35204   2.594059   0 #> 489  500.46418   2.554011   0 #> 490  501.90016   2.813530   0 #> 491  500.06276   2.539301   0 #> 492  528.25942   2.694671   0 #> 493  500.21913   3.290863   0 #> 494  540.62590   2.737916   0 #> 495  500.62384   2.558433   0 #> 496  500.00203   2.539833   0 #> 497  500.02015   2.662171   0 #> 498  517.05348   2.893949   0 #> 499  500.34084   3.121600   0 #> 500  500.29448   2.816939   0 #> 501  500.30143   2.507153   0 #> 502  639.56112   2.826327   0 #> 503  507.66583   2.630990   0 #> 504  503.07956   3.016354   0 #> 505  508.71644   3.482443   0 #> 506  500.02084   2.771653   0 #> 507  500.00783   2.942037   0 #> 508  500.04331   2.577865   0 #> 509  500.29783   2.565777   0 #> 510  861.83590   2.653647   0 #> 511  501.22148   2.941767   0 #> 512  500.33544   2.553216   0 #> 513  509.85902   3.555393   0 #> 514  501.67520   2.835492   0 #> 515  502.84650   3.135493   0 #> 516  517.99116   3.240793   0 #> 517  505.45769   2.749927   0 #> 518  500.25659   3.691749   0 #> 519  520.46618   3.569778   0 #> 520  708.94855   3.937327   0 #> 521  504.06565   3.068956   0 #> 522  500.01463   2.561335   0 #> 523  514.25512   2.873634   0 #> 524  518.44910   2.544129   0 #> 525  505.45397   2.769483   0 #> 526  500.02343   2.589892   0 #> 527  500.06170   3.056618   0 #> 528  500.06054   2.541703   0 #> 529  503.27641   2.920214   0 #> 530  500.01385   2.599268   0 #> 531  500.39044   2.704647   0 #> 532  573.38184   2.516223   0 #> 533  595.82977   3.387685   0 #> 534  500.33228   2.530619   0 #> 535  501.73175   2.595943   0 #> 536  500.08498   2.939032   0 #> 537  500.17973   2.582687   0 #> 538  500.16816   3.209544   0 #> 539  501.81658   3.218198   0 #> 540  500.68803   3.277388   0 #> 541  500.43918   2.548215   0 #> 542  539.48540   2.521408   0 #> 543  507.62348   3.042316   0 #> 544  514.00172   2.510232   0 #> 545  576.78635   2.586668   0 #> 546  856.56924   3.156099   0 #> 547  500.10807   3.343509   0 #> 548  666.28242   3.107382   0 #> 549  503.68463   3.592664   0 #> 550  500.46202   2.583909   0 #> 551  847.82806   3.131450   0 #> 552  500.10977   3.093649   0 #> 553  500.00952   2.676269   0 #> 554  719.24031   3.456035   0 #> 555  540.85448   2.752552   0 #> 556  545.87198   3.389362   0 #> 557  503.86902   2.653906   0 #> 558  500.08433   3.096872   0 #> 559  502.03385   2.800728   0 #> 560  503.92763   2.884557   0 #> 561  601.53688   2.776010   0 #> 562  507.45563   3.496354   0 #> 563  500.61576   2.563692   0 #> 564  500.02430   2.757364   0 #> 565  605.92135   2.526569   0 #> 566  500.47071   2.763709   0 #> 567  527.59144   3.027659   0 #> 568  500.13187   2.993555   0 #> 569  643.60031   3.346271   0 #> 570  539.82304   2.561187   0 #> 571  525.36981   2.856911   0 #> 572  506.67784   2.530947   0 #> 573  507.81800   3.094923   0 #> 574  500.01527   2.544233   0 #> 575  661.92018   2.750417   0 #> 576  500.81392   3.055982   0 #> 577  503.52878   3.587469   0 #> 578  503.90097   2.821399   0 #> 579  511.46932   2.563885   0 #> 580  617.85643   3.088096   0 #> 581  500.14040   3.293620   0 #> 582  502.72330   2.609851   0 #> 583  501.75238   2.825147   0 #> 584  511.53530   3.038691   0 #> 585  564.14978   2.646489   0 #> 586  504.62718   2.776636   0 #> 587  584.11779   2.622859   0 #> 588  502.43053   2.886235   0 #> 589  513.46005   2.715100   0 #> 590  503.01659   2.547201   0 #> 591  500.25523   3.019881   0 #> 592  502.35131   3.513658   0 #> 593  500.51215   2.710581   0 #> 594  525.07434   2.673209   0 #> 595  501.85769   2.605246   0 #> 596  551.56203   2.507976   0 #> 597  686.31563   2.500728   0 #> 598  540.98069   2.611872   0 #> 599  500.18646   2.648977   0 #> 600  500.21249   3.825402   0 #> 601  500.14567   2.872838   0 #> 602  504.17646   2.966198   0 #> 603  608.19012   2.736264   0 #> 604  500.56053   2.867899   0 #> 605  517.82164   2.866723   0 #> 606  504.54272   3.033341   0 #> 607  500.26626   2.531697   0 #> 608  502.54135   2.538532   0 #> 609  591.01465   2.505029   0 #> 610  517.96826   2.751106   0 #> 611  500.04522   2.539999   0 #> 612  505.16683   3.560230   0 #> 613  509.95624   2.974837   0 #> 614  508.89960   3.557428   0 #> 615  504.68422   2.520624   0 #> 616  500.83611   3.156021   0 #> 617  501.41302   3.257116   0 #> 618  727.51398   2.595655   0 #> 619  504.79749   3.789481   0 #> 620  500.38089   2.763822   0 #> 621  675.99544   2.515519   0 #> 622  587.92382   3.816019   0 #> 623  510.82011   2.862938   0 #> 624  678.96999   2.647457   0 #> 625  503.09314   2.534983   0 #> 626  570.91319   2.607036   0 #> 627  511.12220   2.979999   0 #> 628  811.15917   2.575900   0 #> 629  509.15708   2.914521   0 #> 630  565.33774   3.022367   0 #> 631  501.75766   4.187683   0 #> 632  511.56946   2.561294   0 #> 633  543.75731   2.563925   0 #> 634  500.68222   2.611206   0 #> 635  515.80526   2.866495   0 #> 636  501.58877   2.526465   0 #> 637  500.81178   3.765983   0 #> 638  500.43541   2.638709   0 #> 639  501.08419   2.737041   0 #> 640  667.70951   3.112747   0 #> 641  500.31986   3.819770   0 #> 642  500.38620   2.792700   0 #> 643  872.22494   3.192048   0 #> 644  619.96264   2.620234   0 #> 645  500.00420   3.618995   0 #> 646  516.46067   2.719472   0 #> 647  500.74743   2.841079   0 #> 648  500.24062   3.325744   0 #> 649  502.28986   3.653533   0 #> 650  502.04508   2.579940   0 #> 651  500.09592   2.527728   0 #> 652  501.69851   2.727267   0 #> 653  801.75358   2.935232   0 #> 654  500.04203   3.179323   0 #> 655  501.59087   3.281319   0 #> 656  532.03027   2.578717   0 #> 657  500.01024   3.010347   0 #> 658  521.41882   2.590382   0 #> 659  500.07423   2.695677   0 #> 660  803.43444   4.767705   0 #> 661  529.59445   2.747324   0 #> 662  500.56499   2.501717   0 #> 663  500.12006   2.844669   0 #> 664  515.23509   3.562774   0 #> 665  634.48642   3.706335   0 #> 666  697.83954   2.993234   0 #> 667  500.05092   3.808501   0 #> 668  504.11140   2.647131   0 #> 669  500.17362   2.763481   0 #> 670  602.29941   2.527534   0 #> 671  540.09403   3.019032   0 #> 672  513.72572   2.504960   0 #> 673  507.26745   2.568885   0 #> 674  600.26796   2.717893   0 #> 675  500.08009   3.028371   0 #> 676  655.03931   2.768160   0 #> 677  635.83602   2.968117   0 #> 678  529.35070   3.003787   0 #> 679  898.45763   2.555879   0 #> 680  528.34518   2.944241   0 #> 681  513.32854   2.565121   0 #> 682  729.55161   2.573471   0 #> 683  500.07908   2.857366   0 #> 684  500.03564   3.797979   0 #> 685  500.54601   2.894372   0 #> 686  690.12022   2.734150   0 #> 687  502.00632   3.012037   0 #> 688  500.10857   2.596016   0 #> 689  768.08845   2.586911   0 #> 690  559.69726   2.852110   0 #> 691  500.04054   2.680071   0 #> 692  539.79232   2.650908   0 #> 693  507.99588   2.622036   0 #> 694  500.45758   2.518450   0 #> 695  516.24343   2.620608   0 #> 696  501.70327   2.660521   0 #> 697  500.85948   2.698682   0 #> 698  502.74294   2.861481   0 #> 699  823.49367   3.183115   0 #> 700  519.08873   2.574678   0 #> 701  505.02974   2.553301   0 #> 702  500.67410   2.618156   0 #> 703  500.91547   2.546655   0 #> 704  500.98813   4.312644   0 #> 705  504.31531   2.834467   0 #> 706  502.31946   3.038339   0 #> 707  500.85050   2.599571   0 #> 708  500.62722   2.874012   0 #> 709  500.35797   3.469282   0 #> 710  502.54138   2.578989   0 #> 711  611.13380   2.912878   0 #> 712  500.23111   2.737701   0 #> 713  501.72901   3.454683   0 #> 714  500.10817   2.511293   0 #> 715  522.51329   3.181641   0 #> 716  502.20107   3.429123   0 #> 717  507.10819   2.510754   0 #> 718  599.21638   2.773682   0 #> 719  504.93267   2.694869   0 #> 720  500.61683   2.723506   0 #> 721  605.33793   2.994966   0 #> 722  774.84518   2.855765   0 #> 723  687.61558   2.951891   0 #> 724  500.54630   3.041057   0 #> 725  503.81792   2.615408   0 #> 726  500.10806   2.694897   0 #> 727  500.04785   3.255574   0 #> 728  500.51661   2.556415   0 #> 729  507.66117   2.923239   0 #> 730  500.04224   2.762995   0 #> 731  500.38617   2.540848   0 #> 732  539.96170   3.281615   0 #> 733  737.60650   2.870713   0 #> 734  547.77966   2.661499   0 #> 735  545.50446   2.946970   0 #> 736  581.54979   3.466955   0 #> 737  501.19410   3.068129   0 #> 738  500.42098   2.721661   0 #> 739  757.66506   2.596229   0 #> 740  500.08278   3.041913   0 #> 741  502.66951   2.526113   0 #> 742  505.47429   3.326587   0 #> 743  500.00676   2.549194   0 #> 744  500.89418   2.981975   0 #> 745  503.47766   3.026478   0 #> 746  542.63233   3.225112   0 #> 747  528.39835   3.097340   0 #> 748  504.55262   2.956204   0 #> 749  514.59760   3.079970   0 #> 750  531.99582   3.043554   0 #> 751  500.28195   2.917882   0 #> 752  521.10368   3.134598   0 #> 753  842.03367   5.082047   0 #> 754  505.33917   2.741776   0 #> 755  569.28799   3.787723   0 #> 756  512.26455   3.024825   0 #> 757  515.64496   2.779191   0 #> 758  515.05393   2.737579   0 #> 759  511.58719   2.515934   0 #> 760  501.80991   2.630824   0 #> 761  509.53259   2.582241   0 #> 762  508.35789   2.605188   0 #> 763  500.30327   2.578593   0 #> 764  560.61642   2.929512   0 #> 765  500.17230   3.037413   0 #> 766  526.60373   2.710781   0 #> 767  500.06018   2.566879   0 #> 768  595.72067   2.562757   0 #> 769  500.00127   2.515799   0 #> 770  500.93601   2.619898   0 #> 771  500.52541   2.549747   0 #> 772  501.90922   2.988165   0 #> 773  538.23142   2.644338   0 #> 774  500.27839   3.015015   0 #> 775  501.03670   2.849224   0 #> 776  500.57045   2.573545   0 #> 777  512.46042   2.557063   0 #> 778  521.93742   2.560114   0 #> 779  501.20623   2.574780   0 #> 780  790.18295   2.620713   0 #> 781  509.60602   2.578284   0 #> 782  501.87991   2.791565   0 #> 783  530.13869   2.896753   0 #> 784  500.00008   2.538978   0 #> 785  510.85310   2.856338   0 #> 786  503.90160   2.540336   0 #> 787  536.81024   3.012931   0 #> 788  501.53338   4.422709   0 #> 789  507.76530   2.533252   0 #> 790  559.58210   2.927285   0 #> 791  500.12401   2.770877   0 #> 792  511.96801   3.085248   0 #> 793  501.50748   2.874745   0 #> 794  500.64712   2.850612   0 #> 795  512.05579   2.940887   0 #> 796  501.57493   3.200328   0 #> 797  546.33837   3.554980   0 #> 798  544.71139   2.558374   0 #> 799  500.96636   2.532594   0 #> 800  500.45241   2.911947   0 #> 801  539.47180   3.235682   0 #> 802  711.90207   2.977755   0 #> 803  501.25205   3.670174   0 #> 804  563.02712   3.664328   0 #> 805  555.14732   2.827024   0 #> 806  500.14173   2.570225   0 #> 807  505.03035   2.670069   0 #> 808  501.16317   2.519560   0 #> 809  579.09862   2.826002   0 #> 810  502.93842   2.547997   0 #> 811  515.10615   2.977669   0 #> 812  500.89826   3.324924   0 #> 813  500.14333   2.635957   0 #> 814  592.07114   3.377436   0 #> 815  520.53548   2.516286   0 #> 816  500.99812   2.663209   0 #> 817  500.17511   2.512682   0 #> 818  500.56296   2.678090   0 #> 819  533.90985   2.877492   0 #> 820  500.83798   3.283777   0 #> 821  501.50544   2.547354   0 #> 822  500.29061   2.567153   0 #> 823  500.25340   2.568075   0 #> 824  504.98366   2.968954   0 #> 825  500.81277   3.313270   0 #> 826  523.78770   2.618346   0 #> 827  526.12160   3.350800   0 #> 828  500.00190   2.606426   0 #> 829  500.58669   3.052459   0 #> 830  524.88674   3.371611   0 #> 831  500.17144   3.453432   0 #> 832  644.41901   2.557393   0 #> 833  500.11954   2.713593   0 #> 834  500.47185   2.837198   0 #> 835  500.62733   3.338439   0 #> 836  500.09518   2.863244   0 #> 837  500.43814   3.038854   0 #> 838  502.93025   4.902999   0 #> 839  532.96533   2.522981   0 #> 840  505.14194   2.803177   0 #> 841  500.07516   2.873972   0 #> 842  533.08874   3.208399   0 #> 843  642.25158   2.973852   0 #> 844  502.22677   2.569643   0 #> 845  500.43237   2.811621   0 #> 846  500.07775   2.644758   0 #> 847  500.11440   2.915326   0 #> 848  500.92798   2.719779   0 #> 849  516.31445   2.558388   0 #> 850  599.88806   2.825076   0 #> 851  946.91042   2.786036   0 #> 852  500.46818   2.578034   0 #> 853  521.01816   3.184050   0 #> 854  521.62356   3.032848   0 #> 855  501.00597   2.659470   0 #> 856  631.82717   2.675813   0 #> 857  539.48597   2.735622   0 #> 858  515.78077   2.785831   0 #> 859  660.78249   2.515209   0 #> 860  501.59517   2.986736   0 #> 861  500.12455   2.617004   0 #> 862  502.25602   3.745895   0 #> 863  585.10734   2.918154   0 #> 864  593.36177   2.674135   0 #> 865  500.88949   3.019230   0 #> 866  500.31807   2.798504   0 #> 867  500.16406   2.552898   0 #> 868  503.03963   3.033736   0 #> 869  500.68508   3.581045   0 #> 870  530.94955   2.544210   0 #> 871  500.13910   3.893423   0 #> 872  500.49593   2.721836   0 #> 873  500.05714   3.444481   0 #> 874  552.76856   2.852749   0 #> 875  500.71167   2.506956   0 #> 876  504.34485   4.070916   0 #> 877  957.97179   3.258848   0 #> 878  902.90768   2.584208   0 #> 879  501.86313   3.145905   0 #> 880  500.99225   3.214830   0 #> 881  500.46223   2.795704   0 #> 882  516.22421   2.821566   0 #> 883  500.33151   5.296738   0 #> 884  501.63369   2.990758   0 #> 885  500.34537   2.985679   0 #> 886  540.62339   2.667580   0 #> 887  547.85778   2.699443   0 #> 888  507.55714   3.579398   0 #> 889  503.26524   3.034133   0 #> 890  508.41436   2.722766   0 #> 891  500.07263   2.563359   0 #> 892  515.20494   3.032009   0 #> 893  501.95934   3.050583   0 #> 894  502.82934   3.182878   0 #> 895  503.40294   2.982412   0 #> 896  501.17762   2.839412   0 #> 897  500.46137   3.835095   0 #> 898  530.85802   3.778539   0 #> 899  500.37431   2.933014   0 #> 900  524.70842   2.746140   0 #> 901  543.62861   2.950170   0 #> 902  523.17857   3.448358   0 #> 903  539.60407   2.699298   0 #> 904  565.24862   2.554254   0 #> 905  500.76697   3.219878   0 #> 906  500.21808   3.261998   0 #> 907  584.13281   2.635923   0 #> 908  591.94284   3.427433   0 #> 909  507.17733   3.058807   0 #> 910  637.89293   2.608530   0 #> 911  515.00515   2.696132   0 #> 912  511.18781   3.762197   0 #> 913  500.52925   2.600709   0 #> 914  525.94594   2.533676   0 #> 915  500.10552   2.942323   0 #> 916  500.90977   2.613583   0 #> 917  504.92886   2.551199   0 #> 918  500.12315   2.774980   0 #> 919  508.15274   3.171254   0 #> 920  541.03679   2.808881   0 #> 921  500.11284   3.250213   0 #> 922  727.32445   2.774127   0 #> 923  896.12310   2.930940   0 #> 924  525.73606   2.993980   0 #> 925  500.41492   3.085148   0 #> 926  500.12977   2.578234   0 #> 927  501.77587   2.686642   0 #> 928  507.96169   2.582089   0 #> 929  782.85772   2.810718   0 #> 930  570.10691   2.728412   0 #> 931  521.29788   2.547455   0 #> 932  547.48215   3.182637   0 #> 933  520.84870   2.594816   0 #> 934  517.69566   2.651682   0 #> 935  500.05792   3.270531   0 #> 936  506.79846   3.449928   0 #> 937  503.74219   3.160861   0 #> 938  410.69669   2.995788   1 #> 939  380.61704   2.566058   1 #> 940  528.05934   3.148634   1 #> 941  828.74436   3.800679   1 #> 942  148.21589   2.690971   1 #> 943  801.85200   2.931556   1 #> 944  684.33044   2.565546   1 #> 945  275.71730   2.724945   1 #> 946  808.20704   2.585983   1 #> 947  173.77645   2.925493   1 #> 948  872.66472   2.630083   1 #> 949  297.36788   3.054008   1 #> 950  263.59268   2.602777   1 #> 951  915.36611   2.551679   1 #> 952   44.41977   2.931754   1 #> 953  399.04006   2.804903   1 #> 954  542.51869   3.025336   1 #> 955  775.54427   3.615160   1 #> 956  722.12634   2.612907   1 #> 957  592.65576   2.685462   1 #> 958  155.56004   3.194517   1 #> 959  987.90590   3.578755   1 #> 960  392.86198   3.070893   1 #> 961  114.18101   2.883498   1 #> 962  165.67727   2.529233   1 #> 963   33.85987   3.966358   1 #> 964   69.00250   2.708472   1 #> 965  128.95896   3.265129   1 #> 966  781.74747   3.040730   1 #> 967   90.91031   3.119498   1 #> 968  306.44036   2.950739   1 #> 969   76.72564   2.531576   1 #> 970  666.47573   3.524112   1 #> 971  475.18753   2.702976   1 #> 972  991.10101   3.068591   1 #> 973  434.19847   2.946626   1 #> 974  692.41442   2.855196   1 #> 975   39.86413   2.951272   1 #> 976  143.58113   3.149370   1 #> 977  414.27899   2.844034   1 #> 978  279.70124   2.530419   1 #> 979  696.49559   2.928275   1 #> 980  610.85803   2.785365   1 #> 981  537.14181   2.520811   1 #> 982  416.38028   2.507098   1 #> 983  498.83030   2.620809   1 #> 984  561.63497   2.701120   1 #> 985  626.41708   3.161470   1 #> 986  915.16129   2.741955   1 #> 987  134.57525   2.845390   1 #> 988   83.32427   3.118887   1 #> 989  398.24447   3.012439   1 #> 990  205.00901   2.799407   1 #> 991  810.70592   2.739105   1 #> 992  940.12609   2.729559   1 #> 993  553.54567   2.540172   1 #> 994  780.38444   2.766029   1 #> 995  189.21727   2.594386   1 #> 996  126.48593   2.688381   1 #> 997  158.03653   2.682106   1 #> 998  537.78426   2.802054   1 #> 999  322.96815   2.729971   1 #> 1000 904.04273   4.905597   1 #> 1001 805.70720   2.800607   1 #> 1002 270.08112   4.075241   1 #> 1003 182.84095   2.625526   1 #> 1004 362.68346   2.689016   1 #> 1005 417.94562   2.754223   1 #> 1006 941.92697   2.522647   1 #> 1007 661.86230   3.202012   1 #> 1008 409.27811   3.497353   1 #> 1009 487.83448   2.992836   1 #> 1010 907.95385   3.214527   1 #> 1011 353.84753   2.852986   1 #> 1012 542.56777   3.091356   1 #> 1013 647.03864   3.077230   1 #> 1014 401.18403   2.806984   1 #> 1015 610.42196   2.795965   1 #> 1016 205.10850   2.716020   1 #> 1017 574.85586   2.675556   1 #> 1018  86.27051   3.152361   1 #> 1019 401.13415   3.107081   1 #> 1020 672.40972   3.073043   1 #> 1021 712.25561   2.740975   1 #> 1022 307.67059   3.003310   1 #> 1023 149.69085   4.624848   1 #> 1024  99.70942   2.706088   1 #> 1025  27.04347   2.526505   1 #> 1026 518.42243   3.839411   1 #> 1027 191.61225   2.586209   1 #> 1028  77.64922   2.757767   1 #> 1029 200.57435   2.896933   1 #> 1030  63.85966   2.905633   1 #> 1031 782.21936   2.601253   1 #> 1032 958.66901   2.628088   1 #> 1033 181.93387   2.740402   1 #> 1034 198.91292   2.584046   1 #> 1035 636.65138   2.630731   1 #> 1036 459.34916   4.005518   1 #> 1037 696.00291   2.568175   1 #> 1038 283.42167   2.527587   1 #> 1039 296.88814   2.512566   1 #> 1040 848.60575   2.661436   1 #> 1041 271.30742   3.908581   1 #> 1042 881.74053   2.916173   1 #> 1043 304.55252   3.156089   1 #> 1044 120.46429   2.740047   1 #> 1045 338.62294   3.375889   1 #> 1046 918.17743   2.503275   1 #> 1047 494.17657   2.512399   1 #> 1048 808.65944   2.660775   1 #>  #> [[3]] #>            ts magnitudes gen #> 1   500.49208   2.997108   2 #> 2   556.58416   2.623945   2 #> 3   552.42390   2.785000   2 #> 4   541.61536   3.852275   2 #> 5   512.80768   2.530066   2 #> 6   503.97223   2.753346   2 #> 7   576.84729   2.617335   2 #> 8   563.04601   2.844666   2 #> 9   530.88409   3.118415   2 #> 10  587.99254   2.602911   2 #> 11  587.70264   2.715200   2 #> 12  509.17085   2.510223   2 #> 13  514.97119   2.558993   2 #> 14  505.96495   3.558839   2 #> 15  500.29188   2.503504   2 #> 16  506.96783   2.732389   2 #> 17  557.58701   3.148507   2 #> 18  503.15632   5.093037   2 #> 19  502.17496   2.532770   2 #> 20  679.88095   2.517539   2 #> 21  502.34015   2.723745   2 #> 22  504.61485   2.747123   2 #> 23  541.06851   2.656804   2 #> 24  502.01189   2.938160   2 #> 25  501.08578   2.797444   2 #> 26  949.63487   2.561504   2 #> 27  546.67952   3.053542   2 #> 28  857.39819   2.813561   2 #> 29  630.25571   2.822596   2 #> 30  638.18279   2.907246   2 #> 31  643.17679   3.098660   2 #> 32  669.47631   2.893667   2 #> 33  506.54157   2.672298   2 #> 34  598.15231   2.742643   2 #> 35  500.73196   2.523800   2 #> 36  501.84658   2.593031   2 #> 37  500.31858   2.723899   2 #> 38  536.98786   2.865878   2 #> 39  501.84321   2.823432   2 #> 40  594.81522   2.531594   2 #> 41  504.49160   2.720686   2 #> 42  645.42479   2.571184   2 #> 43  509.13735   2.730367   2 #> 44  537.47922   2.506211   2 #> 45  857.18027   2.773118   2 #> 46  866.30779   3.296299   2 #> 47  528.71308   2.560488   2 #> 48  605.75535   3.359554   2 #> 49  529.57926   3.149451   2 #> 50  839.11949   2.625111   2 #> 51  950.54709   3.106099   2 #> 52  848.36493   3.397315   2 #> 53  533.39222   2.743570   2 #> 54  530.35378   3.035035   2 #> 55  608.61208   2.930476   2 #> 56  604.03866   2.665370   2 #> 57  706.41464   2.584750   2 #> 58  603.91361   2.554472   2 #> 59  603.96490   2.741580   2 #> 60  604.07315   2.594330   2 #> 61  503.90287   3.289543   2 #> 62  501.99020   3.473797   2 #> 63  503.00887   2.625502   2 #> 64  522.06103   2.566730   2 #> 65  522.28080   2.583703   2 #> 66  527.13865   2.523131   2 #> 67  610.88502   2.643473   2 #> 68  817.41343   2.820982   2 #> 69  571.07802   2.775303   2 #> 70  540.54370   3.182260   2 #> 71  522.33380   2.769009   2 #> 72  522.35896   2.873476   2 #> 73  565.97437   2.549378   2 #> 74  675.00615   2.660485   2 #> 75  504.59946   2.878062   2 #> 76  502.18786   2.720806   2 #> 77  502.88985   2.894653   2 #> 78  500.14811   2.597037   2 #> 79  530.09132   2.769771   2 #> 80  520.01187   2.688221   2 #> 81  999.57721   2.688596   2 #> 82  514.83744   3.369676   2 #> 83  504.17675   3.138967   2 #> 84  505.52303   2.744821   2 #> 85  596.99520   3.989470   2 #> 86  842.64441   2.562589   2 #> 87  530.97708   2.748200   2 #> 88  502.47347   2.758321   2 #> 89  500.43141   3.871413   2 #> 90  521.70819   2.588693   2 #> 91  650.34381   2.858552   2 #> 92  590.96345   3.222565   2 #> 93  936.90204   2.593516   2 #> 94  554.85766   2.886831   2 #> 95  515.20258   2.669808   2 #> 96  543.87264   2.708865   2 #> 97  574.84846   2.541618   2 #> 98  522.75500   2.566323   2 #> 99  527.28991   3.452358   2 #> 100 565.86883   2.830109   2 #> 101 516.50202   2.960980   2 #> 102 504.51404   2.547705   2 #> 103 502.94906   3.279727   2 #> 104 501.69027   3.982797   2 #> 105 520.24019   2.804870   2 #> 106 654.75618   3.709922   2 #> 107 520.93938   3.393920   2 #> 108 502.48889   2.530098   2 #> 109 501.19179   3.611514   2 #> 110 500.78693   2.518868   2 #> 111 559.99207   2.628681   2 #> 112 500.98144   4.255161   2 #> 113 567.49325   2.743721   2 #> 114 500.98114   2.771017   2 #> 115 540.85409   2.648943   2 #> 116 500.80991   2.747964   2 #> 117 599.20326   2.807060   2 #> 118 502.82456   2.882099   2 #> 119 502.40483   2.509391   2 #> 120 539.37824   2.659004   2 #> 121 518.98651   2.663750   2 #> 122 522.63224   2.800214   2 #> 123 575.44125   2.742168   2 #> 124 507.21786   2.522707   2 #> 125 520.97635   2.743239   2 #> 126 501.89306   2.729936   2 #> 127 502.80405   2.774411   2 #> 128 506.65067   3.844090   2 #> 129 506.90999   2.547873   2 #> 130 507.24495   2.953911   2 #> 131 528.06942   2.872216   2 #> 132 888.47117   3.721010   2 #> 133 595.39691   2.675091   2 #> 134 516.80244   2.516511   2 #> 135 538.54726   3.983376   2 #> 136 503.09435   3.029931   2 #> 137 616.49986   2.552795   2 #> 138 500.84136   3.219670   2 #> 139 513.70635   2.772654   2 #> 140 543.57149   2.506973   2 #> 141 756.39548   3.349786   2 #> 142 526.98580   2.976416   2 #> 143 501.21540   2.690354   2 #> 144 500.84326   3.391928   2 #> 145 640.49703   2.596467   2 #> 146 500.28195   2.541001   2 #> 147 502.45021   3.259040   2 #> 148 501.17616   3.376767   2 #> 149 689.19561   3.088521   2 #> 150 555.56920   3.082079   2 #> 151 556.75418   2.567894   2 #> 152 502.47912   3.171637   2 #> 153 500.01940   2.707107   2 #> 154 576.50710   2.883614   2 #> 155 500.02388   3.695411   2 #> 156 622.64063   2.823172   2 #> 157 622.03864   3.323482   2 #> 158 845.56804   2.546428   2 #> 159 562.98226   2.563099   2 #> 160 528.92541   2.671921   2 #> 161 868.93917   2.919900   2 #> 162 517.20891   4.014585   2 #> 163 500.66733   3.174242   2 #> 164 641.06983   3.083261   2 #> 165 664.95488   3.095131   2 #> 166 570.30101   3.772930   2 #> 167 577.96443   2.657618   2 #> 168 500.53499   2.663431   2 #> 169 530.80708   2.659545   2 #> 170 507.09867   2.553448   2 #> 171 508.42110   2.686222   2 #> 172 679.73078   2.567364   2 #> 173 517.38593   2.699975   2 #> 174 501.87276   2.507379   2 #> 175 500.97724   2.734779   2 #> 176 500.67688   3.095292   2 #> 177 511.69853   2.633139   2 #> 178 534.57231   3.377059   2 #> 179 534.97836   2.546615   2 #> 180 509.23844   3.166050   2 #> 181 520.38437   3.078783   2 #> 182 874.28862   3.122734   2 #> 183 994.03987   2.918888   2 #> 184 655.96365   2.721096   2 #> 185 506.58829   2.796051   2 #> 186 626.21666   2.750570   2 #> 187 511.53987   2.891761   2 #> 188 514.68101   2.743149   2 #> 189 808.66471   3.288988   2 #> 190 500.29523   2.854621   2 #> 191 655.60934   2.618542   2 #> 192 503.02951   3.541289   2 #> 193 590.12460   3.238460   2 #> 194 947.58752   3.450419   2 #> 195 780.04035   2.789544   2 #> 196 710.43537   2.559181   2 #> 197 711.37076   3.299739   2 #> 198 709.18904   2.666874   2 #> 199 504.09885   3.017198   2 #> 200 516.19739   3.218923   2 #> 201 523.31210   2.577898   2 #> 202 502.40468   2.656109   2 #> 203 594.31882   3.061291   2 #> 204 534.03530   2.998393   2 #> 205 505.51319   2.764463   2 #> 206 728.76414   2.616301   2 #> 207 719.39250   2.738575   2 #> 208 861.27914   2.741073   2 #> 209 547.00296   3.222073   2 #> 210 506.45377   3.388939   2 #> 211 500.37589   3.332076   2 #> 212 517.34067   2.778753   2 #> 213 551.04766   2.988198   2 #> 214 620.54156   2.532184   2 #> 215 582.47754   2.549485   2 #> 216 504.25775   3.268817   2 #> 217 500.44199   3.202133   2 #> 218 504.84397   2.555526   2 #> 219 523.30696   3.162697   2 #> 220 504.55790   3.814843   2 #> 221 503.85165   2.534699   2 #> 222 518.47381   2.504866   2 #> 223 514.81801   2.998103   2 #> 224 501.14632   2.579069   2 #> 225 503.56673   2.910987   2 #> 226 500.76900   2.563462   2 #> 227 500.31699   3.408437   2 #> 228 500.37052   3.263009   2 #> 229 832.30312   3.126680   2 #> 230 826.96918   2.915731   2 #> 231 803.53248   2.656076   2 #> 232 994.50809   2.501669   2 #> 233 816.00526   2.692848   2 #> 234 826.63097   2.595052   2 #> 235 804.55113   4.256630   2 #> 236 803.49729   2.993162   2 #> 237 804.14977   3.120222   2 #> 238 831.80705   2.689741   2 #> 239 515.32713   2.582960   2 #> 240 698.08539   2.921607   2 #> 241 969.53243   2.548393   2 #> 242 513.70250   2.677148   2 #> 243 500.52443   2.753903   2 #> 244 500.67554   2.944665   2 #> 245 768.31919   2.733499   2 #> 246 501.56284   2.888976   2 #> 247 510.44848   2.743765   2 #> 248 502.04098   2.690187   2 #> 249 725.31932   2.570116   2 #> 250 523.38018   3.156930   2 #> 251 502.07467   2.814067   2 #> 252 599.83685   3.065569   2 #> 253 503.77312   3.341465   2 #> 254 977.65468   3.796545   2 #> 255 500.65652   3.718975   2 #> 256 842.37430   2.861281   2 #> 257 846.83132   2.617760   2 #> 258 850.90023   3.121388   2 #> 259 842.66286   2.905038   2 #> 260 903.49900   2.506491   2 #> 261 842.42846   2.606673   2 #> 262 872.59238   3.767808   2 #> 263 843.46654   2.551759   2 #> 264 876.17791   3.381945   2 #> 265 842.21371   2.896672   2 #> 266 912.20936   3.166675   2 #> 267 867.02712   2.631656   2 #> 268 955.04717   3.388334   2 #> 269 501.84371   3.049753   2 #> 270 584.58878   3.688725   2 #> 271 575.79862   2.562015   2 #> 272 530.41691   2.609566   2 #> 273 533.30223   2.603091   2 #> 274 502.69162   2.804131   2 #> 275 505.92440   3.636895   2 #> 276 511.53922   3.494829   2 #> 277 511.27856   3.892643   2 #> 278 508.46391   2.937592   2 #> 279 558.68277   2.821723   2 #> 280 501.59114   2.854278   2 #> 281 546.44231   3.075822   2 #> 282 539.67323   3.170251   2 #> 283 602.70043   2.910885   2 #> 284 666.50059   3.272239   2 #> 285 565.44132   2.550663   2 #> 286 556.66889   3.925216   2 #> 287 515.21656   2.538951   2 #> 288 629.68630   2.579133   2 #> 289 592.37978   3.128657   2 #> 290 550.67164   2.652040   2 #> 291 513.25822   2.899758   2 #> 292 503.28316   2.620257   2 #> 293 556.46921   3.970619   2 #> 294 954.56142   3.011202   2 #> 295 503.01831   2.887739   2 #> 296 508.64171   2.630821   2 #> 297 724.90046   3.258940   2 #> 298 505.25421   3.101566   2 #> 299 574.41171   3.388384   2 #> 300 505.07434   2.511100   2 #> 301 510.22523   2.641022   2 #> 302 513.70455   2.775669   2 #> 303 705.40380   2.892270   2 #> 304 558.03844   3.029896   2 #> 305 783.18698   2.834317   2 #> 306 503.65741   2.762953   2 #> 307 764.86436   2.679751   2 #> 308 533.45913   3.253560   2 #> 309 598.49499   2.636896   2 #> 310 715.80664   2.867121   2 #> 311 527.59836   3.137205   2 #> 312 507.26048   2.603481   2 #> 313 509.43227   3.543301   2 #> 314 611.45048   3.026819   2 #> 315 505.30745   3.475920   2 #> 316 501.24149   3.373839   2 #> 317 501.68745   2.537080   2 #> 318 519.76451   2.718856   2 #> 319 510.50218   2.528456   2 #> 320 501.86721   3.616473   2 #> 321 511.83622   3.016211   2 #> 322 500.81585   2.559012   2 #> 323 500.33203   4.080660   2 #> 324 500.40850   2.573100   2 #> 325 502.29331   2.804790   2 #> 326 511.79099   3.330943   2 #> 327 504.88330   2.593518   2 #> 328 826.30538   3.303370   2 #> 329 502.21319   2.544018   2 #> 330 534.76698   2.582420   2 #> 331 506.05365   2.601566   2 #> 332 502.88870   2.688033   2 #> 333 500.34110   2.931559   2 #> 334 500.67950   2.520350   2 #> 335 739.29543   3.007397   2 #> 336 517.67414   3.219553   2 #> 337 621.32908   3.617927   2 #> 338 612.24482   3.422158   2 #> 339 500.58394   3.700688   2 #> 340 571.07470   2.896370   2 #> 341 503.33470   3.928918   2 #> 342 663.95357   2.793366   2 #> 343 506.93641   2.509744   2 #> 344 500.33928   2.883123   2 #> 345 685.52693   2.919729   2 #> 346 503.36023   2.867765   2 #> 347 585.83730   2.657048   2 #> 348 501.33008   3.415898   2 #> 349 504.30431   2.545985   2 #> 350 529.19103   2.586279   2 #> 351 502.22729   2.538742   2 #> 352 850.78460   3.511214   2 #> 353 564.54521   2.899533   2 #> 354 527.65744   3.025318   2 #> 355 500.50417   3.473526   2 #> 356 551.88648   2.685207   2 #> 357 544.41127   2.996660   2 #> 358 523.85271   3.063064   2 #> 359 525.81329   2.555283   2 #> 360 592.64513   3.285018   2 #> 361 547.32969   2.614713   2 #> 362 518.20082   3.226858   2 #> 363 500.15679   3.057865   2 #> 364 500.84210   2.576906   2 #> 365 508.00239   2.794486   2 #> 366 549.37613   2.843211   2 #> 367 854.55544   2.617547   2 #> 368 285.46739   2.680581   2 #> 369  57.38102   3.514750   2 #> 370  44.54273   3.300573   2 #> 371 245.92453   2.512144   2 #> 372 670.88702   2.741873   2 #> 373 991.13811   3.020332   2 #> 374 537.56574   2.723180   2 #> 375 811.29639   2.546279   2 #> 376 785.84181   3.186246   2 #> 377 189.29825   3.119439   2 #> 378 170.07120   3.197306   2 #> 379 129.71861   3.015726   2 #> 380 904.08104   2.583272   2 #> 381 904.32746   2.523532   2 #> 382 914.27304   2.511537   2 #> 383 908.61533   2.616169   2 #> 384 907.19762   2.652375   2 #> 385 904.33966   2.629709   2 #> 386 957.22371   2.529531   2 #> 387 904.09191   3.583573   2 #> 388 953.91872   2.670070   2 #> 389 904.04336   3.287003   2 #> 390 904.06704   2.522052   2 #> 391 270.41212   2.540403   2 #> 392 491.23617   2.734941   2 #> 393 614.05744   3.227673   2 #> 394  88.03560   3.517351   2 #> 395 401.39006   3.084172   2 #> 396 308.35931   3.143774   2 #> 397 153.37336   2.594353   2 #> 398 150.98175   2.909925   2 #> 399 154.67273   2.817701   2 #> 400 149.84599   2.513103   2 #> 401 153.69134   2.943000   2 #> 402 722.22512   2.875049   2 #> 403 149.76825   3.204407   2 #> 404 541.36619   2.905829   2 #> 405 151.30848   2.858820   2 #> 406 150.53769   2.934961   2 #> 407 518.52373   2.502936   2 #> 408 201.07068   3.399186   2 #> 409  69.69929   2.545366   2 #> 410 200.04564   3.105740   2 #> 411 459.38772   2.653915   2 #> 412 634.15543   2.608447   2 #> 413 271.33081   3.704120   2 #> 414 560.69647   3.257095   2 #> 415 317.43256   3.005861   2 #>  #> [[4]] #>           ts magnitudes gen #> 1   548.2538   2.746738   3 #> 2   542.2489   2.646927   3 #> 3   504.0443   2.946141   3 #> 4   507.4657   2.990861   3 #> 5   610.6736   2.990038   3 #> 6   504.7905   2.845647   3 #> 7   503.4668   2.771704   3 #> 8   503.6854   2.908843   3 #> 9   503.3707   2.555564   3 #> 10  861.4515   2.608027   3 #> 11  503.5809   2.701320   3 #> 12  530.6984   2.826830   3 #> 13  557.7851   3.333682   3 #> 14  549.3283   4.387408   3 #> 15  503.8562   2.630783   3 #> 16  503.6912   2.716265   3 #> 17  513.5469   3.015877   3 #> 18  503.9782   2.929296   3 #> 19  503.7701   2.833320   3 #> 20  503.2995   2.742106   3 #> 21  503.2628   2.542061   3 #> 22  503.4125   2.618782   3 #> 23  639.3413   2.898095   3 #> 24  518.9199   2.804628   3 #> 25  504.2735   2.652718   3 #> 26  503.2822   2.673156   3 #> 27  614.8176   3.018715   3 #> 28  536.7223   3.470106   3 #> 29  679.5234   2.627077   3 #> 30  541.6920   2.542145   3 #> 31  541.7306   2.822837   3 #> 32  704.9688   2.564753   3 #> 33  597.6975   3.357166   3 #> 34  579.7625   2.588803   3 #> 35  581.2915   2.647229   3 #> 36  505.0958   2.815100   3 #> 37  501.0342   2.892991   3 #> 38  501.4366   3.881412   3 #> 39  502.7255   2.562526   3 #> 40  547.5348   2.677554   3 #> 41  657.0335   2.790582   3 #> 42  513.7192   3.204780   3 #> 43  505.7386   2.780671   3 #> 44  509.8309   2.831671   3 #> 45  508.4908   2.722084   3 #> 46  516.4000   3.395169   3 #> 47  889.8965   2.676102   3 #> 48  644.9926   2.995371   3 #> 49  508.1535   2.702942   3 #> 50  502.4881   2.515659   3 #> 51  500.9438   3.166373   3 #> 52  543.1985   2.757060   3 #> 53  571.1566   2.687905   3 #> 54  702.2958   3.829138   3 #> 55  507.1411   2.646513   3 #> 56  622.1104   2.775200   3 #> 57  807.9328   3.566672   3 #> 58  577.7617   2.900259   3 #> 59  518.1418   2.996685   3 #> 60  517.3015   2.744850   3 #> 61  570.3786   2.680282   3 #> 62  668.9945   2.946057   3 #> 63  500.7507   3.338458   3 #> 64  506.8793   2.606198   3 #> 65  502.0385   2.992663   3 #> 66  505.0912   2.639991   3 #> 67  594.3677   3.551448   3 #> 68  551.9969   2.548077   3 #> 69  700.8144   2.505712   3 #> 70  505.5506   2.800233   3 #> 71  595.2698   2.792164   3 #> 72  504.6103   3.086927   3 #> 73  547.8076   2.893087   3 #> 74  502.5029   2.591794   3 #> 75  500.4748   2.703831   3 #> 76  805.6906   2.878786   3 #> 77  914.7573   3.370781   3 #> 78  820.3411   3.419311   3 #> 79  503.8428   2.872852   3 #> 80  991.6977   2.713675   3 #> 81  500.6647   2.988716   3 #> 82  502.7166   3.134967   3 #> 83  844.0461   3.042077   3 #> 84  843.5795   2.931768   3 #> 85  876.5168   2.687488   3 #> 86  876.1874   2.589411   3 #> 87  912.5045   3.266449   3 #> 88  588.2233   3.037093   3 #> 89  587.2606   2.870560   3 #> 90  506.2652   2.580802   3 #> 91  508.4776   2.963547   3 #> 92  511.5834   2.691441   3 #> 93  512.3668   2.770766   3 #> 94  727.4366   2.656629   3 #> 95  734.7647   2.630523   3 #> 96  862.7949   3.255771   3 #> 97  505.5066   2.938446   3 #> 98  502.8039   2.641592   3 #> 99  504.5749   2.774182   3 #> 100 514.8040   2.637965   3 #> 101 511.9239   3.335906   3 #> 102 612.2834   2.748211   3 #> 103 643.0968   2.589567   3 #> 104 505.0038   3.161405   3 #> 105 503.0663   2.844850   3 #> 106 751.5365   2.832160   3 #> 107 511.4734   2.726992   3 #> 108 515.6038   2.737806   3 #> 109 506.9811   3.064065   3 #> 110 689.7527   3.080215   3 #> 111 515.5756   2.969913   3 #> 112 544.4368   2.565867   3 #> 113 521.0173   2.852511   3 #> 114 562.3166   2.875007   3 #> 115 510.9025   3.668173   3 #> 116 130.9680   3.079238   3 #> 117 924.1932   2.775005   3 #> 118 904.5739   3.459347   3 #> 119 904.0596   2.690443   3 #> 120 280.3471   2.938607   3 #> 121 409.5687   3.116320   3 #> 122 309.9614   4.320381   3 #> 123 229.6414   3.274043   3 #> 124 201.0357   2.607913   3 #>  #> [[5]] #>          ts magnitudes gen #> 1  579.5472   4.253780   4 #> 2  640.4232   3.387706   4 #> 3  549.3738   3.087745   4 #> 4  504.3749   2.510561   4 #> 5  707.9071   3.906309   4 #> 6  623.2461   2.659888   4 #> 7  693.3903   3.069983   4 #> 8  513.9455   2.517058   4 #> 9  507.0472   2.914710   4 #> 10 500.9755   2.773773   4 #> 11 505.1411   2.554561   4 #> 12 915.2760   2.670775   4 #> 13 508.6165   2.573069   4 #> 14 881.1160   2.925260   4 #> 15 506.3356   3.247503   4 #> 16 514.4113   2.513868   4 #> 17 870.3399   2.550498   4 #> 18 551.0738   2.744363   4 #> 19 690.0804   2.634765   4 #> 20 552.3826   2.775842   4 #> 21 946.7950   2.605877   4 #> 22 950.5999   2.551569   4 #> 23 280.4496   3.561409   4 #> 24 310.0627   3.055394   4 #> 25 595.4751   2.663044   4 #> 26 716.2846   2.907201   4 #> 27 310.7571   2.780224   4 #> 28 309.9619   2.621307   4 #>  #> [[6]] #>          ts magnitudes gen #> 1  641.5571   3.554161   5 #> 2  657.7771   2.783232   5 #> 3  579.7003   2.601304   5 #> 4  580.4470   2.667496   5 #> 5  579.7636   2.879617   5 #> 6  504.5015   2.958661   5 #> 7  717.1648   3.229598   5 #> 8  709.0910   3.250411   5 #> 9  552.4183   3.372735   5 #> 10 551.1343   3.013086   5 #> 11 554.3665   3.053926   5 #>  #> [[7]] #>         ts magnitudes gen #> 1 709.9092   2.700949   6 #>  #> [[8]] #>         ts magnitudes gen #> 1 725.4028   2.874257   7 #>"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the posterior distribution of the expected number of events — get_posterior_N","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"Plot posterior distribution expected number events","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"","code":"get_posterior_N(input.list, domain.extension = 0.1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"input.list combined input file (link functions) bru output (marginals) domain.extension Percentage posterior quantiles extend domain specified scalar. Default set 0.10.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"list three objects: post.df: data.frame containing posterior informations posterior distribution number events post.plot : ggplot object showing posterior distribution expected number events post.plot.shaded : ggplot object showing posterior distribution expected number events, shaded region corresponds 0.025 0.975 quantiles distribution distribution number events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"Retrieve posterior distribution ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"","code":"get_posterior_param(input.list)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"input.list input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"list two elements: post.df : data.frame posterior distributions parameters columns x (value parameter), y (value posterior), param (parameter name) post.plot : ggplot object showing posterior distribution parameter","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS triggering function - used by inlabru — gt","title":"ETAS triggering function - used by inlabru — gt","text":"function returns value ETAS triggering function specified time t points history th, mh","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ETAS triggering function - used by inlabru — gt","text":"","code":"gt(theta, t, th, mh, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ETAS triggering function - used by inlabru — gt","text":"theta ETAS parameters list names K, alpha, c, p t Time function calculated, scalar vector th Time events history [days, months,...], scalar vector mh Magnitude events history, scalar vector M0 Minimum magnitude threshold, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ETAS triggering function - used by inlabru — gt","text":"value ETAS triggering function evaluated t history th, mh.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ETAS triggering function - used by inlabru — gt","text":"ETAS triggering function evaluated $$g(t - t_h | m_h) = K e^{\\alpha(m_h - M_0)} \\left( \\frac{t - t_h}{c} + 1\\right)^{-p}$$ \\(K, \\alpha, c > 0\\), \\(p \\geq 1\\) ETAS parameters, \\(t\\) (t) time function evaluated, considering past observation \\(t_h, m_h\\) (th, mh). function returns 0 \\(t_h > t\\). \\(t\\) scalar \\(t_h, m_h\\) vectors function returns vector, \\(t\\) vector \\(t_h, m_h\\) scalars, \\(t, t_h, m_h\\) vectors length. use \\(t\\) \\(t_h, m_h\\) vectors different lengths.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":null,"dir":"Reference","previous_headings":"","what":"HORUS Ita Catalogue — horus","title":"HORUS Ita Catalogue — horus","text":"HOmogenized instRUmental Seismic catalog (HORUS) Italy 1960 present, limited limited 1960-2019.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"HORUS Ita Catalogue — horus","text":"","code":"horus"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"HORUS Ita Catalogue — horus","text":"Original file format: Year: Origin Time (OT) year Mo: OT month Da: OT day Ho: OT hour Mi OT minute Se OT seconds fractions Lat epicenter N latitude (degrees) Lon epicenter E longitude (degrees) Depth hypocenter depth (km) Mw true proxy moment magnitude sigMw moment magnitude uncertainty Geo.Ita \"*\" indicates epicenter within Italian mainland territory, otherwise \" \" Geo.CPTI15 \"*\" indicates epicenter within spatial window CPTI15 catalog (Rovida et al., 2020, Bull Earth Eng, doi: 10.1007/s10518-020-00818-y) Ev..type \"x\" indicates event earthquake (e.g. explosion, eruption, landslide, ...) (since May 1st 2012) Iside.n. ISIDe id number (since April 16th 2005) ETAS.inlabru format: time_string: Data-time event, ISO 8601 format; format = \"%Y-%m-%dT%H:%M:%OS\" use .POSIXct() lon: Original Lon lat: Original Lat depth Original Depth M: Original Mw","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"HORUS Ita Catalogue — horus","text":"http://horus.bo.ingv./","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"HORUS Ita Catalogue — horus","text":"original entire HORUS catalog provided single tab separated ascii file: HORUS_Ita_Catalog.txt random second decimal digit added ML Md INGV bulletin (ISIDe) computing Mw proxies (Lolli et al., Seism. Res. Lett., 91, 3208-3222, doi: 10.1785/0220200148), HORUS_Ita_Catalog_o.txt original ML Md used compute Mw proxies. ETAS.inlabru includes reformatted version data HORUS_Ita_Catalog.txt data.frame, limited 1960-2019. data provided , express implied warranty given.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"HORUS Ita Catalogue — horus","text":"Barbara Lolli(1), Daniele Randazzo(1), Gianfranco Vannucci(1) Paolo Gasperini (2),(1) (2020). Homogenized Instrumental Seismic Catalog (HORUS) Italy 1960 Present, Seismol. Res. Lett, doi: 10.1785/0220200148. (1) Istituto Nazionale di Geofisica e Vulcanologia, Sezione di Bologna (2) Dipartimento di Fisica e Astronomia, Università di Bologna","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"Copula transformation Exponential standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"","code":"inv_exp_t(x, rate)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"x values Exponential distribution, vector. rate rate Exponential distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"Copula transformation Gamma standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"","code":"inv_gamma_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"x values Gamma distribution, vector. shape parameter Gamma distribution, scalar. b rate parameter Gamma distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"Copula transformation Log-Normal standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"","code":"inv_loggaus_t(x, m, s)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"x values Log-Normal distribution, vector. m mean logarithm Log-Normal distribution, scalar. s standard deviation logarithm Log-Normal distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"Copula transformation Uniform standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"","code":"inv_unif_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"x values Uniform distribution, vector. minimum Uniform distribution, scalar. b maximum Uniform distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the integral of the ETAS conditional intensity — lambda_N","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"Calculate number events time interval T1 T2 given imposed events ETAS","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"","code":"lambda_N(th.mu, th.K, th.alpha, th.c, th.p, T1, T2, M0, Ht, link.functions)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"th.mu Background rate, mu, internal parameter scale th.K ETAS triggering parameter K internal parameter scale th.alpha ETAS triggering parameter alpha internal parameter scale th.c ETAS triggering parameter c internal parameter scale th.p ETAS triggering parameter p internal parameter scale T1 Start temporal model domain. T2 End temporal model domain. M0 Minimum magnitude threshold Ht History process, set known events interval. must data.frame columns ts (time) magnitudes (magnitudes). link.functions list functions transform parameters internal scale ETAS scale","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"Integral ETAS conditional intensity T1 T2 minimum magnitude M0, .e. expected number events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":null,"dir":"Reference","previous_headings":"","what":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"Logarithm integral ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"","code":"log_Lambda_h(theta, th, mh, M0, T1, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"theta ETAS parameters data.frame(mu=mu, K=K, alpha=alpha, c=c, p=p). th Time parent event. mh Magnitude parent event M0 Minimum magnitude threshold T1 Start temporal model domain. T2 End temporal model domain.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"Logarithm integral ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"Copula transformation standard Normal distribution Log-Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"","code":"loggaus_t(x, m, s)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"x values standard Normal distribution, vector. m mean logarithm Log-Normal distribution, scalar. s standard deviation logarithm Log-Normal distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"Values Log-Normal distribution logarithmic mean m standard deviation s, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to calculate Omori's law — omori","title":"Function to calculate Omori's law — omori","text":"Function calculate Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to calculate Omori's law — omori","text":"","code":"omori(theta, t, ti)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to calculate Omori's law — omori","text":"theta ETAS parameters (list(mu = mu, K = K, alpha = alpha, c = c, p = p), parameters c p used t Time Omori's law evaluated ti Time event history","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to calculate Omori's law — omori","text":"Value Omori's law point t event happened ti","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"Function plot Omori's law corresponding different posterior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"","code":"omori_plot_posterior(   input.list,   post.samp = NULL,   n.samp = 10,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale post.samp data.frame containing posterior samples parameters. NULL, n.samp samples generated. n.samp different nrow(post.samp) n.samp rows uniformly sampled post.samp. Default NULL. n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"ggplot object","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"Function plot Omori's law corresponding different prior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"","code":"omori_plot_prior(input.list, n.samp = 10, t.end = 1, n.breaks = 100)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"input.list structured input list least one element: link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"ggplot object","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"Plot posterior densities ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"","code":"post_pairs_plot(   input.list = NULL,   n.samp = NULL,   post.samp = NULL,   max.batch = 1000 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp number samples draw posteriors plot post.samp data.frame columns mu, K, alpha, c, p rows corresponding different posterior samples. NULL function samples joint posterior distribution n.samp times. default NULL. max.batch parameter post_sampling function used case post.samp = NULL","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"list: elements post.samp.df:data.frame posterior samples nrow = n.samp columns mu, K, alpha, c, p corresponding ETAS parameters. post.samp NULL returns post.samp pair.plot: ggplot object reporting pair plot parameters samples. obtained using ggpairs function Ggally library","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from the posterior of the ETAS parameters — post_sampling","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"Sample posterior ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"","code":"post_sampling(input.list, n.samp, max.batch = 1000, ncore = 1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp number samples draw posteriors max.batch Maximum number posterior samples generated simultaneously. Default 1000. ncore Number cores used n.samp exceeds max.batch. Default 1","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"data.frame posterior samples nrow = n.samp columns mu, K, alpha, c, p corresponding ETAS parameters.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":null,"dir":"Reference","previous_headings":"","what":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"Return sample magnitudes drawn GR distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"","code":"sample_GR_magnitudes(n, beta.p, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"n Number events sample. beta.p Related b-value via b ln(10). M0 Minimum magnitude sample.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"list magnitudes length n drawn GR distribution.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"","code":"sample_GR_magnitudes(n = 100, beta.p = log(10), M0 = 2.5) #>   [1] 3.264722 3.865149 3.718498 2.872702 2.707736 2.778885 3.005309 3.216066 #>   [9] 4.040281 2.537539 2.502875 3.074191 3.252254 3.538096 2.565686 2.899193 #>  [17] 3.455107 2.503725 2.627809 2.760555 2.975859 3.016969 2.773348 2.818284 #>  [25] 2.544535 3.120450 3.002644 2.704333 2.715076 3.026517 2.699705 3.538156 #>  [33] 3.086593 2.785647 2.739209 2.613822 3.637869 3.324269 2.940304 3.100748 #>  [41] 2.512692 2.567885 2.887344 2.638703 2.585668 4.035616 2.622009 3.125344 #>  [49] 2.663892 3.596801 2.841082 2.772537 2.558073 4.552025 3.340889 2.659250 #>  [57] 3.575852 3.193017 3.273774 3.027792 2.519397 2.696719 3.917600 2.860226 #>  [65] 2.664285 2.602687 2.638658 2.571934 3.158837 2.653939 2.509991 2.669413 #>  [73] 3.306514 2.533057 3.044911 3.039825 3.737968 3.689199 3.754584 2.980111 #>  [81] 2.648180 2.524590 2.639015 2.760987 2.843679 2.553669 2.706788 2.844941 #>  [89] 2.803958 2.764743 2.513176 2.540724 3.299376 2.644882 2.537550 2.892392 #>  [97] 2.833985 2.643590 2.872110 2.503428"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"Generate sample new events data.frame(t_i, M_i) length n.ev one parent event occuring time t_h using ETAS model.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"","code":"sample_temporal_ETAS_daughters(theta, beta.p, th, n.ev, M0, T1, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). th Time parent event [days]. n.ev number events placed. M0 Minimum magnitude synthetic catalogue. T1 Start time synthetic catalogue [days]. T2 End time synthetic catalogue [days].","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"Generate sample new events data.frame(t_i, M_i) one parent","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":null,"dir":"Reference","previous_headings":"","what":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"Take previous parent events Ht=data.frame[ts, magnitudes] generates daughters events using ETAS model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"","code":"sample_temporal_ETAS_generation(theta, beta.p, Ht, M0, T1, T2, ncore = 1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). Ht set parent events form data.frame[ts, magnitudes] M0 minimum earthquake magnitude synthetic catalogue. T1 start time synthetic catalogue [days]. T2 end time synthetic catalogue [days]. ncore number compute cores use","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"Return one generation daughters parents Ht form data.frame(t_i, M_i).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"","code":"# The parents are specified in Ht Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) sample_temporal_ETAS_generation(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000,   Ht = Ht ) #>           ts magnitudes #> 1   501.0954   2.941901 #> 2   501.1629   2.614360 #> 3   586.3468   3.357990 #> 4   731.9907   2.592459 #> 5   500.2459   2.709705 #> 6   500.3233   2.578515 #> 7   597.5976   2.827089 #> 8   504.0862   3.680147 #> 9   500.0255   3.579831 #> 10  766.2502   3.811617 #> 11  500.6597   3.479139 #> 12  686.7865   2.954357 #> 13  578.3320   3.066362 #> 14  665.4296   3.617791 #> 15  501.1363   3.217106 #> 16  500.0007   2.740150 #> 17  500.8555   3.994678 #> 18  504.3663   2.613502 #> 19  501.2237   2.569787 #> 20  516.7319   2.552179 #> 21  500.0274   2.545674 #> 22  500.2714   2.693630 #> 23  500.8171   3.379972 #> 24  501.5015   3.053680 #> 25  500.0306   2.934548 #> 26  500.1699   2.779512 #> 27  500.0603   3.070877 #> 28  500.7348   3.202838 #> 29  513.1486   3.153452 #> 30  764.8820   2.662377 #> 31  500.1707   3.071768 #> 32  500.3514   2.987578 #> 33  529.1003   2.644129 #> 34  503.3749   2.834321 #> 35  555.2911   2.562503 #> 36  729.2388   2.574093 #> 37  507.8431   3.685577 #> 38  583.6614   3.507044 #> 39  500.6882   2.799994 #> 40  500.6512   2.887942 #> 41  507.0914   2.789375 #> 42  502.4269   3.378712 #> 43  507.3348   3.053109 #> 44  629.3944   2.650055 #> 45  908.7782   2.873917 #> 46  827.7431   3.501905 #> 47  501.2617   2.988453 #> 48  500.0785   2.631255 #> 49  500.7196   2.582641 #> 50  557.0930   3.847658 #> 51  800.5995   2.542381 #> 52  607.3575   2.724969 #> 53  501.9549   2.757154 #> 54  500.0239   2.964165 #> 55  500.0220   3.313802 #> 56  511.0436   2.759052 #> 57  500.1144   2.847103 #> 58  504.7562   3.460901 #> 59  571.3574   3.309173 #> 60  613.6362   3.331485 #> 61  501.0853   2.732569 #> 62  527.1402   2.512932 #> 63  500.1881   2.521137 #> 64  702.3910   3.030201 #> 65  500.4570   2.840431 #> 66  500.0763   3.055707 #> 67  503.0746   2.505344 #> 68  500.5601   3.807337 #> 69  503.1415   2.517526 #> 70  609.1734   2.672206 #> 71  787.6886   3.075619 #> 72  666.4314   2.830697 #> 73  502.3555   3.133057 #> 74  500.1486   2.852889 #> 75  500.7381   2.656683 #> 76  510.7565   3.045208 #> 77  667.8713   2.757880 #> 78  501.9725   2.833124 #> 79  732.0183   2.628216 #> 80  500.0673   3.263876 #> 81  618.4624   3.059756 #> 82  576.8336   2.511065 #> 83  552.3976   2.923387 #> 84  500.5791   4.168357 #> 85  501.5073   2.614673 #> 86  654.9968   2.946756 #> 87  505.5542   2.651409 #> 88  500.0092   2.707409 #> 89  500.0101   4.819962 #> 90  666.6188   4.203277 #> 91  626.0766   3.125559 #> 92  500.0173   2.776142 #> 93  504.1112   2.513504 #> 94  508.0119   3.047745 #> 95  501.7624   3.038846 #> 96  770.7865   3.010153 #> 97  501.0802   3.362438 #> 98  511.9121   3.121018 #> 99  501.5370   2.628272 #> 100 534.0340   3.278565 #> 101 501.1853   3.365337 #> 102 500.3198   2.531117 #> 103 501.1167   3.349312 #> 104 500.0241   2.606029 #> 105 742.5181   2.575482 #> 106 500.3649   3.510819 #> 107 512.5539   2.783561 #> 108 504.6867   3.078425 #> 109 508.3178   2.875983 #> 110 515.8850   3.324522 #> 111 500.0065   2.845197 #> 112 511.8146   2.965453 #> 113 884.8877   2.784554 #> 114 501.0601   3.279381 #> 115 501.8721   2.677584 #> 116 501.3155   2.528315 #> 117 506.0628   2.762993 #> 118 524.0920   2.514062 #> 119 500.0666   2.736922 #> 120 579.0324   2.657761 #> 121 500.2942   3.088537 #> 122 506.0125   3.259276 #> 123 919.7575   2.598103 #> 124 535.5576   2.892208 #> 125 500.0054   2.638794 #> 126 500.2084   2.962750 #> 127 956.9092   2.717954 #> 128 500.6901   2.770730 #> 129 593.3203   2.913094 #> 130 591.2091   2.663614 #> 131 500.1904   2.529197 #> 132 500.0824   2.853125 #> 133 505.0380   3.477132 #> 134 500.0871   2.590439 #> 135 537.2983   2.639028 #> 136 500.3164   2.595864 #> 137 500.4433   2.809926 #> 138 500.1572   3.227413 #> 139 525.2135   3.034300 #> 140 500.7090   2.597257 #> 141 506.0874   3.141961 #> 142 517.5407   2.712551 #> 143 580.2842   3.398227 #> 144 646.7180   3.079003 #> 145 500.1914   2.569971 #> 146 502.6737   2.999189 #> 147 500.2361   2.585862 #> 148 547.2984   2.804005 #> 149 513.4107   2.631084 #> 150 703.1218   3.208773 #> 151 517.4755   2.565070 #> 152 500.4941   2.776600 #> 153 500.2537   2.550929 #> 154 509.0991   2.702158 #> 155 500.9364   3.142433 #> 156 500.2158   4.001340 #> 157 501.6671   3.059551 #> 158 500.0426   3.049618 #> 159 509.2569   3.242239 #> 160 627.1463   4.230069 #> 161 500.2014   3.464529 #> 162 507.5406   2.999180 #> 163 500.4380   2.526190 #> 164 542.5080   3.516066 #> 165 513.2669   2.524292 #> 166 502.7718   3.476633 #> 167 596.3679   4.252851 #> 168 500.2222   2.609597 #> 169 516.6370   3.681022 #> 170 500.5157   2.625958 #> 171 500.6491   2.614570 #> 172 501.5650   2.700306 #> 173 796.5359   2.746993 #> 174 525.9808   2.621729 #> 175 501.3076   3.032883 #> 176 534.2203   3.215686 #> 177 500.9374   2.746172 #> 178 511.2921   2.507918 #> 179 859.5890   3.083730 #> 180 503.3386   3.162582 #> 181 500.1067   2.772337 #> 182 501.0327   2.531323 #> 183 506.2683   3.408568 #> 184 528.2145   2.877928 #> 185 500.1133   2.613136 #> 186 507.8653   2.806889 #> 187 500.7730   2.523546 #> 188 576.1798   3.357192 #> 189 500.3734   2.957388 #> 190 500.1064   3.028132 #> 191 532.1911   2.933409 #> 192 603.5191   2.605676 #> 193 897.1840   2.762218 #> 194 672.5515   2.662019 #> 195 500.7785   3.189402 #> 196 500.0371   2.633889 #> 197 500.7215   2.527908 #> 198 516.8604   2.671241 #> 199 502.6854   2.689753 #> 200 514.0553   3.302490 #> 201 500.8101   2.699940 #> 202 518.9986   3.040322 #> 203 545.2687   3.042487 #> 204 502.9372   2.853864 #> 205 501.5612   2.869793 #> 206 542.2203   2.531240 #> 207 662.8927   2.824453 #> 208 502.5414   2.637963 #> 209 520.0825   2.909965 #> 210 504.4390   3.560809 #> 211 649.8252   2.643747 #> 212 501.3551   2.612466 #> 213 500.0164   4.531246 #> 214 500.3756   2.666188 #> 215 944.1780   3.935399 #> 216 512.0366   2.515889 #> 217 500.0566   4.038839 #> 218 500.0082   3.157966 #> 219 952.1664   2.724846 #> 220 532.2524   3.325457 #> 221 500.4207   3.214774 #> 222 500.0454   3.041540 #> 223 500.0031   2.573660 #> 224 525.2469   2.584922 #> 225 521.7098   2.865075 #> 226 501.8088   2.669202 #> 227 517.8436   2.853854 #> 228 538.1256   2.541029 #> 229 501.2201   2.991164 #> 230 511.5111   2.538195 #> 231 500.0681   2.509888 #> 232 579.7180   2.712708 #> 233 500.0216   2.569302 #> 234 637.6028   2.928028 #> 235 517.5123   2.674807 #> 236 503.0972   3.012784 #> 237 511.4942   2.673861 #> 238 503.8705   2.665351 #> 239 500.0848   2.598078 #> 240 501.0809   2.729788 #> 241 554.5119   2.749098 #> 242 504.2430   3.033730 #> 243 515.1410   3.184220 #> 244 500.0461   2.547481 #> 245 515.3119   2.943152 #> 246 792.1535   3.852647 #> 247 522.1538   2.603191 #> 248 508.9814   2.995118 #> 249 515.5663   2.807258 #> 250 500.7767   2.562418 #> 251 503.7202   2.798749 #> 252 514.4114   2.529591 #> 253 667.8904   2.625892 #> 254 501.9258   2.608134 #> 255 501.2361   3.565050 #> 256 889.8701   2.566889 #> 257 501.8143   3.263495 #> 258 695.2629   4.041538 #> 259 718.2229   3.220468 #> 260 500.2206   2.543240 #> 261 500.1189   2.941607 #> 262 500.2379   2.788247 #> 263 530.1543   3.477977 #> 264 500.3203   2.831308 #> 265 519.4571   2.875146 #> 266 539.8420   2.729656 #> 267 903.3809   3.046271 #> 268 520.2978   3.191011 #> 269 504.3344   2.728326 #> 270 500.7035   2.769398 #> 271 503.7795   2.771187 #> 272 523.0458   2.581543 #> 273 500.3157   2.743939 #> 274 505.3045   2.732327 #> 275 503.8047   5.159547 #> 276 500.0995   3.113329 #> 277 586.2284   2.538656 #> 278 503.9579   2.952081 #> 279 553.8300   2.807046 #> 280 533.8275   2.695129 #> 281 502.0668   2.537807 #> 282 558.8132   2.614440 #> 283 520.2742   2.653783 #> 284 500.8783   2.628602 #> 285 594.7855   2.780891 #> 286 503.6182   2.594265 #> 287 602.2671   3.352267 #> 288 522.6648   2.582153 #> 289 629.1419   2.721683 #> 290 514.0489   2.812014 #> 291 504.2235   2.789494 #> 292 500.1609   2.863325 #> 293 500.4482   3.272538 #> 294 515.1240   2.643037 #> 295 500.1569   3.221022 #> 296 500.1652   2.866171 #> 297 724.3414   2.719509 #> 298 520.1769   3.089991 #> 299 540.1218   2.974444 #> 300 513.4342   2.719351 #> 301 545.5434   2.595390 #> 302 640.5833   2.909549 #> 303 501.2953   2.835307 #> 304 501.0545   2.577909 #> 305 500.0044   2.762051 #> 306 505.7627   3.695646 #> 307 540.7042   3.053039 #> 308 500.1225   2.934540 #> 309 503.0277   2.731467 #> 310 770.6130   2.665298 #> 311 557.6175   2.750923 #> 312 502.9591   3.094532 #> 313 507.0389   2.565031 #> 314 849.7605   2.690532 #> 315 757.6636   2.686916 #> 316 531.7261   2.789643 #> 317 500.3289   2.858551 #> 318 501.0830   2.775747 #> 319 501.5360   2.740079 #> 320 536.3470   2.534954 #> 321 500.0261   3.199373 #> 322 505.4190   2.775289 #> 323 521.3093   2.727356 #> 324 501.6597   2.838325 #> 325 505.0539   3.662159 #> 326 500.0513   2.838538 #> 327 800.1410   3.194735 #> 328 505.2703   2.657653 #> 329 659.1378   2.523215 #> 330 500.7067   3.443677 #> 331 500.0869   2.664704 #> 332 500.6663   3.486188 #> 333 500.0443   3.610651 #> 334 511.1723   2.553528 #> 335 711.4017   2.693246 #> 336 500.0092   3.495748 #> 337 504.5115   4.462624 #> 338 503.7660   3.016121 #> 339 510.4998   2.868701 #> 340 500.7845   3.776591 #> 341 500.1008   3.407649 #> 342 518.9401   3.217085 #> 343 513.7825   3.616432 #> 344 834.4031   2.538911 #> 345 564.9741   2.755111 #> 346 519.6125   2.585319 #> 347 728.5443   2.598665 #> 348 504.3698   2.522467 #> 349 500.6780   2.754460 #> 350 500.0398   2.611846 #> 351 509.1446   3.073265 #> 352 542.2854   3.168767 #> 353 501.0885   2.606457 #> 354 500.2995   2.510524 #> 355 513.8747   3.598249 #> 356 500.2794   2.557926 #> 357 522.3773   2.571750 #> 358 515.3899   3.101113 #> 359 511.6104   2.630781 #> 360 677.3818   3.570069 #> 361 513.1829   3.182714 #> 362 500.2730   2.797199 #> 363 805.3173   2.900320 #> 364 503.1942   3.574304 #> 365 507.9723   2.982998 #> 366 500.1468   2.585679 #> 367 500.2366   3.456352 #> 368 500.0504   2.922894 #> 369 500.0050   2.655301 #> 370 530.1286   2.657189 #> 371 507.4736   2.739032 #> 372 501.7097   2.508921 #> 373 502.2515   2.530921 #> 374 503.8506   2.514428 #> 375 803.4583   2.625060 #> 376 500.1074   2.660073 #> 377 500.2171   3.724160 #> 378 559.7361   2.590985 #> 379 516.3705   3.085541 #> 380 500.3926   3.067732 #> 381 789.2086   2.875475 #> 382 500.2143   2.745139 #> 383 526.4758   2.533917 #> 384 562.7016   2.978874 #> 385 501.3634   2.683728 #> 386 500.0580   3.673898 #> 387 573.4907   2.761321 #> 388 501.0628   2.571134 #> 389 520.5142   2.699743 #> 390 500.1557   4.950154 #> 391 504.3846   2.990820 #> 392 511.3365   2.557603 #> 393 525.2206   2.502710 #> 394 500.1996   2.615498 #> 395 500.1252   2.926782 #> 396 500.0503   2.529881 #> 397 507.7010   2.776543 #> 398 500.2682   2.855281 #> 399 525.4402   2.643378 #> 400 500.0371   3.442795 #> 401 507.9107   2.817590 #> 402 503.2864   3.475708 #> 403 738.5539   2.611549 #> 404 500.2689   3.750354 #> 405 500.3136   2.979256 #> 406 501.7836   2.733680 #> 407 508.5662   2.615947 #> 408 549.9013   2.559195 #> 409 507.6215   3.178262 #> 410 523.0999   2.502921 #> 411 501.1486   2.567450 #> 412 500.2073   2.720818 #> 413 522.7821   2.888121 #> 414 517.6717   3.194987 #> 415 504.2629   2.632547 #> 416 507.3463   2.650769 #> 417 500.1453   3.010353 #> 418 508.8028   2.584661 #> 419 508.7744   2.547843 #> 420 500.6607   3.624080 #> 421 534.3917   3.249541 #> 422 502.5811   2.659529 #> 423 500.6272   2.630718 #> 424 500.1172   3.225822 #> 425 624.4193   3.269143 #> 426 523.9426   2.594592 #> 427 500.0666   2.515257 #> 428 511.6849   2.545796 #> 429 500.3239   2.873775 #> 430 521.6907   2.799598 #> 431 500.0829   3.167412 #> 432 500.4167   4.606777 #> 433 942.7340   2.989305 #> 434 511.5033   2.575394 #> 435 997.1620   2.742283 #> 436 501.9113   3.589390 #> 437 500.1092   2.506884 #> 438 747.8434   2.645291 #> 439 535.4784   2.805572 #> 440 502.4175   2.544362 #> 441 649.8958   2.552705 #> 442 500.7115   2.634988 #> 443 514.7062   2.964119 #> 444 537.6707   2.730359 #> 445 534.8017   2.755020 #> 446 507.4545   3.037698 #> 447 500.6518   2.707903 #> 448 691.4797   2.513267 #> 449 500.3248   2.532578 #> 450 513.1296   3.780885 #> 451 501.0239   2.604551 #> 452 500.7991   2.549325 #> 453 536.3176   2.771620 #> 454 500.5734   2.660475 #> 455 500.5659   2.553619 #> 456 500.4009   2.790385 #> 457 512.0928   3.293436 #> 458 524.0765   2.526576 #> 459 500.2917   4.090307 #> 460 541.0512   2.579180 #> 461 573.9340   2.854347 #> 462 503.4014   2.596746 #> 463 500.4145   2.626664 #> 464 571.8748   5.839715 #> 465 549.2496   2.834041 #> 466 501.9769   3.340230 #> 467 509.7486   2.597117 #> 468 833.8156   2.956672 #> 469 500.0397   2.595690 #> 470 512.0443   2.554102 #> 471 526.0289   3.012530 #> 472 500.0918   3.843830 #> 473 500.4233   3.007534 #> 474 500.2149   3.145833 #> 475 550.7304   2.956106 #> 476 501.0541   3.519006 #> 477 616.8321   3.177959 #> 478 544.8328   2.829937 #> 479 500.0436   2.644349 #> 480 500.0365   2.745260 #> 481 500.1770   2.665059 #> 482 500.0764   2.537975 #> 483 502.2662   2.787215 #> 484 542.9740   2.506917 #> 485 617.8950   2.570041 #> 486 502.8457   2.788613 #> 487 500.2214   4.272305 #> 488 783.5833   2.809722 #> 489 533.7703   2.517390 #> 490 500.1326   2.858453 #> 491 502.1738   4.342534 #> 492 501.6122   2.638107 #> 493 523.7658   2.780795 #> 494 615.7830   2.805618 #> 495 502.6628   2.502604 #> 496 501.2560   2.676699 #> 497 808.9870   3.770732 #> 498 536.4063   2.998220 #> 499 572.0181   2.629354 #> 500 511.7189   2.798715 #> 501 500.6548   3.267139 #> 502 505.4435   3.025789 #> 503 672.3944   3.588966 #> 504 500.0052   2.658428 #> 505 500.8065   4.643497 #> 506 584.9861   4.512815 #> 507 502.9580   3.332964 #> 508 520.8477   2.944810 #> 509 508.1732   3.962189 #> 510 502.3121   3.279369 #> 511 500.3430   3.252020 #> 512 500.0046   2.627457 #> 513 540.3914   3.246167 #> 514 505.3017   2.587439 #> 515 500.0348   2.754879 #> 516 500.3817   2.769086 #> 517 500.0239   2.629257 #> 518 519.8971   2.695921 #> 519 600.3287   2.581278 #> 520 522.2901   3.107496 #> 521 574.1238   2.755090 #> 522 500.0342   2.502402 #> 523 501.4536   3.213630 #> 524 524.5101   3.077998 #> 525 513.2292   2.636171 #> 526 503.5751   2.567867 #> 527 500.4464   2.649645 #> 528 625.0312   2.729288 #> 529 596.9554   2.631274 #> 530 500.0087   2.546641 #> 531 503.2421   2.697689 #> 532 500.2956   3.700783 #> 533 502.1144   2.797510 #> 534 535.7591   2.711278 #> 535 964.2516   2.592405 #> 536 500.5512   2.873206 #> 537 500.7139   4.290894 #> 538 500.4072   3.660929 #> 539 500.0413   3.190104 #> 540 504.1313   2.551723 #> 541 500.0340   2.633734 #> 542 509.9899   2.826922 #> 543 501.8470   2.864009 #> 544 501.1923   2.536660 #> 545 502.8116   2.642407 #> 546 500.5011   3.273755 #> 547 522.2306   4.257414 #> 548 503.0793   2.519158 #> 549 501.6351   2.948750 #> 550 523.8636   2.611462 #> 551 506.3628   2.972137 #> 552 500.6152   2.658932 #> 553 512.3376   2.839064 #> 554 534.9352   4.050388 #> 555 939.7420   3.704652 #> 556 502.1801   3.833577 #> 557 512.4477   2.578239 #> 558 529.2116   2.602962 #> 559 500.0851   2.793570 #> 560 500.3348   2.750942 #> 561 502.5847   2.639127 #> 562 500.5786   3.959411 #> 563 983.9231   2.538607 #> 564 560.8022   2.713709 #> 565 502.0050   2.642884 #> 566 505.5318   3.235572 #> 567 754.3740   2.551494 #> 568 970.0356   2.516952 #> 569 513.0690   3.614561 #> 570 500.0220   2.605696 #> 571 506.2684   2.740726 #> 572 503.9487   2.785230 #> 573 529.3069   3.120282 #> 574 531.4553   2.518714 #> 575 708.3756   2.597623 #> 576 501.6725   2.592817 #> 577 501.9243   2.537075 #> 578 510.9672   2.609368 #> 579 501.1158   2.695439 #> 580 500.0400   2.603022 #> 581 501.8679   2.548803 #> 582 500.7903   2.554544 #> 583 503.6582   3.107648 #> 584 500.0052   2.515219 #> 585 500.1912   3.170415 #> 586 818.0661   2.593039 #> 587 512.2449   3.089443 #> 588 501.0008   2.825267 #> 589 786.9011   2.575847 #> 590 500.1873   2.557654 #> 591 502.0695   2.545122 #> 592 984.8233   2.681434 #> 593 500.1644   3.158899 #> 594 506.5672   2.566395 #> 595 500.0951   3.866079 #> 596 500.8830   3.026538 #> 597 501.8410   2.767514 #> 598 500.0361   2.511253 #> 599 662.2843   2.678077 #> 600 500.4011   2.686552 #> 601 504.1571   2.659334 #> 602 736.8038   2.961014 #> 603 500.3418   2.799139 #> 604 504.8129   2.509824 #> 605 500.0230   3.264252 #> 606 500.2171   2.755515 #> 607 865.8746   2.982961 #> 608 502.4942   2.522581 #> 609 500.7696   2.537015 #> 610 500.1246   2.944614 #> 611 515.8036   2.614834 #> 612 500.7698   2.799996 #> 613 500.1327   3.186059 #> 614 500.1825   2.670132 #> 615 501.9691   3.604958 #> 616 516.1297   2.535324 #> 617 556.5172   3.420927 #> 618 506.5242   3.268385 #> 619 634.3159   2.940473 #> 620 537.1997   3.051155 #> 621 503.0137   2.910894 #> 622 500.2176   2.828838 #> 623 633.0851   2.719116 #> 624 500.0477   2.654035 #> 625 521.8639   2.559226 #> 626 500.1272   2.939377 #> 627 503.4128   2.722276 #> 628 684.5782   2.814050 #> 629 500.5179   3.046201 #> 630 605.1702   2.900398 #> 631 531.8137   2.735727 #> 632 625.7870   2.784310 #> 633 501.0161   2.711388 #> 634 730.6230   2.643914 #> 635 500.1396   2.794154 #> 636 603.0864   3.485655 #> 637 500.5609   2.832539 #> 638 500.0222   2.988821 #> 639 503.7507   2.810167 #> 640 511.8582   4.179970 #> 641 500.2477   2.639235 #> 642 501.4482   3.153738 #> 643 501.0493   2.754793 #> 644 686.7596   2.852204 #> 645 549.4525   3.177364 #> 646 501.9090   2.720634 #> 647 501.3379   2.939389 #> 648 556.6428   2.501410 #> 649 500.6162   3.123683 #> 650 551.2958   2.919265 #> 651 500.1067   2.828363 #> 652 504.0013   2.554145 #> 653 642.0234   3.398719 #> 654 501.1111   2.901410 #> 655 740.9517   2.570838 #> 656 895.1534   2.640759 #> 657 500.0613   2.606904 #> 658 654.6479   2.935527 #> 659 575.1041   2.563798 #> 660 511.6468   2.588316 #> 661 500.0662   3.061574 #> 662 807.8029   3.580873 #> 663 948.9571   2.641476 #> 664 519.3824   2.729935 #> 665 500.0098   4.497078 #> 666 500.1930   2.844739 #> 667 500.0241   2.616511 #> 668 502.4449   2.515302 #> 669 529.6525   2.742712 #> 670 500.0392   2.680648 #> 671 500.5210   2.789026 #> 672 513.6336   2.543588 #> 673 502.6121   2.880905 #> 674 500.3641   2.627639 #> 675 500.0704   2.607805 #> 676 501.5912   3.606825 #> 677 513.6252   3.914269 #> 678 500.6144   3.171058 #> 679 608.9825   2.520870 #> 680 505.1717   2.670156 #> 681 500.0441   2.899576 #> 682 500.0339   3.061200 #> 683 959.6434   2.662539 #> 684 500.1316   2.775686 #> 685 500.5865   2.508864 #> 686 501.2878   2.782513 #> 687 518.7440   2.631921 #> 688 693.8415   3.128627 #> 689 501.0158   3.464729 #> 690 795.4087   2.605070 #> 691 906.7942   2.600283 #> 692 531.5073   2.758047 #> 693 505.8201   2.579150 #> 694 517.2645   2.864657 #> 695 501.7838   3.734831 #> 696 500.0907   2.530850 #> 697 622.8286   3.043870 #> 698 509.4792   3.151027 #> 699 527.6195   2.508921 #> 700 501.9826   3.369545 #> 701 501.0898   2.549569 #> 702 571.6617   2.952556 #> 703 918.0598   2.634112 #> 704 500.0588   2.781085 #> 705 511.4434   2.662241 #> 706 500.1229   3.886759 #> 707 501.4933   2.907794 #> 708 500.5159   2.971619 #> 709 506.6722   3.642731 #> 710 500.2585   3.092547 #> 711 529.8814   3.473544 #> 712 827.0522   2.769719 #> 713 553.0006   2.517141 #> 714 773.4893   2.756119 #> 715 796.7921   3.073343 #> 716 530.9957   3.833818 #> 717 500.7443   3.349154 #> 718 504.0466   3.544375 #> 719 500.0046   2.740882 #> 720 502.7807   3.499722 #> 721 500.2890   2.915459 #> 722 500.6433   2.892639 #> 723 981.6538   3.267167 #> 724 915.0504   3.127433 #> 725 500.7435   4.427660 #> 726 502.5678   2.902512 #> 727 501.7013   2.931347 #> 728 512.2939   2.511611 #> 729 791.7864   2.532468 #> 730 585.1486   3.465805 #> 731 500.3255   2.684952 #> 732 500.3609   2.538375 #> 733 500.0498   3.885123 #> 734 533.5316   3.736634 #> 735 637.3167   2.544966 #> 736 500.0512   2.761258 #> 737 503.9404   2.755258 #> 738 500.8543   2.518459 #> 739 500.0090   3.322448 #> 740 501.1168   3.151084 #> 741 512.9375   3.273531 #> 742 500.3228   3.675877 #> 743 500.4093   2.622160 #> 744 522.9903   3.129077 #> 745 645.1555   3.195241 #> 746 500.0029   2.795279 #> 747 828.4159   2.516043 #> 748 709.4801   2.605605 #> 749 504.0246   3.078664 #> 750 500.8158   3.455726 #> 751 500.0196   2.531180 #> 752 901.3054   2.546368 #> 753 537.0673   3.013995 #> 754 500.0972   4.001872 #> 755 500.2652   2.802906 #> 756 500.2367   3.413460 #> 757 500.8181   3.280357 #> 758 621.6611   2.609118 #> 759 535.6012   3.275009 #> 760 501.0446   3.201361 #> 761 916.1552   2.627171 #> 762 550.9348   2.987492 #> 763 500.0240   3.033229 #> 764 528.5905   2.579987 #> 765 501.2313   2.513605 #> 766 500.0482   3.013143 #> 767 500.0198   3.046231 #> 768 500.6899   3.477557 #> 769 503.8452   2.860904 #> 770 502.1221   2.627754 #> 771 501.4857   2.742343 #> 772 868.0360   2.782296 #> 773 603.2089   2.956200 #> 774 502.3171   2.517009 #> 775 563.4236   2.505139 #> 776 501.1348   2.837201 #> 777 658.5538   2.990918 #> 778 690.1034   2.649503 #> 779 590.1160   4.530634 #> 780 500.9638   3.423400 #> 781 500.2121   2.563950 #> 782 542.0388   2.550823 #> 783 500.9436   3.566397 #> 784 500.0050   2.541505 #> 785 501.4224   2.732163 #> 786 544.6613   2.573297 #> 787 500.4822   3.278463 #> 788 712.6746   2.578202 #> 789 594.3933   2.615241 #> 790 509.8902   3.907859 #> 791 500.2529   2.913804 #> 792 500.2071   2.981062 #> 793 506.1069   3.188952 #> 794 500.0943   2.898793 #> 795 505.3706   2.640554 #> 796 505.1930   2.522314 #> 797 500.0632   2.587987 #> 798 521.4640   2.551277 #> 799 516.1461   2.900586 #> 800 505.9981   3.156714 #> 801 502.5551   3.115487 #> 802 506.7283   5.201339 #> 803 560.1022   2.512725 #> 804 534.5980   2.589398 #> 805 500.8662   4.044164 #> 806 500.8881   2.557869 #> 807 500.5261   2.733050 #> 808 541.4935   3.491913 #> 809 500.0140   2.566596 #> 810 500.4389   3.491350 #> 811 903.3897   2.749354 #> 812 681.4510   2.788360 #> 813 563.4948   2.928294 #> 814 512.5254   3.294844 #> 815 500.1749   2.717636 #> 816 501.0121   3.093721 #> 817 500.4794   2.992563 #> 818 504.2337   2.705461 #> 819 502.3613   3.045762 #> 820 502.6424   3.077901 #> 821 500.2016   3.218689 #> 822 501.9013   2.523885 #> 823 500.3473   2.536883 #> 824 500.0253   2.766867 #> 825 500.1265   2.632793 #> 826 500.1188   2.532018 #> 827 517.3061   2.605255 #> 828 501.4189   2.506134 #> 829 500.6079   2.649590 #> 830 501.6657   2.771790 #> 831 501.0613   4.074415 #> 832 502.2382   3.419458 #> 833 576.5835   2.744813 #> 834 564.0001   3.173923 #> 835 501.7213   2.722787 #> 836 503.9868   2.585023 #> 837 524.3305   3.276631 #> 838 500.0428   2.842580 #> 839 535.1618   2.522617 #> 840 501.4748   2.574572 #> 841 515.4542   2.542206 #> 842 968.1405   2.658168 #> 843 501.9302   2.779374 #> 844 500.1505   3.180410 #> 845 500.1568   2.990783 #> 846 501.1047   3.377200 #> 847 500.7665   2.676360 #> 848 500.1150   3.380793 #> 849 705.2425   3.024038 #> 850 522.5872   2.517482 #> 851 831.1114   2.639061 #> 852 504.5466   2.621212 #> 853 510.6949   3.210019 #> 854 500.1905   3.046268 #> 855 539.2440   3.429285 #> 856 521.5803   2.540206 #> 857 580.1363   2.836182 #> 858 501.4162   3.391909 #> 859 500.9514   2.649679 #> 860 502.2056   2.528348 #> 861 703.2524   2.538691 #> 862 502.2890   3.210588 #> 863 500.3057   2.548442 #> 864 502.0471   2.883628 #> 865 500.5612   2.943432 #> 866 525.2929   2.856913 #> 867 503.7575   2.603871 #> 868 579.9925   2.865015 #> 869 657.6172   2.921770 #> 870 500.0677   2.538391 #> 871 543.3805   2.804388 #> 872 847.1326   2.561157 #> 873 501.1938   3.138930 #> 874 544.6851   2.716030 #> 875 514.0432   4.663220 #> 876 500.4527   2.673888 #> 877 500.0268   2.555742 #> 878 501.5937   2.798250 #> 879 502.3625   3.173935 #> 880 538.6752   2.701106 #> 881 500.0571   3.323037 #> 882 500.1005   2.551227 #> 883 501.2620   2.512284 #> 884 540.0114   2.873207 #> 885 501.6622   3.224613 #> 886 517.4631   2.577713 #> 887 502.9913   2.943496 #> 888 500.4488   2.993774 #> 889 500.0541   2.651431 #> 890 589.3109   2.506682 #> 891 519.8676   3.282537 #> 892 500.8195   2.680199 #> 893 502.5082   2.582278 #> 894 506.1069   2.579997 #> 895 500.9540   2.590878 #> 896 500.0948   2.710693 #> 897 827.4772   3.084279 #> 898 522.6238   3.724067 #> 899 500.0305   2.559326 #> 900 500.2585   3.611946 #> 901 500.7904   2.640221 #> 902 500.1272   2.735627 #> 903 500.0612   2.874734 #> 904 503.1873   2.633597 #> 905 500.2048   2.816867 #> 906 536.7704   2.874025 #> 907 501.4192   2.725425 #> 908 568.5267   2.866026 #> 909 500.0137   2.777162 #> 910 500.7954   3.020532 #> 911 535.2689   2.620455 #> 912 526.4801   2.746299 #> 913 508.2828   2.511783 #> 914 500.3890   2.756111 #> 915 531.1863   2.787509 #> 916 501.8084   2.793699 #> 917 735.2254   2.704204 #> 918 962.4723   2.861366 #> 919 500.0452   4.095060 #> 920 502.7041   2.549660 #> 921 548.0507   3.470413 #> 922 500.6155   2.640647 #> 923 501.2505   2.551737 #> 924 639.4222   2.564480 #> 925 525.2752   2.712010 #> 926 691.0709   2.937495 #> 927 544.2013   2.793770 #> 928 500.4466   2.906661 #> 929 510.2536   3.698248 #> 930 500.4055   2.708981 #> 931 500.7357   3.180771 #> 932 500.0400   2.854538 #> 933 500.2491   2.625321 #> 934 500.6615   3.128898 #> 935 508.4238   2.565351 #> 936 501.9529   3.196098 #> 937 731.9535   2.675773 #> 938 521.1914   2.677543 #> 939 502.3129   2.832795 #> 940 500.2556   2.528196 #> 941 603.3051   3.156454 #> 942 860.3606   3.586432 #> 943 501.2166   2.653513 #> 944 515.8902   2.689469 #> 945 531.4094   3.045702 #> 946 966.6537   2.528885 #> 947 501.8234   2.594261 #> 948 714.0057   2.675833"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":null,"dir":"Reference","previous_headings":"","what":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"Sampling times events triggered parent th according ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"","code":"sample_temporal_ETAS_times(theta, n.ev, th, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). n.ev Number events return sample time domain (th, T2]. th Time parent event producing n.ev daughters. T2 End time model domain.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"t.sample list times interval [0, T2] distributed according ETAS triggering function.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — sample_temporal_injection_events","title":"Title — sample_temporal_injection_events","text":"Title","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — sample_temporal_injection_events","text":"","code":"sample_temporal_injection_events(   a = 50,   V.i = 1,   tau = 10,   beta.p,   M0,   T.i,   T2 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — sample_temporal_injection_events","text":"Induced event rate per unit volume. V.Injected volume tau Decay rate [days]. beta.p Related b-value via b ln(10). M0 Minimum magnitude threshold. T.Time injection [days]. T2 End temporal model domain [days].","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — sample_temporal_injection_events","text":"Catalogue parent events induced injection; data.frame(times, magnitudes)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a set of time bins for a specific event. — time_grid","title":"Generate a set of time bins for a specific event. — time_grid","text":"Generate set time bins specific event.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a set of time bins for a specific event. — time_grid","text":"","code":"time_grid(data.point, coef.t, delta.t, N.exp., T1., T2.)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a set of time bins for a specific event. — time_grid","text":"data.point Point binning calculated, list elements time (ts, scalar), event index (idx.p, scalar). Names mandatory changed coef.t TimeBinning parameter: look breaks_exp() delta.t TimeBinning parameter: look breaks_exp() N.exp. TimeBinning parameter: look breaks_exp() T1. Start temporal domain, scalar T2. End temporal domain scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a set of time bins for a specific event. — time_grid","text":"data.frame many rows number bins fixed number columns. columns t.start : starting point bin (minimum = T1.). t.end : end point bin. (maximum = T2.). t.bin.name : unique bin identifier. t.ref_layer : bin identifier calculations ts : time provided data.point idx.p : identifier provided data.point bins T1. T2. containing T1.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a set of time bins for a specific event. — time_grid","text":"","code":"## EXAMPLE 1 event <- list(ts = 0, idx.p = 1) time_grid(data.point = event, coef.t = 1, delta.t = 0.1, N.exp. = 8, T1. = 1, T2. = 20) #>   t.start t.end t.bin.name t.ref_layer ts idx.p #> 1     1.0   1.6    0.8-1.6   between-1  0     1 #> 2     1.6   3.2    1.6-3.2           6  0     1 #> 3     3.2   6.4    3.2-6.4           7  0     1 #> 4     6.4  12.8   6.4-12.8           8  0     1 #> 5    12.8  20.0    12.8-20      last-1  0     1"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"Function plot ETAS triggering function corresponding different posterior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"","code":"triggering_fun_plot(   input.list,   post.samp = NULL,   n.samp = 10,   magnitude = 4,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale post.samp data.frame containing posterior samples parameters. NULL, n.samp samples generated. n.samp different nrow(post.samp) n.samp rows uniformly sampled post.samp. Default NULL n.samp Number posterior samples, integer (default = 10). magnitude Magnitude event triggering function calculated, scalar (default = 4). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"ggplot object grey lines representing triggering function posterior sample. Black lines representing 0.025 0.975 quantiles function values calculated posterior sample. Horizontal red lines represents 0.025 0.975 quantiles sampled background rates.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"Function plot ETAS triggering function corresponding different prior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"","code":"triggering_fun_plot_prior(   input.list,   magnitude = 4,   n.samp = 10,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"input.list structured input list least one element: link.functions: list functions convert ETAS parameters INLA scale ETAS scale magnitude Magnitude event triggering function calculated, scalar (default = 4). n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"ggplot object grey lines representing triggering function posterior sample. Black lines representing 0.025 0.975 quantiles function values calculated posterior sample. Horizontal red lines represents 0.025 0.975 quantiles sampled background rates.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"Copula transformation standard Normal distribution Uniform distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"","code":"unif_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"x values standard Normal distribution, vector. minimum value Uniform distribution, scalar. b maximum value Uniform distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"values Uniform distribution b, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/news/index.html","id":"etasinlabru-development-version","dir":"Changelog","previous_headings":"","what":"ETAS.inlabru (development version)","title":"ETAS.inlabru (development version)","text":"Cleaned R package structure Added vignettes package website Renamed functions avoid “.” non-S3-method function names. Temporal.ETAS.* functions retain “.”, now.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/news/index.html","id":"etasinlabru-101","dir":"Changelog","previous_headings":"","what":"ETAS.inlabru 1.0.1","title":"ETAS.inlabru 1.0.1","text":"Initial package version.","code":""}]
