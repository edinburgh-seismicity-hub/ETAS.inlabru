[{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/generateSyntheticCatalogues.html","id":"create-catalogue","dir":"Articles","previous_headings":"","what":"Create catalogue","title":"Generating synthetic temporal ETAS catalogues","text":"define ETAS parameters define model domain specify history generate ETAS sample plot results","code":"mu <- 1070. / 365 K <- 0.089 alpha <- 2.29 c <- 0.011 p <- 1.08  modelledDuration <- 10 # [days]  M0 <- 2  theta_etas <- data.frame(mu = mu, K = K, alpha = alpha, c = c, p = p)  Ht <- data.frame(ts = c(0., 1.5), magnitudes = c(6.7, 7.))  samp.etas.list <- generate_temporal_ETAS_synthetic(theta = theta_etas, beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = Ht)  ggplot() +   geom_point(data = samp.etas.list[[1]], aes(x = ts, y = magnitudes), color = \"red\") +   geom_point(data = samp.etas.list[[2]], aes(x = ts, y = magnitudes), color = \"green\") +   xlim(0, modelledDuration) +   ggtitle(\"M7 plus background and ETAS\") combined.M7.ETAS.cat <- bind_rows(samp.etas.list)  combined.M7.ETAS.cat <- bind_rows(samp.etas.list) combined.M7.ETAS.cat <- combined.M7.ETAS.cat[order(combined.M7.ETAS.cat$ts), ]  combined.M7.ETAS.cat$ID <- seq(1, length(combined.M7.ETAS.cat$ts))  ggplot() +   geom_point(data = combined.M7.ETAS.cat, aes(x = ID, y = magnitudes), color = \"red\") #+ #  geom_ma(data = combined.M7.ETAS.cat, aes(x=ID, y=magnitudes), ma_fun = SMA, n = 10)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"multiple-analyses-of-two-catalogues-using-different-initial-values","dir":"Articles","previous_headings":"","what":"Multiple analyses of two catalogues using different initial values","title":"Sensitivity to starting point","text":"inlabru algorithm takes initial guess mode parameters inverting iteratively updates initial guess. potential may bad initial conditions find different solutions runtime differ depending upon solution converges. notebook, explore robustness posteriors two synthetic catalogues true parameters known. catalogues contain 2000 days data. One catalogue contain large event second contains M6.7 event day 1000.","code":"library(ETAS.inlabru)  library(tidyquant) library(gridExtra) library(grid) library(lemon) library(ggplot2) library(ggpubr) library(GGally)  library(inlabru) library(INLA) library(ETAS.inlabru)  # inla.setOption(pardiso.license=\"~/sys/licences/pardiso.lic\")  library(dplyr)  # Increase num.threads if you have more cores on your computer INLA::inla.setOption(num.threads = 2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"define-the-parameters-for-the-synthetic-catalogues-and-starting-values-for-inversion","dir":"Articles","previous_headings":"Multiple analyses of two catalogues using different initial values","what":"Define the parameters for the synthetic catalogues and starting values for inversion","title":"Sensitivity to starting point","text":"","code":"# Parameters we use to generate synthetics, which we will refer to as the 'true' parameters mu <- 0.1 K <- 0.089 alpha <- 2.29 c <- 0.11 p <- 1.08  # Format the true ETAS parameters for code to generate the synthetics theta_etas <- data.frame(mu = mu, K = K, alpha = alpha, c = c, p = p)  # A dataframe containing different starting values for the algorithm startingValues <- data.frame(   mu = c(5., mu),   K = c(1., K),   alpha = c(5., alpha),   c = c(0.3, c),   p = c(1.5, p) ) nRealisations <- length(startingValues$mu)   # Temporal duration of the synthetic catalogue in days modelledDuration <- 1000 # [days]  # The minimum magnitude that will be modelled M0 <- 2.5"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"generate-new-catalogues-and-save-them","dir":"Articles","previous_headings":"Multiple analyses of two catalogues using different initial values","what":"Generate new catalogues and save them","title":"Sensitivity to starting point","text":"vignette use Rmd caching, can save catalogues files explicitly:","code":"############ #### Generate the first catalogue with no large events  samp.etas.list <- generate_temporal_ETAS_synthetic(   theta = theta_etas,   beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = NULL )  quiet.ETAS.cat <- bind_rows(samp.etas.list) quiet.ETAS.cat <- quiet.ETAS.cat[order(quiet.ETAS.cat$ts), ] # quiet.ETAS.cat <- na.omit(quiet.ETAS.cat) ############ #### Generate the second catalogue with a M6.7 event on day 1000  Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) # Impose a M6.7 event on day 1000  samp.etas.list <- generate_temporal_ETAS_synthetic(theta = theta_etas, beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = Ht)  M6p7.ETAS.cat <- bind_rows(samp.etas.list) M6p7.ETAS.cat <- M6p7.ETAS.cat[order(M6p7.ETAS.cat$ts), ] # save(M6p7.ETAS.cat,file=\"M6p7_ETAS_cat.Rda\") # save(quiet.ETAS.cat,file=\"quiet.ETAS.cat.Rda\")"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"load-the-catalogues","dir":"Articles","previous_headings":"Present the catalogues","what":"Load the catalogues","title":"Sensitivity to starting point","text":"read saved object files:","code":"# load(\"M6p7_ETAS_cat.Rda\") # load(\"quiet.ETAS.cat.Rda\")"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-properties-of-the-catalogues","dir":"Articles","previous_headings":"Present the catalogues","what":"Plot properties of the catalogues","title":"Sensitivity to starting point","text":"","code":"plots <- list()  plots[[1]] <- ggplot() +   geom_point(data = quiet.ETAS.cat, aes(x = ts, y = magnitudes), size = 0.1, alpha = 0.5) +   xlim(0, modelledDuration) +   ggtitle(paste(\"A.  Unseeded catalog, nEvents =\", length(quiet.ETAS.cat$ts))) +   ylim(2, 7) +   xlab(\"Time [days]\") +   ylab(\"Magnitude\") +   theme_bw()  plots[[2]] <- ggplot() +   geom_point(data = M6p7.ETAS.cat, aes(x = ts, y = magnitudes), size = 0.1, alpha = 0.5) +   xlim(0, modelledDuration) +   ggtitle(paste(\"B.  Catalog seeded with M6.7 event on day 500, nEvents =\", length(M6p7.ETAS.cat$ts))) +   ylim(2, 7) +   xlab(\"Time [days]\") +   ylab(\"Magnitude\") +   theme_bw()   plt <- grid.arrange(plots[[1]], plots[[2]], ncol = 1, nrow = 2) # ggsave(\"initialConditionCats.png\", plt) # ggsave(\"initialConditionCats.pdf\", plt)"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"analysis-of-quiet-catalogue","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Analysis of quiet catalogue","title":"Sensitivity to starting point","text":"","code":"list.output.quietScenario <- list()  for (i in seq_len(nRealisations)) {   if (exists(\"list.input\")) remove(\"list.input\")    # Load a set of parameters that we will need to tweak for this application   fpath <- system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\")   list.input <- create_input_list_temporal_noCatalogue(fpath)    ####################   # Tweak the variables loaded from the input file   list.input$M0 <- M0   list.input$time.int <- c(0, modelledDuration)   list.input$T12 <- c(0, modelledDuration)    # Change the starting location, measured on the ETAS scale   list.input$mu.init <- startingValues$mu[i]   list.input$alpha.init <- startingValues$alpha[i]   list.input$K.init <- startingValues$K[i]   list.input$c.init <- startingValues$c[i]   list.input$p.init <- startingValues$p[i]    link.f <- list(     mu = \\(x) gamma_t(x, a_mu, b_mu),     K = \\(x) loggaus_t(x, a_K, b_K),     alpha = \\(x) unif_t(x, a_alpha, b_alpha),     c_ = \\(x) unif_t(x, a_c, b_c),     p = \\(x) unif_t(x, a_p, b_p)   )    # initial value - convert from ETAS scale to internal scale   list.input$th.init <- list(     th.mu = inv_gamma_t(list.input$mu.init, list.input$a_mu, list.input$b_mu),     th.K = inv_loggaus_t(list.input$K.init, list.input$a_K, list.input$b_K),     th.alpha = inv_unif_t(list.input$alpha.init, list.input$a_alpha, list.input$b_alpha),     th.c = inv_unif_t(list.input$c.init, list.input$a_c, list.input$b_c),     th.p = inv_unif_t(list.input$p.init, list.input$a_p, list.input$b_p)   )    # Define options for inlabru   if (is.null(list.input$max_step)) {     list.input$bru.opt.list <- list(       bru_verbose = 0, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       # bru_method = list(max_step = 0.5),       bru_initial = list.input$th.init     ) # parameters initial values   } else {     list.input$bru.opt.list <- list(       bru_verbose = 0, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       bru_method = list(max_step = list.input$max_step),       bru_initial = list.input$th.init     ) # parameters initial values   }    ## Add out catalogue to the input list   list.input$catalog <- data.frame(     time_diff = quiet.ETAS.cat$ts,     magnitudes = quiet.ETAS.cat$magnitudes   )    ## Add the catalogue formatted for bru   list.input$catalog.bru <- data.frame(     ts = quiet.ETAS.cat$ts,     magnitudes = quiet.ETAS.cat$magnitudes,     idx.p = seq_len(nrow(quiet.ETAS.cat))   )    ## Input list is now formatted   ####################    ## Run the model according to the input list   ETAS.model.fit <- Temporal.ETAS.fit(list.input)    ## Small bit of post processing   list.output.quietScenario[[i]] <- append(list.input, list(model.fit = ETAS.model.fit))   list.output.quietScenario[[i]]$runtime <- sum(list.output.quietScenario[[i]]$model.fit$bru_timings$Time)   list.output.quietScenario[[i]]$nEvents <- length(list.output.quietScenario[[i]]$catalog[, 1]) } #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  0.5746055  #> Finish model fitting  #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  0.4869592  #> Finish model fitting"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"analysis-of-m6-7-catalogue","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Analysis of M6.7 catalogue","title":"Sensitivity to starting point","text":"","code":"list.output.M6p7Scenario <- list()  for (i in seq_len(nRealisations)) {   if (exists(\"list.input\")) {     remove(list.input)   }    # Load a set of parameters that we will need to tweak for this application   fpath <- system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\")   list.input <- create_input_list_temporal_noCatalogue(fpath)    ####################   # Tweak the variables laoded from the input file   list.input$M0 <- M0   list.input$time.int <- c(0, modelledDuration)   list.input$T12 <- c(0, modelledDuration)    # Change the starting location, measured on the ETAS scale   list.input$mu.init <- startingValues$mu[i]   list.input$alpha.init <- startingValues$alpha[i]   list.input$K.init <- startingValues$K[i]   list.input$c.init <- startingValues$c[i]   list.input$p.init <- startingValues$p[i]    link.f <- list(     mu = \\(x) gamma_t(x, a_mu, b_mu),     K = \\(x) loggaus_t(x, a_K, b_K),     alpha = \\(x) unif_t(x, a_alpha, b_alpha),     c_ = \\(x) unif_t(x, a_c, b_c),     p = \\(x) unif_t(x, a_p, b_p)   )    # initial value - convert from ETAS scale to internal scale   list.input$th.init <- list(     th.mu = inv_gamma_t(list.input$mu.init, list.input$a_mu, list.input$b_mu),     th.K = inv_loggaus_t(list.input$K.init, list.input$a_K, list.input$b_K),     th.alpha = inv_unif_t(list.input$alpha.init, list.input$a_alpha, list.input$b_alpha),     th.c = inv_unif_t(list.input$c.init, list.input$a_c, list.input$b_c),     th.p = inv_unif_t(list.input$p.init, list.input$a_p, list.input$b_p)   )    # Define options for inlabru   if (is.null(list.input$max_step)) {     list.input$bru.opt.list <- list(       bru_verbose = 3, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       # bru_method = list(max_step = 0.5),       bru_initial = list.input$th.init     ) # parameters initial values   } else {     list.input$bru.opt.list <- list(       bru_verbose = 3, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       bru_method = list(max_step = list.input$max_step),       bru_initial = list.input$th.init     ) # parameters initial values   }    ## Add out catalogue to the input list   list.input$catalog <- data.frame(     time_diff = M6p7.ETAS.cat$ts,     magnitudes = M6p7.ETAS.cat$magnitudes   )    ## Add the catalogue formatted for bru   list.input$catalog.bru <- data.frame(     ts = M6p7.ETAS.cat$ts,     magnitudes = M6p7.ETAS.cat$magnitudes,     idx.p = seq_len(nrow(M6p7.ETAS.cat))   )    ## Input list is now formatted   ####################    ## Run the model according to the input list   ETAS.model.fit <- Temporal.ETAS.fit(list.input)    ## Small bit of post processing   list.output.M6p7Scenario[[i]] <- append(list.input, list(model.fit = ETAS.model.fit))   list.output.M6p7Scenario[[i]]$runtime <- sum(list.output.M6p7Scenario[[i]]$model.fit$bru_timings$Time)   list.output.M6p7Scenario[[i]]$nEvents <- length(list.output.M6p7Scenario[[i]]$catalog[, 1]) } #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  9.739749 #> iinla: Evaluate component inputs #> iinla: Evaluate component linearisations #> iinla: Evaluate component simplifications #> iinla: Evaluate predictor linearisation #> iinla: Construct inla stack #> iinla: Model initialisation completed #> iinla: Iteration 1 [max:100] #> iinla: Step rescaling: 94.69%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Iteration 2 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 118.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 1550% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 3 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 101.5%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 2190% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 4 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 64.83%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 896% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 5 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 104.8%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 397% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 6 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 102.9%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 283% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 7 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.6%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 237% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 8 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 101%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 202% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 9 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.7%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 183% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 10 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.6%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 167% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 11 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.5%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 153% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 12 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.4%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 140% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 13 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.4%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 130% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 14 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 120% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 15 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 112% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 16 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 104% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 17 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 97.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 18 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 91.1% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 19 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 85.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 20 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 80.1% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 21 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 75.2% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 22 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 70.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 23 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 66.7% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 24 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 62.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 25 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 59.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 26 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 56% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 27 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 52.9% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 28 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 50% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 29 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 47.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 30 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 44.8% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 31 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 42.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 32 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 40.2% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 33 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 38.2% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 34 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 36.2% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 35 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 34.4% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 36 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 32.6% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 37 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 31% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 38 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 29.4% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 39 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 28% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 40 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 26.6% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 41 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 25.3% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 42 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 24% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 43 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 22.9% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 44 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 21.8% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 45 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 20.7% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 46 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 19.7% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 47 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 18.8% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 48 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 17.9% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 49 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 17% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 50 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 16.2% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 51 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 15.4% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 52 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 14.7% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 53 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 14% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 54 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 13.4% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 55 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 12.7% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 56 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 12.1% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 57 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 11.6% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 58 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 11% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 59 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 10.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 60 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 10% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 61 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 9.57% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Convergence criterion met, running final INLA integration with known theta mode. #> iinla: Iteration 62 [max:100] #> Finish model fitting  #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  9.082923 #> iinla: Evaluate component inputs #> iinla: Evaluate component linearisations #> iinla: Evaluate component simplifications #> iinla: Evaluate predictor linearisation #> iinla: Construct inla stack #> iinla: Model initialisation completed #> iinla: Iteration 1 [max:100] #> iinla: Step rescaling: 94.21%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Iteration 2 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 32.7% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 3 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 12.9% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 4 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 4.2% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 5 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 1.49% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Convergence criterion met, running final INLA integration with known theta mode. #> iinla: Iteration 6 [max:100] #> Finish model fitting"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-posteriors-with-corresponding-starting-values","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions > Analysis of M6.7 catalogue","what":"Plot posteriors with corresponding starting values","title":"Sensitivity to starting point","text":"","code":"plots <- list()  trueParas <- data.frame(value = c(mu, K, alpha, c, p), param = c(\"mu\", \"K\", \"alpha\", \"c\", \"p\"))  post.list <- get_posterior_param(input.list = list.output.quietScenario[[1]]) post.df <- post.list[[1]] post.df$id <- 1  for (i in 2:nRealisations) {   post.list <- get_posterior_param(input.list = list.output.quietScenario[[i]])   post.df.tmp <- post.list[[1]]   post.df.tmp$id <- i    post.df <- rbind(post.df, post.df.tmp) }  plots[[1]] <- ggplot(post.df, aes(x = x, y = y, group = id, color = factor(id), lty = factor(id))) +   geom_line() +   # scale_x_discrete(guide = guide_axis(check.overlap = TRUE)) +   facet_wrap(facets = vars(param), scales = \"free\", labeller = label_parsed, nrow = 1) +   geom_vline(aes(xintercept = value),     data = trueParas, color = \"black\", linetype = 2,     label = \"True value\"   ) +   labs(color = \"Initial ETAS Para. Set\", linetype = \"Initial ETAS Para. Set\") +   ggtitle(paste(\"A.  Inversion of a 1000 day catalogue with no large events, nEvents =\", length(quiet.ETAS.cat$ts))) +   xlab(\"ETAS Posteriors\") +   theme_bw() +   theme(axis.text.x = element_text(angle = 45, hjust = 1)) +   theme(legend.position = \"hidden\") +   theme(plot.title = element_text(size = 12)) #> Warning in geom_vline(aes(xintercept = value), data = trueParas, color = #> \"black\", : Ignoring unknown parameters: `label` trueParas <- data.frame(value = c(mu, K, alpha, c, p), param = c(\"mu\", \"K\", \"alpha\", \"c\", \"p\"))  post.list <- get_posterior_param(input.list = list.output.M6p7Scenario[[1]]) post.df <- post.list[[1]] post.df$id <- 2  for (i in 2:nRealisations) {   post.list <- get_posterior_param(input.list = list.output.M6p7Scenario[[i]])   post.df.tmp <- post.list[[1]]   post.df.tmp$id <- i    post.df <- rbind(post.df, post.df.tmp) }  plots[[2]] <- ggplot(post.df, aes(x = x, y = y, group = id, color = factor(id), lty = factor(id))) +   geom_line() +   # scale_x_discrete(guide = guide_axis(check.overlap = TRUE)) +   facet_wrap(facets = vars(param), scales = \"free\", labeller = label_parsed, nrow = 1) +   geom_vline(aes(xintercept = value),     data = trueParas, color = \"black\", linetype = 2,     label = \"True value\"   ) +   labs(color = \"Initial ETAS Para. Set\", linetype = \"Initial ETAS Para. Set\") +   ggtitle(paste(\"B. Inversion of a 1000 day catalogue with a M6.7 on day 500, nEvents =\", length(M6p7.ETAS.cat$ts))) +   xlab(\"ETAS Posteriors\") +   theme_bw() +   theme(axis.text.x = element_text(angle = 45, hjust = 1)) +   theme(legend.position = \"hidden\") +   theme(plot.title = element_text(size = 12)) #> Warning in geom_vline(aes(xintercept = value), data = trueParas, color = #> \"black\", : Ignoring unknown parameters: `label` plt <- grid_arrange_shared_legend(plots[[1]], plots[[2]], ncol = 1, nrow = 2, position = \"bottom\") plt #> TableGrob (2 x 1) \"arrange\": 2 grobs #>   z     cells    name              grob #> 1 1 (1-1,1-1) arrange   gtable[arrange] #> 2 2 (2-2,1-1) arrange gtable[guide-box] # ggsave(\"initialCondition_posteriors.png\", plt) # ggsave(\"initialCondition_posteriors.pdf\", plt)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"explore-etas-triggering-function-using-posterior-samples","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Explore ETAS triggering function using posterior samples","title":"Sensitivity to starting point","text":"","code":"plot_triggering <- list() plot_triggering[[1]] <- triggering_fun_plot(list.output.quietScenario[[1]], magnitude = 4, n.samp = 100) +   ggtitle(\"C. M4 triggering function\") +   theme_bw() +   ylim(0, 5.5) +   theme(plot.title = element_text(size = 8))  plot_triggering[[2]] <- triggering_fun_plot(list.output.M6p7Scenario[[1]], magnitude = 4, n.samp = 100) +   ggtitle(\"D. M4 triggering function\") +   theme_bw() +   ylim(0, 5.5) +   theme(plot.title = element_text(size = 8))  plot_triggering[[3]] <- triggering_fun_plot(list.output.quietScenario[[1]], magnitude = 6.7, n.samp = 100) +   ggtitle(\"E. M6.7 triggering function\") +   theme_bw() +   ylim(0, 1700) +   theme(plot.title = element_text(size = 8))   plot_triggering[[4]] <- triggering_fun_plot(list.output.M6p7Scenario[[1]], magnitude = 6.7, n.samp = 100) +   ggtitle(\"F. M6.7 triggering function\") +   theme_bw() +   ylim(0, 1700) +   theme(plot.title = element_text(size = 8))   plt <- grid.arrange(plot_triggering[[1]], plot_triggering[[3]], plot_triggering[[2]], plot_triggering[[4]], ncol = 2, nrow = 2, top = \"Triggering function variability\") +   theme(plot.title = element_text(size = 8)) #> Warning: Removed 8 rows containing missing values (`geom_line()`). #> Warning: Removed 1 row containing missing values (`geom_line()`). #> Warning: Removed 8 rows containing missing values (`geom_line()`). #> Warning: Removed 1 row containing missing values (`geom_line()`). plt #> NULL  # ggsave(\"trigFuncVariability_runin.png\", plt) # ggsave(\"trigFuncVariability_runin.pdf\", plt) plot_omori <- list() plot_omori[[1]] <- omori_plot_posterior(list.output.quietScenario[[1]], n.samp = 100) +   ggtitle(\"A. Omori decay\") +   theme_bw() +   ylim(0, 1) +   theme(plot.title = element_text(size = 8))   plot_omori[[2]] <- omori_plot_posterior(list.output.M6p7Scenario[[1]], n.samp = 100) +   ggtitle(\"B. Omori decay\") +   theme_bw() +   ylim(0, 1) +   theme(plot.title = element_text(size = 8)) plt <- grid.arrange(plot_omori[[1]], plot_triggering[[1]], plot_triggering[[3]], plot_omori[[2]], plot_triggering[[2]], plot_triggering[[4]], ncol = 3, nrow = 2, top = \"Triggering  function variability\", left = \"M6.7 baseline            Unseeded baseline\") #> Warning: Removed 8 rows containing missing values (`geom_line()`). #> Warning: Removed 1 row containing missing values (`geom_line()`). #> Warning: Removed 8 rows containing missing values (`geom_line()`). #> Warning: Removed 1 row containing missing values (`geom_line()`). plt #> TableGrob (3 x 4) \"arrange\": 8 grobs #>   z     cells    name                 grob #> 1 1 (2-2,2-2) arrange       gtable[layout] #> 2 2 (2-2,3-3) arrange       gtable[layout] #> 3 3 (2-2,4-4) arrange       gtable[layout] #> 4 4 (3-3,2-2) arrange       gtable[layout] #> 5 5 (3-3,3-3) arrange       gtable[layout] #> 6 6 (3-3,4-4) arrange       gtable[layout] #> 7 7 (1-1,2-4) arrange text[GRID.text.1299] #> 8 8 (1-3,1-1) arrange text[GRID.text.1300]  # ggsave(\"trigFuncVariability_runin.png\", plt) # ggsave(\"trigFuncVariability_runin.pdf\", plt)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-the-samples-from-the-joint-posteriors-as-pairs-plots","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Plot the samples from the joint posteriors as pairs plots","title":"Sensitivity to starting point","text":"","code":"post_pairs_plot(list.output.quietScenario[[1]], n.samp = 1000)$pair.plot post_pairs_plot(list.output.M6p7Scenario[[1]], n.samp = 1000)$pair_plot #> NULL"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"inlabru-convergence-diagnostics","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"inlabru convergence diagnostics","title":"Sensitivity to starting point","text":"can also assess convergence inlabru method , using bru_convergence_plot() function. can reveal starting values inlabru estimation unreasonable, better starting values nonlinear iterations might speed computations.","code":"bru_convergence_plot(list.output.quietScenario[[1]]$model.fit) bru_convergence_plot(list.output.quietScenario[[2]]$model.fit) bru_convergence_plot(list.output.M6p7Scenario[[1]]$model.fit) bru_convergence_plot(list.output.M6p7Scenario[[2]]$model.fit)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"introduction-to-etas-model","dir":"Articles","previous_headings":"","what":"Introduction to ETAS model","title":"Tutorial on real data","text":"tutorial, show use ETAS.inlabru R-package fit temporal ETAS model real earthquakes data. tutorial shows prepare data, fit model, retrieve posterior distribution parameters posterior distribution quantities interest, generate synthetic catalogues fitted model, produce forecasts seismicity. Epidemic-Type Aftershock Sequence (ETAS) model belongs family Hawkes () point processes. temporal Hawkes process point process model conditional intensity given \\[ \\lambda(t | \\mathcal H_t) = \\mu + \\sum_{t_h \\\\mathcal H_t} g(t- t_h) \\] \\(\\mathcal H_t\\) history process time \\(t\\). Generally speaking \\(\\mathcal H_t\\) contains events occurred \\(t\\). quantity \\(\\mu > 0\\) usually called , interpreted rate events occur spontaneously. function \\(g(t-t_h)\\) called function (excitation function, simply kernel) measures influence event \\(t_h\\) time \\(t\\). look \\(g(t-t_h)\\) function \\(t\\) intensity point process representing offspring event \\(t_h\\). seismology offspring event called , two terms used synonyms. essence, Hawkes process model can seen superposition background process intensity \\(\\mu\\) aftershock processes generated observations \\(\\mathcal H_t\\) one intensity \\(g(t-t_h)\\). makes Hawkes process model particularly suitable describe phenomena event ability trigger additional events, phenomena characterized cascades events earthquakes, infectious diseases, wildfires, financial crisis, similar. ETAS model particular instance Hawkes process model proven particularly suitable model earthquake occurrence. Earthquakes usually described modelled marked time points marking variable magnitude event. history process composed time-magnitude pairs, namely \\(\\mathcal H_t = \\{(t_h,m_h), h = 1,...,N_h\\}\\). Various slightly different ETAS formulations exists, usually characterized slightly different triggering functions, one implemented ETAS.inlabru R-package conditional intensity given \\[ \\lambda(t | \\mathcal H_t) = \\mu + \\sum_{t_h \\\\mathcal H_t} K \\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] \\(M_0\\) cutoff magnitude \\(m_h \\geq M_0\\) \\(h\\). value decided priori based quality catalogue used. parameters model : \\(\\mu \\geq 0\\), background rate \\(K \\geq 0\\) general productivity parameter, plays role determining average number aftershocks induced event catalogue. \\(\\alpha \\geq 0\\) magnitude scaling parameter, determines number aftershocks changes based magnitude event generating aftershocks. non-negative reflect fact stronger earthquakes generate aftershocks. \\(c > 0\\) time offset parameter, smaller values associated catalogues fewer missing events. \\(p \\geq 1\\) aftershock decay parameter, determines rate aftershock activity decreases time. greater 1 otherwise event may generate infinite number aftershocks infinite interval time thought unphysical.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"priors","dir":"Articles","previous_headings":"","what":"Priors","title":"Tutorial on real data","text":"bayesian analysis need decide priors parameters. approximation method use considers parameters two different scales: original ETAS scale, internal scale. internal scale used package perform calculations. internal scale parameters constraint standard normal distribution prior. need set priors parameters ETAS scale. done considering copula transformation \\(\\eta(X)\\) \\(X \\sim N(0,1)\\) , \\(\\eta(X)\\) desired distribution. ETAS.inlabru R-package provides four different functions corresponding three different distributions: gamma_t(X, , b) Gamma distribution shape parameter rate b. distribution mean \\texttt{}/\\texttt{b} variance \\(\\texttt{}/\\texttt{b}^2\\). unit_t(X, , b) Uniform distribution b. exp_t(X, r) Exponential distribution rate r. loggaus_t(X, m ,s) Log-Gaussian distribution mean logarithm m standard deviation logarithm s. code generate 1000 observations normal distribution, transform using functions provided package, shows empirical density estimated sample.  package also provide inverse functions retrieve value parameter internal scale value ETAS scale provided. example decided priors going use analysis, need store corresponding copula transformations list. list one element parameter model (\\(5\\)), element list must name corresponding parameter. names fixed mu, K, alpha, c_, p. parameter \\(c\\) referred c_ avoid clashing names R function c(). useful inverse functions also, list used set initial value parameters later. code assumes parameter \\(\\mu\\) Gamma distribution prior parameters \\(0.3\\) \\(0.6\\), parameters \\(K, \\alpha,\\) \\(c\\) Uniform prior \\((0,10)\\), parameter \\(p\\) Uniform prior \\((1,10)\\).","code":"# obtain sample from standard normal distribution X <- rnorm(1000) # apply copula transformations gamma.X <- gamma_t(X, 1, 2) unif.X <- unif_t(X, 0, 1) exp.X <- exp_t(X, 1) loggaus.X <- loggaus_t(X, 0.5, 0.5)  # build data.frame for plotting df.to.plot <- rbind(   data.frame(     value = X,     distribution = \"Std Normal\"   ),   data.frame(     value = gamma.X,     distribution = \"Gamma\"   ),   data.frame(     value = unif.X,     distribution = \"Uniform\"   ),   data.frame(     value = exp.X,     distribution = \"Exponential\"   ),   data.frame(     value = loggaus.X,     distribution = \"Log-Gaussian\"   ) ) # plot them ggplot(df.to.plot, aes(value)) +   geom_histogram() +   theme_bw() +   facet_wrap(facets = ~distribution, scales = \"free\") #> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. inv_gamma_t(gamma_t(1.2, 1, 2), 1, 2) #> [1] 1.2 inv_unif_t(unif_t(1.2, 1, 2), 1, 2) #> [1] 1.2 inv_exp_t(exp_t(1.2, 1), 1) #> [1] 1.2 inv_loggaus_t(loggaus_t(1.2, 1, 2), 1, 2) #> [1] 1.2 # set copula transformations list link.f <- list(   mu = \\(x) gamma_t(x, 0.3, 0.6),   K = \\(x) unif_t(x, 0, 10),   alpha = \\(x) unif_t(x, 0, 10),   c_ = \\(x) unif_t(x, 0, 10),   p = \\(x) unif_t(x, 1, 10) )  # set inverse copula transformations list inv.link.f <- list(   mu = \\(x) inv_gamma_t(x, 0.3, 0.6),   K = \\(x) inv_unif_t(x, 0, 10),   alpha = \\(x) inv_unif_t(x, 0, 10),   c_ = \\(x) inv_unif_t(x, 0, 10),   p = \\(x) inv_unif_t(x, 1, 10) )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"laquila-seismic-sequence","dir":"Articles","previous_headings":"","what":"LAquila seismic sequence","title":"Tutorial on real data","text":"Earthquake data stored -called earthquake catalogues. Many different catalogues exists region easy way decide one better. , provide HOmogenized instRUmental Seismic (HORUS) catalogue 1960 2020. can downloaded http://horus.bo.ingv./. subset (see data-raw/horus.R subset created) information Horus catalogue can loaded using data reports earthquake longitude (lon) latitude (lat) epicentre, moment magnitude (M), time string (time_string), depth kilometres (depth), catalogue event IDs. focus LAquila seismic sequence sufficient retain observations specific space-time-magnitude region include sequence interest. LAquila sequence, retain events magnitude greater equal \\(2.5\\) happened 2009 longitude \\((10.5, 16)\\) latitude \\((40.5, 45)\\). LAquila sequence selected way composed 1024 events. seismic sequence can selected similarly. selection convenient transform time string Date object select rows Horus catalogue verifying conditions. data can visually represented plotting time event magnitude. shows clustering observations correspondance high magnitude events. LAquila seismic sequence, times versus magnitudes","code":"# load ISIDE catalogue data(horus, package = \"ETAS.inlabru\") head(horus) #>       lon     lat    M            time_string depth catalog_id event_id #> 1 15.3000 39.3000 6.34 1960-01-03T20:19:34.00   290         -1       NA #> 2 13.1667 43.1333 3.94 1960-01-04T09:20:00.00     0         -1       NA #> 3 12.7000 46.4833 4.69 1960-01-06T15:17:34.00     4         -1       NA #> 4 12.7000 46.4667 4.14 1960-01-06T15:20:53.00     0         -1       NA #> 5 12.7500 46.4333 3.00 1960-01-06T15:31:00.00     0         -1       NA #> 6 12.7500 46.4333 3.00 1960-01-06T15:45:00.00     0         -1       NA # transform time string in Date object time_string <- gsub(\"T\", \" \", horus$time_string) horus$time_date <- as.POSIXct(time_string,   format = \"%Y-%m-%d %H:%M:%OS\" )  # set up parameters for selection start.date <- as.POSIXct(\"2009-01-01 00:00:00\", format = \"%Y-%m-%d %H:%M:%OS\") end.date <- as.POSIXct(\"2010-01-01 00:00:00\", format = \"%Y-%m-%d %H:%M:%OS\") min.longitude <- 10.5 max.longitude <- 16 min.latitude <- 40.5 max.latitude <- 45 M0 <- 2.5  # set up conditions for selection aquila.sel <- (horus$time_date >= start.date) &   (horus$time_date < end.date) &   (horus$lon >= min.longitude) &   (horus$lon <= max.longitude) &   (horus$lat >= min.latitude) &   (horus$lat <= max.latitude) &   (horus$M >= M0)  # select aquila <- horus[aquila.sel, ] ggplot(aquila, aes(time_date, M)) +   geom_point() +   theme_bw()"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"data-preparation-to-model-fitting","dir":"Articles","previous_headings":"","what":"Data preparation to model fitting","title":"Tutorial on real data","text":"need prepare data.frame used input data fit ETAS model. data.frame must three columns: ts time difference starting date occurrence time events (measured days example), magnitudes magnitude events, idx.p index column different value event. names fixed changed , need set initial values parameters list containing inlabru options used. initial values stored list elements th.mu, th.K, th.alpha, th.c, th.p corresponds ETAS parameters. initial values must provided internal scale therefore useful retrieve using inverse copula transformations set . way, can find values parameters internal scale given value parameters ETAS scale. example uses \\(\\mu = 0.5, K = 0.1, \\alpha = 1, c = 0.1,\\) \\(p = 1.1\\) initial values. crucial set initial values cause numerical problems, general achieved setting initial values zero. values provided worked well various examples. Lastly, need set list inlabru options. main elements list : bru_verbose: number indicating type diagnostic output. Set 0 output. bru_max_iter: maximum number iterations. set max_step inlabru algorithm stops stopping criterion met. However, setting max_step values smaller 1 forces algorithm run exactly bru_max_iter iterations. num.threads: number cores used parallel. bru_method: relevant , thing may need set max_step argument. algorithm converge without fixing max_step suggest try fix value 1, experience \\(0.5\\) \\(0.2\\) works well. example line setting bru_method commented. bru_initial: list initial values created .","code":"# set up data.frame for model fitting aquila.bru <- data.frame(   ts = as.numeric(difftime(aquila$time_date, start.date,     units = \"days\"   )),   magnitudes = aquila$M,   idx.p = 1:nrow(aquila) ) # set up list of initial values th.init <- list(   th.mu = inv.link.f$mu(0.5),   th.K = inv.link.f$K(0.1),   th.alpha = inv.link.f$alpha(1),   th.c = inv.link.f$c_(0.1),   th.p = inv.link.f$p(1.1) ) # set up list of bru options bru.opt.list <- list(   bru_verbose = 3, # type of visual output   bru_max_iter = 70, # maximum number of iterations   num.threads = 2, # Increase this if your computer has multiple cores   # bru_method = list(max_step = 0.5),   bru_initial = th.init ) # parameters initial values"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"model-fitting","dir":"Articles","previous_headings":"","what":"Model fitting","title":"Tutorial on real data","text":"function Temporal.ETAS fit ETAS model returns bru object output. required inputs : total.data: data.frame containing observed events. format described previous Section. M0: cutoff magnitude. events total.data must magnitude greater equal number. T1: starting time time interval want fit model. T2: end time time interval want fit model. link.functions: list copula transformation functions format described previous sections. coef.t., delta.t., N.max.: parameters temporal binning. binning strategy described Appendix B paper Approximation Bayesian Hawkes process inlabru. parameters corresponds coef.t.\\(=\\delta\\), delta.t.\\(=\\Delta\\), N.max.\\(=n_{\\max}\\). bru.opt: list inlabru options described previous Section.","code":"# set starting and time of the time interval used for model fitting. In this case, we use the interval covered by the data. T1 <- 0 T2 <- max(aquila.bru$ts) + 0.2 # fit the model aquila.fit <- Temporal.ETAS(   total.data = aquila.bru,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  2.27141"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"create-input-list","dir":"Articles","previous_headings":"","what":"Create input list","title":"Tutorial on real data","text":"model fitted package ETAS.inlabru offers various functions visually explore output. require input list. list must different elements depending function going use. retrieve posterior parameters sample posterior parameters need two elements: model.fit: output Temporal.ETAS link.functions: list copula transformations","code":"# create input list to explore model output input_list <- list(   model.fit = aquila.fit,   link.functions = link.f )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"check-marginal-posterior-distributions","dir":"Articles","previous_headings":"","what":"Check marginal posterior distributions","title":"Tutorial on real data","text":"function get_posterior_param can use retrieve marginal posteriors parameters ETAS scale. function returns list elements: post.df: data.frame containing posterior parameters. data.frame three columns, x value parameter, y corresponding value posterior, param indicates ETAS parameter x y referring . post.plot: ggplot object containing plot marginal posteriors parameters","code":"# get marginal posterior information post.list <- get_posterior_param(input.list = input_list)  # plot marginal posteriors post.list$post.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"sample-the-joint-posterior-and-make-pair-plot","dir":"Articles","previous_headings":"","what":"Sample the joint posterior and make pair plot","title":"Tutorial on real data","text":"function post_sampling generate samples joint posterior ETAS parameters. function takes input: input.list: list model.fit element link.functions elements described . n.samp: number posterior samples. max.batch: number posterior samples generated simultaneously. n.samp\\(>\\)max.batch, , samples generated parallel batches maximum size equal max.batch. Default \\(1000\\). ncore: number cores used parallel n.samp\\(>\\)max.batch. function returns data.frame columns corresponding ETAS parameters posterior samples can used analyse correlation parameters. function post_pairs_plot generate pair plot posterior samples taken input. function 4 arguments need specified. input : post.samp: data.frame samples joint posterior distribution parameters. NULL samples generated function . input.list: input list arguments model.fit link.functions used generate posterior samples. used post.samp = NULL. Default NULL. n.samp: number posterior samples. NULL, samples post.samp used. post.samp NULL, n.samp samples generated joint posterior. post.samp n.samp NULL n.samp samples randomly (uniformly replacement) selected post.samp. Default NULL max.batch number posterior samples generated simultaneously. used post.samp NULL. Default NULL function returns list two elements: post.samp posterior samples, pair.plot ggplot object containing pair plot.","code":"post.samp <- post_sampling(   input.list = input_list,   n.samp = 1000,   max.batch = 1000,   ncore = 1 )  head(post.samp) #>          mu         K    alpha          c        p #> 1 0.2878431 0.1247815 2.445897 0.06962674 1.167915 #> 2 0.2695624 0.1711480 2.404393 0.04620019 1.120986 #> 3 0.3242999 0.0767913 2.565346 0.08615021 1.187531 #> 4 0.3173505 0.1525979 2.430747 0.05423486 1.142772 #> 5 0.3050368 0.1156822 2.473772 0.07766207 1.201357 #> 6 0.3330687 0.1472780 2.492120 0.05212689 1.169099 pair.plot <- post_pairs_plot(   post.samp = post.samp,   input.list = NULL,   n.samp = NULL,   max.batch = 1000 ) #> Registered S3 method overwritten by 'GGally': #>   method from    #>   +.gg   ggplot2 pair.plot$pair.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"check-posterior-number-of-events","dir":"Articles","previous_headings":"","what":"Check posterior number of events","title":"Tutorial on real data","text":"quantity interest posterior distribution number events. can accessed using function get_posterior_N requires input list. However, list needs additional elements respect one used now. Specifically, need add T12 extremes time interval want calculate number events, M0 cutoff magnitude, catalog.bru data.frame containing observed events. latter format total.data used Temporal.ETAS function. function returns list three elements: post.plot plot distribution, post.plot.shaded plot distribution shaded regions representing \\(95\\%\\) interval distribution, post.df data.frame used generate plots. vertical line plots represent number events catalog.bru element input list.","code":"# set additional elements of the list input_list$T12 <- c(T1, T2) input_list$M0 <- M0 input_list$catalog.bru <- aquila.bru N.post <- get_posterior_N(input.list = input_list) N.post$post.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"posterior-of-the-triggering-function-and-omori-law","dir":"Articles","previous_headings":"","what":"Posterior of the triggering function and Omori law","title":"Tutorial on real data","text":"functions triggering_fun_plot triggering_fun_plot_prior plot, respectively, quantiles posterior prior distribution triggering function \\(g(t-t_h, mh)\\), namely, \\[ g(t - t_h, m_h) = K\\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] function takes input input.list: input list defined functions used previously. post.samp: data.frame samples posterior distribution parameters. NULL, n.samp samples generated posterior. n.samp: number posterior samples parameters used generated. magnitude: magnitude event (\\(m_h\\)). t.end: maximum value \\(t\\) plot. n.breaks: number breaks interval \\((0, \\texttt{t.end})\\) divided. function returns ggplot object. sample parameters triggering function \\(0\\) t.end calculated. black solid lines represents \\(95\\%\\) posterior interval function, grey lines represent triggering function calculated posterior samples, horizontal red lines represent \\(95\\%\\) posterior interval background rate \\(\\mu\\). function triggering_fun_plot_prior value parameters sampled according prior distribution rather posterior, therefore, need specify posterior samples data.frame.   functions omori_plot_posterior omori_plot_prior functions triggering_fun_plot triggering_fun_plot_prior considering \\[ \\left(\\frac{t- t_h}{c} + 1\\right)^{-p} \\] instead whole triggering function without background rate.","code":"triggering_fun_plot(   input.list = input_list,   post.samp = post.samp,   n.samp = NULL, magnitude = 4,   t.end = 5, n.breaks = 100 ) triggering_fun_plot_prior(input.list = input_list, magnitude = 4, n.samp = 1000, t.end = 10) omori_plot_posterior(input.list = input_list, post.samp = post.samp, n.samp = NULL, t.end = 5) omori_plot_prior(input.list = input_list, n.samp = 1000, t.end = 5)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"generate-synthetic-catalogues-from-model","dir":"Articles","previous_headings":"","what":"Generate synthetic catalogues from model","title":"Tutorial on real data","text":"earthquake forecast usually composed collection synthetic catalogues model. package ETAS.inlabru provides function generate synthetic catalogues given set parameters. can used produce forecasts simply produce synthetic catalogues. function generate synthetic catalogues called generate_temporal_ETAS_synthetic takes input theta: list ETAS parameters names mu, K, alpha, c, p, corresponding ETAS parameters. beta.p: parameter magnitude distribution M0: cutoff magnitude, generated event magnitude greater M0. T1: starting time catalogue (unit measure depends unit used fit model). T2: end time catalogue (unit measure depends unit used fit model). Ht: set known events. can also T1 T2, useful want generate catalogues imposed events. Regarding magnitude distribution, exponential, specificically assume \\[ m - M_0 \\sim \\text{Exp}(\\beta) \\] parameter \\(\\beta\\) usually estimated independently ETAS parameters. use maximum likelihood estimator \\(\\beta\\) given \\[ \\hat\\beta = \\frac{1}{\\bar{m} - M_0} \\] \\(\\bar m\\) mean observed magnitudes values. function returns list data.frame, element output list corresponds different generation. data.frame three columns: occurence time (ts), magnitude (magnitudes), generation identifier (gen). generation identifier uses following convention, \\(-1\\) indicates events Ht time T1 T2, \\(0\\) indicates first generation offspring events gen equal \\(-1\\), \\(1\\) indicates background events, \\(2\\) offspring events gen equal \\(0\\) \\(1\\), \\(3\\) indicates offspring events gen equal \\(2\\), \\(4\\) indicates offspring events gen equal \\(3\\), . obtain unique data.frame containing simulated events sufficient bind rows generations. example generate 1 synthetic catalogue using parameters one posterior samples generated . catalogue covers time span LAquila catalogue impose greatest event sequence.  can easily generate multiple catalogues. code generates 8 catalogues using different samples posterior distribution parameters. red point indicates event imposed last panel represents observed LAquila sequence.","code":"# maximum likelihood estimator for beta beta.p <- 1 / (mean(aquila.bru$magnitudes) - M0) synth.cat.list <- generate_temporal_ETAS_synthetic(   theta = post.samp[1, ], # ETAS parameters   beta.p = beta.p, # magnitude distribution parameter   M0 = M0, # cutoff magnitude   T1 = T1, # starting time   T2 = T2, # end time   Ht = aquila.bru[which.max(aquila.bru$magnitudes), ] # known events ) # merge into unique data.frame synth.cat.df <- do.call(rbind, synth.cat.list) # order events by time synth.cat.df <- synth.cat.df[order(synth.cat.df$ts), ]  ggplot(synth.cat.df, aes(ts, magnitudes, color = as.factor(gen))) +   geom_point(size = 0.5) set.seed(2) n.cat <- 8 # generate catalogues as list of lists multi.synth.cat.list <- lapply(seq_len(n.cat), \\(x) generate_temporal_ETAS_synthetic(   theta = post.samp[x, ],   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = aquila.bru[which.max(aquila.bru$magnitudes), ] ))  # store catalogues as list of data.frames multi.synth.cat.list.df <- lapply(multi.synth.cat.list, \\(x) do.call(rbind, x)) # set catalogue identifier multi.synth.cat.list.df <- lapply(seq_len(n.cat), \\(x) cbind(multi.synth.cat.list.df[[x]],   cat.idx = x )) # merge catalogues in unique data.frame multi.synth.cat.df <- do.call(rbind, multi.synth.cat.list.df)  # we need to bing the synthetics with the observed catalogue for plotting cat.df.for.plotting <- rbind(   multi.synth.cat.df,   cbind(aquila.bru[, c(\"ts\", \"magnitudes\")],     gen = NA,     cat.idx = \"observed\"   ) )  # plot them ggplot(cat.df.for.plotting, aes(ts, magnitudes)) +   geom_point(size = 0.5) +   geom_point(     data = aquila.bru[which.max(aquila.bru$magnitudes), ],     mapping = aes(ts, magnitudes),     color = \"red\"   ) +   facet_wrap(facets = ~cat.idx)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"forecasting","dir":"Articles","previous_headings":"","what":"Forecasting","title":"Tutorial on real data","text":"earthquake forecast usually collection synthetic catalogues generated model. bayesian models can reflect uncertainty parameters values generating synthetic catalogue composing forecast using different set parameters sampled join posterior distribution. can generate forecasts using function Temporal.ETAS.forecast. function takes input post.samp: data.frame samples posterior distribution parameters format described previous sections. n.cat: number synthetic catalogues composing forecast. n.cat greater nrow(post.samp), rows post.samp sampled uniformly replacement n.cat times. n.cat smaller nrow(post.samp), , rows post.samp sampled uniformly without replacement n.cat times. n.cat NULL equal nrow(post.samp), , post.samp used . ncore: number cores used generate synthetic catalogues parallel. remaining inputs (beta.p, M0, T1, T2, Ht) ones used generate_temporal_ETAS_synthetic. output function list two elements: fore.df n.cat. element fore.df data.frame synthetic catalogues binded together row, multi.synth.cat.df created . element n.cat just number catalogues generated. need n.cat zero-events catalogues appear fore.df, corresponding cat.idx value missing. Therefore need n.cat recover total number catalogues. code creates daily forecast 24 hours starting 1 minute event greatest magnitude sequence. starting date end date forecast expressed unit used catalogue fit model (days case). Day zero correspond start.date stated beginning document example \\(2009-01-01 00:00:00\\). forecast generated assuming known events catalogue occurred forecasting period. can easily retrieve predictive distribution number events forecasting period looking frequencies catalogue identifiers appears fore.df element. Indeed, number rows fore.df cat.idx value represents number events synthetic catalogue. , frequency catalogue identifier appears fore.df$cat.idx correspond number events catalogue. allows easily retrieve predictive distribution number events using code . remark case can use function table find frequencies elements fore.df$cat.idx. catalogue identifier zero-events catalogues present fore.df$cat.idx. using table lead zero probability zero events day, quantity crucial intersted probability earthquake activity (probability least one event).","code":"# express 1 minute in days min.in.days <- 1 / (24 * 60) # find time of the event with the greatest magnitude t.max.mag <- aquila.bru$ts[which.max(aquila.bru$magnitudes)] # set starting time of the forecasting period T1.fore <- t.max.mag + min.in.days # set forecast length fore.length <- 1 # set end time of the forecasting period T2.fore <- T1.fore + fore.length # set known data Ht.fore <- aquila.bru[aquila.bru$ts < T1.fore, ]  # produce forecast daily.fore <- Temporal.ETAS.forecast(   post.samp = post.samp, # ETAS parameters posterior samples   n.cat = nrow(post.samp), # number of synthetic catalogues   beta.p = beta.p, # magnitude distribution parameter   M0 = M0, # cutoff magnitude   T1 = T1.fore, # forecast starting time   T2 = T2.fore, # forecast end time   Ht = Ht.fore, # known events   ncore = 3 ) # number of cores # find number of events per catalogue N.fore <- vapply(   seq_len(daily.fore$n.cat),   \\(x) sum(daily.fore$fore.df$cat.idx == x), 0 ) # find number of observed events in the forecasting period N.obs <- sum(aquila.bru$ts >= T1.fore & aquila.bru$ts <= T2.fore) # plot the distribution ggplot() +   geom_histogram(aes(x = N.fore, y = after_stat(density)), binwidth = 1) +   geom_vline(xintercept = N.obs) +   xlim(100, 500) #> Warning: Removed 32 rows containing non-finite values (`stat_bin()`). #> Warning: Removed 2 rows containing missing values (`geom_bar()`)."},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Tutorial on synthetic data","text":"tutorial shows use ETAS.inlabru package generate synthetic catalogue temporal ETAS model fit ETAS model data. also show retrieve posterior distribution parameters quantity interest. brief introduction ETAS model refer tutorial real earthquake data.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"generate-a-synthetic-catalogue","dir":"Articles","previous_headings":"","what":"Generate a synthetic catalogue","title":"Tutorial on synthetic data","text":"function generate_temporal_ETAS_synthetic() can used generate synthetic catalogues temporal ETAS model fixed parameters spanning given interval time. generate_temporal_ETAS_synthetic() takes input theta: list ETAS parameters names mu, K, alpha, c, p, corresponding ETAS parameters. beta.p: parameter magnitude distribution M0: cutoff magnitude, generated event magnitude greater M0. T1: starting time catalogue (unit measure depends unit used fit model). T2: end time catalogue (unit measure depends unit used fit model). Ht: set known events. can also T1 T2, useful want generate catalogues imposed events. NULL events imposed. function returns list data.frame, element output list corresponds different generation. data.frame three columns: occurence time (ts), magnitude (magnitudes), generation identifier (gen). generation identifier uses following convention, \\(-1\\) indicates events Ht time T1 T2, \\(0\\) indicates first generation offspring events gen equal \\(-1\\), \\(1\\) indicates background events, \\(2\\) offspring events gen equal \\(0\\) \\(1\\), \\(3\\) indicates offspring events gen equal \\(2\\), \\(4\\) indicates offspring events gen equal \\(3\\), . obtain unique data.frame containing simulated events sufficient bind rows generations. code generates synthetic catalogue events magnitude greater \\(2.5\\) according temporal ETAS model parameters equal vector true.param. value parameters equal posterior mean parameters obtained fitting model LAquila seismic sequence done tutorial real data. Also parameter \\(\\beta\\) magnitude distribution comes example. output function list data.frames convenient transform single data.frame binding rows data.frames list. synthetic catalogue composed total \\(288\\) events \\(112\\) background events \\(176\\) aftershocks. can easily retrieve numbers looking gen column data. code plot occurrence time events magnitude color indicating generation event time evolution cumulative number events. multiplot function provided inlabru R-package can used combine plots.","code":"set.seed(111) # set true ETAS parameters true.param <- list(mu = 0.30106014, K = 0.13611399, alpha = 2.43945301, c = 0.07098607, p = 1.17838741) # set magnitude distribution parameter beta.p <- 2.353157 # set cutoff magnitude M0 <- 2.5 # set starting time of the synthetic catalogue T1 <- 0 # set end time of the synthetic catalogue T2 <- 365 # generate the catalogue - it returns a list of data.frames synth.cat.list <- generate_temporal_ETAS_synthetic(   theta = true.param,   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = NULL,   ncore = 1 ) synth.cat.df <- do.call(rbind, synth.cat.list) head(synth.cat.df) #>           ts magnitudes gen #> 1 135.204031   2.661688   1 #> 2 187.947198   2.632073   1 #> 3 137.847074   3.073890   1 #> 4 152.693124   2.653628   1 #> 5   3.890113   2.686633   1 #> 6 194.287763   3.035756   1 c(N = nrow(synth.cat.df), N.bkg = sum(synth.cat.df$gen == 1), N.after = sum(synth.cat.df$gen > 1)) #>       N   N.bkg N.after  #>     288     112     176 pl1 <- ggplot(synth.cat.df, aes(ts, magnitudes, color = as.factor(gen))) +   geom_point() +   labs(color = \"gen\")  t.breaks <- T1:T2 N.cumsum <- vapply(t.breaks, \\(x) sum(synth.cat.df$ts < x), 0) df.to.cumsum.plot <- data.frame(ts = t.breaks, N.cum = N.cumsum) pl2 <- ggplot(df.to.cumsum.plot, aes(ts, N.cum)) +   geom_line() +   ylab(\"cumulative number of events\")  inlabru::multiplot(pl1, pl2, cols = 2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"prepare-data-for-model-fitting","dir":"Articles","previous_headings":"","what":"Prepare data for model fitting","title":"Tutorial on synthetic data","text":"order fit model synthetic catalogue need set parameters priors set initial value parameters set inlabru options prepare data model fitting set priors need create list copula transformation (simply link) functions. method works internal representation parameters parameter Gaussian distribution. need function transform parameters original ETAS scale set prior . ETAS.inlabru package offers four different functions corresponding four different prior distributions. functions gamma_t, unif_t, exp_t, loggaus_t corresponds Gamma distribution, Uniform distribution, Exponential distribution Log-Gaussian distribution. also provide inverse functions retrieve value parameters internal scale given value ETAS scale. inv_gamma_t, inv_unif_t, exp_t, inv_loggaus_t. example going consider following priors parameters \\[\\begin{align*} \\mu & \\sim \\Gamma(0.3, 0.6) \\\\ K & \\sim \\text{Unif}(0,10) \\\\ \\alpha & \\sim \\text{Unif}(0,10) \\\\ c & \\sim \\text{Unif}(0,10) \\\\ p & \\sim \\text{Unif}(1,10) \\end{align*}\\] list link functions corresponding priors initial value parameters inlabru algorithm must specified internal scale parameters. reason, useful create list inverse link functions can specify initial value parameters ETAS scale easily retrieve corresponding value parameters internal scale. can done shown initial value parameters specified list names th.mu, th.K, th.alpha, th.c, th.p, , example, th.mu corresponds initial value parameter \\(\\mu\\) internal scale. initial value parameters important ensure algorithm able converge. Indeed, start algorithm values parameters causing numerical problems, may prevent algorithm converge. experience, setting initial values parameter (e.g.\\(< 10^{-5}\\)) (e.g.\\(> 10^2\\)) safe choice. code uses following initial values parameters \\(\\mu_{\\text{init}} = 0.5, K_{\\text{init}} = 0.1, \\alpha_{\\text{init}} = 1, c_{\\text{init}} = 0.1, p_{\\text{init}} = 1.1\\) Also inlabru options provided list, main elements list : bru_verbose: number indicating type visual output. Set 0 output. bru_max_iter: maximum number iterations. set max_step inlabru algorithm stops stopping criterion met. However, setting max_step values smaller 1 forces algorithm run exactly bru_max_iter iterations. bru_method: relevant , thing may need set max_step argument. algorithm converge without fixing max_step suggest try fix value 1, experience \\(0.5\\) \\(0.2\\) works well. example line setting bru_method commented. bru_initial: list initial values created . Lastly, need prepare data model fitting. data must provided data.frame least 3 columns names ts corresponding occurrence time events, magnitudes corresponding magnitude, idx.p event identifier. events data.frame must sorted respect occurrence time. synthetic catalogue generated beginning already columns ts magnitudes, sorted generation time. code sort rows data.frame adds event identifier","code":"# set copula transformations list link.f <- list(   mu = \\(x) gamma_t(x, 0.3, 0.6),   K = \\(x) unif_t(x, 0, 10),   alpha = \\(x) unif_t(x, 0, 10),   c_ = \\(x) unif_t(x, 0, 10),   p = \\(x) unif_t(x, 1, 10) ) # set inverse copula transformations list inv.link.f <- list(   mu = \\(x) inv_gamma_t(x, 0.3, 0.6),   K = \\(x) inv_unif_t(x, 0, 10),   alpha = \\(x) inv_unif_t(x, 0, 10),   c_ = \\(x) inv_unif_t(x, 0, 10),   p = \\(x) inv_unif_t(x, 1, 10) ) # set up list of initial values th.init <- list(   th.mu = inv.link.f$mu(0.5),   th.K = inv.link.f$K(0.1),   th.alpha = inv.link.f$alpha(1),   th.c = inv.link.f$c_(0.1),   th.p = inv.link.f$p(1.1) ) # set up list of bru options bru.opt.list <- list(   bru_verbose = 3, # type of visual output   bru_max_iter = 70, # maximum number of iterations   # bru_method = list(max_step = 0.5),   bru_initial = th.init ) # parameters initial values # sort catalogue by occurrence time synth.cat.df <- synth.cat.df[order(synth.cat.df$ts), ] # add event identifier synth.cat.df$idx.p <- seq_len(nrow(synth.cat.df))"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"model-fitting","dir":"Articles","previous_headings":"","what":"Model Fitting","title":"Tutorial on synthetic data","text":"function Temporal.ETAS fit ETAS model returns bru object output. required inputs : total.data: data.frame containing observed events. format described previous Section. M0: cutoff magnitude. events total.data must magnitude greater equal number. T1: starting time time interval want fit model. T2: end time time interval want fit model. link.functions: list copula transformation functions format described previous sections. coef.t., delta.t., N.max.: parameters temporal binning. binning strategy described Appendix B paper Approximation Bayesian Hawkes process inlabru. parameters corresponds coef.t.\\(=\\delta\\), delta.t.\\(=\\Delta\\), N.max.\\(=n_{\\max}\\). bru.opt: list inlabru options described previous Section.","code":"synth.fit <- Temporal.ETAS(   total.data = synth.cat.df,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  0.5742245"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"check-marginal-posterior-distributions","dir":"Articles","previous_headings":"","what":"Check marginal posterior distributions","title":"Tutorial on synthetic data","text":"order retrieve marginal posterior distributions parameter need provide list containing two elements: model.fit bru object containing fitted model, link.functions list link functions created . list created, function get_posterior_param returns marginal posterior distribution parameters ETAS scale. function returns list two elements: post.df data.frame three columns, x indicating value parameter, y indicating corresponding value marginal posterior distribution, param parameter identifier. output list also contains post.plot ggplot object containing plot marginal posterior distributions parameter. code retrieve marginal posterior distribution parameters plot along true value parameters represented vertical dashed lines.","code":"# create input list to explore model output input_list <- list(   model.fit = synth.fit,   link.functions = link.f ) # retrieve marginal posterior distributions post.list <- get_posterior_param(input.list = input_list)  # create data.frame of true value of parameters df.true.param <- data.frame(   x = unlist(true.param),   param = names(true.param) ) # add to the marginal posterior distribution of the parameters the true value of the parameters. post.list$post.plot +   geom_vline(     data = df.true.param,     mapping = aes(xintercept = x), linetype = 2   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"sampling-the-joint-posterior-distribution","dir":"Articles","previous_headings":"","what":"Sampling the joint posterior distribution","title":"Tutorial on synthetic data","text":"function post_sampling generate samples joint posterior ETAS parameters. function takes input: input.list: list model.fit element link.functions elements described . n.samp: number posterior samples. max.batch: number posterior samples generated simultaneously. n.samp\\(>\\)max.batch, , samples generated parallel batches maximum size equal max.batch. Default \\(1000\\). ncore: number cores used parallel n.samp\\(>\\)max.batch. function returns data.frame columns corresponding ETAS parameters posterior samples can used estimate posterior distribution functions parameters.","code":"post.samp <- post_sampling(   input.list = input_list,   n.samp = 1000,   max.batch = 1000,   ncore = 1 ) head(post.samp) #>          mu          K    alpha         c        p #> 1 0.2790974 0.02189279 2.726641 0.3877238 1.421399 #> 2 0.3404774 0.05984857 2.408840 0.2094975 1.262960 #> 3 0.3391051 0.05514446 2.565456 0.1761669 1.312291 #> 4 0.3551220 0.02641285 2.471338 0.7081336 1.593562 #> 5 0.3434043 0.05332829 2.527373 0.2503940 1.365725 #> 6 0.3582565 0.04774075 2.512326 0.1799058 1.230140"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"triggering-function-and-omori-law","dir":"Articles","previous_headings":"","what":"Triggering function and Omori law","title":"Tutorial on synthetic data","text":"Interesting functions parameters triggering function Omori law. can estimate posterior distribution functions using samples joint posterior distribution parameters obtained previous section. functions triggering_fun_plot provides plot quantiles posterior distribution triggering function \\(g(t-t_h, mh)\\), namely, \\[ g(t - t_h, m_h) = K\\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] function takes input input.list: input list defined functions used previously. post.samp: data.frame samples posterior distribution parameters. NULL, n.samp samples generated posterior. n.samp: number posterior samples parameters used generated. magnitude: magnitude event (\\(m_h\\)). t.end: maximum value \\(t\\) plot. n.breaks: number breaks interval \\((0, \\texttt{t.end})\\) divided. function returns ggplot object. sample parameters triggering function \\(0\\) t.end calculated. black solid lines represents \\(95\\%\\) posterior interval function, grey lines represent triggering function calculated posterior samples, horizontal red lines represent \\(95\\%\\) posterior interval background rate \\(\\mu\\). function triggering_plot_prior using parameters sampled priors parameters. code creates plot posterior triggering function adds triggering function calculated true parameter values blue. need add argument M0 input_list use function triggering_fun_plot.  functions omori_plot_posterior function triggering_fun_plot considering \\[ \\left(\\frac{t- t_h}{c} + 1\\right)^{-p} \\] instead whole triggering function without background rate.","code":"# add cutoff magnitude to input_list input_list$M0 <- M0  # generate triggering function plot trig.plot <- triggering_fun_plot(   input.list = input_list,   post.samp = post.samp,   n.samp = NULL, magnitude = 4,   t.end = 5, n.breaks = 100 )  # set times at which calculate the true triggering function t.breaks <- seq(1e-6, 5, length.out = 100) # calculate the function true.trig <- gt(unlist(true.param), t = t.breaks, th = 0, mh = 4, M0 = M0) # store in data.frame for plotting true.trig.df <- data.frame(ts = t.breaks, trig.fun = true.trig)  # add the true triggering function to the plot trig.plot +   geom_line(     data = true.trig.df,     mapping = aes(x = ts, y = trig.fun), color = \"blue\"   ) omori.plot <- omori_plot_posterior(input.list = input_list, post.samp = post.samp, n.samp = NULL, t.end = 5)  true.omori <- omori(theta = unlist(true.param), t = t.breaks, ti = 0) true.omori.df <- data.frame(ts = t.breaks, omori.fun = true.omori)  omori.plot +   geom_line(     data = true.omori.df,     mapping = aes(x = ts, y = omori.fun), color = \"blue\"   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"comparison-between-different-fitted-models","dir":"Articles","previous_headings":"","what":"Comparison between different fitted models","title":"Tutorial on synthetic data","text":"interesting fit model multiple synthetic catalogues compare parameters posterior distributions obtained different catalogues. section, going generate second synthetic catalogue, fit model, compare posterior distributions ones obtained . second catalogue impose large event magnitude \\(6\\) happening midpoint time interval. first step set data.frame known events generate second synthetic catalogue Counting number background events aftershocks case slightly different . fact, count imposed event background event, aftershocks need include also event gen = 0 ones induced imposed event case 192. comparison number events two catalogues. Notice background events roughly expected given time interval . , just need set data.frame model fitting. inputs can use ones created first model fit. Now, extract marginal posterior distributions, need create input_list second model fit. Now, can retrieve marginal posterior distributions provided model fitted second catalogue compare ones obtained .  process shown can extended multiple (\\(>2\\)) input catalogues order study parameters identifiable. Also, using characteristics input catalogue catalogue identifier can study change posterior distribution characteristic input catalogue changes. interesting example number events catalogue, studying marginal posterior distributions change increase decrease number events.","code":"# set up data.frame of imposed events Ht.imposed <- data.frame(   ts = mean(c(T1, T2)),   magnitudes = 6 ) # generate second catalogue set.seed(1) synth.cat.list.2 <- generate_temporal_ETAS_synthetic(   theta = true.param,   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = Ht.imposed,   ncore = 1 ) # transform it in a data.frame synth.cat.df.2 <- do.call(rbind, synth.cat.list.2) sum(synth.cat.df.2$gen == 0) #> [1] 192 rbind(   first = c(     N = nrow(synth.cat.df),     N.bkg = sum(synth.cat.df$gen == 1),     N.after = sum(synth.cat.df$gen > 1)   ),   second = c(     N = nrow(synth.cat.df.2),     N.bkg = sum(synth.cat.df.2$gen == 1 | synth.cat.df.2$gen == -1),     N.after = sum(synth.cat.df.2$gen > 1 | synth.cat.df.2$gen == 0)   ) ) #>          N N.bkg N.after #> first  288   112     176 #> second 408   104     304 synth.cat.df.2 <- synth.cat.df.2[order(synth.cat.df.2$ts), ] synth.cat.df.2$idx.p <- seq_len(nrow(synth.cat.df.2))  synth.fit.2 <- Temporal.ETAS(   total.data = synth.cat.df.2,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  1.029788 input_list.2 <- list(   model.fit = synth.fit.2,   link.functions = link.f ) # retrieve marginal posterior distributions post.list.2 <- get_posterior_param(input.list = input_list.2)  # set model identifier post.list$post.df$cat.used <- \"first catalogue\" post.list.2$post.df$cat.used <- \"second catalogue\"  # bind marginal posterior data.frames bind.post.df <- rbind(post.list$post.df, post.list.2$post.df)  # plot them ggplot(bind.post.df, aes(x = x, y = y, color = cat.used)) +   geom_line() +   facet_wrap(facets = ~param, scales = \"free\") +   xlab(\"param\") +   ylab(\"pdf\") +   geom_vline(     data = df.true.param,     mapping = aes(xintercept = x), linetype = 2   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Francesco Serafini. Author, maintainer. Mark Naylor. Author, thesis advisor. Finn Lindgren. Author, thesis advisor.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Mark Naylor, & Francesco Serafini (2023). edinburgh-seismicity-hub/ETAS.inlabru: Temporal Hawkes (v1.0.1).  Zenodo. https://doi.org/10.5281/zenodo.7515785 Mark Naylor, Francesco Serafini, Finn Lindgren (2023). doi:10.3389/fams.2023.1126759, https://www.frontiersin.org/articles/10.3389/fams.2023.1126759 Francesco Serafini, Finn Lindgren, Mark Naylor (2023). doi:10.1002/env.2798, https://onlinelibrary.wiley.com/doi/abs/10.1002/env.2798","code":"@Misc{,   title = {edinburgh-seismicity-hub/ETAS.inlabru: Temporal Hawkes},   author = {Mark Naylor and Francesco Serafini},   publisher = {Zenodo},   year = {2023},   number = {v1.0.1},   url = {https://doi.org/10.5281/zenodo.7515785},   doi = {10.5281/zenodo.7515785}, } @Article{,   title = {Bayesian modelling of the temporal evolution of seismicity using the ETAS.inlabru R-package},   author = {Mark Naylor and Francesco Serafini and Finn Lindgren},   journal = {Frontiers in Applied Mathematics and Statistics},   year = {2023},   doi = {10.3389/fams.2023.1126759},   url = {https://www.frontiersin.org/articles/10.3389/fams.2023.1126759}, } @Article{,   title = {Approximation of Bayesian Hawkes process with inlabru},   author = {{Serafini} and {Francesco} and {Lindgren} and {Finn} and {Naylor} and {Mark}},   journal = {Environmetrics},   year = {2023},   doi = {10.1002/env.2798},   url = {https://onlinelibrary.wiley.com/doi/abs/10.1002/env.2798}, }"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"etasinlabru","dir":"","previous_headings":"","what":"Bayesian ETAS model for modelling seismic sequences with inlabru","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"R package implements ETAS Hawkes process modelling seismicity Online documentation: https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"authors","dir":"","previous_headings":"","what":"Authors","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Francesco Serafini Dr Mark Naylor, School GeoSciences, University Edinburgh Prof Finn Lindgren, School Mathematics, University Edinburgh Dr Kirsty Bayliss, Global Earthquake Model (GEM)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"ETAS.inlabru work, need install R-INLA inlabru: inlabru (see https://inlabru-org.github.io/inlabru/): CRAN release, development version, R-INLA (see https://www.r-inla.org/download-install): can install development version ETAS.inlabru GitHub ","code":"install.packages(\"inlabru\") # install.packages(\"remotes\") remotes::install_github(\"inlabru-org/inlabru\") install.packages(   \"INLA\",   repos = c(getOption(\"repos\"), INLA=\"https://inla.r-inla-download.org/R/testing\"),   dep = TRUE ) # install.packages(\"remotes\") remotes::install_github(\"edinburgh-seismicity-hub/ETAS.inlabru\")"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"file-structure-in-package","dir":"","previous_headings":"Terminology and planning suggestions","what":"File structure in package","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"ETAS.triggering.function.R : Contains ETAS specific model functions HawkesProcess.R : Generic Hawkes code intended integration back inlabru generateSyntheticCatalogues.R : Contains iterative Hawkes functions generating triggered events actual triggering functions reside ETAS file introduce models temporalBinning.R : Code generate time bins make integration scheme efficient plottingFunctions.R : lets put standard plotting functions setupInlabruInputs.R : Put functions generating input.list ","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"terminology","dir":"","previous_headings":"","what":"Terminology","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Lets specific just temporal clear function names spatial spatial-temporal later Might anything bad? tried modify just theta","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"implemented","dir":"","previous_headings":"","what":"Implemented","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Generation synthetic ETAS catalogues ETAS.inlabru demonstration notebook","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"in-development","dir":"","previous_headings":"","what":"In development","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Add inversion modelling based original code Modify implementation generic Hawkes code can go inlabru ETAS triggering function code stay package","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"roadmap","dir":"","previous_headings":"","what":"Roadmap","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Implement incompleteness fix Implement pre-model domain history Integrate spatial modelling","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/ETAS.inlabru-package.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru  ETAS.inlabru-package","title":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru  ETAS.inlabru-package","text":"Modelling inversion ETAS model seismicity using inlabru Epidemic Type Aftershock Sequence (ETAS) model designed model earthquakes triggered previous events. statistics, referred Hawkes process. code can used generate synthetic ETAS catalogues can also include seeded events model specific sequences. also implement Bayesian inversion scheme using Integrated Nested Laplace Approximation (INLA) using inlabru. temporal model, given training catalogue times magnitudes, code returns joint posteriors ETAS parameters. future roadmap, include tools model spatial distribution spatio-temporal evolution seismic sequences.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/ETAS.inlabru-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru  ETAS.inlabru-package","text":"Maintainer: Francesco Serafini francesco.serafini@newcastle.ac.uk (ORCID) Authors: Mark Naylor mark.naylor@ed.ac.uk (ORCID) [thesis advisor] Finn Lindgren Finn.Lindgren@ed.ac.uk (ORCID) [thesis advisor]","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":null,"dir":"Reference","previous_headings":"","what":"Injection Rate function calculations  IntInjectionIntensity","title":"Injection Rate function calculations  IntInjectionIntensity","text":"Forward time integrated function exponential rate decay, inverse","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Injection Rate function calculations  IntInjectionIntensity","text":"","code":"IntInjectionIntensity(a = 50, V.i = 1, tau = 10, T.i, T2)  Inv_IntInjectionIntensity(   a = 50,   V.i = 1,   tau = 10,   T.i,   number.injected.events )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Injection Rate function calculations  IntInjectionIntensity","text":"Event rate per unit volume injected V.Injected volume tau Decay rate [days] T.Time injection event T2 End temporal model domain number.injected.events number expected injected events, used inverse.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Injection Rate function calculations  IntInjectionIntensity","text":"IntInjectionIntensity returns forward time integrated function exponential rate decay. Inv_IntInjectionIntensity returns end time corresponding given expected number injected events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":null,"dir":"Reference","previous_headings":"","what":"Integrated Omori's law  Int_ETAS_time_trig_function","title":"Integrated Omori's law  Int_ETAS_time_trig_function","text":"Integrated Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Integrated Omori's law  Int_ETAS_time_trig_function","text":"","code":"Int_ETAS_time_trig_function(theta, th, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Integrated Omori's law  Int_ETAS_time_trig_function","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p) th Time past event [days] start temporal domain, vector. T2 End temporal domain, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Integrated Omori's law  Int_ETAS_time_trig_function","text":"Value integral Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Integrated Omori's law  Int_ETAS_time_trig_function","text":"function returns integral Omori's law, namely $$\\int_{t_h}^{T_2} \\left(\\frac{t - t_h}{c} + 1\\right)^{-p} dt$$","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse of integrated Omori's law  Inv_Int_ETAS_time_trig_function","title":"Inverse of integrated Omori's law  Inv_Int_ETAS_time_trig_function","text":"Inverse integrated Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse of integrated Omori's law  Inv_Int_ETAS_time_trig_function","text":"","code":"Inv_Int_ETAS_time_trig_function(theta, omega, th)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse of integrated Omori's law  Inv_Int_ETAS_time_trig_function","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p) omega Value integral inverted, vector th Time integral calculated scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inverse of integrated Omori's law  Inv_Int_ETAS_time_trig_function","text":"Value start temporal domain used calculate integral","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Inverse of integrated Omori's law  Inv_Int_ETAS_time_trig_function","text":"Considering integral Omori's law $$\\omega = \\int_{t_h}^{T_2}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} dt$$ function applied value \\(\\omega\\) returns value \\(t_h\\).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to calculate the integral of Omori's law  It_df","title":"Function to calculate the integral of Omori's law  It_df","text":"Function calculate integral Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to calculate the integral of Omori's law  It_df","text":"","code":"It_df(param_, time.df)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to calculate the integral of Omori's law  It_df","text":"param_ ETAS parameters vector (\\(\\mu, K, \\alpha, c, p\\)), \\(c, p\\) used. time.df output function time_grid()","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to calculate the integral of Omori's law  It_df","text":"vector integral values bin provided time.df","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function.  Temporal.ETAS.fit","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function.  Temporal.ETAS.fit","text":"Fits remporal ETAS model returns results. function decomposes input.list `Hawkes.bru2`` function.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function.  Temporal.ETAS.fit","text":"","code":"Temporal.ETAS.fit(input.list)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function.  Temporal.ETAS.fit","text":"input.list input data parameters passed inlabru via structured list. output function create_input_list_temporal_withCatalogue create_input_list_temporal_noCatalogue","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function.  Temporal.ETAS.fit","text":"fitted model bru object, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":null,"dir":"Reference","previous_headings":"","what":"Title  Temporal.ETAS.forecast","title":"Title  Temporal.ETAS.forecast","text":"Title","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title  Temporal.ETAS.forecast","text":"","code":"Temporal.ETAS.forecast(post.samp, n.cat, beta.p, M0, T1, T2, Ht, ncore = 1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title  Temporal.ETAS.forecast","text":"post.samp data.frame containing samples posterior distribution ETAS parameters. row data.frame corresponds different sample parameters order \\(\\mu\\), \\(K\\), \\(\\alpha\\), \\(c\\), \\(p\\). n.cat number synthetic catalogues composing forecast. n.cat greater nrow(post.samp), , n.cat rows sampled uniformly replacement post.samp. n.cat smaller nrow(post.samp), , n.cat rows sampled uniformly without replacement post.samp. n.cat NULL equal nrow(post.samp), post.samp used nrow(post.samp) catalogues generated. beta.p parameter magnitude distribution M0 cutoff magnitude, synthetic events magnitude greater value. T1 starting time forecast T2 end time forecast Ht set known events ncore number cores used generate synthetic catalogues parallel.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title  Temporal.ETAS.forecast","text":"list two elements: fore.df data.frame containing synthetic catalogues composing forecast. data.frame four columns, ts occurrence time, magnitudes magnitude, gen generation event, cat.idx catalogue identifier second element output list n.cat number synthetic catalogues generated.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to fit Hawkes process model  Temporal.ETAS","title":"Function to fit Hawkes process model  Temporal.ETAS","text":"function fit temporal ETAS model using inlabru.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to fit Hawkes process model  Temporal.ETAS","text":"","code":"Temporal.ETAS(   total.data,   M0,   T1,   T2,   link.functions = NULL,   coef.t.,   delta.t.,   N.max.,   bru.opt )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to fit Hawkes process model  Temporal.ETAS","text":"total.data Observed events: data.frame columns time (ts), magnitude (magnitudes), event identifier (idx.p). Column names must changed. M0 Minimum magnitude threshold, scalar T1 Start temporal model domain, scalar [measure unit sample.s$ts]. T2 End temporal model domain, scalar [measure unit sample.s$ts]. link.functions Functions transform parameters internal INLA scale ETAS scale. must list functions names (mu, K, alpha, c_, p) coef.t. TimeBinning parameter: parameter regulating relative length successive bins, scalar. delta.t. TimeBinning parameter: parameter regulating bins' width, scalar. N.max. TimeBinning parameter: parameter regulating Number bins (= N.max + 2), scalar. bru.opt Runtime options inlabru: See https://inlabru-org.github.io/inlabru/reference/bru_call_options.html, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to fit Hawkes process model  Temporal.ETAS","text":"fitted model 'bru' object, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":null,"dir":"Reference","previous_headings":"","what":"Find breaks point for 1D grid  breaks_exp","title":"Find breaks point for 1D grid  breaks_exp","text":"breaks_exp return breaks points one dimensional grid depending three parameters, see details","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find breaks point for 1D grid  breaks_exp","text":"","code":"breaks_exp(start.grid, end.grid, coef.t = 2, delta.t, N.exp. = 10)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find breaks point for 1D grid  breaks_exp","text":"start.grid Starting point grid, scalar. end.grid End point grid, scalar. coef.t TimeBinning parameter: \\(\\delta > 0\\) determines relative length subsequent intervals, scalar. delta.t TimeBinning parameter: \\(\\Delta > 0\\) determines length intervals, scalar. N.exp. TimeBinning parameter: \\(n_{max} >0\\) determines maximum number intervals, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find breaks point for 1D grid  breaks_exp","text":"vector containing grid points","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Find breaks point for 1D grid  breaks_exp","text":"grid calculated follows $$t, t + \\Delta, t + \\Delta(1 + \\delta), t + \\Delta(1 + \\delta)^2,...., T$$ \\(t\\) start.grid argument, \\(T\\) end.grid argument, \\(n_{max}\\) maximum value exponent","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find breaks point for 1D grid  breaks_exp","text":"","code":"breaks_exp(start.grid = 1, end.grid = 100, coef.t = 1, delta.t = 1, N.exp. = 3) #> [1]   1   2   3   5   9 100 breaks_exp(start.grid = 1, end.grid = 100, coef.t = 1, delta.t = 1, N.exp. = 10) #> [1]   1   2   3   5   9  17  33  65 100"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to compute the integral of Omori's law efficiently  compute_grid","title":"Function to compute the integral of Omori's law efficiently  compute_grid","text":"Function compute integral Omori's law efficiently","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to compute the integral of Omori's law efficiently  compute_grid","text":"","code":"compute_grid(param., list.input_)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to compute the integral of Omori's law efficiently  compute_grid","text":"param. ETAS parameters vector (\\(\\mu, K, \\alpha, c, p\\)), \\(c, p\\) used. list.input_ list containing information calculate integrals efficiently. list created inside Temporal.ETAS function Two elements used time.sel selection rows output time_grid unique t.ref_layer value, data.frame. Imapping mapper unique names provided time.sel original rows output time_grid(), vector.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to compute the integral of Omori's law efficiently  compute_grid","text":"vector length list.input_$Imapping integral Omori's law bin.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS conditional intensity - used by inlabru  cond_lambda","title":"ETAS conditional intensity - used by inlabru  cond_lambda","text":"Function calculate value ETAS model conditional intensity specified time given history process.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ETAS conditional intensity - used by inlabru  cond_lambda","text":"","code":"cond_lambda(theta, t, th, mh, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ETAS conditional intensity - used by inlabru  cond_lambda","text":"theta ETAS parameters list names mu, K, alpha, c, p t Time conditional intensity evaluated, scalar th Time events history process, vector mh Magnitudes events history process, vector M0 Minimum magnitude threshold","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ETAS conditional intensity - used by inlabru  cond_lambda","text":"Value ETAS conditional intensity calculated t history th, mh, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ETAS conditional intensity - used by inlabru  cond_lambda","text":"function takes single value t returns ETAS conditional intensity calculated t history th, mh. ETAS conditional intensity given $$\\lambda(t | \\mathcal H_t) = \\mu + \\sum_{h: (t_h,m_h) \\\\mathcal H_t} K e^{\\alpha(m_h - M_0)} \\left( \\frac{t - t_h}{c} + 1\\right)^{-p}$$ use t vector.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file  create_input_list_temporal_noCatalogue","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file  create_input_list_temporal_noCatalogue","text":"Function create default input list ETAS Hawkes temporal model catalogue specified input file","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file  create_input_list_temporal_noCatalogue","text":"","code":"create_input_list_temporal_noCatalogue(input_path, num.threads = NULL)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file  create_input_list_temporal_noCatalogue","text":"input_path Input file path string num.threads Optional argument number threads used parallel processing","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file  create_input_list_temporal_noCatalogue","text":"formatted input.list elements required temporal Hawkes model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file  create_input_list_temporal_noCatalogue","text":"","code":"create_input_list_temporal_noCatalogue(   system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\") ) #> $catalog #> NULL #>  #> $catalog.bru #> NULL #>  #> $time.int #> NULL #>  #> $T12 #> [1] \"T1\"  \" T2\" #>  #> $lat.int #> [1] -90  90 #>  #> $lon.int #> [1] -180  180 #>  #> $M0 #> NULL #>  #> $mu.init #> [1] 0.25 #>  #> $K.init #> [1] 0.3 #>  #> $alpha.init #> [1] 1.6 #>  #> $c.init #> [1] 0.2 #>  #> $p.init #> [1] 1.1 #>  #> $a_mu #> [1] 0.5 #>  #> $b_mu #> [1] 0.5 #>  #> $a_K #> [1] -1 #>  #> $b_K #> [1] 0.5 #>  #> $a_alpha #> [1] 0 #>  #> $b_alpha #> [1] 10 #>  #> $a_c #> [1] 0 #>  #> $b_c #> [1] 1 #>  #> $a_p #> [1] 1 #>  #> $b_p #> [1] 2 #>  #> $max_iter #> [1] 100 #>  #> $max_step #> NULL #>  #> $link.functions #> $link.functions$mu #> function (x)  #> gamma_t(x, a_mu, b_mu) #> <bytecode: 0x5567fd013078> #> <environment: 0x5567fd011a98> #>  #> $link.functions$K #> function (x)  #> loggaus_t(x, a_K, b_K) #> <bytecode: 0x5567fd012da0> #> <environment: 0x5567fd011a98> #>  #> $link.functions$alpha #> function (x)  #> unif_t(x, a_alpha, b_alpha) #> <bytecode: 0x5567fd012ac8> #> <environment: 0x5567fd011a98> #>  #> $link.functions$c_ #> function (x)  #> unif_t(x, a_c, b_c) #> <bytecode: 0x5567fd0127f0> #> <environment: 0x5567fd011a98> #>  #> $link.functions$p #> function (x)  #> unif_t(x, a_p, b_p) #> <bytecode: 0x5567fd012518> #> <environment: 0x5567fd011a98> #>  #>  #> $bru.opt.list #> $bru.opt.list$bru_verbose #> [1] 3 #>  #> $bru.opt.list$bru_max_iter #> [1] 100 #>  #> $bru.opt.list$num.threads #> NULL #>  #> $bru.opt.list$bru_initial #> $bru.opt.list$bru_initial$th.mu #> [1] -0.2978078 #>  #> $bru.opt.list$bru_initial$th.K #> [1] -0.4079456 #>  #> $bru.opt.list$bru_initial$th.alpha #> [1] -0.9944579 #>  #> $bru.opt.list$bru_initial$th.c #> [1] -0.8416212 #>  #> $bru.opt.list$bru_initial$th.p #> [1] -1.281552 #>  #>  #>  #> $coef.t #> [1] 1 #>  #> $delta.t #> [1] 0.1 #>  #> $Nmax #> [1] 8 #>  #> $n.periods #> [1] 120 #>  #> $period.length #> [1] 1 #>  #> $start.date.fore #> NULL #>  #> $magnitude.update #> [1] 5.5 #>  #> $output.name #> [1] \"report_ETAS\" #>"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file.  create_input_list_temporal_withCatalogue","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file.  create_input_list_temporal_withCatalogue","text":"Function create default input file ETAS Hawkes temporal model catalogue specified input file.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file.  create_input_list_temporal_withCatalogue","text":"","code":"create_input_list_temporal_withCatalogue(input_path, num.threads = NULL)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file.  create_input_list_temporal_withCatalogue","text":"input_path path txt file containing experiment's information num.threads Optional argument number threads used parallel processing","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file.  create_input_list_temporal_withCatalogue","text":"formatted input.list elements required temporal Hawkes model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to an Exponential distribution  exp_t","title":"Copula transformation from a standard Normal distribution to an Exponential distribution  exp_t","text":"Copula transformation standard Normal distribution Exponential distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to an Exponential distribution  exp_t","text":"","code":"exp_t(x, r)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to an Exponential distribution  exp_t","text":"x values standard Normal distribution, vector. r rate exponential distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to an Exponential distribution  exp_t","text":"values Exponential distribution rate r, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Gamma distribution  gamma_t","title":"Copula transformation from a standard Normal distribution to a Gamma distribution  gamma_t","text":"Copula transformation standard Normal distribution Gamma distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Gamma distribution  gamma_t","text":"","code":"gamma_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Gamma distribution  gamma_t","text":"x values standard Normal distribution, vector. shape parameter gamma distribution scalar. b rate parameter gamma distribution scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Gamma distribution  gamma_t","text":"values Gamma distribution shape rate b, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":null,"dir":"Reference","previous_headings":"","what":"Generates a synthetic catalogue using the ETAS model  generate_temporal_ETAS_synthetic","title":"Generates a synthetic catalogue using the ETAS model  generate_temporal_ETAS_synthetic","text":"Generates synthetic catalogue using ETAS model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generates a synthetic catalogue using the ETAS model  generate_temporal_ETAS_synthetic","text":"","code":"generate_temporal_ETAS_synthetic(   theta,   beta.p,   M0,   T1,   T2,   Ht = NULL,   ncore = 1 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generates a synthetic catalogue using the ETAS model  generate_temporal_ETAS_synthetic","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). M0 minimum magnitude synthetic catalogue. T1 start time synthetic catalogue [days]. T2 end time synthetic catalogue [days]. Ht catalogue history impose synthetic sequence. ncore Integer number compute cores use.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generates a synthetic catalogue using the ETAS model  generate_temporal_ETAS_synthetic","text":"data.frame temporal catalogue columns [t_i, M_i, gen_i] , t_i times,  M_i magnitudes, gen_i includes information generation number","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generates a synthetic catalogue using the ETAS model  generate_temporal_ETAS_synthetic","text":"","code":"## EXAMPLE 1: Generate a 1000 day synthetic ETAS catalogue  generate_temporal_ETAS_synthetic(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000 ) #> [[1]] #>            ts magnitudes gen #> 1  922.286261   2.551858   1 #> 2   26.231010   2.670374   1 #> 3  365.642970   2.651632   1 #> 4  637.623912   3.745365   1 #> 5  970.863759   2.699569   1 #> 6  592.957250   3.935034   1 #> 7  800.104626   3.484797   1 #> 8  314.561315   3.441440   1 #> 9  904.367222   3.588741   1 #> 10 819.102869   3.012548   1 #> 11 997.904399   2.599628   1 #> 12  91.977811   3.462534   1 #> 13 623.486053   2.604642   1 #> 14 322.259604   2.543219   1 #> 15 582.512416   2.673695   1 #> 16 690.789640   2.557024   1 #> 17 812.883579   3.044128   1 #> 18 341.807439   2.656737   1 #> 19 867.628460   3.068080   1 #> 20 983.609614   2.648920   1 #> 21 373.618124   2.584727   1 #> 22 124.119796   2.747579   1 #> 23 797.251655   3.302129   1 #> 24 915.842190   2.606659   1 #> 25  95.353039   3.469051   1 #> 26 754.727027   2.797494   1 #> 27 343.311729   2.608123   1 #> 28 357.800857   3.266790   1 #> 29 298.435374   2.908956   1 #> 30 317.684987   2.723134   1 #> 31 996.184744   2.526987   1 #> 32 431.864545   2.912667   1 #> 33 863.924020   3.231244   1 #> 34 546.780247   3.548408   1 #> 35 883.617001   2.572545   1 #> 36 636.694804   2.550838   1 #> 37 996.933288   3.253897   1 #> 38 146.599519   3.132020   1 #> 39 399.252316   2.562188   1 #> 40  47.704081   2.643786   1 #> 41 622.975450   3.270027   1 #> 42 137.277392   2.513071   1 #> 43 502.860889   3.010454   1 #> 44 134.601982   2.835151   1 #> 45 723.459715   2.677320   1 #> 46 881.173704   3.209852   1 #> 47 729.517281   4.657651   1 #> 48 868.845319   2.600163   1 #> 49 508.810183   2.511240   1 #> 50 357.139341   2.684670   1 #> 51 550.057228   3.253829   1 #> 52  57.286054   2.538642   1 #> 53 819.007014   2.841443   1 #> 54 538.288036   2.515885   1 #> 55 477.743205   2.527274   1 #> 56 946.946010   2.819683   1 #> 57 653.436912   2.658528   1 #> 58 341.843762   2.575617   1 #> 59  36.610914   3.071867   1 #> 60   6.563293   3.172030   1 #> 61 631.441767   2.778252   1 #> 62 318.721207   3.067152   1 #> 63 583.103749   2.835567   1 #> 64   3.658398   2.912019   1 #> 65 102.936684   2.843097   1 #> 66 309.308904   2.612206   1 #> 67 498.507516   3.297240   1 #> 68 124.871399   3.557602   1 #> 69  70.323414   2.650460   1 #> 70 185.153863   2.768004   1 #> 71 123.182751   2.695293   1 #> 72 776.184766   3.336692   1 #> 73 388.620274   2.633472   1 #> 74 412.745512   2.847618   1 #> 75 452.782170   2.748498   1 #> 76 924.233448   2.724336   1 #> 77 262.863023   2.720222   1 #> 78 269.644202   2.620421   1 #> 79 467.043875   4.494141   1 #> 80 948.734557   3.017737   1 #> 81 733.067475   2.747262   1 #> 82 459.903580   3.281983   1 #> 83 564.787727   3.129204   1 #> 84 769.979703   3.329002   1 #> 85 919.926088   3.045231   1 #> 86 384.540946   3.180926   1 #> 87 934.900225   3.551557   1 #> 88 336.307004   2.582204   1 #> 89 745.927579   2.878385   1 #> 90 353.955561   2.511031   1 #> 91 888.229612   2.545637   1 #> 92  81.170124   2.527024   1 #> 93 263.506633   3.601302   1 #> 94 843.442865   2.643848   1 #> 95 877.180592   2.534614   1 #> 96 981.244068   3.732868   1 #> 97 404.351886   2.785451   1 #> 98 319.037013   3.099459   1 #>  #> [[2]] #>           ts magnitudes gen #> 1  593.13898   2.680932   2 #> 2  886.02814   3.529086   2 #> 3  314.68086   4.676769   2 #> 4  102.80382   3.694175   2 #> 5  586.26087   2.926680   2 #> 6  983.85060   2.652653   2 #> 7  857.98881   3.088103   2 #> 8   96.03703   3.210453   2 #> 9  867.37769   2.606588   2 #> 10 998.91405   2.765887   2 #> 11 622.99585   3.052689   2 #> 12 518.04055   2.635674   2 #> 13 135.29755   3.672285   2 #> 14 724.31264   2.912484   2 #> 15 730.15182   2.894554   2 #> 16 738.25512   2.537405   2 #> 17 735.67598   2.503350   2 #> 18 730.53464   2.580568   2 #> 19 729.95055   2.683887   2 #> 20 774.01305   2.713481   2 #> 21 767.43275   2.687067   2 #> 22 730.04625   2.936389   2 #> 23 730.40139   3.171336   2 #> 24 794.51095   3.298439   2 #> 25 729.58247   3.266533   2 #> 26 540.57927   2.613561   2 #> 27 499.17510   2.985748   2 #> 28 931.70226   3.147990   2 #> 29 924.03345   2.554453   2 #> 30 468.48544   2.547381   2 #> 31 779.27507   3.411026   2 #> 32 270.84084   2.884047   2 #> 33 846.23882   2.795472   2 #> 34 981.39962   2.548445   2 #>  #> [[3]] #>          ts magnitudes gen #> 1  315.4361   2.518764   3 #> 2  327.3410   2.692952   3 #> 3  503.6328   2.678070   3 #> 4  417.9093   3.039458   3 #> 5  315.2972   2.851213   3 #> 6  316.5935   2.765053   3 #> 7  530.0612   2.639660   3 #> 8  316.0514   3.382346   3 #> 9  108.8261   2.812863   3 #> 10 113.3005   4.077149   3 #> 11 447.9413   3.372890   3 #> 12 137.4234   2.641766   3 #> 13 135.4075   2.759211   3 #> 14 135.4613   3.143825   3 #> 15 135.4201   3.631461   3 #> 16 811.8875   2.776217   3 #>    ## EXAMPLE 2: To generate a 1000 day catalogue including a M6.7 event on day 500  Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) generate_temporal_ETAS_synthetic(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000,   Ht = Ht ) #> [[1]] #>    ts magnitudes gen #> 1 500        6.7  -1 #>  #> [[2]] #>             ts magnitudes gen #> 1    579.61593   3.621106   0 #> 2    511.55582   2.562702   0 #> 3    504.99615   2.535053   0 #> 4    966.32215   2.550532   0 #> 5    500.38741   2.661006   0 #> 6    500.43343   3.137470   0 #> 7    500.11814   2.848874   0 #> 8    516.53557   2.620146   0 #> 9    643.39453   2.793936   0 #> 10   500.09417   2.663936   0 #> 11   595.86248   3.053589   0 #> 12   502.04407   2.537428   0 #> 13   512.02740   3.061471   0 #> 14   543.14971   3.104545   0 #> 15   585.84371   2.574520   0 #> 16   504.40635   2.551158   0 #> 17   500.24877   3.316639   0 #> 18   582.87163   2.633582   0 #> 19   505.58180   2.813481   0 #> 20   500.02187   2.789419   0 #> 21   500.06853   3.357094   0 #> 22   515.35525   3.008013   0 #> 23   501.07685   2.623876   0 #> 24   500.79944   2.572946   0 #> 25   636.49834   3.577015   0 #> 26   506.74624   2.654261   0 #> 27   509.86526   3.710803   0 #> 28   511.92826   2.520266   0 #> 29   582.80645   2.849019   0 #> 30   500.28710   4.109794   0 #> 31   524.35628   3.763055   0 #> 32   510.72453   2.518923   0 #> 33   533.03920   2.612532   0 #> 34   506.43770   2.687542   0 #> 35   521.49248   2.820190   0 #> 36   500.66107   2.711823   0 #> 37   518.26142   3.340876   0 #> 38   516.95570   2.537969   0 #> 39   501.25343   2.881495   0 #> 40   502.27019   2.599755   0 #> 41   525.85516   2.702714   0 #> 42   502.30382   2.999660   0 #> 43   598.44746   2.539125   0 #> 44   511.13902   2.535284   0 #> 45   602.38270   2.580176   0 #> 46   500.42099   3.044503   0 #> 47   500.06569   2.630392   0 #> 48   896.46740   3.123878   0 #> 49   500.65027   3.025058   0 #> 50   501.11342   2.528934   0 #> 51   504.77943   3.237935   0 #> 52   836.16021   2.519222   0 #> 53   500.11547   2.998662   0 #> 54   500.13649   3.135338   0 #> 55   500.94690   2.626830   0 #> 56   526.28743   3.906172   0 #> 57   500.20735   2.963899   0 #> 58   500.60732   2.591952   0 #> 59   500.62177   2.774314   0 #> 60   615.43649   2.993179   0 #> 61   500.24526   2.506882   0 #> 62   505.82942   2.564837   0 #> 63   500.36840   2.657903   0 #> 64   535.97295   3.116858   0 #> 65   826.62464   3.072521   0 #> 66   500.03741   3.248267   0 #> 67   503.14457   2.727075   0 #> 68   505.04726   2.910177   0 #> 69   500.39970   2.682656   0 #> 70   502.08017   4.568931   0 #> 71   500.58718   2.881857   0 #> 72   500.04900   3.373544   0 #> 73   531.58320   2.508297   0 #> 74   587.62010   3.518938   0 #> 75   500.04482   3.786639   0 #> 76   500.31478   3.183934   0 #> 77   707.64507   2.753985   0 #> 78   501.17709   3.268721   0 #> 79   500.35091   2.595580   0 #> 80   501.71878   3.284590   0 #> 81   500.14794   2.705145   0 #> 82   502.31872   4.025078   0 #> 83   500.57161   4.982409   0 #> 84   502.31147   2.691020   0 #> 85   508.47317   2.720228   0 #> 86   500.23527   2.670007   0 #> 87   500.83265   3.350200   0 #> 88   501.55598   2.597451   0 #> 89   500.02991   2.582904   0 #> 90   500.39610   2.506829   0 #> 91   502.87678   2.555292   0 #> 92   500.03864   2.623135   0 #> 93   502.98417   2.504855   0 #> 94   500.82360   2.752305   0 #> 95   500.21113   2.567400   0 #> 96   500.81695   2.577865   0 #> 97   504.32898   2.737163   0 #> 98   904.81133   2.636455   0 #> 99   500.09050   2.513624   0 #> 100  623.64041   2.703156   0 #> 101  500.15650   2.842985   0 #> 102  508.66122   3.112289   0 #> 103  500.08901   2.525325   0 #> 104  503.17928   3.896282   0 #> 105  538.18018   3.492623   0 #> 106  500.00924   3.473154   0 #> 107  500.08070   2.720124   0 #> 108  500.69848   2.793646   0 #> 109  526.56980   3.591546   0 #> 110  501.06046   2.620711   0 #> 111  501.54074   2.575678   0 #> 112  502.50927   2.827527   0 #> 113  500.05355   2.878901   0 #> 114  500.10468   2.645176   0 #> 115  500.63449   3.436959   0 #> 116  500.29788   2.649603   0 #> 117  539.55360   3.204688   0 #> 118  502.66393   2.511439   0 #> 119  500.41537   3.055882   0 #> 120  506.32108   2.670615   0 #> 121  569.17803   2.539808   0 #> 122  708.86423   3.003800   0 #> 123  501.50638   2.599290   0 #> 124  757.02348   3.550919   0 #> 125  710.07814   3.384587   0 #> 126  500.00551   3.792445   0 #> 127  522.94323   2.635615   0 #> 128  500.12846   3.131557   0 #> 129  501.99744   2.661046   0 #> 130  503.97243   3.184062   0 #> 131  518.58974   2.656347   0 #> 132  501.18550   2.664810   0 #> 133  501.48815   2.559062   0 #> 134  505.48686   2.579925   0 #> 135  510.89113   3.182208   0 #> 136  930.38451   2.810344   0 #> 137  574.35260   2.860549   0 #> 138  506.28775   3.663001   0 #> 139  500.03810   2.847441   0 #> 140  507.09053   2.542500   0 #> 141  504.54062   2.809500   0 #> 142  500.12018   2.572315   0 #> 143  500.42705   2.549709   0 #> 144  681.98122   2.722289   0 #> 145  501.97770   3.766813   0 #> 146  502.45338   2.585668   0 #> 147  527.37540   2.803107   0 #> 148  500.28073   2.777386   0 #> 149  596.87460   4.062666   0 #> 150  548.15283   2.707754   0 #> 151  519.58556   2.609811   0 #> 152  500.75566   2.673520   0 #> 153  541.51390   2.543069   0 #> 154  500.16398   2.798960   0 #> 155  519.44782   4.037106   0 #> 156  501.12200   3.024303   0 #> 157  526.52758   3.110082   0 #> 158  508.41982   2.512072   0 #> 159  886.15490   3.177840   0 #> 160  501.30100   2.629064   0 #> 161  500.50561   3.205633   0 #> 162  971.33616   3.065730   0 #> 163  513.38985   3.452008   0 #> 164  500.05943   2.753832   0 #> 165  559.65597   2.556147   0 #> 166  500.30716   3.502416   0 #> 167  514.71515   2.904000   0 #> 168  500.01743   3.437401   0 #> 169  504.52406   3.013738   0 #> 170  502.45162   3.964896   0 #> 171  500.39117   3.051567   0 #> 172  500.79298   3.369969   0 #> 173  500.31561   3.408283   0 #> 174  505.61343   2.672000   0 #> 175  500.31654   2.807837   0 #> 176  500.88289   2.503129   0 #> 177  500.18476   3.176062   0 #> 178  536.79217   3.316346   0 #> 179  500.09175   3.412669   0 #> 180  509.04554   2.651943   0 #> 181  723.13281   2.538941   0 #> 182  501.84430   2.634047   0 #> 183  500.11083   3.142479   0 #> 184  502.01085   3.879233   0 #> 185  511.00471   2.956398   0 #> 186  500.06779   2.928808   0 #> 187  519.45768   2.606215   0 #> 188  501.33920   2.549908   0 #> 189  500.25579   2.720814   0 #> 190  502.47456   2.783308   0 #> 191  543.57796   3.059639   0 #> 192  831.13317   2.987144   0 #> 193  500.08399   2.664987   0 #> 194  503.08101   2.687086   0 #> 195  500.60238   2.762150   0 #> 196  500.14453   2.826689   0 #> 197  500.31433   2.610102   0 #> 198  500.30394   2.884605   0 #> 199  505.52602   2.521644   0 #> 200  510.53561   3.552696   0 #> 201  505.60848   3.919238   0 #> 202  500.97357   2.711045   0 #> 203  700.60916   3.025264   0 #> 204  639.39663   2.509387   0 #> 205  564.77493   2.603172   0 #> 206  501.74618   2.690761   0 #> 207  500.26969   4.125076   0 #> 208  581.22530   2.731873   0 #> 209  500.00746   2.666281   0 #> 210  501.33631   3.797557   0 #> 211  500.27776   2.500815   0 #> 212  524.72829   2.609185   0 #> 213  503.40522   2.603561   0 #> 214  501.90173   3.588844   0 #> 215  512.96905   2.680762   0 #> 216  500.28806   2.591496   0 #> 217  632.96486   2.798678   0 #> 218  501.79054   3.881480   0 #> 219  500.19964   2.660625   0 #> 220  515.14007   3.103779   0 #> 221  500.36789   2.551244   0 #> 222  608.35135   2.770054   0 #> 223  592.25821   2.633285   0 #> 224  507.49367   2.764716   0 #> 225  500.24921   3.865563   0 #> 226  500.26910   2.592964   0 #> 227  500.72242   2.536398   0 #> 228  500.76365   2.749270   0 #> 229  502.45072   2.519658   0 #> 230  809.55556   2.512056   0 #> 231  511.24818   3.569737   0 #> 232  500.31260   3.604630   0 #> 233  501.79668   2.770515   0 #> 234  527.67090   2.551831   0 #> 235  500.03694   2.706509   0 #> 236  508.38786   2.550073   0 #> 237  504.89607   3.089211   0 #> 238  556.13060   3.465219   0 #> 239  500.39416   2.702518   0 #> 240  772.01372   2.786126   0 #> 241  862.28626   3.056841   0 #> 242  500.76543   2.591419   0 #> 243  505.55957   2.570366   0 #> 244  516.13309   2.961482   0 #> 245  501.84303   2.904886   0 #> 246  501.13958   2.827868   0 #> 247  500.17076   2.540584   0 #> 248  702.12731   2.688599   0 #> 249  813.44737   2.907284   0 #> 250  709.44665   4.083448   0 #> 251  502.07020   3.449727   0 #> 252  500.31408   2.851312   0 #> 253  504.24858   2.734423   0 #> 254  500.30766   2.886283   0 #> 255  534.96259   3.313507   0 #> 256  501.84409   2.558397   0 #> 257  500.08310   3.259400   0 #> 258  500.32344   2.622161   0 #> 259  849.84658   3.131404   0 #> 260  501.39458   2.567392   0 #> 261  528.52679   2.532226   0 #> 262  550.93465   3.199248   0 #> 263  500.12281   4.845133   0 #> 264  502.88239   4.454940   0 #> 265  500.14228   2.969733   0 #> 266  500.13971   2.544340   0 #> 267  832.14943   2.759488   0 #> 268  500.02448   3.134766   0 #> 269  504.36728   3.007056   0 #> 270  684.85845   2.503548   0 #> 271  500.14498   3.890691   0 #> 272  504.06034   4.048842   0 #> 273  500.94195   2.699600   0 #> 274  500.23160   4.097558   0 #> 275  509.27913   2.565470   0 #> 276  500.36615   2.904987   0 #> 277  784.14639   2.942514   0 #> 278  501.32900   2.909783   0 #> 279  515.91248   3.480026   0 #> 280  501.57762   2.707701   0 #> 281  833.04924   3.010534   0 #> 282  503.32366   2.845992   0 #> 283  822.97389   2.551978   0 #> 284  501.08839   2.552641   0 #> 285  617.03854   2.599400   0 #> 286  500.14123   3.590855   0 #> 287  545.05052   3.242207   0 #> 288  500.65098   2.616606   0 #> 289  537.24789   2.565441   0 #> 290  500.04470   2.785577   0 #> 291  733.39608   2.716788   0 #> 292  500.58153   2.879805   0 #> 293  572.85784   2.500467   0 #> 294  501.95202   2.555769   0 #> 295  502.98448   2.726242   0 #> 296  542.56426   2.697742   0 #> 297  663.86794   3.017183   0 #> 298  941.66009   2.570024   0 #> 299  501.33266   3.859786   0 #> 300  500.49067   2.853340   0 #> 301  641.43867   2.500977   0 #> 302  500.02275   2.690355   0 #> 303  502.35092   2.762029   0 #> 304  591.92230   2.596780   0 #> 305  514.78676   2.786630   0 #> 306  500.27095   2.763654   0 #> 307  522.15207   2.603371   0 #> 308  505.76092   2.962748   0 #> 309  500.00070   3.231014   0 #> 310  500.82207   2.524551   0 #> 311  668.59346   3.737074   0 #> 312  500.00774   2.537502   0 #> 313  501.20899   2.637964   0 #> 314  500.12568   2.923536   0 #> 315  500.06478   3.223796   0 #> 316  502.01197   2.766499   0 #> 317  500.05916   2.603278   0 #> 318  502.51753   2.987113   0 #> 319  500.69121   3.169361   0 #> 320  500.73031   2.550275   0 #> 321  501.00353   3.359071   0 #> 322  510.72767   2.632857   0 #> 323  534.53637   2.716098   0 #> 324  501.60742   3.079601   0 #> 325  500.18715   2.664613   0 #> 326  624.52633   2.532179   0 #> 327  502.37589   2.576106   0 #> 328  611.19779   2.578557   0 #> 329  627.77898   4.086676   0 #> 330  500.07423   4.148224   0 #> 331  645.38335   2.519591   0 #> 332  500.03724   3.012789   0 #> 333  578.75361   3.418447   0 #> 334  505.69628   2.677228   0 #> 335  602.08504   2.612742   0 #> 336  503.72318   2.875407   0 #> 337  500.19063   2.534428   0 #> 338  507.44178   2.917436   0 #> 339  500.05291   3.185406   0 #> 340  501.06666   2.796244   0 #> 341  624.80219   3.061602   0 #> 342  500.38000   3.265880   0 #> 343  501.40253   4.070761   0 #> 344  534.94615   2.905794   0 #> 345  723.15957   2.927771   0 #> 346  500.06987   2.597037   0 #> 347  500.91558   2.741423   0 #> 348  796.17738   2.590173   0 #> 349  500.62485   2.554707   0 #> 350  527.57470   3.967084   0 #> 351  502.31210   4.163072   0 #> 352  501.11317   2.511787   0 #> 353  500.19982   2.607965   0 #> 354  802.07857   2.880294   0 #> 355  846.88876   2.847532   0 #> 356  501.87908   2.547941   0 #> 357  713.32002   2.579000   0 #> 358  500.35442   3.725770   0 #> 359  501.90794   2.859365   0 #> 360  693.06810   3.474847   0 #> 361  500.39737   2.572883   0 #> 362  500.06824   2.708859   0 #> 363  500.02216   2.808143   0 #> 364  504.43499   3.050348   0 #> 365  500.01682   2.623949   0 #> 366  533.64872   2.701883   0 #> 367  742.26385   3.236710   0 #> 368  524.00899   2.955711   0 #> 369  500.04023   3.427535   0 #> 370  773.34778   2.648215   0 #> 371  651.17422   2.788645   0 #> 372  564.82306   2.568314   0 #> 373  500.17488   2.780521   0 #> 374  522.31041   2.779638   0 #> 375  883.27787   2.922683   0 #> 376  610.80302   2.713736   0 #> 377  500.72034   3.373211   0 #> 378  545.11568   2.892460   0 #> 379  507.67072   2.540183   0 #> 380  500.37276   2.795280   0 #> 381  890.72544   2.901207   0 #> 382  500.58040   3.201124   0 #> 383  510.32562   3.371139   0 #> 384  503.04913   3.011522   0 #> 385  502.83273   4.031930   0 #> 386  560.75411   2.564507   0 #> 387  554.39028   3.277681   0 #> 388  501.97908   2.918944   0 #> 389  793.17538   4.214914   0 #> 390  522.74299   2.524359   0 #> 391  503.98535   2.901959   0 #> 392  500.39194   3.023649   0 #> 393  503.41962   2.597158   0 #> 394  500.43933   3.157591   0 #> 395  828.52686   2.895520   0 #> 396  503.71922   2.754268   0 #> 397  710.55276   2.744077   0 #> 398  505.51980   2.726725   0 #> 399  502.02590   2.798800   0 #> 400  744.30514   2.785963   0 #> 401  500.28070   3.168137   0 #> 402  509.14479   2.514881   0 #> 403  505.40643   2.787750   0 #> 404  512.56216   3.444705   0 #> 405  500.34304   2.603020   0 #> 406  664.05458   2.746477   0 #> 407  500.05550   2.811034   0 #> 408  650.00208   2.820058   0 #> 409  507.50411   3.170425   0 #> 410  936.71122   2.717213   0 #> 411  840.16867   3.225511   0 #> 412  513.05136   2.664081   0 #> 413  514.85796   3.072558   0 #> 414  524.54503   2.781325   0 #> 415  500.06539   2.844180   0 #> 416  500.10454   2.895424   0 #> 417  538.70175   2.520214   0 #> 418  508.55324   2.586864   0 #> 419  583.37864   3.049275   0 #> 420  500.48450   3.112550   0 #> 421  643.03747   2.979390   0 #> 422  502.81149   2.788325   0 #> 423  504.52161   3.626236   0 #> 424  500.64401   2.783162   0 #> 425  624.61361   2.535114   0 #> 426  500.90749   3.331410   0 #> 427  500.20004   2.507983   0 #> 428  521.61767   3.549530   0 #> 429  500.13032   2.579778   0 #> 430  534.42400   2.624400   0 #> 431  529.29793   2.785860   0 #> 432  500.41882   3.152911   0 #> 433  512.75975   2.883535   0 #> 434  500.14209   3.512123   0 #> 435  502.12921   3.028247   0 #> 436  555.72413   2.672137   0 #> 437  513.47263   4.083201   0 #> 438  503.09758   2.700724   0 #> 439  503.39227   2.539615   0 #> 440  500.07686   2.753090   0 #> 441  500.24866   2.969695   0 #> 442  502.73482   4.136573   0 #> 443  500.70431   2.505731   0 #> 444  501.78089   2.826004   0 #> 445  501.23525   2.883143   0 #> 446  500.01080   2.587333   0 #> 447  503.26924   2.588791   0 #> 448  503.39027   2.722553   0 #> 449  507.60581   2.883412   0 #> 450  504.24030   2.558157   0 #> 451  500.71383   2.677124   0 #> 452  607.10365   2.573959   0 #> 453  851.97215   2.621478   0 #> 454  500.71094   2.905356   0 #> 455  500.45546   3.071235   0 #> 456  507.01790   2.903140   0 #> 457  500.27641   2.592178   0 #> 458  502.06823   2.512951   0 #> 459  507.14542   2.644240   0 #> 460  500.06860   2.613593   0 #> 461  500.40452   2.547677   0 #> 462  506.12348   2.598002   0 #> 463  505.91443   2.643585   0 #> 464  546.15809   2.710886   0 #> 465  712.94422   2.934131   0 #> 466  520.20899   2.793014   0 #> 467  576.05504   3.702579   0 #> 468  531.97837   3.738237   0 #> 469  529.32459   3.433551   0 #> 470  500.84967   2.986080   0 #> 471  501.80594   2.934738   0 #> 472  500.24148   2.552966   0 #> 473  518.35459   2.953221   0 #> 474  500.35729   2.609029   0 #> 475  571.82800   3.178410   0 #> 476  503.65322   3.350559   0 #> 477  507.94818   2.514841   0 #> 478  500.49598   2.572589   0 #> 479  500.11391   2.669496   0 #> 480  500.13382   2.501894   0 #> 481  505.11265   4.776014   0 #> 482  500.42838   2.602880   0 #> 483  500.35084   2.683447   0 #> 484  500.35523   3.271689   0 #> 485  508.50836   2.736393   0 #> 486  504.54142   3.114856   0 #> 487  500.48896   2.661341   0 #> 488  500.14770   3.292517   0 #> 489  508.89128   2.502214   0 #> 490  501.32570   2.914889   0 #> 491  540.46970   2.537584   0 #> 492  504.78192   2.651838   0 #> 493  925.40519   3.680973   0 #> 494  500.50239   2.728612   0 #> 495  500.10362   2.927947   0 #> 496  509.74334   3.737953   0 #> 497  500.04179   3.000301   0 #> 498  500.69834   3.108621   0 #> 499  733.73036   2.843809   0 #> 500  507.30555   3.119724   0 #> 501  515.44952   2.538958   0 #> 502  563.85674   3.561645   0 #> 503  503.17246   2.834775   0 #> 504  501.10496   2.511042   0 #> 505  501.62188   2.526804   0 #> 506  500.45769   2.641345   0 #> 507  500.06593   2.990418   0 #> 508  580.10649   2.516962   0 #> 509  512.62512   3.150403   0 #> 510  533.32324   3.063356   0 #> 511  517.47668   2.551715   0 #> 512  503.10806   2.943271   0 #> 513  508.65588   3.046617   0 #> 514  615.41885   2.786653   0 #> 515  500.71177   4.654071   0 #> 516  535.93330   3.134349   0 #> 517  501.64550   2.509750   0 #> 518  505.48635   2.538456   0 #> 519  510.25893   3.565765   0 #> 520  601.29034   2.822594   0 #> 521  503.62433   2.524704   0 #> 522  750.31799   2.605442   0 #> 523  501.01366   3.719196   0 #> 524  544.74111   2.575022   0 #> 525  500.46941   2.717962   0 #> 526  500.07821   2.547921   0 #> 527  505.16987   2.559444   0 #> 528  755.16183   2.711510   0 #> 529  520.90808   2.682172   0 #> 530  508.09417   2.503252   0 #> 531  500.40735   3.239877   0 #> 532  500.35428   2.760871   0 #> 533  504.38021   2.703814   0 #> 534  503.29974   2.769861   0 #> 535  500.52205   2.613022   0 #> 536  625.76753   2.708297   0 #> 537  501.53723   3.173610   0 #> 538  500.16217   3.178592   0 #> 539  500.99599   3.099137   0 #> 540  504.24255   2.782779   0 #> 541  749.43849   2.587020   0 #> 542  501.09367   2.885207   0 #> 543  512.94942   2.609419   0 #> 544  601.14740   3.431274   0 #> 545  566.38262   4.445364   0 #> 546  863.95376   2.581765   0 #> 547  751.25074   2.873101   0 #> 548  500.80912   2.507051   0 #> 549  500.48328   3.161287   0 #> 550  514.39375   2.950819   0 #> 551  500.17526   2.658961   0 #> 552  538.69826   3.288284   0 #> 553  500.82639   2.780036   0 #> 554  523.20035   2.745060   0 #> 555  501.72696   2.741659   0 #> 556  500.13076   2.663052   0 #> 557  500.72180   3.148970   0 #> 558  505.64662   3.803977   0 #> 559  501.63341   3.620668   0 #> 560  503.81427   2.961354   0 #> 561  500.55654   2.831101   0 #> 562  500.51136   2.679653   0 #> 563  564.51969   2.634884   0 #> 564  502.14602   3.291254   0 #> 565  500.00726   2.859557   0 #> 566  501.19789   2.520322   0 #> 567  597.01806   2.924033   0 #> 568  656.30124   2.992407   0 #> 569  540.48568   2.883592   0 #> 570  502.28068   3.326690   0 #> 571  576.76259   2.562107   0 #> 572  500.07182   3.158259   0 #> 573  505.31961   2.693426   0 #> 574  505.59829   2.553036   0 #> 575  500.32962   2.633425   0 #> 576  500.55963   2.670076   0 #> 577  502.56021   2.788868   0 #> 578  504.50900   2.695388   0 #> 579  971.28891   3.903284   0 #> 580  501.40739   2.877498   0 #> 581  500.10391   2.906735   0 #> 582  502.08731   3.378492   0 #> 583  500.17264   2.515562   0 #> 584  500.12322   2.535810   0 #> 585  500.14865   2.680746   0 #> 586  505.32453   2.696381   0 #> 587  500.86701   2.621953   0 #> 588  500.01599   2.879909   0 #> 589  504.06710   3.767512   0 #> 590  500.82713   2.661274   0 #> 591  516.46327   2.686666   0 #> 592  501.72540   2.712412   0 #> 593  519.58117   2.682612   0 #> 594  651.61623   2.501404   0 #> 595  500.16920   2.616711   0 #> 596  523.35844   2.781894   0 #> 597  503.94854   3.087626   0 #> 598  500.81305   2.809970   0 #> 599  500.98831   2.776554   0 #> 600  511.61300   2.955062   0 #> 601  500.01419   2.557939   0 #> 602  500.12127   3.010638   0 #> 603  514.64441   2.616408   0 #> 604  509.36784   3.337605   0 #> 605  541.78542   2.585707   0 #> 606  500.71861   2.632310   0 #> 607  537.75930   2.904713   0 #> 608  578.00045   2.577561   0 #> 609  530.69262   3.080992   0 #> 610  605.42085   3.035163   0 #> 611  500.02106   2.590088   0 #> 612  574.77356   2.750987   0 #> 613  512.05093   3.072492   0 #> 614  626.64840   4.140682   0 #> 615  575.82245   2.741886   0 #> 616  500.45445   3.100677   0 #> 617  541.37448   3.083388   0 #> 618  530.29470   4.403015   0 #> 619  550.26800   2.968356   0 #> 620  500.35048   3.532443   0 #> 621  500.10783   2.911120   0 #> 622  508.66943   2.683098   0 #> 623  500.01647   2.615422   0 #> 624  558.86788   2.590387   0 #> 625  968.36180   3.737772   0 #> 626  879.81115   2.655474   0 #> 627  500.04596   2.928229   0 #> 628  500.11042   2.605350   0 #> 629  501.87444   2.865870   0 #> 630  591.87980   3.920136   0 #> 631  501.18853   2.586880   0 #> 632  752.04240   2.511343   0 #> 633  546.72143   2.962451   0 #> 634  500.59137   2.766067   0 #> 635  680.74155   2.630017   0 #> 636  566.45335   2.721209   0 #> 637  526.78921   2.825121   0 #> 638  500.09974   3.011579   0 #> 639  501.35710   2.829881   0 #> 640  534.65919   2.544448   0 #> 641  607.58380   3.550145   0 #> 642  500.10047   2.743917   0 #> 643  507.34184   3.547818   0 #> 644  500.32081   2.883144   0 #> 645  503.57968   2.537135   0 #> 646  500.68072   3.656863   0 #> 647  500.68613   2.590957   0 #> 648  500.13280   3.259103   0 #> 649  500.16380   2.580238   0 #> 650  503.42564   2.897377   0 #> 651  505.35805   2.507695   0 #> 652  500.18083   2.660496   0 #> 653  500.01567   2.709507   0 #> 654  501.85060   3.280751   0 #> 655  505.45020   2.554226   0 #> 656  500.15392   2.821390   0 #> 657  500.17434   3.528025   0 #> 658  500.03252   3.004589   0 #> 659  502.91709   2.777428   0 #> 660  520.64743   2.826103   0 #> 661  510.05709   4.207789   0 #> 662  501.52335   2.892707   0 #> 663  504.13416   2.986576   0 #> 664  502.81721   2.795080   0 #> 665  566.03036   4.351934   0 #> 666  500.02918   3.524494   0 #> 667  507.02830   3.187258   0 #> 668  500.15677   2.816996   0 #> 669  502.12746   3.297674   0 #> 670  500.33585   2.826038   0 #> 671  645.41706   3.005380   0 #> 672  588.59151   2.979435   0 #> 673  666.82789   2.734182   0 #> 674  726.15032   2.827037   0 #> 675  500.05348   2.644088   0 #> 676  511.74264   4.093743   0 #> 677  529.69349   3.183275   0 #> 678  502.01417   3.854069   0 #> 679  500.11888   3.972793   0 #> 680  503.74015   2.551834   0 #> 681  500.20406   2.676285   0 #> 682  508.68968   2.669990   0 #> 683  537.26837   2.503322   0 #> 684  500.77719   2.779040   0 #> 685  504.87904   2.504371   0 #> 686  500.30111   2.579758   0 #> 687  500.08279   5.177971   0 #> 688  500.12218   2.899753   0 #> 689  504.62483   2.746149   0 #> 690  503.37736   2.554324   0 #> 691  519.74921   2.788351   0 #> 692  578.49023   2.894743   0 #> 693  575.64049   2.500011   0 #> 694  512.52834   2.861110   0 #> 695  561.76023   3.067755   0 #> 696  512.04108   3.030914   0 #> 697  558.66374   3.754514   0 #> 698  504.02518   2.740756   0 #> 699  523.49034   2.610087   0 #> 700  521.29200   2.537595   0 #> 701  500.24724   2.871789   0 #> 702  502.20920   2.986073   0 #> 703  502.12218   2.742797   0 #> 704  526.12041   2.841562   0 #> 705  500.12706   3.016716   0 #> 706  507.63009   2.677752   0 #> 707  501.98160   2.928017   0 #> 708  501.22540   2.692783   0 #> 709  523.85223   2.500636   0 #> 710  513.78664   2.617058   0 #> 711  500.24930   2.664388   0 #> 712  500.76932   2.552997   0 #> 713  501.02640   3.023361   0 #> 714  604.56673   2.653683   0 #> 715  500.43811   3.055454   0 #> 716  501.58903   3.573923   0 #> 717  500.06239   3.226738   0 #> 718  501.32445   2.678539   0 #> 719  511.67386   2.604836   0 #> 720  500.37649   2.855115   0 #> 721  500.31324   2.552846   0 #> 722  500.00740   2.980760   0 #> 723  508.31680   3.177220   0 #> 724  500.37020   3.164516   0 #> 725  560.94717   2.964254   0 #> 726  581.18303   2.686033   0 #> 727  501.73188   3.099464   0 #> 728  500.15926   2.730867   0 #> 729  501.75778   2.599800   0 #> 730  507.95486   2.570279   0 #> 731  501.75334   2.540498   0 #> 732  515.53537   2.578215   0 #> 733  500.24930   2.852736   0 #> 734  501.04822   2.767933   0 #> 735  527.85585   2.548246   0 #> 736  509.46652   3.095445   0 #> 737  500.04757   3.150711   0 #> 738  500.35658   3.298059   0 #> 739  501.67876   2.503892   0 #> 740  854.22054   3.341098   0 #> 741  505.15112   2.839478   0 #> 742  500.01292   2.901526   0 #> 743  504.55762   2.908598   0 #> 744  569.74551   2.861801   0 #> 745  500.02946   2.557812   0 #> 746  500.71605   3.022371   0 #> 747  500.04093   3.358199   0 #> 748  539.69048   2.677904   0 #> 749  500.99754   2.995863   0 #> 750  504.04737   3.113925   0 #> 751  587.60495   2.638938   0 #> 752  547.37120   2.505850   0 #> 753  527.04167   3.081037   0 #> 754  513.93680   3.940102   0 #> 755  501.78517   2.597801   0 #> 756  500.90277   2.712035   0 #> 757  500.63208   3.237860   0 #> 758  500.00963   2.674220   0 #> 759  500.16387   2.504253   0 #> 760  502.84347   3.107687   0 #> 761  508.07607   2.912305   0 #> 762  500.23025   3.005357   0 #> 763  502.70201   2.594091   0 #> 764  506.72539   3.303188   0 #> 765  503.66078   2.572846   0 #> 766  500.14312   2.914656   0 #> 767  535.36351   2.839056   0 #> 768  501.04560   2.536693   0 #> 769  667.92162   2.879197   0 #> 770  500.48668   3.861189   0 #> 771  500.22007   3.352681   0 #> 772  936.93437   2.709598   0 #> 773  501.21200   2.535177   0 #> 774  542.64093   3.119478   0 #> 775  501.30518   2.852070   0 #> 776  630.22926   2.911918   0 #> 777  501.87489   2.734617   0 #> 778  500.01791   2.524289   0 #> 779  789.07506   3.106724   0 #> 780  500.59686   3.277032   0 #> 781  567.37068   2.567676   0 #> 782  501.84598   3.198151   0 #> 783  500.71262   2.956377   0 #> 784  601.94038   3.213992   0 #> 785  500.45181   2.709722   0 #> 786  501.56049   3.701711   0 #> 787  504.30598   2.941628   0 #> 788  543.19693   3.358178   0 #> 789  500.03970   2.525428   0 #> 790  501.00860   3.017307   0 #> 791  500.64467   2.593873   0 #> 792  529.61642   2.543746   0 #> 793  688.84553   2.675753   0 #> 794  500.91818   2.609968   0 #> 795  500.05068   3.027896   0 #> 796  500.16870   2.698967   0 #> 797  500.06447   2.760325   0 #> 798  500.00942   2.616678   0 #> 799  619.83499   2.963781   0 #> 800  500.17309   2.764502   0 #> 801  500.71672   3.858122   0 #> 802  500.63461   2.865334   0 #> 803  579.95010   2.855501   0 #> 804  500.31412   2.663382   0 #> 805  500.63150   3.661544   0 #> 806  576.22953   2.688500   0 #> 807  988.71592   4.126254   0 #> 808  504.09931   2.722350   0 #> 809  659.53220   2.538306   0 #> 810  512.25346   2.716792   0 #> 811  500.72334   2.792804   0 #> 812  500.01317   2.603055   0 #> 813  500.52551   2.568747   0 #> 814  502.65760   3.773764   0 #> 815  500.15324   2.974958   0 #> 816  500.45558   3.491907   0 #> 817  506.72219   2.500529   0 #> 818  500.18613   2.729188   0 #> 819  531.45334   2.527242   0 #> 820  500.48232   2.758936   0 #> 821  565.19001   2.572930   0 #> 822  538.47331   2.536242   0 #> 823  500.30002   2.877236   0 #> 824  500.32088   2.872201   0 #> 825  500.80634   2.521937   0 #> 826  636.26835   3.106765   0 #> 827  506.14380   2.717024   0 #> 828  536.16840   3.012231   0 #> 829  500.32462   2.758033   0 #> 830  500.24876   2.561716   0 #> 831  649.15078   3.147850   0 #> 832  509.56343   2.760968   0 #> 833  513.34999   3.250903   0 #> 834  705.65851   2.863634   0 #> 835  520.06661   2.730616   0 #> 836  517.56015   2.643973   0 #> 837  508.99628   2.732587   0 #> 838  500.54271   2.927088   0 #> 839  531.80732   3.842576   0 #> 840  526.79545   2.897651   0 #> 841  520.56417   3.429655   0 #> 842  500.30944   2.554525   0 #> 843  501.65059   3.820532   0 #> 844  746.40196   3.817593   0 #> 845  500.63846   2.921336   0 #> 846  500.76737   2.796073   0 #> 847  547.25662   2.554217   0 #> 848  500.00452   2.936980   0 #> 849  507.82327   2.533625   0 #> 850  503.34602   2.632806   0 #> 851  507.56052   3.215107   0 #> 852  500.55028   2.915751   0 #> 853  603.14422   2.685179   0 #> 854  501.63073   2.538438   0 #> 855  500.46051   2.741214   0 #> 856  519.72107   3.161010   0 #> 857  502.44778   2.816118   0 #> 858  512.07455   2.609252   0 #> 859  513.80499   2.573410   0 #> 860  511.96247   2.685157   0 #> 861  500.03425   2.726631   0 #> 862  500.27070   3.197950   0 #> 863  684.90440   2.885728   0 #> 864  530.77716   2.714958   0 #> 865  647.78384   3.322614   0 #> 866  713.92412   3.136001   0 #> 867  810.59598   2.884915   0 #> 868  500.15123   2.584299   0 #> 869  505.87906   2.678005   0 #> 870  500.03210   4.086767   0 #> 871  507.49371   3.511048   0 #> 872  500.29867   2.785879   0 #> 873  500.42770   3.275215   0 #> 874  501.68846   2.513502   0 #> 875  501.86745   2.724681   0 #> 876  500.04413   2.945348   0 #> 877  537.98208   2.806412   0 #> 878  682.13752   2.606131   0 #> 879  500.04529   3.134986   0 #> 880  544.68653   4.093177   0 #> 881  500.52067   2.590111   0 #> 882  501.94258   2.518152   0 #> 883  500.13817   2.701075   0 #> 884  500.87713   2.977780   0 #> 885  583.27954   2.660797   0 #> 886  500.38954   2.550409   0 #> 887  501.86527   2.796589   0 #> 888  501.15868   2.511379   0 #> 889  776.12300   2.762008   0 #> 890  500.50499   2.726164   0 #> 891  500.09547   2.591433   0 #> 892  500.05513   2.771726   0 #> 893  500.36376   2.522311   0 #> 894  558.04883   2.707115   0 #> 895  500.96778   2.886250   0 #> 896  500.25151   2.555224   0 #> 897  540.52408   2.714090   0 #> 898  818.15443   2.503364   0 #> 899  513.54305   3.213545   0 #> 900  500.22591   2.522331   0 #> 901  636.16275   2.639319   0 #> 902  500.00730   3.350857   0 #> 903  519.46985   2.544707   0 #> 904  500.85286   4.061198   0 #> 905  500.48309   3.246748   0 #> 906  720.29937   2.685742   0 #> 907  603.30776   3.844567   0 #> 908  500.36823   2.545761   0 #> 909  512.14413   2.638749   0 #> 910  521.02419   3.017381   0 #> 911  501.45543   3.186338   0 #> 912  511.46721   2.670808   0 #> 913  500.05212   3.485772   0 #> 914  611.43273   2.888920   0 #> 915  546.20223   3.390856   0 #> 916  500.17136   2.656137   0 #> 917  500.03398   2.596393   0 #> 918  621.20962   4.240097   0 #> 919  554.71594   2.663259   0 #> 920  509.97029   2.654307   0 #> 921  255.59768   3.226762   1 #> 922  488.79512   3.103649   1 #> 923  887.32637   3.936046   1 #> 924  277.62259   2.635660   1 #> 925  121.46991   2.528802   1 #> 926  154.67492   2.625047   1 #> 927  647.30169   2.720920   1 #> 928  574.92517   2.683539   1 #> 929  931.34423   2.854520   1 #> 930  262.60686   2.750609   1 #> 931  822.67467   2.532549   1 #> 932  363.59966   2.585245   1 #> 933  786.21413   2.699336   1 #> 934  282.71015   2.500571   1 #> 935  220.36350   2.936513   1 #> 936  310.59142   2.715267   1 #> 937  798.91215   2.524312   1 #> 938  816.06059   2.895526   1 #> 939  369.41655   2.629143   1 #> 940   49.97052   2.764642   1 #> 941  186.81272   2.712503   1 #> 942  745.26996   3.544957   1 #> 943  757.90287   2.839463   1 #> 944   88.40411   2.936933   1 #> 945  268.11809   2.553984   1 #> 946  667.08301   3.378233   1 #> 947  509.44783   2.523172   1 #> 948  364.84258   3.825688   1 #> 949  829.35097   2.624000   1 #> 950  386.86675   2.717759   1 #> 951  470.23520   2.747971   1 #> 952  273.73155   2.547667   1 #> 953  538.65030   2.582536   1 #> 954  220.37949   3.225119   1 #> 955  497.10053   2.765512   1 #> 956  983.11353   2.541412   1 #> 957  267.50882   2.768539   1 #> 958  553.07174   3.296421   1 #> 959  126.97100   2.550727   1 #> 960  490.25197   2.563238   1 #> 961  107.81962   2.526654   1 #> 962  689.68591   3.293241   1 #> 963  317.18558   2.556629   1 #> 964  238.27750   2.600228   1 #> 965  569.87455   2.580138   1 #> 966  421.37137   2.531316   1 #> 967  677.06598   3.128651   1 #> 968  886.24835   2.935679   1 #> 969  945.33737   3.444394   1 #> 970  116.96818   3.016028   1 #> 971  766.94336   2.875485   1 #> 972  421.77628   3.477786   1 #> 973   20.92420   2.866815   1 #> 974  407.16751   2.599839   1 #> 975  706.50959   2.528714   1 #> 976  530.59447   3.587318   1 #> 977   46.83396   2.640671   1 #> 978  622.90724   2.523724   1 #> 979   32.98831   2.657261   1 #> 980  575.66391   3.000630   1 #> 981  241.60972   3.693261   1 #> 982  129.86735   2.902897   1 #> 983   19.30958   2.533125   1 #> 984  205.18165   3.790376   1 #> 985   93.90061   2.880323   1 #> 986  438.71516   2.533261   1 #> 987  205.32465   2.604393   1 #> 988  907.66543   3.071069   1 #> 989   97.10784   3.454528   1 #> 990  296.41889   2.593006   1 #> 991  885.74219   2.645902   1 #> 992  138.47862   2.725234   1 #> 993  869.50327   2.545184   1 #> 994  242.37371   3.165279   1 #> 995  245.58626   2.538082   1 #> 996  970.74421   2.504614   1 #> 997   83.39335   2.735708   1 #> 998  740.66826   2.612689   1 #> 999  850.82285   2.700348   1 #> 1000 356.69993   2.982477   1 #> 1001 336.47254   3.501058   1 #> 1002 779.28070   2.584382   1 #> 1003 825.97611   2.696013   1 #> 1004 386.13708   2.548573   1 #> 1005 538.86045   5.310024   1 #> 1006 292.68863   2.576214   1 #> 1007 939.90999   3.448483   1 #> 1008 207.47774   2.705690   1 #> 1009 592.75248   2.774167   1 #> 1010 841.12997   2.845606   1 #> 1011 326.58351   2.871822   1 #> 1012 958.27014   2.799261   1 #> 1013 690.01568   2.761782   1 #> 1014 147.32657   2.647740   1 #> 1015 459.81541   2.582575   1 #> 1016  80.64234   2.807078   1 #> 1017  37.19277   2.610793   1 #> 1018 828.33431   3.652368   1 #> 1019  65.32368   3.421900   1 #> 1020 823.69189   3.953917   1 #> 1021  42.67314   2.537022   1 #> 1022 643.54800   2.508056   1 #> 1023 345.97517   3.386943   1 #> 1024 285.87330   2.619390   1 #> 1025 885.76919   3.275633   1 #> 1026 986.11423   3.734218   1 #> 1027  19.00680   3.039747   1 #> 1028 380.50623   3.526750   1 #>  #> [[3]] #>            ts magnitudes gen #> 1   582.61967   3.556178   2 #> 2   583.21229   3.132710   2 #> 3   585.62942   2.537479   2 #> 4   505.04815   2.729429   2 #> 5   505.84234   3.051430   2 #> 6   730.79815   2.675935   2 #> 7   742.81729   2.567268   2 #> 8   637.23336   2.512857   2 #> 9   623.17437   2.553476   2 #> 10  567.77411   2.520694   2 #> 11  896.80687   3.167537   2 #> 12  513.09105   2.522085   2 #> 13  504.87076   3.230774   2 #> 14  512.74426   2.971722   2 #> 15  529.65163   2.837885   2 #> 16  733.19031   2.924376   2 #> 17  526.61913   2.553312   2 #> 18  532.12976   2.562833   2 #> 19  827.06426   2.555263   2 #> 20  503.96770   2.708043   2 #> 21  502.47434   2.737048   2 #> 22  760.76009   2.962554   2 #> 23  502.15926   2.549952   2 #> 24  524.15897   3.049632   2 #> 25  502.18220   3.512626   2 #> 26  502.76865   2.552822   2 #> 27  502.10572   2.644639   2 #> 28  560.23599   2.972625   2 #> 29  501.53430   2.696430   2 #> 30  501.41308   2.777388   2 #> 31  714.89965   3.025958   2 #> 32  521.99829   2.706265   2 #> 33  526.39720   3.620518   2 #> 34  500.58905   3.192824   2 #> 35  502.31337   3.068664   2 #> 36  529.42212   3.334574   2 #> 37  500.67304   2.854002   2 #> 38  507.05338   2.682465   2 #> 39  945.74404   3.337629   2 #> 40  512.54886   2.567126   2 #> 41  526.17324   3.131899   2 #> 42  613.83435   2.780064   2 #> 43  538.43301   2.684062   2 #> 44  516.52813   3.623014   2 #> 45  500.81261   3.602310   2 #> 46  500.67639   2.569550   2 #> 47  994.29753   2.844101   2 #> 48  500.68207   2.606604   2 #> 49  503.53447   2.688195   2 #> 50  517.33190   2.783265   2 #> 51  725.22784   2.745903   2 #> 52  534.07957   2.523820   2 #> 53  512.52609   3.205464   2 #> 54  744.06622   3.140302   2 #> 55  503.49551   2.758915   2 #> 56  538.57437   3.510772   2 #> 57  500.04911   2.513858   2 #> 58  736.51854   2.744901   2 #> 59  551.24889   3.761067   2 #> 60  557.26898   2.617017   2 #> 61  504.07207   2.747273   2 #> 62  504.06826   3.154960   2 #> 63  800.97237   3.177703   2 #> 64  506.48342   2.779751   2 #> 65  500.38538   2.619122   2 #> 66  515.00582   2.714569   2 #> 67  696.68121   3.148723   2 #> 68  614.63306   2.642273   2 #> 69  939.61358   2.701947   2 #> 70  744.44014   2.622120   2 #> 71  757.53936   2.524042   2 #> 72  524.12949   2.962330   2 #> 73  526.94797   2.839526   2 #> 74  535.46877   3.210816   2 #> 75  517.55099   2.998699   2 #> 76  608.01460   3.715915   2 #> 77  502.51366   2.878714   2 #> 78  505.78183   3.017845   2 #> 79  512.17611   3.731026   2 #> 80  533.23915   3.665932   2 #> 81  500.39921   3.948757   2 #> 82  502.27507   2.862188   2 #> 83  518.31240   2.549501   2 #> 84  561.98805   3.211720   2 #> 85  501.70081   2.873913   2 #> 86  559.66310   2.652115   2 #> 87  915.78840   3.169152   2 #> 88  516.56207   4.097535   2 #> 89  502.12932   2.704763   2 #> 90  537.93718   3.043836   2 #> 91  591.81647   2.900194   2 #> 92  507.48004   2.585600   2 #> 93  503.63142   2.997858   2 #> 94  508.72004   3.318927   2 #> 95  517.68399   2.835829   2 #> 96  500.28639   2.641572   2 #> 97  500.58098   2.668019   2 #> 98  710.58929   3.354425   2 #> 99  507.21617   3.068085   2 #> 100 501.49352   3.108993   2 #> 101 626.47153   3.104646   2 #> 102 761.86171   2.566608   2 #> 103 501.21394   3.739121   2 #> 104 501.55337   3.275987   2 #> 105 500.44195   2.665398   2 #> 106 606.13788   3.192040   2 #> 107 500.16855   2.610007   2 #> 108 579.03625   2.592616   2 #> 109 512.61945   2.583685   2 #> 110 500.64077   2.501588   2 #> 111 501.39081   3.197822   2 #> 112 747.92031   3.311076   2 #> 113 507.41017   3.090196   2 #> 114 614.76583   3.381540   2 #> 115 515.37906   2.812510   2 #> 116 528.84054   2.977556   2 #> 117 500.65677   2.641877   2 #> 118 523.11961   2.542086   2 #> 119 526.15889   2.553334   2 #> 120 503.02201   2.685961   2 #> 121 520.12552   3.530813   2 #> 122 550.46257   2.834371   2 #> 123 500.35285   3.552327   2 #> 124 500.26213   2.670976   2 #> 125 796.14642   3.158735   2 #> 126 501.44507   2.645470   2 #> 127 661.24339   2.678884   2 #> 128 500.47194   4.113163   2 #> 129 506.28945   2.834726   2 #> 130 668.68948   3.147358   2 #> 131 668.85179   2.546382   2 #> 132 668.72054   2.508498   2 #> 133 504.01073   2.568379   2 #> 134 596.16074   2.532800   2 #> 135 502.46222   2.510852   2 #> 136 697.23270   2.609561   2 #> 137 509.48058   3.050864   2 #> 138 685.14580   2.736243   2 #> 139 628.32678   2.535224   2 #> 140 647.57535   3.950726   2 #> 141 628.37386   3.584068   2 #> 142 554.88917   2.799861   2 #> 143 509.02022   2.715931   2 #> 144 552.66915   3.092459   2 #> 145 813.93348   3.300748   2 #> 146 500.33572   2.811853   2 #> 147 502.63978   2.841488   2 #> 148 593.19441   2.810974   2 #> 149 746.73465   2.500699   2 #> 150 716.30436   2.534106   2 #> 151 534.58674   3.153109   2 #> 152 500.31971   2.584033   2 #> 153 500.78107   2.535551   2 #> 154 515.84663   2.509405   2 #> 155 502.94267   3.010573   2 #> 156 624.40085   4.868124   2 #> 157 797.75272   2.747507   2 #> 158 819.68352   2.854715   2 #> 159 793.27383   2.817322   2 #> 160 798.58477   2.772103   2 #> 161 501.22802   3.028438   2 #> 162 501.32019   2.603310   2 #> 163 514.16316   2.989882   2 #> 164 502.87446   3.455327   2 #> 165 657.07452   2.679928   2 #> 166 501.34722   2.519756   2 #> 167 507.24801   3.670057   2 #> 168 577.28979   3.068350   2 #> 169 721.27877   2.742370   2 #> 170 583.07873   2.735960   2 #> 171 547.03661   2.738018   2 #> 172 629.61704   3.636524   2 #> 173 518.46696   2.759089   2 #> 174 572.08299   2.920029   2 #> 175 507.00818   2.609157   2 #> 176 505.34549   3.299995   2 #> 177 573.69146   2.593063   2 #> 178 505.59162   2.542850   2 #> 179 506.05863   3.359358   2 #> 180 506.32624   2.671205   2 #> 181 506.84129   2.687386   2 #> 182 581.84021   2.647259   2 #> 183 505.91469   3.682918   2 #> 184 505.34191   3.487336   2 #> 185 538.81174   2.609559   2 #> 186 505.30624   2.664992   2 #> 187 507.63329   2.668232   2 #> 188 509.10459   3.312228   2 #> 189 513.61828   4.932720   2 #> 190 765.91515   2.547543   2 #> 191 505.27282   3.123453   2 #> 192 568.27551   3.045658   2 #> 193 507.12501   2.712388   2 #> 194 514.26370   2.770946   2 #> 195 501.45047   2.670017   2 #> 196 959.51536   2.725465   2 #> 197 925.62978   3.415576   2 #> 198 507.11581   2.677732   2 #> 199 540.66056   3.344500   2 #> 200 515.46273   3.030437   2 #> 201 705.03482   3.416818   2 #> 202 500.82417   3.391459   2 #> 203 500.88425   2.586510   2 #> 204 502.01462   2.642525   2 #> 205 542.76155   2.781612   2 #> 206 560.96690   3.003038   2 #> 207 648.49538   2.510491   2 #> 208 501.14645   2.814105   2 #> 209 601.40844   3.416199   2 #> 210 572.42814   2.921499   2 #> 211 596.13410   2.651040   2 #> 212 566.84231   2.931921   2 #> 213 864.69121   2.537881   2 #> 214 761.83793   2.531512   2 #> 215 514.56009   2.945557   2 #> 216 591.48291   2.526466   2 #> 217 515.07067   3.029200   2 #> 218 505.76614   3.212461   2 #> 219 504.78503   2.709365   2 #> 220 523.40570   2.738517   2 #> 221 524.14927   2.991911   2 #> 222 516.71707   2.732893   2 #> 223 626.90982   2.687818   2 #> 224 627.00072   3.563606   2 #> 225 575.83093   2.560706   2 #> 226 530.54623   3.398595   2 #> 227 531.26650   2.500400   2 #> 228 729.67800   3.400682   2 #> 229 501.82389   2.545641   2 #> 230 969.09156   2.725072   2 #> 231 975.90705   2.876205   2 #> 232 883.28185   2.656989   2 #> 233 500.20436   2.886556   2 #> 234 651.06827   2.825957   2 #> 235 501.34062   2.826082   2 #> 236 556.69911   2.549704   2 #> 237 510.07965   2.819938   2 #> 238 569.15615   4.142500   2 #> 239 521.36419   2.707683   2 #> 240 569.74597   2.593703   2 #> 241 509.28305   2.997142   2 #> 242 561.19896   2.604302   2 #> 243 511.88215   3.678024   2 #> 244 511.78458   2.948154   2 #> 245 519.87024   2.538756   2 #> 246 512.45003   3.942367   2 #> 247 567.75530   2.559048   2 #> 248 566.92054   2.708490   2 #> 249 500.27608   3.809526   2 #> 250 531.21437   3.287352   2 #> 251 523.83715   2.540204   2 #> 252 507.87413   2.590544   2 #> 253 501.82594   2.559419   2 #> 254 509.03377   2.761553   2 #> 255 812.84486   2.617824   2 #> 256 521.56819   2.506882   2 #> 257 512.34953   3.371301   2 #> 258 500.40912   2.916633   2 #> 259 560.53366   3.720519   2 #> 260 500.12991   2.630403   2 #> 261 502.50057   2.537648   2 #> 262 500.85688   2.824421   2 #> 263 502.71277   4.402213   2 #> 264 500.49045   2.631610   2 #> 265 506.93438   2.539549   2 #> 266 500.27974   3.899730   2 #> 267 500.27072   3.130274   2 #> 268 516.32883   2.762024   2 #> 269 500.25768   2.572580   2 #> 270 665.71502   2.971483   2 #> 271 523.46486   5.289661   2 #> 272 574.97802   2.551626   2 #> 273 500.14620   2.637188   2 #> 274 500.18266   2.566903   2 #> 275 977.48871   2.702086   2 #> 276 519.78626   2.973830   2 #> 277 639.89200   2.618179   2 #> 278 558.81826   2.985094   2 #> 279 558.93805   2.554656   2 #> 280 504.66191   2.938856   2 #> 281 784.51314   2.551810   2 #> 282 525.77682   3.116730   2 #> 283 504.04993   2.674762   2 #> 284 501.20628   2.616551   2 #> 285 519.65354   2.827455   2 #> 286 763.67840   2.640945   2 #> 287 508.16734   2.919024   2 #> 288 500.32447   2.512279   2 #> 289 500.64983   3.708271   2 #> 290 500.55051   2.771308   2 #> 291 502.41330   4.294861   2 #> 292 542.66707   4.101107   2 #> 293 502.01082   2.518057   2 #> 294 502.24277   3.155815   2 #> 295 648.75053   2.755744   2 #> 296 502.20390   3.037174   2 #> 297 502.27395   2.912609   2 #> 298 501.09513   2.509522   2 #> 299 580.17961   2.514759   2 #> 300 988.73809   3.217140   2 #> 301 988.93894   2.731254   2 #> 302 511.73043   3.465493   2 #> 303 502.96387   2.778649   2 #> 304 500.80663   2.893697   2 #> 305 534.61937   2.637459   2 #> 306 506.15102   3.070923   2 #> 307 540.53985   2.533521   2 #> 308 944.29479   3.736826   2 #> 309 746.09170   2.577350   2 #> 310 712.73661   3.437141   2 #> 311 521.10293   2.658162   2 #> 312 729.58238   2.619029   2 #> 313 532.30410   2.522279   2 #> 314 531.84649   2.718255   2 #> 315 566.83943   2.804281   2 #> 316 505.31367   2.804896   2 #> 317 765.97248   2.545403   2 #> 318 684.96811   2.563037   2 #> 319 531.19372   2.554223   2 #> 320 810.99479   3.453636   2 #> 321 506.98059   2.530031   2 #> 322 500.23376   2.785242   2 #> 323 500.17441   2.680525   2 #> 324 516.15134   2.682077   2 #> 325 509.95569   3.490588   2 #> 326 507.79531   3.212810   2 #> 327 556.74916   2.736445   2 #> 328 518.02662   2.705611   2 #> 329 544.88776   2.623139   2 #> 330 564.57974   3.513990   2 #> 331 547.13714   3.378380   2 #> 332 500.14215   2.957481   2 #> 333 500.67735   3.000829   2 #> 334 501.27843   2.913135   2 #> 335 507.42114   3.746580   2 #> 336 911.24008   2.741916   2 #> 337 501.19270   3.641770   2 #> 338 507.46715   2.662337   2 #> 339 641.79563   2.631184   2 #> 340 619.46101   2.827212   2 #> 341 774.44560   3.539848   2 #> 342 622.37400   3.373600   2 #> 343 899.49577   3.220261   2 #> 344 222.49699   2.623775   2 #> 345 670.02398   2.603667   2 #> 346 684.37305   3.006248   2 #> 347 367.01413   3.058362   2 #> 348 478.00906   2.685457   2 #> 349 690.32369   2.626124   2 #> 350 705.95612   2.908912   2 #> 351 118.23588   2.708784   2 #> 352 558.86876   4.138886   2 #> 353 532.27328   3.145853   2 #> 354 530.95500   3.529450   2 #> 355 530.97291   2.920354   2 #> 356 337.38794   3.132456   2 #> 357 539.56107   2.725721   2 #> 358 541.47501   3.595976   2 #> 359 538.86250   2.551300   2 #> 360 587.53102   2.999123   2 #> 361 539.04071   2.602024   2 #> 362 539.64735   3.414264   2 #> 363 540.10855   2.690618   2 #> 364 539.18819   2.923885   2 #> 365 538.91654   3.590631   2 #> 366 565.75476   2.710368   2 #> 367 878.84254   3.546585   2 #> 368 573.85353   2.693273   2 #> 369 540.68243   2.579536   2 #> 370 540.09022   2.900316   2 #> 371 539.28148   3.110708   2 #> 372 546.09279   2.736666   2 #> 373 550.67795   2.751180   2 #> 374 541.65206   2.729642   2 #> 375 545.42571   2.961740   2 #> 376 575.73430   2.746423   2 #> 377 931.56886   3.087587   2 #> 378 540.66467   2.625091   2 #> 379 561.81795   3.520738   2 #> 380 749.86255   2.687613   2 #> 381 538.89508   2.579786   2 #> 382 887.63168   2.698569   2 #> 383 546.98052   2.709095   2 #> 384 539.17820   2.544359   2 #> 385 539.19562   3.141201   2 #> 386 550.67862   2.823923   2 #> 387 540.55978   3.222442   2 #> 388 538.88286   2.822639   2 #> 389 978.44341   3.321190   2 #> 390 539.02217   3.491318   2 #> 391 538.87747   2.508171   2 #> 392 605.10019   2.876891   2 #> 393 538.97217   2.530401   2 #> 394 576.30715   2.779740   2 #> 395 538.89197   2.586788   2 #> 396  82.01883   2.903887   2 #> 397  98.23184   2.533081   2 #> 398 823.83546   3.250923   2 #> 399 844.55008   2.775074   2 #> 400  46.28502   4.465944   2 #> 401 986.23157   3.170074   2 #> 402 153.78262   2.614575   2 #> 403 381.47883   2.537899   2 #>  #> [[4]] #>            ts magnitudes gen #> 1   598.10760   3.384707   3 #> 2   908.51814   2.680961   3 #> 3   506.59126   2.613649   3 #> 4   503.52943   2.806854   3 #> 5   501.66357   2.550475   3 #> 6   503.66706   2.999383   3 #> 7   529.87788   2.723142   3 #> 8   515.80065   3.057409   3 #> 9   501.90929   2.549091   3 #> 10  682.07158   3.527059   3 #> 11  727.09176   3.392870   3 #> 12  744.18236   3.206745   3 #> 13  551.45416   3.192428   3 #> 14  579.71317   2.559813   3 #> 15  615.71245   2.968654   3 #> 16  608.22507   2.542093   3 #> 17  658.06634   2.871973   3 #> 18  501.47343   2.564776   3 #> 19  580.78770   2.689858   3 #> 20  538.08387   2.619477   3 #> 21  932.69136   2.608121   3 #> 22  509.36656   3.397852   3 #> 23  711.76049   2.560149   3 #> 24  720.73628   2.623529   3 #> 25  814.04021   3.299374   3 #> 26  500.80265   2.852233   3 #> 27  512.07085   2.555028   3 #> 28  500.50190   2.600664   3 #> 29  686.01308   2.802795   3 #> 30  669.04550   2.927599   3 #> 31  507.41423   3.000805   3 #> 32  670.72850   2.950149   3 #> 33  553.67775   2.529850   3 #> 34  685.87168   3.134817   3 #> 35  640.11058   2.867367   3 #> 36  626.13160   3.308459   3 #> 37  625.47887   2.540260   3 #> 38  628.17028   2.581944   3 #> 39  630.19967   2.813063   3 #> 40  624.63731   3.374904   3 #> 41  624.69294   3.210046   3 #> 42  636.02454   2.693888   3 #> 43  633.05953   2.667174   3 #> 44  648.86271   3.092177   3 #> 45  649.33567   2.885360   3 #> 46  629.06692   2.557855   3 #> 47  508.10281   3.378175   3 #> 48  671.57782   2.741942   3 #> 49  889.06345   2.807298   3 #> 50  506.63382   2.635800   3 #> 51  563.08386   2.560531   3 #> 52  521.56306   2.861942   3 #> 53  513.64462   3.251657   3 #> 54  516.20111   2.623973   3 #> 55  514.13373   2.594297   3 #> 56  513.69138   2.813617   3 #> 57  532.32243   3.275205   3 #> 58  518.19967   2.979967   3 #> 59  522.18589   2.555233   3 #> 60  966.62632   2.988533   3 #> 61  513.65228   2.674577   3 #> 62  630.87678   3.152817   3 #> 63  500.96019   2.756966   3 #> 64  503.43230   2.786327   3 #> 65  546.83720   3.379512   3 #> 66  733.74711   2.624173   3 #> 67  627.70936   2.774433   3 #> 68  635.06496   2.827050   3 #> 69  587.16280   3.441669   3 #> 70  975.95527   2.908438   3 #> 71  974.65848   2.858561   3 #> 72  573.35410   2.701878   3 #> 73  523.50973   2.971495   3 #> 74  512.38643   3.249118   3 #> 75  669.99165   2.656042   3 #> 76  513.35879   2.563775   3 #> 77  507.26478   2.566741   3 #> 78  570.88100   2.706821   3 #> 79  591.80790   2.541505   3 #> 80  502.86671   2.883525   3 #> 81  530.80962   2.645383   3 #> 82  688.32072   3.855297   3 #> 83  556.59922   2.991518   3 #> 84  522.23961   2.734412   3 #> 85  503.91246   2.944757   3 #> 86  504.55649   2.573765   3 #> 87  500.41355   3.096724   3 #> 88  666.15648   2.540837   3 #> 89  528.45242   4.103252   3 #> 90  551.72701   3.756482   3 #> 91  523.60996   3.166792   3 #> 92  951.91681   3.023939   3 #> 93  528.55641   2.658797   3 #> 94  525.83055   2.607918   3 #> 95  529.49193   2.512054   3 #> 96  600.23099   3.288469   3 #> 97  523.57605   2.587038   3 #> 98  538.97629   2.801063   3 #> 99  523.56873   4.029172   3 #> 100 529.15440   3.105360   3 #> 101 649.65860   2.560762   3 #> 102 527.80910   3.426028   3 #> 103 539.32219   4.009821   3 #> 104 524.39596   2.624279   3 #> 105 709.41205   3.255643   3 #> 106 523.54076   5.247916   3 #> 107 524.23390   2.647387   3 #> 108 709.54993   2.611563   3 #> 109 570.86766   2.739701   3 #> 110 524.05146   2.858281   3 #> 111 761.39399   3.190981   3 #> 112 523.65169   2.545235   3 #> 113 523.46687   2.850646   3 #> 114 524.51016   2.732856   3 #> 115 781.34340   3.353939   3 #> 116 523.81548   2.666552   3 #> 117 525.16550   3.816401   3 #> 118 524.87075   2.693064   3 #> 119 525.14149   2.566560   3 #> 120 523.52153   2.965304   3 #> 121 529.55923   2.535593   3 #> 122 524.29869   3.570520   3 #> 123 523.52753   3.633991   3 #> 124 640.82791   2.778082   3 #> 125 782.97665   2.587094   3 #> 126 502.73203   2.691937   3 #> 127 519.86958   2.570915   3 #> 128 587.33329   2.707723   3 #> 129 944.96769   3.338220   3 #> 130 734.21721   2.704396   3 #> 131 505.31398   2.887787   3 #> 132 685.67111   2.954358   3 #> 133 564.58899   2.588645   3 #> 134 644.38341   3.022777   3 #> 135 570.01361   2.700527   3 #> 136 780.41637   2.554518   3 #> 137 900.97340   2.864401   3 #> 138 828.36348   2.747332   3 #> 139 683.88681   2.833549   3 #> 140 588.00759   3.179699   3 #> 141 678.15503   3.123550   3 #> 142 574.97325   3.343016   3 #> 143 581.36111   2.973515   3 #> 144 540.86984   2.553897   3 #> 145 540.64815   2.507257   3 #> 146 547.08681   2.529920   3 #> 147 548.40516   2.804647   3 #> 148 931.60074   3.122013   3 #> 149 563.17746   2.554134   3 #> 150 885.19098   2.523140   3 #> 151  93.54258   2.797434   3 #> 152 169.74399   2.873898   3 #> 153  46.59918   2.509750   3 #> 154  48.13161   3.059678   3 #> 155  79.92585   2.890986   3 #> 156  46.68798   2.651946   3 #> 157  48.35971   2.813767   3 #> 158  70.44844   2.769041   3 #> 159 381.66508   2.767596   3 #>  #> [[5]] #>          ts magnitudes gen #> 1  517.7868   3.900315   4 #> 2  744.7129   2.942565   4 #> 3  746.4708   3.784504   4 #> 4  796.4641   2.740428   4 #> 5  835.2044   3.065218   4 #> 6  671.7595   2.505603   4 #> 7  624.8104   2.586415   4 #> 8  514.4826   2.583329   4 #> 9  573.5130   3.218169   4 #> 10 535.0752   2.590848   4 #> 11 696.2025   5.211941   4 #> 12 689.3704   2.956530   4 #> 13 693.2980   2.595278   4 #> 14 558.7150   2.566360   4 #> 15 528.5225   2.529535   4 #> 16 530.4647   2.760079   4 #> 17 572.7281   3.537003   4 #> 18 525.4353   2.971801   4 #> 19 554.7342   2.680326   4 #> 20 526.0464   3.742792   4 #> 21 559.1348   2.538281   4 #> 22 635.1258   2.522762   4 #> 23 554.7605   2.918775   4 #> 24 523.7764   2.566994   4 #> 25 544.8183   2.855413   4 #> 26 802.8132   2.515685   4 #> 27 523.6501   3.259942   4 #> 28 523.8834   2.576577   4 #> 29 529.9775   3.361373   4 #> 30 527.6716   2.632436   4 #> 31 525.3709   2.805851   4 #> 32 523.5967   3.466807   4 #> 33 552.8426   2.673203   4 #> 34 523.5567   2.539399   4 #> 35 945.4961   2.533329   4 #> 36 707.3746   2.511016   4 #> 37 643.0591   3.658777   4 #> 38 738.4440   2.731622   4 #> 39 531.2101   2.725376   4 #> 40 658.1573   3.705441   4 #> 41 523.6394   3.710865   4 #> 42 523.5702   3.093742   4 #> 43 527.9697   2.563867   4 #> 44 616.9474   2.830509   4 #> 45 529.1334   2.708404   4 #> 46 523.9249   3.963339   4 #> 47 524.0305   2.941237   4 #> 48 699.6238   2.955622   4 #> 49 772.4540   2.698892   4 #> 50 635.6767   3.016168   4 #> 51 524.7412   2.740081   4 #> 52 523.9805   2.687662   4 #> 53 549.4790   2.569325   4 #> 54 523.7512   3.323548   4 #> 55 663.1035   2.902839   4 #> 56 575.3498   3.526021   4 #>  #> [[6]] #>          ts magnitudes gen #> 1  775.2042   2.940855   5 #> 2  979.8504   2.579232   5 #> 3  697.8586   3.170903   5 #> 4  698.3811   2.645436   5 #> 5  730.4502   2.741833   5 #> 6  696.2089   2.515917   5 #> 7  696.2144   2.690559   5 #> 8  700.5353   2.562594   5 #> 9  696.3319   2.545852   5 #> 10 744.0696   2.706900   5 #> 11 697.3512   2.705990   5 #> 12 696.4635   2.867251   5 #> 13 704.8753   2.852503   5 #> 14 696.2383   2.635723   5 #> 15 698.9680   3.163044   5 #> 16 715.9345   2.611692   5 #> 17 697.0928   3.441248   5 #> 18 703.4954   3.178042   5 #> 19 702.2003   2.724314   5 #> 20 721.8656   2.781169   5 #> 21 697.8345   4.144774   5 #> 22 702.0740   3.086206   5 #> 23 696.4648   2.710673   5 #> 24 696.3734   2.693556   5 #> 25 701.2410   2.818571   5 #> 26 831.5468   2.859327   5 #> 27 530.1680   3.074587   5 #> 28 862.6385   2.544756   5 #> 29 682.6773   2.593244   5 #> 30 523.8231   3.946670   5 #> 31 524.0984   2.852508   5 #> 32 699.7046   2.937820   5 #> 33 525.2423   2.995194   5 #>  #> [[7]] #>         ts magnitudes gen #> 1 775.8759   2.850637   6 #> 2 697.8692   3.043029   6 #> 3 701.2405   2.813703   6 #> 4 746.4742   3.153778   6 #> 5 698.0717   2.891734   6 #> 6 526.8213   2.760098   6 #> 7 533.0142   2.595879   6 #> 8 525.3967   2.854980   6 #>"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the posterior distribution of the expected number of events  get_posterior_N","title":"Plot the posterior distribution of the expected number of events  get_posterior_N","text":"Plot posterior distribution expected number events","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the posterior distribution of the expected number of events  get_posterior_N","text":"","code":"get_posterior_N(input.list, domain.extension = 0.1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the posterior distribution of the expected number of events  get_posterior_N","text":"input.list combined input file (link functions) bru output (marginals) domain.extension Percentage posterior quantiles extend domain specified scalar. Default set 0.10.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the posterior distribution of the expected number of events  get_posterior_N","text":"list three objects: post.df: data.frame containing posterior informations posterior distribution number events post.plot : ggplot object showing posterior distribution expected number events post.plot.shaded : ggplot object showing posterior distribution expected number events, shaded region corresponds 0.025 0.975 quantiles distribution distribution number events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve posterior distribution of ETAS parameters  get_posterior_param","title":"Retrieve posterior distribution of ETAS parameters  get_posterior_param","text":"Retrieve posterior distribution ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve posterior distribution of ETAS parameters  get_posterior_param","text":"","code":"get_posterior_param(input.list)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve posterior distribution of ETAS parameters  get_posterior_param","text":"input.list input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve posterior distribution of ETAS parameters  get_posterior_param","text":"list two elements: post.df : data.frame posterior distributions parameters columns x (value parameter), y (value posterior), param (parameter name) post.plot : ggplot object showing posterior distribution parameter","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS triggering function - used by inlabru  gt","title":"ETAS triggering function - used by inlabru  gt","text":"function returns value ETAS triggering function specified time t points history th, mh","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ETAS triggering function - used by inlabru  gt","text":"","code":"gt(theta, t, th, mh, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ETAS triggering function - used by inlabru  gt","text":"theta ETAS parameters list names K, alpha, c, p t Time function calculated, scalar vector th Time events history [days, months,...], scalar vector mh Magnitude events history, scalar vector M0 Minimum magnitude threshold, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ETAS triggering function - used by inlabru  gt","text":"value ETAS triggering function evaluated t history th, mh.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ETAS triggering function - used by inlabru  gt","text":"ETAS triggering function evaluated $$g(t - t_h | m_h) = K e^{\\alpha(m_h - M_0)} \\left( \\frac{t - t_h}{c} + 1\\right)^{-p}$$ \\(K, \\alpha, c > 0\\), \\(p \\geq 1\\) ETAS parameters, \\(t\\) (t) time function evaluated, considering past observation \\(t_h, m_h\\) (th, mh). function returns 0 \\(t_h > t\\). \\(t\\) scalar \\(t_h, m_h\\) vectors function returns vector, \\(t\\) vector \\(t_h, m_h\\) scalars, \\(t, t_h, m_h\\) vectors length. use \\(t\\) \\(t_h, m_h\\) vectors different lengths.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":null,"dir":"Reference","previous_headings":"","what":"HOURS Ita Catalogue  horus","title":"HOURS Ita Catalogue  horus","text":"HOmogenized instRUmental Seismic catalog (HORUS) Italy 1960 present","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"HOURS Ita Catalogue  horus","text":"","code":"data(horus, package = \"ETAS.inlabru\")"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"HOURS Ita Catalogue  horus","text":"Original file format: Year: Origin Time (OT) year Mo: OT month Da: OT day Ho: OT hour Mi OT minute Se OT seconds fractions Lat epicenter N latitude (degrees) Lon epicenter E longitude (degrees) Depth hypocenter depth (km) Mw true proxy moment magnitude sigMw moment magnitude uncertainty Geo.Ita \"*\" indicates epicenter within Italian mainland territory, otherwise \" \" Geo.CPTI15 \"*\" indicates epicenter within spatial window CPTI15 catalog (Rovida et al., 2020, Bull Earth Eng, doi: 10.1007/s10518-020-00818-y) Ev..type \"x\" indicates event earthquake (e.g. explosion, eruption, landslide, ...) (since May 1st 2012) Iside.n. ISIDe id number (since April 16th 2005) ETAS.inlabru format: lon: Original Lon lat: Original Lat M: Original Mw time_String: Combination original Year, Mo, Da, Mi, Se depth Original Depth catalog_id ??? event_id ???","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"HOURS Ita Catalogue  horus","text":"http://horus.bo.ingv./","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"HOURS Ita Catalogue  horus","text":"original entire HORUS catalog provided single tab separated ascii file: HORUS_Ita_Catalog.txt random second decimal digit added ML Md INGV bulletin (ISIDe) computing Mw proxies (Lolli et al., Seism. Res. Lett., 91, 3208-3222, doi: 10.1785/0220200148), HORUS_Ita_Catalog_o.txt original ML Md used compute Mw proxies. ETAS.inlabru includes reformatted version data HORUS_Ita_Catalog.txt data.frame. data provided , express implied warranty given.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"HOURS Ita Catalogue  horus","text":"Barbara Lolli(1), Daniele Randazzo(1), Gianfranco Vannucci(1) Paolo Gasperini (2),(1) (2020). Homogenized Instrumental Seismic Catalog (HORUS) Italy 1960 Present, Seismol. Res. Lett, doi: 10.1785/0220200148. (1) Istituto Nazionale di Geofisica e Vulcanologia, Sezione di Bologna (2) Dipartimento di Fisica e Astronomia, Universit di Bologna","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Exponential to a standard Normal distribution  inv_exp_t","title":"Copula transformation from an Exponential to a standard Normal distribution  inv_exp_t","text":"Copula transformation Exponential standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Exponential to a standard Normal distribution  inv_exp_t","text":"","code":"inv_exp_t(x, rate)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Exponential to a standard Normal distribution  inv_exp_t","text":"x values Exponential distribution, vector. rate rate Exponential distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Exponential to a standard Normal distribution  inv_exp_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Gamma to a standard Normal distribution  inv_gamma_t","title":"Copula transformation from an Gamma to a standard Normal distribution  inv_gamma_t","text":"Copula transformation Gamma standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Gamma to a standard Normal distribution  inv_gamma_t","text":"","code":"inv_gamma_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Gamma to a standard Normal distribution  inv_gamma_t","text":"x values Gamma distribution, vector. shape parameter Gamma distribution, scalar. b rate parameter Gamma distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Gamma to a standard Normal distribution  inv_gamma_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Log-Normal to a standard Normal distribution  inv_loggaus_t","title":"Copula transformation from an Log-Normal to a standard Normal distribution  inv_loggaus_t","text":"Copula transformation Log-Normal standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Log-Normal to a standard Normal distribution  inv_loggaus_t","text":"","code":"inv_loggaus_t(x, m, s)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Log-Normal to a standard Normal distribution  inv_loggaus_t","text":"x values Log-Normal distribution, vector. m mean logarithm Log-Normal distribution, scalar. s standard deviation logarithm Log-Normal distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Log-Normal to a standard Normal distribution  inv_loggaus_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Uniform to a standard Normal distribution  inv_unif_t","title":"Copula transformation from an Uniform to a standard Normal distribution  inv_unif_t","text":"Copula transformation Uniform standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Uniform to a standard Normal distribution  inv_unif_t","text":"","code":"inv_unif_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Uniform to a standard Normal distribution  inv_unif_t","text":"x values Uniform distribution, vector. minimum Uniform distribution, scalar. b maximum Uniform distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Uniform to a standard Normal distribution  inv_unif_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the integral of the ETAS conditional intensity  lambda_N","title":"Calculate the integral of the ETAS conditional intensity  lambda_N","text":"Calculate number events time interval T1 T2 given imposed events ETAS","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the integral of the ETAS conditional intensity  lambda_N","text":"","code":"lambda_N(th.mu, th.K, th.alpha, th.c, th.p, T1, T2, M0, Ht, link.functions)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the integral of the ETAS conditional intensity  lambda_N","text":"th.mu Background rate, mu, internal parameter scale th.K ETAS triggering parameter K internal parameter scale th.alpha ETAS triggering parameter alpha internal parameter scale th.c ETAS triggering parameter c internal parameter scale th.p ETAS triggering parameter p internal parameter scale T1 Start temporal model domain. T2 End temporal model domain. M0 Minimum magnitude threshold Ht History process, set known events interval. must data.frame columns ts (time) magnitudes (magnitudes). link.functions list functions transform parameters internal scale ETAS scale","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the integral of the ETAS conditional intensity  lambda_N","text":"Integral ETAS conditional intensity T1 T2 minimum magnitude M0, .e. expected number events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":null,"dir":"Reference","previous_headings":"","what":"Logarithm of the integral of the ETAS triggering function  log_Lambda_h","title":"Logarithm of the integral of the ETAS triggering function  log_Lambda_h","text":"Logarithm integral ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logarithm of the integral of the ETAS triggering function  log_Lambda_h","text":"","code":"log_Lambda_h(theta, th, mh, M0, T1, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logarithm of the integral of the ETAS triggering function  log_Lambda_h","text":"theta ETAS parameters data.frame(mu=mu, K=K, alpha=alpha, c=c, p=p). th Time parent event. mh Magnitude parent event M0 Minimum magnitude threshold T1 Start temporal model domain. T2 End temporal model domain.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logarithm of the integral of the ETAS triggering function  log_Lambda_h","text":"Logarithm integral ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Log-Normal distribution  loggaus_t","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution  loggaus_t","text":"Copula transformation standard Normal distribution Log-Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution  loggaus_t","text":"","code":"loggaus_t(x, m, s)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution  loggaus_t","text":"x values standard Normal distribution, vector. m mean logarithm Log-Normal distribution, scalar. s standard deviation logarithm Log-Normal distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution  loggaus_t","text":"Values Log-Normal distribution logarithmic mean m standard deviation s, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to calculate Omori's law  omori","title":"Function to calculate Omori's law  omori","text":"Function calculate Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to calculate Omori's law  omori","text":"","code":"omori(theta, t, ti)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to calculate Omori's law  omori","text":"theta ETAS parameters (list(mu = mu, K = K, alpha = alpha, c = c, p = p), parameters c p used t Time Omori's law evaluated ti Time event history","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to calculate Omori's law  omori","text":"Value Omori's law point t event happened ti","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot Omori's law corresponding to different posterior samples  omori_plot_posterior","title":"Function to plot Omori's law corresponding to different posterior samples  omori_plot_posterior","text":"Function plot Omori's law corresponding different posterior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot Omori's law corresponding to different posterior samples  omori_plot_posterior","text":"","code":"omori_plot_posterior(   input.list,   post.samp = NULL,   n.samp = 10,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot Omori's law corresponding to different posterior samples  omori_plot_posterior","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale post.samp data.frame containing posterior samples parameters. NULL, n.samp samples generated. n.samp different nrow(post.samp) n.samp rows uniformly sampled post.samp. Default NULL. n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot Omori's law corresponding to different posterior samples  omori_plot_posterior","text":"ggplot object","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot Omori's law corresponding to different prior samples  omori_plot_prior","title":"Function to plot Omori's law corresponding to different prior samples  omori_plot_prior","text":"Function plot Omori's law corresponding different prior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot Omori's law corresponding to different prior samples  omori_plot_prior","text":"","code":"omori_plot_prior(input.list, n.samp = 10, t.end = 1, n.breaks = 100)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot Omori's law corresponding to different prior samples  omori_plot_prior","text":"input.list structured input list least one element: link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot Omori's law corresponding to different prior samples  omori_plot_prior","text":"ggplot object","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the posterior densities of the ETAS parameters  post_pairs_plot","title":"Plot the posterior densities of the ETAS parameters  post_pairs_plot","text":"Plot posterior densities ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the posterior densities of the ETAS parameters  post_pairs_plot","text":"","code":"post_pairs_plot(   input.list = NULL,   n.samp = NULL,   post.samp = NULL,   max.batch = 1000 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the posterior densities of the ETAS parameters  post_pairs_plot","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp number samples draw posteriors plot post.samp data.frame columns mu, K, alpha, c, p rows corresponding different posterior samples. NULL function samples joint posterior distribution n.samp times. default NULL. max.batch parameter post_sampling function used case post.samp = NULL","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the posterior densities of the ETAS parameters  post_pairs_plot","text":"list: elements post.samp.df:data.frame posterior samples nrow = n.samp columns mu, K, alpha, c, p corresponding ETAS parameters. post.samp NULL returns post.samp pair.plot: ggplot object reporting pair plot parameters samples. obtained using ggpairs function Ggally library","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from the posterior of the ETAS parameters  post_sampling","title":"Sample from the posterior of the ETAS parameters  post_sampling","text":"Sample posterior ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from the posterior of the ETAS parameters  post_sampling","text":"","code":"post_sampling(input.list, n.samp, max.batch = 1000, ncore = 1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from the posterior of the ETAS parameters  post_sampling","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp number samples draw posteriors max.batch Maximum number posterior samples generated simultaneously. Default 1000. ncore Number cores used n.samp exceeds max.batch. Default 1","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from the posterior of the ETAS parameters  post_sampling","text":"data.frame posterior samples nrow = n.samp columns mu, K, alpha, c, p corresponding ETAS parameters.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":null,"dir":"Reference","previous_headings":"","what":"Return a sample of magnitudes drawn from the GR distribution  sample_GR_magnitudes","title":"Return a sample of magnitudes drawn from the GR distribution  sample_GR_magnitudes","text":"Return sample magnitudes drawn GR distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return a sample of magnitudes drawn from the GR distribution  sample_GR_magnitudes","text":"","code":"sample_GR_magnitudes(n, beta.p, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return a sample of magnitudes drawn from the GR distribution  sample_GR_magnitudes","text":"n Number events sample. beta.p Related b-value via b ln(10). M0 Minimum magnitude sample.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return a sample of magnitudes drawn from the GR distribution  sample_GR_magnitudes","text":"list magnitudes length n drawn GR distribution.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Return a sample of magnitudes drawn from the GR distribution  sample_GR_magnitudes","text":"","code":"sample_GR_magnitudes(n = 100, beta.p = log(10), M0 = 2.5) #>   [1] 3.544325 3.121890 2.631014 2.585954 2.567375 2.881726 2.847211 2.882442 #>   [9] 3.179070 2.747800 3.392866 3.426206 3.372658 2.796631 2.743077 2.744366 #>  [17] 2.597857 2.565713 2.760622 2.670170 3.267896 2.644113 2.587807 2.994843 #>  [25] 2.551790 3.120594 2.669004 3.185469 2.630070 3.128163 2.698467 3.147640 #>  [33] 2.752642 2.773860 2.618717 2.670396 2.900496 2.583092 2.527448 2.541848 #>  [41] 3.014915 2.908988 3.232841 2.700822 3.238270 2.735232 2.530886 2.722818 #>  [49] 2.505135 2.739027 3.356350 3.144723 2.882414 2.524979 2.796424 2.518683 #>  [57] 2.680029 2.534098 2.722990 2.783929 2.620151 3.506044 3.041701 2.637763 #>  [65] 3.536090 2.650102 2.747976 2.565123 2.668839 3.041399 3.270133 3.386621 #>  [73] 2.718416 2.688975 3.170372 3.830800 2.701111 2.669372 2.860431 3.384620 #>  [81] 3.120167 2.594937 2.621240 2.966003 2.862066 3.096857 3.273877 2.563261 #>  [89] 3.321476 2.601854 2.608951 3.820802 2.629123 2.745607 2.659644 2.523927 #>  [97] 4.611420 3.202184 3.064905 2.539446"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model.  sample_temporal_ETAS_daughters","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model.  sample_temporal_ETAS_daughters","text":"Generate sample new events data.frame(t_i, M_i) length n.ev one parent event occuring time t_h using ETAS model.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model.  sample_temporal_ETAS_daughters","text":"","code":"sample_temporal_ETAS_daughters(theta, beta.p, th, n.ev, M0, T1, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model.  sample_temporal_ETAS_daughters","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). th Time parent event [days]. n.ev number events placed. M0 Minimum magnitude synthetic catalogue. T1 Start time synthetic catalogue [days]. T2 End time synthetic catalogue [days].","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model.  sample_temporal_ETAS_daughters","text":"Generate sample new events data.frame(t_i, M_i) one parent","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":null,"dir":"Reference","previous_headings":"","what":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model  sample_temporal_ETAS_generation","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model  sample_temporal_ETAS_generation","text":"Take previous parent events Ht=data.frame[ts, magnitudes] generates daughters events using ETAS model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model  sample_temporal_ETAS_generation","text":"","code":"sample_temporal_ETAS_generation(theta, beta.p, Ht, M0, T1, T2, ncore = 1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model  sample_temporal_ETAS_generation","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). Ht set parent events form data.frame[ts, magnitudes] M0 minimum earthquake magnitude synthetic catalogue. T1 start time synthetic catalogue [days]. T2 end time synthetic catalogue [days]. ncore number compute cores use","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model  sample_temporal_ETAS_generation","text":"Return one generation daughters parents Ht form data.frame(t_i, M_i).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model  sample_temporal_ETAS_generation","text":"","code":"# The parents are specified in Ht Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) sample_temporal_ETAS_generation(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000,   Ht = Ht ) #>           ts magnitudes #> 1   500.0389   2.853449 #> 2   507.0653   2.685007 #> 3   505.8198   2.529634 #> 4   500.2101   2.754932 #> 5   500.2872   3.266490 #> 6   512.0314   3.381299 #> 7   500.4784   3.203864 #> 8   506.4639   2.715585 #> 9   501.5647   2.501301 #> 10  501.8192   2.749718 #> 11  500.1240   2.530998 #> 12  514.2169   2.787684 #> 13  546.3114   2.735124 #> 14  500.0697   2.653093 #> 15  553.7723   3.069370 #> 16  500.6240   2.746632 #> 17  585.9259   3.347066 #> 18  500.4076   3.032261 #> 19  520.7798   3.658860 #> 20  500.1619   2.690359 #> 21  599.4910   3.565443 #> 22  500.0527   2.530387 #> 23  511.6093   2.620783 #> 24  500.3571   4.000086 #> 25  891.1407   2.527887 #> 26  562.8445   2.553787 #> 27  500.6839   4.486687 #> 28  660.0465   2.577167 #> 29  500.6276   2.519343 #> 30  700.9847   3.469593 #> 31  501.2471   2.663365 #> 32  507.8828   3.221034 #> 33  551.4863   2.539513 #> 34  539.2085   2.850822 #> 35  500.3280   6.130673 #> 36  736.7688   2.613405 #> 37  645.9136   2.502712 #> 38  500.1628   3.303836 #> 39  599.0133   3.219468 #> 40  503.1313   3.360807 #> 41  528.8481   2.537575 #> 42  500.4307   3.082470 #> 43  503.0621   2.592038 #> 44  500.9103   2.920823 #> 45  500.0943   2.793684 #> 46  511.2338   3.613774 #> 47  779.7173   2.568959 #> 48  519.6774   3.834910 #> 49  500.0252   2.508391 #> 50  612.3361   2.852611 #> 51  610.6878   2.653043 #> 52  500.4774   4.864589 #> 53  555.2027   2.733858 #> 54  581.5433   2.501065 #> 55  500.2542   2.971196 #> 56  509.8652   2.834468 #> 57  504.7732   2.540910 #> 58  614.1012   2.639471 #> 59  500.0286   2.922449 #> 60  527.1828   3.101326 #> 61  500.2019   3.251469 #> 62  500.3127   2.707954 #> 63  500.0091   3.036720 #> 64  500.5622   2.889065 #> 65  500.0128   2.580129 #> 66  953.6511   3.012071 #> 67  501.7451   3.067636 #> 68  502.8552   2.948802 #> 69  713.9202   3.261042 #> 70  535.2569   2.561863 #> 71  500.3894   2.764359 #> 72  500.0592   3.015197 #> 73  500.2446   2.657509 #> 74  502.1531   2.801868 #> 75  502.9170   2.992197 #> 76  500.3373   2.733744 #> 77  989.8972   2.507597 #> 78  535.5355   2.714672 #> 79  500.4932   3.035876 #> 80  526.0654   3.417534 #> 81  531.6141   3.081371 #> 82  622.0649   3.204082 #> 83  511.5936   2.510862 #> 84  500.7621   2.910612 #> 85  500.2316   3.648487 #> 86  502.7659   2.930939 #> 87  605.0837   2.500572 #> 88  579.6285   2.727829 #> 89  500.5907   2.546050 #> 90  500.2527   2.547743 #> 91  594.8061   2.520861 #> 92  556.5526   2.728816 #> 93  500.1248   2.616959 #> 94  587.4161   3.136479 #> 95  885.1016   2.693257 #> 96  504.9571   3.298945 #> 97  500.3138   2.635237 #> 98  599.3016   3.701173 #> 99  500.1889   3.122083 #> 100 501.7054   3.399939 #> 101 500.1543   3.887919 #> 102 558.4263   2.739310 #> 103 868.0363   3.294713 #> 104 568.2655   3.098521 #> 105 501.6705   3.485431 #> 106 631.4634   3.240283 #> 107 531.2179   2.662642 #> 108 980.4196   3.116054 #> 109 624.3273   2.833731 #> 110 501.5921   2.670971 #> 111 502.1367   3.448216 #> 112 500.0152   2.961632 #> 113 522.4415   3.368767 #> 114 523.9627   3.062392 #> 115 500.4203   3.404060 #> 116 500.1835   2.717619 #> 117 500.0130   2.673227 #> 118 523.9773   3.040116 #> 119 508.1346   2.856741 #> 120 562.0104   3.697092 #> 121 505.2945   2.665749 #> 122 596.8465   3.168362 #> 123 526.2696   2.731856 #> 124 526.3153   2.725398 #> 125 500.2516   2.573885 #> 126 672.2179   3.357454 #> 127 500.3189   2.594217 #> 128 663.5551   3.580489 #> 129 503.3520   2.853706 #> 130 502.5566   3.855815 #> 131 500.0377   2.561142 #> 132 500.5414   3.013105 #> 133 518.7572   2.663494 #> 134 500.1463   2.764051 #> 135 531.6556   2.792836 #> 136 515.0391   2.524198 #> 137 509.4045   2.603766 #> 138 500.5023   3.036135 #> 139 501.2260   2.837340 #> 140 500.4955   2.881695 #> 141 500.0160   2.725424 #> 142 514.8758   3.237811 #> 143 500.2176   3.430649 #> 144 621.8028   3.651006 #> 145 500.5769   3.197746 #> 146 502.3042   2.910052 #> 147 500.4687   2.638631 #> 148 517.4511   2.790338 #> 149 507.1710   3.213713 #> 150 500.1867   2.888205 #> 151 770.2843   3.275736 #> 152 500.2967   2.725420 #> 153 517.8056   2.978140 #> 154 500.2942   2.529973 #> 155 501.0554   2.618001 #> 156 500.0981   2.878269 #> 157 501.6636   3.004358 #> 158 500.5754   2.669727 #> 159 500.1688   2.501959 #> 160 500.1097   3.592170 #> 161 502.1839   2.642358 #> 162 524.5224   2.645790 #> 163 512.8741   2.619168 #> 164 500.0276   2.868328 #> 165 500.0666   2.582497 #> 166 500.7544   2.671847 #> 167 500.7964   3.521943 #> 168 513.6883   2.635454 #> 169 507.2335   2.878779 #> 170 749.2202   2.500183 #> 171 501.2052   2.610195 #> 172 503.4632   2.610788 #> 173 500.1170   2.669203 #> 174 720.1785   2.583504 #> 175 715.4601   2.615128 #> 176 508.8137   2.575982 #> 177 500.4058   2.797473 #> 178 502.3298   2.723582 #> 179 604.3456   2.653870 #> 180 807.9465   3.570259 #> 181 507.5857   2.542832 #> 182 518.5241   2.885662 #> 183 506.8297   3.381677 #> 184 500.3682   2.555858 #> 185 888.5581   2.671977 #> 186 500.0216   4.063363 #> 187 521.9829   2.780508 #> 188 508.6890   2.888069 #> 189 574.0479   2.544261 #> 190 614.8342   3.166513 #> 191 500.5393   2.718410 #> 192 501.0401   2.732252 #> 193 500.0082   2.612007 #> 194 505.0353   3.507551 #> 195 500.3542   2.619539 #> 196 500.3468   2.750758 #> 197 513.7650   2.712001 #> 198 500.5161   3.454460 #> 199 617.7669   2.597106 #> 200 502.5293   2.845765 #> 201 500.3811   2.906141 #> 202 534.5161   2.726723 #> 203 500.6640   2.794869 #> 204 551.5693   3.369579 #> 205 500.1637   2.724613 #> 206 506.8609   2.570425 #> 207 500.3890   3.147620 #> 208 500.1760   2.517786 #> 209 500.1803   3.132099 #> 210 500.1096   3.265748 #> 211 500.0933   2.776303 #> 212 694.5903   2.708135 #> 213 500.0025   3.376421 #> 214 851.0230   2.679749 #> 215 519.3454   4.604874 #> 216 501.5024   2.784573 #> 217 548.0393   2.774036 #> 218 516.7034   3.522247 #> 219 500.1238   3.683115 #> 220 504.3917   2.958904 #> 221 501.5316   4.155978 #> 222 500.0690   2.596088 #> 223 500.5272   3.125300 #> 224 500.0152   2.691250 #> 225 500.4431   2.823209 #> 226 500.0906   2.507156 #> 227 500.0582   3.441814 #> 228 523.7634   2.874349 #> 229 743.9083   2.574074 #> 230 821.9418   2.668474 #> 231 502.6079   3.124940 #> 232 557.9531   2.581118 #> 233 510.7387   2.849490 #> 234 500.2431   2.844130 #> 235 507.2243   2.689794 #> 236 599.7597   3.277365 #> 237 501.3642   2.675870 #> 238 500.9348   3.126135 #> 239 511.4053   2.806871 #> 240 518.6999   2.809029 #> 241 500.0076   3.089162 #> 242 500.2465   3.187951 #> 243 500.8049   2.564361 #> 244 505.7532   2.969163 #> 245 500.2053   2.732512 #> 246 510.3835   3.029265 #> 247 500.5453   3.233496 #> 248 501.4655   2.735431 #> 249 803.1636   3.230579 #> 250 516.3905   2.543357 #> 251 500.0352   2.705003 #> 252 500.8490   2.701372 #> 253 507.6346   2.680109 #> 254 500.0220   2.902465 #> 255 500.0233   2.521569 #> 256 500.1859   2.819194 #> 257 597.3002   2.815781 #> 258 528.3660   2.965473 #> 259 740.0809   2.578983 #> 260 500.2343   2.892536 #> 261 505.2281   2.534628 #> 262 653.1060   5.365935 #> 263 500.4029   2.812270 #> 264 501.2158   3.539135 #> 265 513.6432   2.660967 #> 266 864.7337   2.774053 #> 267 505.2097   3.120105 #> 268 502.8889   3.857785 #> 269 502.6236   3.350076 #> 270 502.0651   2.692233 #> 271 948.2190   2.848066 #> 272 501.4079   3.183683 #> 273 501.2508   2.502015 #> 274 503.5814   2.777450 #> 275 644.8004   2.535605 #> 276 503.5797   3.006573 #> 277 531.6984   2.837109 #> 278 500.6106   2.799471 #> 279 501.3038   3.305668 #> 280 500.1479   3.314291 #> 281 503.7026   3.235709 #> 282 500.3518   2.644607 #> 283 500.0477   2.982140 #> 284 500.0107   2.511035 #> 285 520.3994   3.169919 #> 286 500.0176   2.874762 #> 287 500.1153   2.536614 #> 288 501.3770   2.933464 #> 289 500.2066   2.623400 #> 290 788.8164   3.139072 #> 291 649.7014   2.523952 #> 292 500.8563   2.579702 #> 293 500.1656   2.506324 #> 294 500.9026   3.719734 #> 295 643.0446   3.101073 #> 296 500.2695   2.958953 #> 297 503.3702   2.737911 #> 298 937.4120   3.615068 #> 299 500.4467   2.741981 #> 300 553.1629   2.613846 #> 301 501.3869   2.562726 #> 302 503.3933   2.689092 #> 303 503.5062   2.502308 #> 304 520.4348   2.657515 #> 305 505.6323   2.712976 #> 306 606.5057   3.265257 #> 307 500.7083   2.759121 #> 308 500.1019   6.030034 #> 309 500.6674   2.810655 #> 310 500.0132   2.503287 #> 311 501.2079   3.461427 #> 312 506.2893   2.701728 #> 313 506.7025   3.498091 #> 314 586.4280   2.826550 #> 315 500.3654   3.564952 #> 316 500.0299   2.599620 #> 317 506.4342   3.748724 #> 318 500.0169   2.907145 #> 319 504.3826   3.245381 #> 320 583.5435   2.807206 #> 321 530.1225   2.591806 #> 322 509.7966   3.475829 #> 323 500.2757   2.632415 #> 324 500.0171   2.564519 #> 325 536.1587   2.680643 #> 326 500.0979   2.755422 #> 327 500.7772   3.365528 #> 328 500.0981   2.796430 #> 329 514.4291   2.639009 #> 330 518.7975   3.244236 #> 331 502.6628   2.683082 #> 332 579.0319   2.862275 #> 333 504.5627   3.803916 #> 334 533.5210   4.025446 #> 335 510.0114   2.511900 #> 336 508.4163   3.315076 #> 337 501.5666   2.605562 #> 338 500.0939   2.567438 #> 339 698.5569   2.756508 #> 340 500.3227   2.574111 #> 341 509.3033   4.209051 #> 342 503.0528   2.913215 #> 343 500.1447   2.866512 #> 344 501.5676   3.054304 #> 345 530.1061   3.904275 #> 346 527.5068   3.253060 #> 347 647.8039   2.980637 #> 348 501.4001   2.603810 #> 349 500.0589   2.670800 #> 350 506.6157   2.688554 #> 351 500.1977   2.993225 #> 352 810.6210   3.619400 #> 353 503.8427   2.594200 #> 354 552.6215   2.622026 #> 355 820.9929   3.355497 #> 356 511.7997   3.241201 #> 357 500.0214   2.630976 #> 358 504.0874   4.297996 #> 359 502.9635   3.728007 #> 360 549.9182   2.989466 #> 361 504.0604   2.583455 #> 362 500.0845   2.643558 #> 363 526.9086   2.820875 #> 364 502.6072   3.223690 #> 365 501.0404   3.236380 #> 366 501.7190   2.706398 #> 367 504.5118   3.967322 #> 368 500.0380   3.520651 #> 369 735.6105   2.528418 #> 370 527.8997   3.213348 #> 371 502.2573   2.676613 #> 372 519.8032   3.228509 #> 373 500.0085   2.580191 #> 374 500.9265   2.778706 #> 375 736.4788   3.809041 #> 376 500.3425   4.314524 #> 377 504.8660   3.385201 #> 378 500.3149   2.626787 #> 379 505.7576   3.053179 #> 380 501.8370   2.668024 #> 381 502.5745   2.653469 #> 382 500.0100   3.661605 #> 383 528.6752   3.344695 #> 384 799.1642   2.724006 #> 385 504.3112   2.570985 #> 386 500.0107   2.560719 #> 387 503.7757   2.709840 #> 388 503.3312   2.957641 #> 389 600.9541   2.631483 #> 390 500.2719   3.373596 #> 391 500.9259   3.306028 #> 392 504.4311   2.739426 #> 393 511.8726   2.533406 #> 394 511.3843   2.682075 #> 395 502.5961   2.570887 #> 396 544.9374   2.757572 #> 397 501.0113   3.215187 #> 398 512.8227   2.519858 #> 399 519.0924   2.687890 #> 400 502.0965   2.624445 #> 401 516.5655   2.572250 #> 402 509.6697   3.043982 #> 403 510.6620   2.530319 #> 404 500.0922   2.882414 #> 405 505.8101   2.502520 #> 406 500.1225   2.702337 #> 407 500.7965   2.628866 #> 408 501.2488   2.649558 #> 409 500.3766   3.478752 #> 410 530.9450   2.669623 #> 411 517.6878   2.666941 #> 412 507.3738   2.897574 #> 413 500.2281   2.568007 #> 414 525.2482   2.663149 #> 415 533.4293   2.613592 #> 416 500.1404   2.625494 #> 417 513.2518   2.715248 #> 418 500.1180   2.640621 #> 419 500.0192   2.525136 #> 420 519.4023   2.564997 #> 421 715.6047   3.172082 #> 422 920.6082   2.611664 #> 423 930.6043   3.637093 #> 424 500.7073   2.626307 #> 425 593.6317   2.868331 #> 426 500.1236   3.058708 #> 427 502.5669   3.704910 #> 428 500.2395   2.740456 #> 429 526.3873   2.913546 #> 430 808.6830   2.861417 #> 431 501.3145   2.712063 #> 432 500.7991   2.563201 #> 433 507.6303   2.619276 #> 434 500.5591   3.094119 #> 435 502.0729   2.529979 #> 436 500.0558   3.274949 #> 437 681.6571   2.924559 #> 438 507.3487   4.846789 #> 439 500.0928   2.642246 #> 440 500.3238   2.848556 #> 441 502.2550   2.764205 #> 442 570.2147   3.148645 #> 443 500.2010   2.845262 #> 444 500.0659   2.847937 #> 445 500.4445   4.031302 #> 446 501.3898   2.628119 #> 447 500.6715   3.062651 #> 448 512.9573   2.565344 #> 449 502.0145   3.691140 #> 450 506.6233   2.738885 #> 451 545.0447   2.647229 #> 452 502.4992   2.558469 #> 453 500.0574   2.757777 #> 454 501.3583   2.779650 #> 455 515.9619   2.582793 #> 456 500.4143   2.867789 #> 457 513.3055   4.209349 #> 458 500.6039   2.642745 #> 459 535.8023   3.536252 #> 460 552.4422   2.582765 #> 461 507.3472   3.479840 #> 462 500.0342   2.847412 #> 463 501.1054   2.759035 #> 464 746.2911   3.171571 #> 465 501.8790   2.764685 #> 466 501.4683   2.613946 #> 467 500.6370   3.200081 #> 468 500.5823   2.635416 #> 469 697.2752   3.380920 #> 470 503.5235   2.660780 #> 471 500.3603   2.633936 #> 472 511.0219   4.084314 #> 473 656.8201   2.825389 #> 474 500.4986   2.867865 #> 475 506.7521   2.742507 #> 476 501.0921   3.302146 #> 477 500.3884   3.303249 #> 478 592.0354   2.932685 #> 479 540.5489   3.473078 #> 480 533.1308   4.428020 #> 481 557.2986   2.976917 #> 482 581.7153   3.241238 #> 483 500.6974   2.933211 #> 484 501.3347   2.577518 #> 485 500.7129   2.859047 #> 486 500.1594   3.112348 #> 487 515.5567   2.802865 #> 488 894.8027   3.259299 #> 489 501.2907   2.832443 #> 490 549.9302   3.611415 #> 491 699.3883   2.596516 #> 492 728.6794   3.025080 #> 493 500.3762   3.173404 #> 494 500.3087   2.796273 #> 495 501.4892   3.313631 #> 496 500.2122   2.615607 #> 497 500.7717   2.504510 #> 498 503.1973   2.612724 #> 499 503.7634   3.163852 #> 500 759.8334   3.420501 #> 501 500.0283   2.588824 #> 502 500.0034   2.572385 #> 503 500.4675   2.663852 #> 504 501.1791   3.346540 #> 505 503.6159   2.525230 #> 506 532.6071   2.716475 #> 507 638.0258   2.867904 #> 508 500.0194   2.933862 #> 509 500.1833   4.418414 #> 510 500.3159   2.527172 #> 511 507.9216   2.680724 #> 512 559.7045   2.652581 #> 513 666.8193   3.402090 #> 514 510.6973   2.541739 #> 515 500.5952   2.536014 #> 516 500.3056   3.102427 #> 517 995.1302   3.055759 #> 518 546.5216   2.991617 #> 519 502.4832   2.507628 #> 520 699.9593   4.730748 #> 521 509.9541   2.793613 #> 522 514.7438   2.621157 #> 523 533.8403   3.328063 #> 524 502.3334   2.528871 #> 525 511.8551   2.594880 #> 526 623.9047   2.518681 #> 527 500.0018   2.669849 #> 528 502.0737   2.863199 #> 529 514.7688   2.647987 #> 530 500.3895   3.201357 #> 531 614.5713   2.689537 #> 532 501.4644   2.593705 #> 533 506.8976   3.143161 #> 534 500.0051   2.759814 #> 535 534.4197   2.627292 #> 536 511.9903   2.848858 #> 537 500.0087   2.722262 #> 538 500.0204   2.708251 #> 539 767.6663   2.721647 #> 540 503.8472   2.755614 #> 541 500.0818   3.353853 #> 542 534.7776   3.154477 #> 543 607.4350   3.476395 #> 544 754.4744   2.911326 #> 545 504.5157   2.618307 #> 546 500.2532   2.708335 #> 547 500.2702   2.937801 #> 548 500.2953   2.802623 #> 549 500.1128   3.040085 #> 550 501.1864   2.600729 #> 551 502.1645   2.562674 #> 552 500.0260   3.040206 #> 553 502.3630   3.075603 #> 554 627.1537   3.313474 #> 555 517.7613   2.820093 #> 556 695.7244   2.999768 #> 557 500.2803   2.539272 #> 558 950.6620   2.548974 #> 559 503.1372   3.187537 #> 560 504.1614   4.622355 #> 561 517.1090   2.724353 #> 562 508.9245   2.842169 #> 563 500.5494   2.682522 #> 564 507.4436   2.693230 #> 565 501.1010   2.528924 #> 566 649.1268   3.956670 #> 567 585.2137   3.081809 #> 568 500.1160   2.988802 #> 569 500.3757   2.560537 #> 570 500.0998   2.873531 #> 571 529.2571   3.095810 #> 572 500.2206   2.806943 #> 573 501.4676   2.639238 #> 574 700.1146   2.551248 #> 575 528.7058   2.539196 #> 576 955.8941   2.624875 #> 577 500.4494   2.883287 #> 578 505.0251   3.146489 #> 579 522.3165   2.677360 #> 580 810.4231   2.770922 #> 581 508.0893   3.234840 #> 582 563.2770   3.400772 #> 583 505.9713   3.391439 #> 584 501.6154   3.232440 #> 585 508.0004   2.742736 #> 586 504.4606   2.543356 #> 587 502.8984   2.603801 #> 588 523.2133   2.814891 #> 589 500.5053   2.561888 #> 590 500.5763   2.621289 #> 591 500.0225   3.213010 #> 592 500.3587   3.045587 #> 593 500.1105   2.645117 #> 594 500.6648   2.857744 #> 595 500.2233   2.536976 #> 596 500.2990   3.436431 #> 597 506.3744   2.826380 #> 598 653.7309   2.549154 #> 599 502.3387   3.574318 #> 600 500.0367   4.426441 #> 601 615.8842   2.547232 #> 602 500.2992   3.855429 #> 603 500.2687   2.735587 #> 604 503.6699   2.815843 #> 605 500.0406   2.912398 #> 606 546.9871   2.727298 #> 607 591.1051   3.080085 #> 608 502.0325   2.629765 #> 609 690.3065   2.584479 #> 610 501.4580   5.152392 #> 611 521.4346   2.846116 #> 612 522.4283   3.078973 #> 613 947.9802   2.810749 #> 614 501.1641   3.092707 #> 615 520.6959   2.951712 #> 616 501.2729   2.651042 #> 617 503.7110   2.568855 #> 618 838.1423   3.130293 #> 619 501.5809   2.577199 #> 620 646.7367   2.971855 #> 621 551.2104   2.832384 #> 622 519.1866   2.581805 #> 623 500.3727   2.504218 #> 624 502.5739   2.526894 #> 625 552.6880   2.720322 #> 626 517.4258   2.731760 #> 627 506.7289   3.012251 #> 628 500.0198   2.863104 #> 629 626.9273   2.790752 #> 630 656.8730   3.502747 #> 631 500.8960   3.483232 #> 632 606.1385   3.249410 #> 633 508.8285   2.889308 #> 634 678.3468   2.809353 #> 635 611.4585   2.574217 #> 636 878.5042   2.798070 #> 637 500.3360   2.907838 #> 638 500.6079   2.952656 #> 639 501.0126   2.525170 #> 640 501.4115   2.582943 #> 641 879.0269   3.583192 #> 642 587.2533   2.818344 #> 643 500.0780   2.610979 #> 644 504.7782   2.697811 #> 645 500.9455   3.226913 #> 646 502.1946   2.543792 #> 647 529.5251   2.697844 #> 648 502.8497   2.856248 #> 649 558.9738   4.438656 #> 650 500.0202   3.466527 #> 651 502.9966   3.087535 #> 652 500.3688   2.773254 #> 653 500.8420   2.737543 #> 654 500.1939   3.008831 #> 655 506.9534   2.839388 #> 656 500.0714   3.081099 #> 657 782.8013   2.600434 #> 658 570.7948   3.116957 #> 659 502.0798   2.558354 #> 660 968.6985   2.542315 #> 661 782.0825   3.113607 #> 662 848.4764   3.221141 #> 663 575.8307   3.366556 #> 664 500.1842   3.384649 #> 665 532.9450   2.714143 #> 666 500.1381   2.944476 #> 667 535.0341   2.586747 #> 668 505.5890   2.989545 #> 669 501.8655   2.647601 #> 670 500.0142   3.021037 #> 671 500.8602   2.818062 #> 672 504.6751   2.524047 #> 673 502.4366   2.541787 #> 674 538.4237   2.992916 #> 675 759.8590   2.756374 #> 676 503.3269   2.999047 #> 677 522.0457   3.256697 #> 678 507.4275   2.839517 #> 679 517.9368   2.585178 #> 680 537.9943   2.792848 #> 681 500.0488   2.569016 #> 682 526.0900   2.630901 #> 683 500.2709   3.047475 #> 684 617.7315   2.548756 #> 685 503.7280   2.552768 #> 686 763.2167   2.825409 #> 687 523.3367   2.741181 #> 688 500.9599   2.844125 #> 689 501.2018   2.574484 #> 690 500.1179   2.906065 #> 691 517.6154   2.904149 #> 692 511.6409   2.883396 #> 693 500.0183   2.757087 #> 694 803.3289   3.637767 #> 695 500.0355   2.874519 #> 696 525.1159   2.818635 #> 697 500.4509   2.920602 #> 698 590.4991   2.527343 #> 699 500.0077   2.635248 #> 700 500.1293   3.369262 #> 701 504.8616   2.858816 #> 702 668.3518   2.544966 #> 703 533.9554   3.460718 #> 704 500.2415   2.709366 #> 705 516.3595   2.647333 #> 706 598.9380   3.210103 #> 707 512.5446   3.287565 #> 708 500.8133   2.762881 #> 709 500.0309   2.667334 #> 710 500.2453   2.576424 #> 711 799.6693   2.770835 #> 712 517.8949   2.772328 #> 713 585.5866   2.916387 #> 714 506.9653   2.521566 #> 715 500.0515   3.323506 #> 716 502.6693   2.578693 #> 717 533.4869   2.660706 #> 718 537.5760   2.521214 #> 719 500.0984   2.837817 #> 720 501.4654   2.669613 #> 721 501.2136   2.503090 #> 722 699.4071   3.090311 #> 723 500.0018   2.816674 #> 724 512.7403   3.288443 #> 725 691.7659   3.130214 #> 726 501.2417   3.106486 #> 727 502.8802   2.636362 #> 728 504.3700   2.676241 #> 729 515.3452   3.893228 #> 730 501.9805   2.542978 #> 731 500.1107   3.225116 #> 732 500.2091   2.511613 #> 733 518.1998   4.894854 #> 734 500.5211   2.751067 #> 735 500.5059   2.823439 #> 736 515.8417   2.732525 #> 737 501.3310   3.241920 #> 738 504.7925   3.699988 #> 739 508.0123   2.674841 #> 740 649.6495   2.597924 #> 741 501.2426   2.577017 #> 742 567.3439   3.064467 #> 743 502.0558   4.732749 #> 744 504.7738   3.556647 #> 745 500.0810   2.720516 #> 746 799.3205   2.568836 #> 747 502.6522   3.150333 #> 748 547.8243   2.906825 #> 749 501.0368   3.396905 #> 750 500.0948   2.713597 #> 751 500.4117   3.056897 #> 752 530.2000   2.885231 #> 753 504.8438   2.617486 #> 754 531.2590   2.539116 #> 755 500.5244   2.814934 #> 756 508.8274   2.600723 #> 757 526.6201   2.990605 #> 758 500.3081   2.850136 #> 759 533.6932   3.561441 #> 760 500.0420   2.766003 #> 761 500.8360   3.293557 #> 762 500.7271   2.503315 #> 763 500.2057   2.880977 #> 764 501.2960   2.905554 #> 765 503.9530   2.705278 #> 766 507.7694   3.585240 #> 767 510.6625   2.601246 #> 768 500.2924   2.827364 #> 769 500.5594   2.997797 #> 770 501.2758   3.105423 #> 771 546.0086   2.716717 #> 772 500.8171   2.565926 #> 773 503.6630   3.327334 #> 774 500.1538   2.515489 #> 775 500.0951   2.674392 #> 776 502.1420   2.961003 #> 777 658.3810   2.940409 #> 778 501.1757   3.020804 #> 779 500.0690   2.932397 #> 780 500.6721   3.238333 #> 781 506.7767   2.995725 #> 782 500.4224   2.636946 #> 783 505.1526   3.193126 #> 784 539.9397   2.727992 #> 785 534.7171   2.816438 #> 786 500.5686   3.055331 #> 787 500.0635   2.539054 #> 788 570.9495   2.567290 #> 789 502.3422   3.261075 #> 790 991.2748   4.495730 #> 791 770.4474   2.556003 #> 792 524.2895   2.501344 #> 793 500.2229   3.595934 #> 794 515.2527   3.265401 #> 795 530.4537   2.619920 #> 796 511.5293   2.749365 #> 797 500.6051   3.047371 #> 798 500.3538   3.082712 #> 799 610.7205   2.720357 #> 800 500.0799   2.760362 #> 801 511.6167   3.142969 #> 802 500.2948   3.534925 #> 803 509.0612   2.955346 #> 804 659.4368   2.701667 #> 805 534.1805   2.677629 #> 806 503.5167   2.549909 #> 807 500.0851   3.088147 #> 808 664.9747   3.361958 #> 809 977.6763   2.823133 #> 810 500.1931   3.278842 #> 811 500.0014   2.678560 #> 812 519.6728   2.658423 #> 813 530.9324   3.196088 #> 814 500.7763   2.526652 #> 815 500.7823   2.866987 #> 816 500.6073   2.628492 #> 817 500.0313   2.869266 #> 818 689.5342   3.922857 #> 819 500.1275   2.579425 #> 820 721.3425   2.822336 #> 821 784.6060   3.070131 #> 822 507.1257   3.565637 #> 823 500.4046   3.643437 #> 824 755.3170   2.803775 #> 825 500.0653   2.973994 #> 826 706.3191   2.855120 #> 827 500.0294   2.756573 #> 828 503.6481   2.617821 #> 829 737.7017   3.051023 #> 830 500.0056   2.762962 #> 831 506.6681   3.153027 #> 832 503.3835   3.301855 #> 833 500.7618   2.971950 #> 834 500.1338   2.746620 #> 835 519.0533   2.928184 #> 836 500.7993   4.318129 #> 837 500.0146   2.775586 #> 838 504.9049   2.612269 #> 839 517.6103   2.841814 #> 840 514.5680   3.193831 #> 841 500.1657   2.738745 #> 842 805.6325   2.543975 #> 843 503.1729   2.594504 #> 844 500.1509   2.853219 #> 845 501.2315   2.978070 #> 846 501.4855   2.528479 #> 847 500.0449   2.695042 #> 848 645.3654   2.720901 #> 849 556.4570   3.239246 #> 850 550.7409   2.576505 #> 851 521.7947   2.784217 #> 852 500.1170   2.512670 #> 853 501.7737   2.584735 #> 854 508.3546   3.053993 #> 855 500.6930   2.590486 #> 856 500.0242   2.562957 #> 857 500.2535   2.619755 #> 858 500.0415   2.828343 #> 859 659.1714   2.660652 #> 860 500.2570   2.997314 #> 861 503.9144   2.746425 #> 862 564.5329   3.942340 #> 863 508.9287   2.720470 #> 864 500.8606   2.564689 #> 865 588.3908   2.577854 #> 866 500.2565   3.522750 #> 867 590.1738   2.909960 #> 868 501.5133   3.534077 #> 869 501.5217   2.950382 #> 870 802.8831   2.624533 #> 871 500.4392   3.562937 #> 872 522.5904   4.601657 #> 873 500.3355   3.442155 #> 874 500.1185   3.103695 #> 875 500.5086   2.903914 #> 876 500.0024   2.894110 #> 877 518.3045   3.039365 #> 878 506.0392   2.791585 #> 879 502.3433   2.544836 #> 880 522.9091   2.817307 #> 881 516.8781   2.529550 #> 882 695.3307   2.539403 #> 883 500.2245   2.716865 #> 884 500.9191   2.555625 #> 885 500.0267   3.078881 #> 886 505.0415   3.035927 #> 887 501.1024   3.007714 #> 888 503.8930   2.743236 #> 889 593.3557   2.564191 #> 890 500.2083   2.640039 #> 891 500.1587   2.616126 #> 892 523.5573   2.751298 #> 893 537.8583   2.718099 #> 894 500.0216   2.576378 #> 895 599.5114   2.562398 #> 896 521.9732   2.835485 #> 897 530.7868   3.122281 #> 898 503.0986   3.637227 #> 899 534.0506   2.565916 #> 900 701.0727   2.666371 #> 901 500.0529   2.866858 #> 902 500.3829   3.233794 #> 903 526.4763   2.572969 #> 904 510.1776   3.009666 #> 905 506.3294   3.057484 #> 906 500.0455   2.582218 #> 907 501.6709   2.610164 #> 908 593.5196   2.984556 #> 909 501.0766   2.914642 #> 910 766.6590   2.867500 #> 911 552.4871   2.672945 #> 912 528.2249   3.965379"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":null,"dir":"Reference","previous_headings":"","what":"Sampling times for events triggered by a parent at th according to the ETAS triggering function  sample_temporal_ETAS_times","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function  sample_temporal_ETAS_times","text":"Sampling times events triggered parent th according ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function  sample_temporal_ETAS_times","text":"","code":"sample_temporal_ETAS_times(theta, n.ev, th, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function  sample_temporal_ETAS_times","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). n.ev Number events return sample time domain (th, T2]. th Time parent event producing n.ev daughters. T2 End time model domain.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function  sample_temporal_ETAS_times","text":"t.sample list times interval [0, T2] distributed according ETAS triggering function.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":null,"dir":"Reference","previous_headings":"","what":"Title  sample_temporal_injection_events","title":"Title  sample_temporal_injection_events","text":"Title","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title  sample_temporal_injection_events","text":"","code":"sample_temporal_injection_events(   a = 50,   V.i = 1,   tau = 10,   beta.p,   M0,   T.i,   T2 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title  sample_temporal_injection_events","text":"Induced event rate per unit volume. V.Injected volume tau Decay rate [days]. beta.p Related b-value via b ln(10). M0 Minimum magnitude threshold. T.Time injection [days]. T2 End temporal model domain [days].","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title  sample_temporal_injection_events","text":"Catalogue parent events induced injection; data.frame(times, magnitudes)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a set of time bins for a specific event.  time_grid","title":"Generate a set of time bins for a specific event.  time_grid","text":"Generate set time bins specific event.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a set of time bins for a specific event.  time_grid","text":"","code":"time_grid(data.point, coef.t, delta.t, N.exp., T1., T2.)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a set of time bins for a specific event.  time_grid","text":"data.point Point binning calculated, list elements time (ts, scalar), event index (idx.p, scalar). Names mandatory changed coef.t TimeBinning parameter: look breaks_exp() delta.t TimeBinning parameter: look breaks_exp() N.exp. TimeBinning parameter: look breaks_exp() T1. Start temporal domain, scalar T2. End temporal domain scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a set of time bins for a specific event.  time_grid","text":"data.frame many rows number bins fixed number columns. columns t.start : starting point bin (minimum = T1.). t.end : end point bin. (maximum = T2.). t.bin.name : unique bin identifier. t.ref_layer : bin identifier calculations ts : time provided data.point idx.p : identifier provided data.point bins T1. T2. containing T1.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a set of time bins for a specific event.  time_grid","text":"","code":"## EXAMPLE 1 event <- list(ts = 0, idx.p = 1) time_grid(data.point = event, coef.t = 1, delta.t = 0.1, N.exp. = 8, T1. = 1, T2. = 20) #>   t.start t.end t.bin.name t.ref_layer ts idx.p #> 1     1.0   1.6    0.8-1.6   between-1  0     1 #> 2     1.6   3.2    1.6-3.2           6  0     1 #> 3     3.2   6.4    3.2-6.4           7  0     1 #> 4     6.4  12.8   6.4-12.8           8  0     1 #> 5    12.8  20.0    12.8-20      last-1  0     1"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot the ETAS triggering function corresponding to different posterior samples  triggering_fun_plot","title":"Function to plot the ETAS triggering function corresponding to different posterior samples  triggering_fun_plot","text":"Function plot ETAS triggering function corresponding different posterior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot the ETAS triggering function corresponding to different posterior samples  triggering_fun_plot","text":"","code":"triggering_fun_plot(   input.list,   post.samp = NULL,   n.samp = 10,   magnitude = 4,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot the ETAS triggering function corresponding to different posterior samples  triggering_fun_plot","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale post.samp data.frame containing posterior samples parameters. NULL, n.samp samples generated. n.samp different nrow(post.samp) n.samp rows uniformly sampled post.samp. Default NULL n.samp Number posterior samples, integer (default = 10). magnitude Magnitude event triggering function calculated, scalar (default = 4). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot the ETAS triggering function corresponding to different posterior samples  triggering_fun_plot","text":"ggplot object grey lines representing triggering function posterior sample. Black lines representing 0.025 0.975 quantiles function values calculated posterior sample. Horizontal red lines represents 0.025 0.975 quantiles sampled background rates.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot the ETAS triggering function corresponding to different prior samples  triggering_fun_plot_prior","title":"Function to plot the ETAS triggering function corresponding to different prior samples  triggering_fun_plot_prior","text":"Function plot ETAS triggering function corresponding different prior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot the ETAS triggering function corresponding to different prior samples  triggering_fun_plot_prior","text":"","code":"triggering_fun_plot_prior(   input.list,   magnitude = 4,   n.samp = 10,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot the ETAS triggering function corresponding to different prior samples  triggering_fun_plot_prior","text":"input.list structured input list least one element: link.functions: list functions convert ETAS parameters INLA scale ETAS scale magnitude Magnitude event triggering function calculated, scalar (default = 4). n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot the ETAS triggering function corresponding to different prior samples  triggering_fun_plot_prior","text":"ggplot object grey lines representing triggering function posterior sample. Black lines representing 0.025 0.975 quantiles function values calculated posterior sample. Horizontal red lines represents 0.025 0.975 quantiles sampled background rates.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Uniform distribution  unif_t","title":"Copula transformation from a standard Normal distribution to a Uniform distribution  unif_t","text":"Copula transformation standard Normal distribution Uniform distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Uniform distribution  unif_t","text":"","code":"unif_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Uniform distribution  unif_t","text":"x values standard Normal distribution, vector. minimum value Uniform distribution, scalar. b maximum value Uniform distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Uniform distribution  unif_t","text":"values Uniform distribution b, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/news/index.html","id":"etasinlabru-development-version","dir":"Changelog","previous_headings":"","what":"ETAS.inlabru (development version)","title":"ETAS.inlabru (development version)","text":"Cleaned R package structure Added vignettes package website Renamed functions avoid . non-S3-method function names. Temporal.ETAS.* functions retain ., now.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/news/index.html","id":"etasinlabru-101","dir":"Changelog","previous_headings":"","what":"ETAS.inlabru 1.0.1","title":"ETAS.inlabru 1.0.1","text":"Initial package version.","code":""}]
