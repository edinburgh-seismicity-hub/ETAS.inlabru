[{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/generateSyntheticCatalogues.html","id":"create-catalogue","dir":"Articles","previous_headings":"","what":"Create catalogue","title":"Generating synthetic temporal ETAS catalogues","text":"define ETAS parameters define model domain specify history generate ETAS sample plot results","code":"mu <- 1070. / 365 K <- 0.089 alpha <- 2.29 c <- 0.011 p <- 1.08  modelledDuration <- 10 # [days]  M0 <- 2  theta_etas <- data.frame(mu = mu, K = K, alpha = alpha, c = c, p = p)  Ht <- data.frame(ts = c(0., 1.5), magnitudes = c(6.7, 7.))  samp.etas.list <- generate_temporal_ETAS_synthetic(theta = theta_etas, beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = Ht)  ggplot() +   geom_point(data = samp.etas.list[[1]], aes(x = ts, y = magnitudes), color = \"red\") +   geom_point(data = samp.etas.list[[2]], aes(x = ts, y = magnitudes), color = \"green\") +   xlim(0, modelledDuration) +   ggtitle(\"M7 plus background and ETAS\") combined.M7.ETAS.cat <- bind_rows(samp.etas.list)  combined.M7.ETAS.cat <- bind_rows(samp.etas.list) combined.M7.ETAS.cat <- combined.M7.ETAS.cat[order(combined.M7.ETAS.cat$ts), ]  combined.M7.ETAS.cat$ID <- seq(1, length(combined.M7.ETAS.cat$ts))  ggplot() +   geom_point(data = combined.M7.ETAS.cat, aes(x = ID, y = magnitudes), color = \"red\") #+ #  geom_ma(data = combined.M7.ETAS.cat, aes(x=ID, y=magnitudes), ma_fun = SMA, n = 10)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"multiple-analyses-of-two-catalogues-using-different-initial-values","dir":"Articles","previous_headings":"","what":"Multiple analyses of two catalogues using different initial values","title":"Sensitivity to starting point","text":"inlabru algorithm takes initial guess mode parameters inverting iteratively updates initial guess. potential may bad initial conditions find different solutions runtime differ depending upon solution converges. notebook, explore robustness posteriors two synthetic catalogues true parameters known. catalogues contain 2000 days data. One catalogue contain large event second contains M6.7 event day 1000.","code":"library(ETAS.inlabru)  library(tidyquant) library(gridExtra) library(grid) library(lemon) library(ggplot2) library(ggpubr) library(GGally)  library(inlabru) library(INLA) library(ETAS.inlabru)  # inla.setOption(pardiso.license=\"~/sys/licences/pardiso.lic\")  library(dplyr)  # Increase num.threads if you have more cores on your computer INLA::inla.setOption(num.threads = 2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"define-the-parameters-for-the-synthetic-catalogues-and-starting-values-for-inversion","dir":"Articles","previous_headings":"Multiple analyses of two catalogues using different initial values","what":"Define the parameters for the synthetic catalogues and starting values for inversion","title":"Sensitivity to starting point","text":"","code":"# Parameters we use to generate synthetics, which we will refer to as the 'true' parameters mu <- 0.1 K <- 0.089 alpha <- 2.29 c <- 0.11 p <- 1.08  # Format the true ETAS parameters for code to generate the synthetics theta_etas <- data.frame(mu = mu, K = K, alpha = alpha, c = c, p = p)  # A dataframe containing different starting values for the algorithm startingValues <- data.frame(   mu = c(5., mu),   K = c(1., K),   alpha = c(5., alpha),   c = c(0.3, c),   p = c(1.5, p) ) nRealisations <- length(startingValues$mu)   # Temporal duration of the synthetic catalogue in days modelledDuration <- 1000 # [days]  # The minimum magnitude that will be modelled M0 <- 2.5"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"generate-new-catalogues-and-save-them","dir":"Articles","previous_headings":"Multiple analyses of two catalogues using different initial values","what":"Generate new catalogues and save them","title":"Sensitivity to starting point","text":"vignette use Rmd caching, can save catalogues files explicitly:","code":"############ #### Generate the first catalogue with no large events  samp.etas.list <- generate_temporal_ETAS_synthetic(   theta = theta_etas,   beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = NULL )  quiet.ETAS.cat <- bind_rows(samp.etas.list) quiet.ETAS.cat <- quiet.ETAS.cat[order(quiet.ETAS.cat$ts), ] # quiet.ETAS.cat <- na.omit(quiet.ETAS.cat) ############ #### Generate the second catalogue with a M6.7 event on day 1000  Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) # Impose a M6.7 event on day 1000  samp.etas.list <- generate_temporal_ETAS_synthetic(theta = theta_etas, beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = Ht)  M6p7.ETAS.cat <- bind_rows(samp.etas.list) M6p7.ETAS.cat <- M6p7.ETAS.cat[order(M6p7.ETAS.cat$ts), ] # save(M6p7.ETAS.cat,file=\"M6p7_ETAS_cat.Rda\") # save(quiet.ETAS.cat,file=\"quiet.ETAS.cat.Rda\")"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"load-the-catalogues","dir":"Articles","previous_headings":"Present the catalogues","what":"Load the catalogues","title":"Sensitivity to starting point","text":"read saved object files:","code":"# load(\"M6p7_ETAS_cat.Rda\") # load(\"quiet.ETAS.cat.Rda\")"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-properties-of-the-catalogues","dir":"Articles","previous_headings":"Present the catalogues","what":"Plot properties of the catalogues","title":"Sensitivity to starting point","text":"","code":"plots <- list()  plots[[1]] <- ggplot() +   geom_point(data = quiet.ETAS.cat, aes(x = ts, y = magnitudes), size = 0.1, alpha = 0.5) +   xlim(0, modelledDuration) +   ggtitle(paste(\"A.  Unseeded catalog, nEvents =\", length(quiet.ETAS.cat$ts))) +   ylim(2, 7) +   xlab(\"Time [days]\") +   ylab(\"Magnitude\") +   theme_bw()  plots[[2]] <- ggplot() +   geom_point(data = M6p7.ETAS.cat, aes(x = ts, y = magnitudes), size = 0.1, alpha = 0.5) +   xlim(0, modelledDuration) +   ggtitle(paste(\"B.  Catalog seeded with M6.7 event on day 500, nEvents =\", length(M6p7.ETAS.cat$ts))) +   ylim(2, 7) +   xlab(\"Time [days]\") +   ylab(\"Magnitude\") +   theme_bw()   plt <- grid.arrange(plots[[1]], plots[[2]], ncol = 1, nrow = 2) # ggsave(\"initialConditionCats.png\", plt) # ggsave(\"initialConditionCats.pdf\", plt)"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"analysis-of-quiet-catalogue","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Analysis of quiet catalogue","title":"Sensitivity to starting point","text":"","code":"list.output.quietScenario <- list()  for (i in seq_len(nRealisations)) {   if (exists(\"list.input\")) remove(\"list.input\")    # Load a set of parameters that we will need to tweak for this application   fpath <- system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\")   list.input <- create_input_list_temporal_noCatalogue(fpath)    ####################   # Tweak the variables loaded from the input file   list.input$M0 <- M0   list.input$time.int <- c(0, modelledDuration)   list.input$T12 <- c(0, modelledDuration)    # Change the starting location, measured on the ETAS scale   list.input$mu.init <- startingValues$mu[i]   list.input$alpha.init <- startingValues$alpha[i]   list.input$K.init <- startingValues$K[i]   list.input$c.init <- startingValues$c[i]   list.input$p.init <- startingValues$p[i]    link.f <- list(     mu = \\(x) gamma_t(x, a_mu, b_mu),     K = \\(x) loggaus_t(x, a_K, b_K),     alpha = \\(x) unif_t(x, a_alpha, b_alpha),     c_ = \\(x) unif_t(x, a_c, b_c),     p = \\(x) unif_t(x, a_p, b_p)   )    # initial value - convert from ETAS scale to internal scale   list.input$th.init <- list(     th.mu = inv_gamma_t(list.input$mu.init, list.input$a_mu, list.input$b_mu),     th.K = inv_loggaus_t(list.input$K.init, list.input$a_K, list.input$b_K),     th.alpha = inv_unif_t(list.input$alpha.init, list.input$a_alpha, list.input$b_alpha),     th.c = inv_unif_t(list.input$c.init, list.input$a_c, list.input$b_c),     th.p = inv_unif_t(list.input$p.init, list.input$a_p, list.input$b_p)   )    # Define options for inlabru   if (is.null(list.input$max_step)) {     list.input$bru.opt.list <- list(       bru_verbose = 0, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       # bru_method = list(max_step = 0.5),       bru_initial = list.input$th.init     ) # parameters initial values   } else {     list.input$bru.opt.list <- list(       bru_verbose = 0, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       bru_method = list(max_step = list.input$max_step),       bru_initial = list.input$th.init     ) # parameters initial values   }    ## Add out catalogue to the input list   list.input$catalog <- data.frame(     time_diff = quiet.ETAS.cat$ts,     magnitudes = quiet.ETAS.cat$magnitudes   )    ## Add the catalogue formatted for bru   list.input$catalog.bru <- data.frame(     ts = quiet.ETAS.cat$ts,     magnitudes = quiet.ETAS.cat$magnitudes,     idx.p = seq_len(nrow(quiet.ETAS.cat))   )    ## Input list is now formatted   ####################    ## Run the model according to the input list   ETAS.model.fit <- Temporal.ETAS.fit(list.input)    ## Small bit of post processing   list.output.quietScenario[[i]] <- append(list.input, list(model.fit = ETAS.model.fit))   list.output.quietScenario[[i]]$runtime <- sum(list.output.quietScenario[[i]]$model.fit$bru_timings$Time)   list.output.quietScenario[[i]]$nEvents <- length(list.output.quietScenario[[i]]$catalog[, 1]) } #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  0.3771555  #> Finish model fitting  #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  0.3710022  #> Finish model fitting"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"analysis-of-m6-7-catalogue","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Analysis of M6.7 catalogue","title":"Sensitivity to starting point","text":"","code":"list.output.M6p7Scenario <- list()  for (i in seq_len(nRealisations)) {   if (exists(\"list.input\")) {     remove(list.input)   }    # Load a set of parameters that we will need to tweak for this application   fpath <- system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\")   list.input <- create_input_list_temporal_noCatalogue(fpath)    ####################   # Tweak the variables laoded from the input file   list.input$M0 <- M0   list.input$time.int <- c(0, modelledDuration)   list.input$T12 <- c(0, modelledDuration)    # Change the starting location, measured on the ETAS scale   list.input$mu.init <- startingValues$mu[i]   list.input$alpha.init <- startingValues$alpha[i]   list.input$K.init <- startingValues$K[i]   list.input$c.init <- startingValues$c[i]   list.input$p.init <- startingValues$p[i]    link.f <- list(     mu = \\(x) gamma_t(x, a_mu, b_mu),     K = \\(x) loggaus_t(x, a_K, b_K),     alpha = \\(x) unif_t(x, a_alpha, b_alpha),     c_ = \\(x) unif_t(x, a_c, b_c),     p = \\(x) unif_t(x, a_p, b_p)   )    # initial value - convert from ETAS scale to internal scale   list.input$th.init <- list(     th.mu = inv_gamma_t(list.input$mu.init, list.input$a_mu, list.input$b_mu),     th.K = inv_loggaus_t(list.input$K.init, list.input$a_K, list.input$b_K),     th.alpha = inv_unif_t(list.input$alpha.init, list.input$a_alpha, list.input$b_alpha),     th.c = inv_unif_t(list.input$c.init, list.input$a_c, list.input$b_c),     th.p = inv_unif_t(list.input$p.init, list.input$a_p, list.input$b_p)   )    # Define options for inlabru   if (is.null(list.input$max_step)) {     list.input$bru.opt.list <- list(       bru_verbose = 3, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       # bru_method = list(max_step = 0.5),       bru_initial = list.input$th.init     ) # parameters initial values   } else {     list.input$bru.opt.list <- list(       bru_verbose = 3, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       bru_method = list(max_step = list.input$max_step),       bru_initial = list.input$th.init     ) # parameters initial values   }    ## Add out catalogue to the input list   list.input$catalog <- data.frame(     time_diff = M6p7.ETAS.cat$ts,     magnitudes = M6p7.ETAS.cat$magnitudes   )    ## Add the catalogue formatted for bru   list.input$catalog.bru <- data.frame(     ts = M6p7.ETAS.cat$ts,     magnitudes = M6p7.ETAS.cat$magnitudes,     idx.p = seq_len(nrow(M6p7.ETAS.cat))   )    ## Input list is now formatted   ####################    ## Run the model according to the input list   ETAS.model.fit <- Temporal.ETAS.fit(list.input)    ## Small bit of post processing   list.output.M6p7Scenario[[i]] <- append(list.input, list(model.fit = ETAS.model.fit))   list.output.M6p7Scenario[[i]]$runtime <- sum(list.output.M6p7Scenario[[i]]$model.fit$bru_timings$Time)   list.output.M6p7Scenario[[i]]$nEvents <- length(list.output.M6p7Scenario[[i]]$catalog[, 1]) } #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  4.604972 #> iinla: Evaluate component inputs #> iinla: Evaluate component linearisations #> iinla: Evaluate component simplifications #> iinla: Evaluate predictor linearisation #> iinla: Construct inla stack #> iinla: Model initialisation completed #> iinla: Iteration 1 [max:100] #> iinla: Step rescaling: 90.18%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Iteration 2 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 130.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 1580% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 3 [max:100] #> iinla: Step rescaling: 38.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 2560% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 4 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 103.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 661% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 5 [max:100] #> iinla: Step rescaling: 38.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 591% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 6 [max:100] #> iinla: Step rescaling: 99.97%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 288% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 7 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 108.5%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 194% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 8 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.8%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 192% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 9 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 101.6%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 153% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 10 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 101.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 140% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 11 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.8%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 126% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 12 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.7%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 115% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 13 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.6%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 104% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 14 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.5%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 95% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 15 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.4%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 86.5% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 16 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.4%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 78.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 17 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 71.7% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 18 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 65.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 19 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 59.4% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 20 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 54.1% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 21 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 49.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 22 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 44.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 23 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 40.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 24 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 37.2% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 25 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 33.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 26 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 30.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 27 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 28% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 28 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 25.5% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 29 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 23.2% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 30 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 21.1% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 31 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 19.2% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 32 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 17.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 33 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 15.9% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 34 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 14.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 35 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 13.2% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 36 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 12% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 37 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 10.9% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 38 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 9.92% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Convergence criterion met, running final INLA integration with known theta mode. #> iinla: Iteration 39 [max:100] #> Finish model fitting  #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  4.63482 #> iinla: Evaluate component inputs #> iinla: Evaluate component linearisations #> iinla: Evaluate component simplifications #> iinla: Evaluate predictor linearisation #> iinla: Construct inla stack #> iinla: Model initialisation completed #> iinla: Iteration 1 [max:100] #> iinla: Step rescaling: 92.08%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Iteration 2 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 59.8% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 3 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.7%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 41.2% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 4 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.5%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 25.4% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 5 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.4%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 24.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 6 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 22.7% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 7 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 21% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 8 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 19.4% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 9 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 17.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 10 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 16.3% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 11 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 14.9% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 12 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 13.6% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 13 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 12.4% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 14 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 11.3% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 15 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 10.3% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 16 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 9.36% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Convergence criterion met, running final INLA integration with known theta mode. #> iinla: Iteration 17 [max:100] #> Finish model fitting"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-posteriors-with-corresponding-starting-values","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions > Analysis of M6.7 catalogue","what":"Plot posteriors with corresponding starting values","title":"Sensitivity to starting point","text":"","code":"plots <- list()  trueParas <- data.frame(value = c(mu, K, alpha, c, p), param = c(\"mu\", \"K\", \"alpha\", \"c\", \"p\"))  post.list <- get_posterior_param(input.list = list.output.quietScenario[[1]]) post.df <- post.list[[1]] post.df$id <- 1  for (i in 2:nRealisations) {   post.list <- get_posterior_param(input.list = list.output.quietScenario[[i]])   post.df.tmp <- post.list[[1]]   post.df.tmp$id <- i    post.df <- rbind(post.df, post.df.tmp) }  plots[[1]] <- ggplot(post.df, aes(x = x, y = y, group = id, color = factor(id), lty = factor(id))) +   geom_line() +   # scale_x_discrete(guide = guide_axis(check.overlap = TRUE)) +   facet_wrap(facets = vars(param), scales = \"free\", labeller = label_parsed, nrow = 1) +   geom_vline(aes(xintercept = value),     data = trueParas, color = \"black\", linetype = 2,     label = \"True value\"   ) +   labs(color = \"Initial ETAS Para. Set\", linetype = \"Initial ETAS Para. Set\") +   ggtitle(paste(\"A.  Inversion of a 1000 day catalogue with no large events, nEvents =\", length(quiet.ETAS.cat$ts))) +   xlab(\"ETAS Posteriors\") +   theme_bw() +   theme(axis.text.x = element_text(angle = 45, hjust = 1)) +   theme(legend.position = \"hidden\") +   theme(plot.title = element_text(size = 12)) #> Warning in geom_vline(aes(xintercept = value), data = trueParas, color = #> \"black\", : Ignoring unknown parameters: `label` trueParas <- data.frame(value = c(mu, K, alpha, c, p), param = c(\"mu\", \"K\", \"alpha\", \"c\", \"p\"))  post.list <- get_posterior_param(input.list = list.output.M6p7Scenario[[1]]) post.df <- post.list[[1]] post.df$id <- 2  for (i in 2:nRealisations) {   post.list <- get_posterior_param(input.list = list.output.M6p7Scenario[[i]])   post.df.tmp <- post.list[[1]]   post.df.tmp$id <- i    post.df <- rbind(post.df, post.df.tmp) }  plots[[2]] <- ggplot(post.df, aes(x = x, y = y, group = id, color = factor(id), lty = factor(id))) +   geom_line() +   # scale_x_discrete(guide = guide_axis(check.overlap = TRUE)) +   facet_wrap(facets = vars(param), scales = \"free\", labeller = label_parsed, nrow = 1) +   geom_vline(aes(xintercept = value),     data = trueParas, color = \"black\", linetype = 2,     label = \"True value\"   ) +   labs(color = \"Initial ETAS Para. Set\", linetype = \"Initial ETAS Para. Set\") +   ggtitle(paste(\"B. Inversion of a 1000 day catalogue with a M6.7 on day 500, nEvents =\", length(M6p7.ETAS.cat$ts))) +   xlab(\"ETAS Posteriors\") +   theme_bw() +   theme(axis.text.x = element_text(angle = 45, hjust = 1)) +   theme(legend.position = \"hidden\") +   theme(plot.title = element_text(size = 12)) #> Warning in geom_vline(aes(xintercept = value), data = trueParas, color = #> \"black\", : Ignoring unknown parameters: `label` plt <- grid_arrange_shared_legend(plots[[1]], plots[[2]], ncol = 1, nrow = 2, position = \"bottom\") plt #> TableGrob (2 x 1) \"arrange\": 2 grobs #>   z     cells    name              grob #> 1 1 (1-1,1-1) arrange   gtable[arrange] #> 2 2 (2-2,1-1) arrange gtable[guide-box] # ggsave(\"initialCondition_posteriors.png\", plt) # ggsave(\"initialCondition_posteriors.pdf\", plt)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"explore-etas-triggering-function-using-posterior-samples","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Explore ETAS triggering function using posterior samples","title":"Sensitivity to starting point","text":"","code":"plot_triggering <- list() plot_triggering[[1]] <- triggering_fun_plot(list.output.quietScenario[[1]], magnitude = 4, n.samp = 100) +   ggtitle(\"C. M4 triggering function\") +   theme_bw() +   ylim(0, 5.5) +   theme(plot.title = element_text(size = 8))  plot_triggering[[2]] <- triggering_fun_plot(list.output.M6p7Scenario[[1]], magnitude = 4, n.samp = 100) +   ggtitle(\"D. M4 triggering function\") +   theme_bw() +   ylim(0, 5.5) +   theme(plot.title = element_text(size = 8))  plot_triggering[[3]] <- triggering_fun_plot(list.output.quietScenario[[1]], magnitude = 6.7, n.samp = 100) +   ggtitle(\"E. M6.7 triggering function\") +   theme_bw() +   ylim(0, 1700) +   theme(plot.title = element_text(size = 8))   plot_triggering[[4]] <- triggering_fun_plot(list.output.M6p7Scenario[[1]], magnitude = 6.7, n.samp = 100) +   ggtitle(\"F. M6.7 triggering function\") +   theme_bw() +   ylim(0, 1700) +   theme(plot.title = element_text(size = 8))   plt <- grid.arrange(plot_triggering[[1]], plot_triggering[[3]], plot_triggering[[2]], plot_triggering[[4]], ncol = 2, nrow = 2, top = \"Triggering function variability\") +   theme(plot.title = element_text(size = 8)) #> Warning: Removed 81 rows containing missing values (`geom_line()`). #> Warning: Removed 3 rows containing missing values (`geom_line()`). #> Warning: Removed 89 rows containing missing values (`geom_line()`). #> Warning: Removed 9 rows containing missing values (`geom_line()`). #> Warning: Removed 27 rows containing missing values (`geom_line()`). #> Warning: Removed 2 rows containing missing values (`geom_line()`). plt #> NULL  # ggsave(\"trigFuncVariability_runin.png\", plt) # ggsave(\"trigFuncVariability_runin.pdf\", plt) plot_omori <- list() plot_omori[[1]] <- omori_plot_posterior(list.output.quietScenario[[1]], n.samp = 100) +   ggtitle(\"A. Omori decay\") +   theme_bw() +   ylim(0, 1) +   theme(plot.title = element_text(size = 8))   plot_omori[[2]] <- omori_plot_posterior(list.output.M6p7Scenario[[1]], n.samp = 100) +   ggtitle(\"B. Omori decay\") +   theme_bw() +   ylim(0, 1) +   theme(plot.title = element_text(size = 8)) plt <- grid.arrange(plot_omori[[1]], plot_triggering[[1]], plot_triggering[[3]], plot_omori[[2]], plot_triggering[[2]], plot_triggering[[4]], ncol = 3, nrow = 2, top = \"Triggering  function variability\", left = \"M6.7 baseline            Unseeded baseline\") #> Warning: Removed 81 rows containing missing values (`geom_line()`). #> Warning: Removed 3 rows containing missing values (`geom_line()`). #> Warning: Removed 89 rows containing missing values (`geom_line()`). #> Warning: Removed 9 rows containing missing values (`geom_line()`). #> Warning: Removed 27 rows containing missing values (`geom_line()`). #> Warning: Removed 2 rows containing missing values (`geom_line()`). plt #> TableGrob (3 x 4) \"arrange\": 8 grobs #>   z     cells    name                 grob #> 1 1 (2-2,2-2) arrange       gtable[layout] #> 2 2 (2-2,3-3) arrange       gtable[layout] #> 3 3 (2-2,4-4) arrange       gtable[layout] #> 4 4 (3-3,2-2) arrange       gtable[layout] #> 5 5 (3-3,3-3) arrange       gtable[layout] #> 6 6 (3-3,4-4) arrange       gtable[layout] #> 7 7 (1-1,2-4) arrange text[GRID.text.1299] #> 8 8 (1-3,1-1) arrange text[GRID.text.1300]  # ggsave(\"trigFuncVariability_runin.png\", plt) # ggsave(\"trigFuncVariability_runin.pdf\", plt)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-the-samples-from-the-joint-posteriors-as-pairs-plots","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Plot the samples from the joint posteriors as pairs plots","title":"Sensitivity to starting point","text":"","code":"post_pairs_plot(list.output.quietScenario[[1]], n.samp = 1000)$pair.plot post_pairs_plot(list.output.M6p7Scenario[[1]], n.samp = 1000)$pair_plot #> NULL"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"inlabru-convergence-diagnostics","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"inlabru convergence diagnostics","title":"Sensitivity to starting point","text":"can also assess convergence inlabru method , using bru_convergence_plot() function. can reveal starting values inlabru estimation unreasonable, better starting values nonlinear iterations might speed computations.","code":"bru_convergence_plot(list.output.quietScenario[[1]]$model.fit) bru_convergence_plot(list.output.quietScenario[[2]]$model.fit) bru_convergence_plot(list.output.M6p7Scenario[[1]]$model.fit) bru_convergence_plot(list.output.M6p7Scenario[[2]]$model.fit)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"introduction-to-etas-model","dir":"Articles","previous_headings":"","what":"Introduction to ETAS model","title":"Tutorial on real data","text":"tutorial, show use ETAS.inlabru R-package fit temporal ETAS model real earthquakes data. tutorial shows prepare data, fit model, retrieve posterior distribution parameters posterior distribution quantities interest, generate synthetic catalogues fitted model, produce forecasts seismicity. Epidemic-Type Aftershock Sequence (ETAS) model belongs family Hawkes () point processes. temporal Hawkes process point process model conditional intensity given \\[ \\lambda(t | \\mathcal H_t) = \\mu + \\sum_{t_h \\\\mathcal H_t} g(t- t_h) \\] \\(\\mathcal H_t\\) history process time \\(t\\). Generally speaking \\(\\mathcal H_t\\) contains events occurred \\(t\\). quantity \\(\\mu > 0\\) usually called , interpreted rate events occur spontaneously. function \\(g(t-t_h)\\) called function (excitation function, simply kernel) measures influence event \\(t_h\\) time \\(t\\). look \\(g(t-t_h)\\) function \\(t\\) intensity point process representing offspring event \\(t_h\\). seismology offspring event called , two terms used synonyms. essence, Hawkes process model can seen superposition background process intensity \\(\\mu\\) aftershock processes generated observations \\(\\mathcal H_t\\) one intensity \\(g(t-t_h)\\). makes Hawkes process model particularly suitable describe phenomena event ability trigger additional events, phenomena characterized cascades events earthquakes, infectious diseases, wildfires, financial crisis, similar. ETAS model particular instance Hawkes process model proven particularly suitable model earthquake occurrence. Earthquakes usually described modelled marked time points marking variable magnitude event. history process composed time-magnitude pairs, namely \\(\\mathcal H_t = \\{(t_h,m_h), h = 1,...,N_h\\}\\). Various slightly different ETAS formulations exist, usually characterized slightly different triggering functions, one implemented ETAS.inlabru R-package conditional intensity given \\[ \\lambda(t | \\mathcal H_t) = \\mu + \\sum_{t_h \\\\mathcal H_t} K \\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] \\(M_0\\) cutoff magnitude \\(m_h \\geq M_0\\) \\(h\\). value decided priori based quality catalogue used. parameters model : \\(\\mu \\geq 0\\), background rate \\(K \\geq 0\\) general productivity parameter, plays role determining average number aftershocks induced event catalogue. \\(\\alpha \\geq 0\\) magnitude scaling parameter, determines number aftershocks changes based magnitude event generating aftershocks. non-negative reflect fact stronger earthquakes generate aftershocks. \\(c > 0\\) time offset parameter, smaller values associated catalogues fewer missing events. \\(p > 1\\) aftershock decay parameter, determines rate aftershock activity decreases time. greater 1 otherwise event may generate infinite number aftershocks infinite interval time thought unphysical.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"priors","dir":"Articles","previous_headings":"","what":"Priors","title":"Tutorial on real data","text":"Bayesian analysis need decide priors parameters. approximation method use considers parameters two different scales: original ETAS scale, internal scale. internal scale used package perform calculations. internal scale parameters constraint standard normal distribution prior. need set priors parameters ETAS scale. done considering copula transformation \\(\\eta(X)\\) \\(X \\sim N(0,1)\\) , \\(\\eta(X)\\) desired distribution. ETAS.inlabru R-package provides four different functions corresponding three different distributions: gamma_t(X, , b) Gamma distribution shape parameter \\(\\) rate \\(b\\). distribution mean \\(/b\\) variance \\(/b^2\\). unit_t(X, , b) Uniform distribution \\(\\) \\(b\\). exp_t(X, r) Exponential distribution rate \\(r\\). loggaus_t(X, m ,s) Log-Gaussian distribution mean logarithm \\(m\\) standard deviation logarithm \\(s\\). code generate 1000 observations normal distribution, transform using functions provided package, shows empirical density estimated sample.  package also provide inverse functions retrieve value parameter internal scale value ETAS scale provided. example decided priors going use analysis, need store corresponding copula transformations list. list one element parameter model (\\(5\\)), element list must name corresponding parameter. names fixed mu, K, alpha, c_, p. parameter \\(c\\) referred c_ avoid clashing names R function c(). useful inverse functions also, list used set initial value parameters later. code assumes parameter \\(\\mu\\) Gamma distribution prior parameters \\(0.3\\) \\(0.6\\), parameters \\(K, \\alpha,\\) \\(c\\) Uniform prior \\((0,10)\\), parameter \\(p\\) Uniform prior \\((1,10)\\).","code":"# obtain sample from standard normal distribution X <- rnorm(1000) # apply copula transformations gamma.X <- gamma_t(X, 1, 2) unif.X <- unif_t(X, 0, 1) exp.X <- exp_t(X, 1) loggaus.X <- loggaus_t(X, 0.5, 0.5)  # build data.frame for plotting df.to.plot <- rbind(   data.frame(     value = X,     distribution = \"Std Normal\"   ),   data.frame(     value = gamma.X,     distribution = \"Gamma\"   ),   data.frame(     value = unif.X,     distribution = \"Uniform\"   ),   data.frame(     value = exp.X,     distribution = \"Exponential\"   ),   data.frame(     value = loggaus.X,     distribution = \"Log-Gaussian\"   ) ) # plot them ggplot(df.to.plot, aes(value)) +   geom_histogram() +   theme_bw() +   facet_wrap(facets = ~distribution, scales = \"free\") #> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. inv_gamma_t(gamma_t(1.2, 1, 2), 1, 2) #> [1] 1.2 inv_unif_t(unif_t(1.2, 1, 2), 1, 2) #> [1] 1.2 inv_exp_t(exp_t(1.2, 1), 1) #> [1] 1.2 inv_loggaus_t(loggaus_t(1.2, 1, 2), 1, 2) #> [1] 1.2 # set copula transformations list link.f <- list(   mu = \\(x) gamma_t(x, 0.3, 0.6),   K = \\(x) unif_t(x, 0, 10),   alpha = \\(x) unif_t(x, 0, 10),   c_ = \\(x) unif_t(x, 0, 10),   p = \\(x) unif_t(x, 1, 10) )  # set inverse copula transformations list inv.link.f <- list(   mu = \\(x) inv_gamma_t(x, 0.3, 0.6),   K = \\(x) inv_unif_t(x, 0, 10),   alpha = \\(x) inv_unif_t(x, 0, 10),   c_ = \\(x) inv_unif_t(x, 0, 10),   p = \\(x) inv_unif_t(x, 1, 10) )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"laquila-seismic-sequence","dir":"Articles","previous_headings":"","what":"L’Aquila seismic sequence","title":"Tutorial on real data","text":"Earthquake data stored -called earthquake catalogues. Many different catalogues exists region easy way decide one better. , provide subset HOmogenized instRUmental Seismic (HORUS) catalogue 1960 2020. can downloaded http://horus.bo.ingv./. See data-raw/horus.R details subset created original data set. HORUS catalogue subset can loaded using documentation data set available via ?horus. data reports earthquake time string (time_string), longitude (lon) latitude (lat) epicentre, depth kilometres (depth), moment magnitude (M). focus L’Aquila seismic sequence sufficient retain observations specific space-time-magnitude region include sequence interest. L’Aquila sequence, retain events magnitude greater equal \\(2.5\\) happened 2009 longitude \\((10.5, 16)\\) latitude \\((40.5, 45)\\). L’Aquila sequence selected way composed 1024 events. seismic sequence can selected similarly. selection convenient transform time string Date object select rows Horus catalogue verifying conditions. data can visually represented plotting time event magnitude. shows clustering observations correspondance high magnitude events. L’Aquila seismic sequence, times versus magnitudes","code":"# load ISIDE catalogue data(horus, package = \"ETAS.inlabru\") head(horus) #>           time_string     lon     lat depth    M #> 1 1960-01-03T20:19:34 15.3000 39.3000   290 6.34 #> 2 1960-01-04T09:20:00 13.1667 43.1333     0 3.94 #> 3 1960-01-06T15:17:34 12.7000 46.4833     4 4.69 #> 4 1960-01-06T15:20:53 12.7000 46.4667     0 4.14 #> 5 1960-01-06T15:31:00 12.7500 46.4333     0 3.00 #> 6 1960-01-06T15:45:00 12.7500 46.4333     0 3.00 # transform time string in Date object horus$time_date <- as.POSIXct(   horus$time_string,   format = \"%Y-%m-%dT%H:%M:%OS\" )  # set up parameters for selection start.date <- as.POSIXct(\"2009-01-01T00:00:00\", format = \"%Y-%m-%dT%H:%M:%OS\") end.date <- as.POSIXct(\"2010-01-01T00:00:00\", format = \"%Y-%m-%dT%H:%M:%OS\") min.longitude <- 10.5 max.longitude <- 16 min.latitude <- 40.5 max.latitude <- 45 M0 <- 2.5  # set up conditions for selection aquila.sel <- (horus$time_date >= start.date) &   (horus$time_date < end.date) &   (horus$lon >= min.longitude) &   (horus$lon <= max.longitude) &   (horus$lat >= min.latitude) &   (horus$lat <= max.latitude) &   (horus$M >= M0)  # select aquila <- horus[aquila.sel, ] ggplot(aquila, aes(time_date, M)) +   geom_point() +   theme_bw()"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"data-preparation-to-model-fitting","dir":"Articles","previous_headings":"","what":"Data preparation to model fitting","title":"Tutorial on real data","text":"need prepare data.frame used input data fit ETAS model. data.frame must three columns: ts time difference starting date occurrence time events (measured days example), magnitudes magnitude events, idx.p index column different value event. names fixed changed , need set initial values parameters list containing inlabru options used. initial values stored list elements th.mu, th.K, th.alpha, th.c, th.p corresponds ETAS parameters. initial values must provided internal scale therefore useful retrieve using inverse copula transformations set . way, can find values parameters internal scale given value parameters ETAS scale. example uses \\(\\mu = 0.5, K = 0.1, \\alpha = 1, c = 0.1,\\) \\(p = 1.1\\) initial values. crucial set initial values cause numerical problems, general achieved setting initial values zero. values provided worked well various examples. Lastly, need set list inlabru options. main elements list : bru_verbose: number indicating type diagnostic output. Set 0 output. bru_max_iter: maximum number iterations. set max_step inlabru algorithm stops stopping criterion met. However, setting max_step values smaller 1 forces algorithm run exactly bru_max_iter iterations. bru_method: relevant , thing may need set max_step argument. algorithm converge without fixing max_step suggest try fix value 1, experience \\(0.5\\) \\(0.2\\) works well. example line setting bru_method commented. bru_initial: list initial values created . Note: option list, one can also set number threads allowed INLA , e.g. num.threads = 8. override global option set beginning tutorial. code likely run many different systems, using global setting easier manage.","code":"# set up data.frame for model fitting aquila.bru <- data.frame(   ts = as.numeric(     difftime(aquila$time_date, start.date, units = \"days\")   ),   magnitudes = aquila$M,   idx.p = 1:nrow(aquila) ) # set up list of initial values th.init <- list(   th.mu = inv.link.f$mu(0.5),   th.K = inv.link.f$K(0.1),   th.alpha = inv.link.f$alpha(1),   th.c = inv.link.f$c_(0.1),   th.p = inv.link.f$p(1.1) ) # set up list of bru options bru.opt.list <- list(   bru_verbose = 3, # type of visual output   bru_max_iter = 70, # maximum number of iterations   # bru_method = list(max_step = 0.5),   bru_initial = th.init # parameters' initial values )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"model-fitting","dir":"Articles","previous_headings":"","what":"Model fitting","title":"Tutorial on real data","text":"function Temporal.ETAS fit ETAS model returns bru object output. required inputs : total.data: data.frame containing observed events. format described previous Section. M0: cutoff magnitude. events total.data must magnitude greater equal number. T1: starting time time interval want fit model. T2: end time time interval want fit model. link.functions: list copula transformation functions format described previous sections. coef.t., delta.t., N.max.: parameters temporal binning. binning strategy described Appendix B paper Approximation Bayesian Hawkes process inlabru. parameters corresponds coef.t.\\(=\\delta\\), delta.t.\\(=\\Delta\\), N.max.\\(=n_{\\max}\\). bru.opt: list inlabru options described previous Section.","code":"# set starting and time of the time interval used for model fitting. In this case, we use the interval covered by the data. T1 <- 0 T2 <- max(aquila.bru$ts) + 0.2 # fit the model aquila.fit <- Temporal.ETAS(   total.data = aquila.bru,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  3.071187"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"create-input-list","dir":"Articles","previous_headings":"","what":"Create input list","title":"Tutorial on real data","text":"model fitted package ETAS.inlabru offers various functions visually explore output. require input list. list must different elements depending function going use. retrieve posterior parameters sample posterior parameters need two elements: model.fit: output Temporal.ETAS link.functions: list copula transformations","code":"# create input list to explore model output input_list <- list(   model.fit = aquila.fit,   link.functions = link.f )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"check-marginal-posterior-distributions","dir":"Articles","previous_headings":"","what":"Check marginal posterior distributions","title":"Tutorial on real data","text":"function get_posterior_param can use retrieve marginal posteriors parameters ETAS scale. function returns list elements: post.df: data.frame containing posterior parameters. data.frame three columns, x value parameter, y corresponding value posterior, param indicates ETAS parameter x y referring . post.plot: ggplot object containing plot marginal posteriors parameters","code":"# get marginal posterior information post.list <- get_posterior_param(input.list = input_list)  # plot marginal posteriors post.list$post.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"sample-the-joint-posterior-and-make-pair-plot","dir":"Articles","previous_headings":"","what":"Sample the joint posterior and make pair plot","title":"Tutorial on real data","text":"function post_sampling generate samples joint posterior ETAS parameters. function takes input: input.list: list model.fit element link.functions elements described . n.samp: number posterior samples. max.batch: number posterior samples generated simultaneously. n.samp\\(>\\)max.batch, , samples generated parallel batches maximum size equal max.batch. Default \\(1000\\). ncore: number cores used parallel n.samp\\(>\\)max.batch. function returns data.frame columns corresponding ETAS parameters posterior samples can used analyse correlation parameters. function post_pairs_plot generate pair plot posterior samples taken input. function 4 arguments need specified. input : post.samp: data.frame samples joint posterior distribution parameters. NULL samples generated function . input.list: input list arguments model.fit link.functions used generate posterior samples. used post.samp = NULL. Default NULL. n.samp: number posterior samples. NULL, samples post.samp used. post.samp NULL, n.samp samples generated joint posterior. post.samp n.samp NULL n.samp samples randomly (uniformly replacement) selected post.samp. Default NULL max.batch number posterior samples generated simultaneously. used post.samp NULL. Default NULL function returns list two elements: post.samp posterior samples, pair.plot ggplot object containing pair plot.","code":"post.samp <- post_sampling(   input.list = input_list,   n.samp = 1000,   max.batch = 1000,   ncore = 1 )  head(post.samp) #>          mu         K    alpha          c        p #> 1 0.2875381 0.1297894 2.442578 0.07528043 1.176927 #> 2 0.2964809 0.1407247 2.454437 0.06276969 1.170890 #> 3 0.2999463 0.1425696 2.456066 0.05683390 1.162561 #> 4 0.3079564 0.1397565 2.442071 0.05668613 1.135177 #> 5 0.2770126 0.1215546 2.440510 0.07311773 1.171568 #> 6 0.2816262 0.0975546 2.449249 0.09279953 1.200078 pair.plot <- post_pairs_plot(   post.samp = post.samp,   input.list = NULL,   n.samp = NULL,   max.batch = 1000 ) #> Registered S3 method overwritten by 'GGally': #>   method from    #>   +.gg   ggplot2 pair.plot$pair.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"check-posterior-number-of-events","dir":"Articles","previous_headings":"","what":"Check posterior number of events","title":"Tutorial on real data","text":"quantity interest posterior distribution number events. can accessed using function get_posterior_N requires input list. However, list needs additional elements respect one used now. Specifically, need add T12 extremes time interval want calculate number events, M0 cutoff magnitude, catalog.bru data.frame containing observed events. latter format total.data used Temporal.ETAS function. function returns list three elements: post.plot plot distribution, post.plot.shaded plot distribution shaded regions representing \\(95\\%\\) interval distribution, post.df data.frame used generate plots. vertical line plots represent number events catalog.bru element input list.","code":"# set additional elements of the list input_list$T12 <- c(T1, T2) input_list$M0 <- M0 input_list$catalog.bru <- aquila.bru N.post <- get_posterior_N(input.list = input_list) N.post$post.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"posterior-of-the-triggering-function-and-omori-law","dir":"Articles","previous_headings":"","what":"Posterior of the triggering function and Omori law","title":"Tutorial on real data","text":"functions triggering_fun_plot triggering_fun_plot_prior plot, respectively, quantiles posterior prior distribution triggering function \\(g(t-t_h, mh)\\), namely, \\[ g(t - t_h, m_h) = K\\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] function takes input input.list: input list defined functions used previously. post.samp: data.frame samples posterior distribution parameters. NULL, n.samp samples generated posterior. n.samp: number posterior samples parameters used generated. magnitude: magnitude event (\\(m_h\\)). t.end: maximum value \\(t\\) plot. n.breaks: number breaks interval \\((0, \\texttt{t.end})\\) divided. function returns ggplot object. sample parameters triggering function \\(0\\) t.end calculated. black solid lines represents \\(95\\%\\) posterior interval function, grey lines represent triggering function calculated posterior samples, horizontal red lines represent \\(95\\%\\) posterior interval background rate \\(\\mu\\). function triggering_fun_plot_prior value parameters sampled according prior distribution rather posterior, therefore, need specify posterior samples data.frame.   functions omori_plot_posterior omori_plot_prior functions triggering_fun_plot triggering_fun_plot_prior considering \\[ \\left(\\frac{t- t_h}{c} + 1\\right)^{-p} \\] instead whole triggering function without background rate.","code":"triggering_fun_plot(   input.list = input_list,   post.samp = post.samp,   n.samp = NULL, magnitude = 4,   t.end = 5, n.breaks = 100 ) triggering_fun_plot_prior(input.list = input_list, magnitude = 4, n.samp = 1000, t.end = 10) omori_plot_posterior(input.list = input_list, post.samp = post.samp, n.samp = NULL, t.end = 5) omori_plot_prior(input.list = input_list, n.samp = 1000, t.end = 5)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"generate-synthetic-catalogues-from-model","dir":"Articles","previous_headings":"","what":"Generate synthetic catalogues from model","title":"Tutorial on real data","text":"earthquake forecast usually composed collection synthetic catalogues model. package ETAS.inlabru provides function generate synthetic catalogues given set parameters. can used produce forecasts simply produce synthetic catalogues. function generate synthetic catalogues called generate_temporal_ETAS_synthetic takes input theta: list ETAS parameters names mu, K, alpha, c, p, corresponding ETAS parameters. beta.p: parameter magnitude distribution M0: cutoff magnitude, generated event magnitude greater M0. T1: starting time catalogue (unit measure depends unit used fit model). T2: end time catalogue (unit measure depends unit used fit model). Ht: set known events. can also T1 T2, useful want generate catalogues imposed events. Regarding magnitude distribution, exponential, specificically assume \\[ m - M_0 \\sim \\text{Exp}(\\beta) \\] parameter \\(\\beta\\) usually estimated independently ETAS parameters. use maximum likelihood estimator \\(\\beta\\) given \\[ \\hat\\beta = \\frac{1}{\\bar{m} - M_0} \\] \\(\\bar m\\) mean observed magnitudes values. function returns list data.frame, element output list corresponds different generation. data.frame three columns: occurence time (ts), magnitude (magnitudes), generation identifier (gen). generation identifier uses following convention, \\(-1\\) indicates events Ht time T1 T2, \\(0\\) indicates first generation offspring events gen equal \\(-1\\), \\(1\\) indicates background events, \\(2\\) offspring events gen equal \\(0\\) \\(1\\), \\(3\\) indicates offspring events gen equal \\(2\\), \\(4\\) indicates offspring events gen equal \\(3\\), . obtain unique data.frame containing simulated events sufficient bind rows generations. example generate 1 synthetic catalogue using parameters one posterior samples generated . catalogue covers time span L’Aquila catalogue impose greatest event sequence.  can easily generate multiple catalogues. code generates 8 catalogues using different samples posterior distribution parameters. red point indicates event imposed last panel represents observed L’Aquila sequence.","code":"# maximum likelihood estimator for beta beta.p <- 1 / (mean(aquila.bru$magnitudes) - M0) synth.cat.list <- generate_temporal_ETAS_synthetic(   theta = post.samp[1, ], # ETAS parameters   beta.p = beta.p, # magnitude distribution parameter   M0 = M0, # cutoff magnitude   T1 = T1, # starting time   T2 = T2, # end time   Ht = aquila.bru[which.max(aquila.bru$magnitudes), ] # known events ) # merge into unique data.frame synth.cat.df <- do.call(rbind, synth.cat.list) # order events by time synth.cat.df <- synth.cat.df[order(synth.cat.df$ts), ]  ggplot(synth.cat.df, aes(ts, magnitudes, color = as.factor(gen))) +   geom_point(size = 0.5) set.seed(2) n.cat <- 8 # generate catalogues as list of lists multi.synth.cat.list <- lapply(seq_len(n.cat), \\(x) generate_temporal_ETAS_synthetic(   theta = post.samp[x, ],   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = aquila.bru[which.max(aquila.bru$magnitudes), ] ))  # store catalogues as list of data.frames multi.synth.cat.list.df <- lapply(multi.synth.cat.list, \\(x) do.call(rbind, x)) # set catalogue identifier multi.synth.cat.list.df <- lapply(seq_len(n.cat), \\(x) cbind(multi.synth.cat.list.df[[x]],   cat.idx = x )) # merge catalogues in unique data.frame multi.synth.cat.df <- do.call(rbind, multi.synth.cat.list.df)  # we need to bing the synthetics with the observed catalogue for plotting cat.df.for.plotting <- rbind(   multi.synth.cat.df,   cbind(aquila.bru[, c(\"ts\", \"magnitudes\")],     gen = NA,     cat.idx = \"observed\"   ) )  # plot them ggplot(cat.df.for.plotting, aes(ts, magnitudes)) +   geom_point(size = 0.5) +   geom_point(     data = aquila.bru[which.max(aquila.bru$magnitudes), ],     mapping = aes(ts, magnitudes),     color = \"red\"   ) +   facet_wrap(facets = ~cat.idx)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"forecasting","dir":"Articles","previous_headings":"","what":"Forecasting","title":"Tutorial on real data","text":"earthquake forecast usually collection synthetic catalogues generated model. bayesian models can reflect uncertainty parameters values generating synthetic catalogue composing forecast using different set parameters sampled join posterior distribution. can generate forecasts using function Temporal.ETAS.forecast. function takes input post.samp: data.frame samples posterior distribution parameters format described previous sections. n.cat: number synthetic catalogues composing forecast. n.cat greater nrow(post.samp), rows post.samp sampled uniformly replacement n.cat times. n.cat smaller nrow(post.samp), , rows post.samp sampled uniformly without replacement n.cat times. n.cat NULL equal nrow(post.samp), , post.samp used . ncore: number cores used generate synthetic catalogues parallel. remaining inputs (beta.p, M0, T1, T2, Ht) ones used generate_temporal_ETAS_synthetic. output function list two elements: fore.df n.cat. element fore.df data.frame synthetic catalogues binded together row, multi.synth.cat.df created . element n.cat just number catalogues generated. need n.cat zero-events catalogues appear fore.df, corresponding cat.idx value missing. Therefore need n.cat recover total number catalogues. code creates daily forecast 24 hours starting 1 minute event greatest magnitude sequence. starting date end date forecast expressed unit used catalogue fit model (days case). Day zero correspond start.date stated beginning document example \\(2009-01-01 00:00:00\\). forecast generated assuming known events catalogue occurred forecasting period. can easily retrieve predictive distribution number events forecasting period looking frequencies catalogue identifiers appears fore.df element. Indeed, number rows fore.df cat.idx value represents number events synthetic catalogue. , frequency catalogue identifier appears fore.df$cat.idx correspond number events catalogue. allows easily retrieve predictive distribution number events using code . remark case can use function table find frequencies elements fore.df$cat.idx. catalogue identifier zero-events catalogues present fore.df$cat.idx. using table lead zero probability zero events day, quantity crucial intersted probability earthquake activity (probability least one event).","code":"# express 1 minute in days min.in.days <- 1 / (24 * 60) # find time of the event with the greatest magnitude t.max.mag <- aquila.bru$ts[which.max(aquila.bru$magnitudes)] # set starting time of the forecasting period T1.fore <- t.max.mag + min.in.days # set forecast length fore.length <- 1 # set end time of the forecasting period T2.fore <- T1.fore + fore.length # set known data Ht.fore <- aquila.bru[aquila.bru$ts < T1.fore, ]  # produce forecast daily.fore <- Temporal.ETAS.forecast(   post.samp = post.samp, # ETAS parameters posterior samples   n.cat = nrow(post.samp), # number of synthetic catalogues   beta.p = beta.p, # magnitude distribution parameter   M0 = M0, # cutoff magnitude   T1 = T1.fore, # forecast starting time   T2 = T2.fore, # forecast end time   Ht = Ht.fore, # known events   ncore = 3 ) # number of cores # find number of events per catalogue N.fore <- vapply(   seq_len(daily.fore$n.cat),   \\(x) sum(daily.fore$fore.df$cat.idx == x), 0 ) # find number of observed events in the forecasting period N.obs <- sum(aquila.bru$ts >= T1.fore & aquila.bru$ts <= T2.fore) # plot the distribution ggplot() +   geom_histogram(aes(x = N.fore, y = after_stat(density)), binwidth = 1) +   geom_vline(xintercept = N.obs) +   xlim(100, 500) #> Warning: Removed 32 rows containing non-finite values (`stat_bin()`). #> Warning: Removed 2 rows containing missing values (`geom_bar()`)."},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Tutorial on synthetic data","text":"tutorial shows use ETAS.inlabru package generate synthetic catalogue temporal ETAS model fit ETAS model data. also show retrieve posterior distribution parameters quantity interest. brief introduction ETAS model refer tutorial real earthquake data.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"generate-a-synthetic-catalogue","dir":"Articles","previous_headings":"","what":"Generate a synthetic catalogue","title":"Tutorial on synthetic data","text":"function generate_temporal_ETAS_synthetic() can used generate synthetic catalogues temporal ETAS model fixed parameters spanning given interval time. generate_temporal_ETAS_synthetic() takes input theta: list ETAS parameters names mu, K, alpha, c, p, corresponding ETAS parameters. beta.p: parameter magnitude distribution M0: cutoff magnitude, generated event magnitude greater M0. T1: starting time catalogue (unit measure depends unit used fit model). T2: end time catalogue (unit measure depends unit used fit model). Ht: set known events. can also T1 T2, useful want generate catalogues imposed events. NULL events imposed. function returns list data.frame, element output list corresponds different generation. data.frame three columns: occurence time (ts), magnitude (magnitudes), generation identifier (gen). generation identifier uses following convention, \\(-1\\) indicates events Ht time T1 T2, \\(0\\) indicates first generation offspring events gen equal \\(-1\\), \\(1\\) indicates background events, \\(2\\) offspring events gen equal \\(0\\) \\(1\\), \\(3\\) indicates offspring events gen equal \\(2\\), \\(4\\) indicates offspring events gen equal \\(3\\), . obtain unique data.frame containing simulated events sufficient bind rows generations. code generates synthetic catalogue events magnitude greater \\(2.5\\) according temporal ETAS model parameters equal vector true.param. value parameters equal posterior mean parameters obtained fitting model L’Aquila seismic sequence done tutorial real data. Also parameter \\(\\beta\\) magnitude distribution comes example. output function list data.frames convenient transform single data.frame binding rows data.frames list. synthetic catalogue composed total \\(288\\) events \\(112\\) background events \\(176\\) aftershocks. can easily retrieve numbers looking gen column data. code plot occurrence time events magnitude color indicating generation event time evolution cumulative number events. multiplot function provided inlabru R-package can used combine plots.","code":"set.seed(111) # set true ETAS parameters true.param <- list(mu = 0.30106014, K = 0.13611399, alpha = 2.43945301, c = 0.07098607, p = 1.17838741) # set magnitude distribution parameter beta.p <- 2.353157 # set cutoff magnitude M0 <- 2.5 # set starting time of the synthetic catalogue T1 <- 0 # set end time of the synthetic catalogue T2 <- 365 # generate the catalogue - it returns a list of data.frames synth.cat.list <- generate_temporal_ETAS_synthetic(   theta = true.param,   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = NULL,   ncore = 1 ) synth.cat.df <- do.call(rbind, synth.cat.list) head(synth.cat.df) #>           ts magnitudes gen #> 1 135.204031   2.661688   1 #> 2 187.947198   2.632073   1 #> 3 137.847074   3.073890   1 #> 4 152.693124   2.653628   1 #> 5   3.890113   2.686633   1 #> 6 194.287763   3.035756   1 c(N = nrow(synth.cat.df), N.bkg = sum(synth.cat.df$gen == 1), N.after = sum(synth.cat.df$gen > 1)) #>       N   N.bkg N.after  #>     288     112     176 pl1 <- ggplot(synth.cat.df, aes(ts, magnitudes, color = as.factor(gen))) +   geom_point() +   labs(color = \"gen\")  t.breaks <- T1:T2 N.cumsum <- vapply(t.breaks, \\(x) sum(synth.cat.df$ts < x), 0) df.to.cumsum.plot <- data.frame(ts = t.breaks, N.cum = N.cumsum) pl2 <- ggplot(df.to.cumsum.plot, aes(ts, N.cum)) +   geom_line() +   ylab(\"cumulative number of events\")  inlabru::multiplot(pl1, pl2, cols = 2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"prepare-data-for-model-fitting","dir":"Articles","previous_headings":"","what":"Prepare data for model fitting","title":"Tutorial on synthetic data","text":"order fit model synthetic catalogue need set parameters priors set initial value parameters set inlabru options prepare data model fitting set priors need create list copula transformation (simply link) functions. method works internal representation parameters parameter Gaussian distribution. need function transform parameters original ETAS scale set prior . ETAS.inlabru package offers four different functions corresponding four different prior distributions. functions gamma_t, unif_t, exp_t, loggaus_t corresponds Gamma distribution, Uniform distribution, Exponential distribution Log-Gaussian distribution. also provide inverse functions retrieve value parameters internal scale given value ETAS scale. inv_gamma_t, inv_unif_t, exp_t, inv_loggaus_t. example going consider following priors parameters \\[\\begin{align*} \\mu & \\sim \\Gamma(0.3, 0.6) \\\\ K & \\sim \\text{Unif}(0,10) \\\\ \\alpha & \\sim \\text{Unif}(0,10) \\\\ c & \\sim \\text{Unif}(0,10) \\\\ p & \\sim \\text{Unif}(1,10) \\end{align*}\\] list link functions corresponding priors initial value parameters inlabru algorithm must specified internal scale parameters. reason, useful create list inverse link functions can specify initial value parameters ETAS scale easily retrieve corresponding value parameters internal scale. can done shown initial value parameters specified list names th.mu, th.K, th.alpha, th.c, th.p, , example, th.mu corresponds initial value parameter \\(\\mu\\) internal scale. initial value parameters important ensure algorithm able converge. Indeed, start algorithm values parameters causing numerical problems, may prevent algorithm converge. experience, setting initial values parameter (e.g. \\(< 10^{-5}\\)) (e.g. \\(> 10^2\\)) safe choice. code uses following initial values parameters \\(\\mu_{\\text{init}} = 0.5, K_{\\text{init}} = 0.1, \\alpha_{\\text{init}} = 1, c_{\\text{init}} = 0.1, p_{\\text{init}} = 1.1\\) Also inlabru options provided list, main elements list : bru_verbose: number indicating type visual output. Set 0 output. bru_max_iter: maximum number iterations. set max_step inlabru algorithm stops stopping criterion met. However, setting max_step values smaller 1 forces algorithm run exactly bru_max_iter iterations. bru_method: relevant , thing may need set max_step argument. algorithm converge without fixing max_step suggest try fix value 1, experience \\(0.5\\) \\(0.2\\) works well. example line setting bru_method commented. bru_initial: list initial values created . Lastly, need prepare data model fitting. data must provided data.frame least 3 columns names ts corresponding occurrence time events, magnitudes corresponding magnitude, idx.p event identifier. events data.frame must sorted respect occurrence time. synthetic catalogue generated beginning already columns ts magnitudes, sorted generation time. code sort rows data.frame adds event identifier","code":"# set copula transformations list link.f <- list(   mu = \\(x) gamma_t(x, 0.3, 0.6),   K = \\(x) unif_t(x, 0, 10),   alpha = \\(x) unif_t(x, 0, 10),   c_ = \\(x) unif_t(x, 0, 10),   p = \\(x) unif_t(x, 1, 10) ) # set inverse copula transformations list inv.link.f <- list(   mu = \\(x) inv_gamma_t(x, 0.3, 0.6),   K = \\(x) inv_unif_t(x, 0, 10),   alpha = \\(x) inv_unif_t(x, 0, 10),   c_ = \\(x) inv_unif_t(x, 0, 10),   p = \\(x) inv_unif_t(x, 1, 10) ) # set up list of initial values th.init <- list(   th.mu = inv.link.f$mu(0.5),   th.K = inv.link.f$K(0.1),   th.alpha = inv.link.f$alpha(1),   th.c = inv.link.f$c_(0.1),   th.p = inv.link.f$p(1.1) ) # set up list of bru options bru.opt.list <- list(   bru_verbose = 3, # type of visual output   bru_max_iter = 70, # maximum number of iterations   # bru_method = list(max_step = 0.5),   bru_initial = th.init ) # parameters initial values # sort catalogue by occurrence time synth.cat.df <- synth.cat.df[order(synth.cat.df$ts), ] # add event identifier synth.cat.df$idx.p <- seq_len(nrow(synth.cat.df))"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"model-fitting","dir":"Articles","previous_headings":"","what":"Model Fitting","title":"Tutorial on synthetic data","text":"function Temporal.ETAS fit ETAS model returns bru object output. required inputs : total.data: data.frame containing observed events. format described previous Section. M0: cutoff magnitude. events total.data must magnitude greater equal number. T1: starting time time interval want fit model. T2: end time time interval want fit model. link.functions: list copula transformation functions format described previous sections. coef.t., delta.t., N.max.: parameters temporal binning. binning strategy described Appendix B paper Approximation Bayesian Hawkes process inlabru. parameters corresponds coef.t.\\(=\\delta\\), delta.t.\\(=\\Delta\\), N.max.\\(=n_{\\max}\\). bru.opt: list inlabru options described previous Section.","code":"synth.fit <- Temporal.ETAS(   total.data = synth.cat.df,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  0.7189271"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"check-marginal-posterior-distributions","dir":"Articles","previous_headings":"","what":"Check marginal posterior distributions","title":"Tutorial on synthetic data","text":"order retrieve marginal posterior distributions parameter need provide list containing two elements: model.fit bru object containing fitted model, link.functions list link functions created . list created, function get_posterior_param returns marginal posterior distribution parameters ETAS scale. function returns list two elements: post.df data.frame three columns, x indicating value parameter, y indicating corresponding value marginal posterior distribution, param parameter identifier. output list also contains post.plot ggplot object containing plot marginal posterior distributions parameter. code retrieve marginal posterior distribution parameters plot along true value parameters represented vertical dashed lines.","code":"# create input list to explore model output input_list <- list(   model.fit = synth.fit,   link.functions = link.f ) # retrieve marginal posterior distributions post.list <- get_posterior_param(input.list = input_list)  # create data.frame of true value of parameters df.true.param <- data.frame(   x = unlist(true.param),   param = names(true.param) ) # add to the marginal posterior distribution of the parameters the true value of the parameters. post.list$post.plot +   geom_vline(     data = df.true.param,     mapping = aes(xintercept = x), linetype = 2   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"sampling-the-joint-posterior-distribution","dir":"Articles","previous_headings":"","what":"Sampling the joint posterior distribution","title":"Tutorial on synthetic data","text":"function post_sampling generate samples joint posterior ETAS parameters. function takes input: input.list: list model.fit element link.functions elements described . n.samp: number posterior samples. max.batch: number posterior samples generated simultaneously. n.samp\\(>\\)max.batch, , samples generated parallel batches maximum size equal max.batch. Default \\(1000\\). ncore: number cores used parallel n.samp\\(>\\)max.batch. function returns data.frame columns corresponding ETAS parameters posterior samples can used estimate posterior distribution functions parameters.","code":"post.samp <- post_sampling(   input.list = input_list,   n.samp = 1000,   max.batch = 1000,   ncore = 1 ) head(post.samp) #>          mu          K    alpha         c        p #> 1 0.3447122 0.05632264 2.651333 0.1721728 1.370521 #> 2 0.3588253 0.04512786 2.469745 0.5248405 1.618707 #> 3 0.3192821 0.03533102 2.475790 0.3685908 1.374277 #> 4 0.3159579 0.04087010 2.550492 0.2702158 1.369314 #> 5 0.3017068 0.04818273 2.564914 0.2413635 1.402494 #> 6 0.3426802 0.04279500 2.506681 0.4210498 1.511304"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"triggering-function-and-omori-law","dir":"Articles","previous_headings":"","what":"Triggering function and Omori law","title":"Tutorial on synthetic data","text":"Interesting functions parameters triggering function Omori law. can estimate posterior distribution functions using samples joint posterior distribution parameters obtained previous section. functions triggering_fun_plot provides plot quantiles posterior distribution triggering function \\(g(t-t_h, mh)\\), namely, \\[ g(t - t_h, m_h) = K\\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] function takes input input.list: input list defined functions used previously. post.samp: data.frame samples posterior distribution parameters. NULL, n.samp samples generated posterior. n.samp: number posterior samples parameters used generated. magnitude: magnitude event (\\(m_h\\)). t.end: maximum value \\(t\\) plot. n.breaks: number breaks interval \\((0, \\texttt{t.end})\\) divided. function returns ggplot object. sample parameters triggering function \\(0\\) t.end calculated. black solid lines represents \\(95\\%\\) posterior interval function, grey lines represent triggering function calculated posterior samples, horizontal red lines represent \\(95\\%\\) posterior interval background rate \\(\\mu\\). function triggering_plot_prior using parameters sampled priors parameters. code creates plot posterior triggering function adds triggering function calculated true parameter values blue. need add argument M0 input_list use function triggering_fun_plot.  functions omori_plot_posterior function triggering_fun_plot considering \\[ \\left(\\frac{t- t_h}{c} + 1\\right)^{-p} \\] instead whole triggering function without background rate.","code":"# add cutoff magnitude to input_list input_list$M0 <- M0  # generate triggering function plot trig.plot <- triggering_fun_plot(   input.list = input_list,   post.samp = post.samp,   n.samp = NULL, magnitude = 4,   t.end = 5, n.breaks = 100 )  # set times at which calculate the true triggering function t.breaks <- seq(1e-6, 5, length.out = 100) # calculate the function true.trig <- gt(unlist(true.param), t = t.breaks, th = 0, mh = 4, M0 = M0) # store in data.frame for plotting true.trig.df <- data.frame(ts = t.breaks, trig.fun = true.trig)  # add the true triggering function to the plot trig.plot +   geom_line(     data = true.trig.df,     mapping = aes(x = ts, y = trig.fun), color = \"blue\"   ) omori.plot <- omori_plot_posterior(input.list = input_list, post.samp = post.samp, n.samp = NULL, t.end = 5)  true.omori <- omori(theta = unlist(true.param), t = t.breaks, ti = 0) true.omori.df <- data.frame(ts = t.breaks, omori.fun = true.omori)  omori.plot +   geom_line(     data = true.omori.df,     mapping = aes(x = ts, y = omori.fun), color = \"blue\"   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"comparison-between-different-fitted-models","dir":"Articles","previous_headings":"","what":"Comparison between different fitted models","title":"Tutorial on synthetic data","text":"interesting fit model multiple synthetic catalogues compare parameters posterior distributions obtained different catalogues. section, going generate second synthetic catalogue, fit model, compare posterior distributions ones obtained . second catalogue impose large event magnitude \\(6\\) happening midpoint time interval. first step set data.frame known events generate second synthetic catalogue Counting number background events aftershocks case slightly different . fact, count imposed event background event, aftershocks need include also event gen = 0 ones induced imposed event case 192. comparison number events two catalogues. Notice background events roughly expected given time interval . , just need set data.frame model fitting. inputs can use ones created first model fit. Now, extract marginal posterior distributions, need create input_list second model fit. Now, can retrieve marginal posterior distributions provided model fitted second catalogue compare ones obtained .  process shown can extended multiple (\\(>2\\)) input catalogues order study parameters identifiable. Also, using characteristics input catalogue catalogue identifier can study change posterior distribution characteristic input catalogue changes. interesting example number events catalogue, studying marginal posterior distributions change increase decrease number events.","code":"# set up data.frame of imposed events Ht.imposed <- data.frame(   ts = mean(c(T1, T2)),   magnitudes = 6 ) # generate second catalogue set.seed(1) synth.cat.list.2 <- generate_temporal_ETAS_synthetic(   theta = true.param,   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = Ht.imposed,   ncore = 1 ) # transform it in a data.frame synth.cat.df.2 <- do.call(rbind, synth.cat.list.2) sum(synth.cat.df.2$gen == 0) #> [1] 192 rbind(   first = c(     N = nrow(synth.cat.df),     N.bkg = sum(synth.cat.df$gen == 1),     N.after = sum(synth.cat.df$gen > 1)   ),   second = c(     N = nrow(synth.cat.df.2),     N.bkg = sum(synth.cat.df.2$gen == 1 | synth.cat.df.2$gen == -1),     N.after = sum(synth.cat.df.2$gen > 1 | synth.cat.df.2$gen == 0)   ) ) #>          N N.bkg N.after #> first  288   112     176 #> second 408   104     304 synth.cat.df.2 <- synth.cat.df.2[order(synth.cat.df.2$ts), ] synth.cat.df.2$idx.p <- seq_len(nrow(synth.cat.df.2))  synth.fit.2 <- Temporal.ETAS(   total.data = synth.cat.df.2,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  0.9830351 input_list.2 <- list(   model.fit = synth.fit.2,   link.functions = link.f ) # retrieve marginal posterior distributions post.list.2 <- get_posterior_param(input.list = input_list.2)  # set model identifier post.list$post.df$cat.used <- \"first catalogue\" post.list.2$post.df$cat.used <- \"second catalogue\"  # bind marginal posterior data.frames bind.post.df <- rbind(post.list$post.df, post.list.2$post.df)  # plot them ggplot(bind.post.df, aes(x = x, y = y, color = cat.used)) +   geom_line() +   facet_wrap(facets = ~param, scales = \"free\") +   xlab(\"param\") +   ylab(\"pdf\") +   geom_vline(     data = df.true.param,     mapping = aes(xintercept = x), linetype = 2   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Francesco Serafini. Author, maintainer. Mark Naylor. Author, thesis advisor. Finn Lindgren. Author, thesis advisor.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Mark Naylor, & Francesco Serafini (2023). edinburgh-seismicity-hub/ETAS.inlabru: Temporal Hawkes (v1.0.1).  Zenodo. https://doi.org/10.5281/zenodo.7515785 Mark Naylor, Francesco Serafini, Finn Lindgren (2023). doi:10.3389/fams.2023.1126759, https://www.frontiersin.org/articles/10.3389/fams.2023.1126759 Francesco Serafini, Finn Lindgren, Mark Naylor (2023). doi:10.1002/env.2798, https://onlinelibrary.wiley.com/doi/abs/10.1002/env.2798","code":"@Misc{,   title = {edinburgh-seismicity-hub/ETAS.inlabru: Temporal Hawkes},   author = {Mark Naylor and Francesco Serafini},   publisher = {Zenodo},   year = {2023},   number = {v1.0.1},   url = {https://doi.org/10.5281/zenodo.7515785},   doi = {10.5281/zenodo.7515785}, } @Article{,   title = {Bayesian modelling of the temporal evolution of seismicity using the ETAS.inlabru R-package},   author = {Mark Naylor and Francesco Serafini and Finn Lindgren},   journal = {Frontiers in Applied Mathematics and Statistics},   year = {2023},   doi = {10.3389/fams.2023.1126759},   url = {https://www.frontiersin.org/articles/10.3389/fams.2023.1126759}, } @Article{,   title = {Approximation of Bayesian Hawkes process with inlabru},   author = {{Serafini} and {Francesco} and {Lindgren} and {Finn} and {Naylor} and {Mark}},   journal = {Environmetrics},   year = {2023},   doi = {10.1002/env.2798},   url = {https://onlinelibrary.wiley.com/doi/abs/10.1002/env.2798}, }"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"etasinlabru","dir":"","previous_headings":"","what":"Bayesian ETAS model for modelling seismic sequences with inlabru","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"R package implements ETAS Hawkes process modelling seismicity Online documentation: https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"authors","dir":"","previous_headings":"","what":"Authors","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Dr Francesco Serafini Dr Mark Naylor , School GeoSciences, University Edinburgh Prof Finn Lindgren , School Mathematics, University Edinburgh Dr Kirsty Bayliss , Global Earthquake Model (GEM)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"funding","dir":"","previous_headings":"","what":"Funding","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"study funded yhe Real-Time Earthquake Risk Reduction Resilient Europe RISE project , received funding European Union’s Horizon 2020 Research Innovation Program grant Agreement 821115. Naylor additionally funded NSFGEO-NERC grant NE/R000794/1. Bayliss funded EPSRC Studentship.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"ETAS.inlabru work, need install R-INLA inlabru: inlabru (see https://inlabru-org.github.io/inlabru/): CRAN release, development version, R-INLA (see https://www.r-inla.org/download-install): can install development version ETAS.inlabru GitHub ","code":"install.packages(\"inlabru\") # install.packages(\"remotes\") remotes::install_github(\"inlabru-org/inlabru\") install.packages(   \"INLA\",   repos = c(getOption(\"repos\"), INLA=\"https://inla.r-inla-download.org/R/testing\"),   dep = TRUE ) # install.packages(\"remotes\") remotes::install_github(\"edinburgh-seismicity-hub/ETAS.inlabru\")"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"file-structure-in-package","dir":"","previous_headings":"Terminology and planning suggestions","what":"File structure in package","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"ETAS.triggering.function.R : Contains ETAS specific model functions HawkesProcess.R : Generic Hawkes code intended integration back inlabru generateSyntheticCatalogues.R : Contains iterative Hawkes functions generating triggered events actual triggering functions reside ETAS file introduce models temporalBinning.R : Code generate time bins make integration scheme efficient plottingFunctions.R : lets put standard plotting functions setupInlabruInputs.R : Put functions generating input.list ","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"terminology","dir":"","previous_headings":"","what":"Terminology","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Let’s specific just temporal clear function names spatial spatial-temporal later Might anything bad? tried modify just theta","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"implemented","dir":"","previous_headings":"","what":"Implemented","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Generation synthetic ETAS catalogues ETAS.inlabru demonstration notebook","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"in-development","dir":"","previous_headings":"","what":"In development","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Add inversion modelling based original code Modify implementation generic Hawkes code can go inlabru ETAS triggering function code stay package Implement time varying incompleteness model Farnaz Kamranzad","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"roadmap","dir":"","previous_headings":"","what":"Roadmap","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Implement incompleteness fix Integrate spatial modelling","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/ETAS.inlabru-package.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru — ETAS.inlabru-package","title":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru — ETAS.inlabru-package","text":"Modelling inversion ETAS model seismicity using inlabru Epidemic Type Aftershock Sequence (ETAS) model designed model earthquakes triggered previous events. statistics, referred Hawkes process. code can used generate synthetic ETAS catalogues can also include seeded events model specific sequences. also implement Bayesian inversion scheme using Integrated Nested Laplace Approximation (INLA) using inlabru. temporal model, given training catalogue times magnitudes, code returns joint posteriors ETAS parameters. future roadmap, include tools model spatial distribution spatio-temporal evolution seismic sequences.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/ETAS.inlabru-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru — ETAS.inlabru-package","text":"Maintainer: Francesco Serafini francesco.serafini@newcastle.ac.uk (ORCID) Authors: Mark Naylor mark.naylor@ed.ac.uk (ORCID) [thesis advisor] Finn Lindgren Finn.Lindgren@ed.ac.uk (ORCID) [thesis advisor]","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":null,"dir":"Reference","previous_headings":"","what":"Injection Rate function calculations — IntInjectionIntensity","title":"Injection Rate function calculations — IntInjectionIntensity","text":"Forward time integrated function exponential rate decay, inverse","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Injection Rate function calculations — IntInjectionIntensity","text":"","code":"IntInjectionIntensity(a = 50, V.i = 1, tau = 10, T.i, T2)  Inv_IntInjectionIntensity(   a = 50,   V.i = 1,   tau = 10,   T.i,   number.injected.events )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Injection Rate function calculations — IntInjectionIntensity","text":"Event rate per unit volume injected V.Injected volume tau Decay rate [days] T.Time injection event T2 End temporal model domain number.injected.events number expected injected events, used inverse.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Injection Rate function calculations — IntInjectionIntensity","text":"IntInjectionIntensity returns forward time integrated function exponential rate decay. Inv_IntInjectionIntensity returns end time corresponding given expected number injected events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":null,"dir":"Reference","previous_headings":"","what":"Integrated Omori's law — Int_ETAS_time_trig_function","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"Integrated Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"","code":"Int_ETAS_time_trig_function(theta, th, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p) th Time past event [days] start temporal domain, vector. T2 End temporal domain, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"Value integral Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"function returns integral Omori's law, namely $$\\int_{t_h}^{T_2} \\left(\\frac{t - t_h}{c} + 1\\right)^{-p} dt$$","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"Inverse integrated Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"","code":"Inv_Int_ETAS_time_trig_function(theta, omega, th)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p) omega Value integral inverted, vector th Time integral calculated scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"Value start temporal domain used calculate integral","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"Considering integral Omori's law $$\\omega = \\int_{t_h}^{T_2}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} dt$$ function applied value \\(\\omega\\) returns value \\(t_h\\).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to calculate the integral of Omori's law — It_df","title":"Function to calculate the integral of Omori's law — It_df","text":"Function calculate integral Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to calculate the integral of Omori's law — It_df","text":"","code":"It_df(param_, time.df)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to calculate the integral of Omori's law — It_df","text":"param_ ETAS parameters vector (\\(\\mu, K, \\alpha, c, p\\)), \\(c, p\\) used. time.df output function time_grid()","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to calculate the integral of Omori's law — It_df","text":"vector integral values bin provided time.df","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"Fits remporal ETAS model returns results. function decomposes input.list `Hawkes.bru2`` function.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"","code":"Temporal.ETAS.fit(input.list)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"input.list input data parameters passed inlabru via structured list. output function create_input_list_temporal_withCatalogue create_input_list_temporal_noCatalogue","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"fitted model bru object, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — Temporal.ETAS.forecast","title":"Title — Temporal.ETAS.forecast","text":"Title","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — Temporal.ETAS.forecast","text":"","code":"Temporal.ETAS.forecast(post.samp, n.cat, beta.p, M0, T1, T2, Ht, ncore = 1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — Temporal.ETAS.forecast","text":"post.samp data.frame containing samples posterior distribution ETAS parameters. row data.frame corresponds different sample parameters order \\(\\mu\\), \\(K\\), \\(\\alpha\\), \\(c\\), \\(p\\). n.cat number synthetic catalogues composing forecast. n.cat greater nrow(post.samp), , n.cat rows sampled uniformly replacement post.samp. n.cat smaller nrow(post.samp), , n.cat rows sampled uniformly without replacement post.samp. n.cat NULL equal nrow(post.samp), post.samp used nrow(post.samp) catalogues generated. beta.p parameter magnitude distribution M0 cutoff magnitude, synthetic events magnitude greater value. T1 starting time forecast T2 end time forecast Ht set known events ncore number cores used generate synthetic catalogues parallel.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — Temporal.ETAS.forecast","text":"list two elements: fore.df data.frame containing synthetic catalogues composing forecast. data.frame four columns, ts occurrence time, magnitudes magnitude, gen generation event, cat.idx catalogue identifier second element output list n.cat number synthetic catalogues generated.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to fit Hawkes process model — Temporal.ETAS","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"function fit temporal ETAS model using inlabru.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"","code":"Temporal.ETAS(   total.data,   M0,   T1,   T2,   link.functions = NULL,   coef.t.,   delta.t.,   N.max.,   bru.opt )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"total.data Observed events: data.frame columns time (ts), magnitude (magnitudes), event identifier (idx.p). Column names must changed. M0 Minimum magnitude threshold, scalar T1 Start temporal model domain, scalar [measure unit sample.s$ts]. T2 End temporal model domain, scalar [measure unit sample.s$ts]. link.functions Functions transform parameters internal INLA scale ETAS scale. must list functions names (mu, K, alpha, c_, p) coef.t. TimeBinning parameter: parameter regulating relative length successive bins, scalar. delta.t. TimeBinning parameter: parameter regulating bins' width, scalar. N.max. TimeBinning parameter: parameter regulating Number bins (= N.max + 2), scalar. bru.opt Runtime options inlabru: See https://inlabru-org.github.io/inlabru/reference/bru_call_options.html, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"fitted model 'bru' object, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":null,"dir":"Reference","previous_headings":"","what":"Find breaks point for 1D grid — breaks_exp","title":"Find breaks point for 1D grid — breaks_exp","text":"breaks_exp return breaks points one dimensional grid depending three parameters, see details","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find breaks point for 1D grid — breaks_exp","text":"","code":"breaks_exp(start.grid, end.grid, coef.t = 2, delta.t, N.exp. = 10)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find breaks point for 1D grid — breaks_exp","text":"start.grid Starting point grid, scalar. end.grid End point grid, scalar. coef.t TimeBinning parameter: \\(\\delta > 0\\) determines relative length subsequent intervals, scalar. delta.t TimeBinning parameter: \\(\\Delta > 0\\) determines length intervals, scalar. N.exp. TimeBinning parameter: \\(n_{max} >0\\) determines maximum number intervals, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find breaks point for 1D grid — breaks_exp","text":"vector containing grid points","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Find breaks point for 1D grid — breaks_exp","text":"grid calculated follows $$t, t + \\Delta, t + \\Delta(1 + \\delta), t + \\Delta(1 + \\delta)^2,...., T$$ \\(t\\) start.grid argument, \\(T\\) end.grid argument, \\(n_{max}\\) maximum value exponent","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find breaks point for 1D grid — breaks_exp","text":"","code":"breaks_exp(start.grid = 1, end.grid = 100, coef.t = 1, delta.t = 1, N.exp. = 3) #> [1]   1   2   3   5   9 100 breaks_exp(start.grid = 1, end.grid = 100, coef.t = 1, delta.t = 1, N.exp. = 10) #> [1]   1   2   3   5   9  17  33  65 100"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to compute the integral of Omori's law efficiently — compute_grid","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"Function compute integral Omori's law efficiently","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"","code":"compute_grid(param., list.input_)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"param. ETAS parameters vector (\\(\\mu, K, \\alpha, c, p\\)), \\(c, p\\) used. list.input_ list containing information calculate integrals efficiently. list created inside Temporal.ETAS function Two elements used time.sel selection rows output time_grid unique t.ref_layer value, data.frame. Imapping mapper unique names provided time.sel original rows output time_grid(), vector.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"vector length list.input_$Imapping integral Omori's law bin.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS conditional intensity - used by inlabru — cond_lambda","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"Function calculate value ETAS model conditional intensity specified time given history process.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"","code":"cond_lambda(theta, t, th, mh, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"theta ETAS parameters list names mu, K, alpha, c, p t Time conditional intensity evaluated, scalar th Time events history process, vector mh Magnitudes events history process, vector M0 Minimum magnitude threshold","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"Value ETAS conditional intensity calculated t history th, mh, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"function takes single value t returns ETAS conditional intensity calculated t history th, mh. ETAS conditional intensity given $$\\lambda(t | \\mathcal H_t) = \\mu + \\sum_{h: (t_h,m_h) \\\\mathcal H_t} K e^{\\alpha(m_h - M_0)} \\left( \\frac{t - t_h}{c} + 1\\right)^{-p}$$ use t vector.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"Function create default input list ETAS Hawkes temporal model catalogue specified input file","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"","code":"create_input_list_temporal_noCatalogue(input_path, num.threads = NULL)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"input_path Input file path string num.threads Optional argument number threads used parallel processing","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"formatted input.list elements required temporal Hawkes model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"","code":"create_input_list_temporal_noCatalogue(   system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\") ) #> $catalog #> NULL #>  #> $catalog.bru #> NULL #>  #> $time.int #> NULL #>  #> $T12 #> [1] \"T1\"  \" T2\" #>  #> $lat.int #> [1] -90  90 #>  #> $lon.int #> [1] -180  180 #>  #> $M0 #> NULL #>  #> $mu.init #> [1] 0.25 #>  #> $K.init #> [1] 0.3 #>  #> $alpha.init #> [1] 1.6 #>  #> $c.init #> [1] 0.2 #>  #> $p.init #> [1] 1.1 #>  #> $a_mu #> [1] 0.5 #>  #> $b_mu #> [1] 0.5 #>  #> $a_K #> [1] -1 #>  #> $b_K #> [1] 0.5 #>  #> $a_alpha #> [1] 0 #>  #> $b_alpha #> [1] 10 #>  #> $a_c #> [1] 0 #>  #> $b_c #> [1] 1 #>  #> $a_p #> [1] 1 #>  #> $b_p #> [1] 2 #>  #> $max_iter #> [1] 100 #>  #> $max_step #> NULL #>  #> $link.functions #> $link.functions$mu #> function (x)  #> gamma_t(x, a_mu, b_mu) #> <bytecode: 0x55c056c26cd8> #> <environment: 0x55c056c29528> #>  #> $link.functions$K #> function (x)  #> loggaus_t(x, a_K, b_K) #> <bytecode: 0x55c056c2a830> #> <environment: 0x55c056c29528> #>  #> $link.functions$alpha #> function (x)  #> unif_t(x, a_alpha, b_alpha) #> <bytecode: 0x55c056c2a558> #> <environment: 0x55c056c29528> #>  #> $link.functions$c_ #> function (x)  #> unif_t(x, a_c, b_c) #> <bytecode: 0x55c056c2a280> #> <environment: 0x55c056c29528> #>  #> $link.functions$p #> function (x)  #> unif_t(x, a_p, b_p) #> <bytecode: 0x55c056c29fa8> #> <environment: 0x55c056c29528> #>  #>  #> $bru.opt.list #> $bru.opt.list$bru_verbose #> [1] 3 #>  #> $bru.opt.list$bru_max_iter #> [1] 100 #>  #> $bru.opt.list$num.threads #> NULL #>  #> $bru.opt.list$bru_initial #> $bru.opt.list$bru_initial$th.mu #> [1] -0.2978078 #>  #> $bru.opt.list$bru_initial$th.K #> [1] -0.4079456 #>  #> $bru.opt.list$bru_initial$th.alpha #> [1] -0.9944579 #>  #> $bru.opt.list$bru_initial$th.c #> [1] -0.8416212 #>  #> $bru.opt.list$bru_initial$th.p #> [1] -1.281552 #>  #>  #>  #> $coef.t #> [1] 1 #>  #> $delta.t #> [1] 0.1 #>  #> $Nmax #> [1] 8 #>  #> $n.periods #> [1] 120 #>  #> $period.length #> [1] 1 #>  #> $start.date.fore #> NULL #>  #> $magnitude.update #> [1] 5.5 #>  #> $output.name #> [1] \"report_ETAS\" #>"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"Function create default input file ETAS Hawkes temporal model catalogue specified input file.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"","code":"create_input_list_temporal_withCatalogue(input_path, num.threads = NULL)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"input_path path txt file containing experiment's information num.threads Optional argument number threads used parallel processing","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"formatted input.list elements required temporal Hawkes model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"Copula transformation standard Normal distribution Exponential distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"","code":"exp_t(x, r)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"x values standard Normal distribution, vector. r rate exponential distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"values Exponential distribution rate r, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"Copula transformation standard Normal distribution Gamma distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"","code":"gamma_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"x values standard Normal distribution, vector. shape parameter gamma distribution scalar. b rate parameter gamma distribution scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"values Gamma distribution shape rate b, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":null,"dir":"Reference","previous_headings":"","what":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"Generates synthetic catalogue using ETAS model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"","code":"generate_temporal_ETAS_synthetic(   theta,   beta.p,   M0,   T1,   T2,   Ht = NULL,   ncore = 1 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). M0 minimum magnitude synthetic catalogue. T1 start time synthetic catalogue [days]. T2 end time synthetic catalogue [days]. Ht catalogue history impose synthetic sequence. ncore Integer number compute cores use.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"data.frame temporal catalogue columns [t_i, M_i, gen_i] , t_i times,  M_i magnitudes, gen_i includes information generation number","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"","code":"## EXAMPLE 1: Generate a 1000 day synthetic ETAS catalogue  generate_temporal_ETAS_synthetic(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000 ) #> [[1]] #>            ts magnitudes gen #> 1   949.81970   4.165622   1 #> 2   443.20003   2.609649   1 #> 3    65.90174   2.923859   1 #> 4   255.55263   2.698457   1 #> 5   110.34301   2.504808   1 #> 6   697.78259   2.752089   1 #> 7   605.68645   3.194096   1 #> 8   329.08388   3.407909   1 #> 9   742.69314   2.575639   1 #> 10  432.81544   4.628133   1 #> 11  473.88489   3.458130   1 #> 12  363.62420   2.683367   1 #> 13  476.24876   2.640975   1 #> 14  488.34242   3.078494   1 #> 15  259.81373   2.551578   1 #> 16  974.44820   2.524324   1 #> 17  173.70028   3.158413   1 #> 18  528.78379   2.525267   1 #> 19  421.10082   2.583897   1 #> 20  615.73056   4.159330   1 #> 21   25.04287   2.524146   1 #> 22  404.78530   2.809116   1 #> 23  424.22468   2.811889   1 #> 24  550.09166   3.114893   1 #> 25  438.67924   3.769980   1 #> 26   96.08455   2.638703   1 #> 27  389.30784   3.122000   1 #> 28  982.44656   2.557053   1 #> 29  951.97821   2.674289   1 #> 30  418.39211   3.327874   1 #> 31  149.90601   2.517811   1 #> 32  317.78896   2.546591   1 #> 33  305.11314   2.555986   1 #> 34  351.14543   2.591205   1 #> 35  369.67150   3.413977   1 #> 36  977.09505   2.548324   1 #> 37  936.87916   3.306135   1 #> 38  561.63435   2.527369   1 #> 39  373.56703   2.739092   1 #> 40  936.47137   2.584254   1 #> 41  774.19013   2.788077   1 #> 42  817.52560   2.930958   1 #> 43  492.72030   2.577750   1 #> 44  564.88398   2.530168   1 #> 45  602.30514   2.862151   1 #> 46  538.80624   3.160304   1 #> 47  300.55903   2.736491   1 #> 48   45.91552   2.526015   1 #> 49  268.63188   2.971028   1 #> 50  612.29517   2.568893   1 #> 51  411.51158   2.501127   1 #> 52  106.22517   2.500386   1 #> 53  505.84415   2.518131   1 #> 54  510.72231   2.623892   1 #> 55  820.59967   2.727776   1 #> 56  526.85537   3.946210   1 #> 57  539.52420   4.528699   1 #> 58  164.74534   2.703898   1 #> 59  538.31923   2.553071   1 #> 60   29.64909   2.979002   1 #> 61  330.75738   2.615013   1 #> 62  605.60818   2.600434   1 #> 63  336.36787   2.710215   1 #> 64   95.38354   2.563160   1 #> 65  571.56622   3.208477   1 #> 66  677.40781   3.291638   1 #> 67  391.67271   3.155577   1 #> 68  695.20003   3.127016   1 #> 69  377.56252   2.710139   1 #> 70  126.50391   2.719477   1 #> 71  942.85828   2.556411   1 #> 72  284.82920   2.934138   1 #> 73  851.91835   2.718712   1 #> 74  607.38584   2.948740   1 #> 75  772.98756   3.409818   1 #> 76   24.72634   2.525014   1 #> 77   43.84229   2.626518   1 #> 78  509.19304   2.544000   1 #> 79   72.33229   2.889900   1 #> 80  662.09552   3.979502   1 #> 81  554.92349   2.933955   1 #> 82   36.02215   3.118076   1 #> 83  819.17173   2.595476   1 #> 84  415.98581   2.586571   1 #> 85  629.34687   2.677729   1 #> 86  799.19511   2.778316   1 #> 87  260.16835   2.575023   1 #> 88   51.09887   2.672367   1 #> 89  457.44915   3.860156   1 #> 90  600.25469   2.566632   1 #> 91  335.24989   3.604149   1 #> 92  408.41256   2.768923   1 #> 93  967.85966   2.732579   1 #> 94  939.68940   3.716938   1 #> 95  131.39541   2.684294   1 #> 96  191.67990   2.586360   1 #> 97  444.11753   2.637769   1 #> 98  714.18949   2.823416   1 #> 99  964.00216   3.657358   1 #> 100 668.28813   2.799712   1 #>  #> [[2]] #>           ts magnitudes gen #> 1  950.01865   2.675600   2 #> 2  949.97690   3.095127   2 #> 3  345.22221   3.186811   2 #> 4  832.79326   3.475902   2 #> 5  447.36737   3.537109   2 #> 6  456.51641   2.839062   2 #> 7  433.61368   2.626549   2 #> 8  432.89386   2.720936   2 #> 9  474.48762   3.574758   2 #> 10 433.26420   2.929921   2 #> 11 244.84898   2.979622   2 #> 12 616.36199   2.748913   2 #> 13 449.23543   3.506312   2 #> 14 530.76254   2.542622   2 #> 15 485.38517   2.758540   2 #> 16 849.58167   2.539445   2 #> 17 526.90321   2.854586   2 #> 18 528.93633   2.597832   2 #> 19 539.54671   3.305017   2 #> 20 539.80952   2.645108   2 #> 21 683.82178   2.717612   2 #> 22 539.57828   4.009850   2 #> 23 539.96115   3.468701   2 #> 24 539.68299   2.700995   2 #> 25 167.97205   2.696807   2 #> 26 336.69564   2.778323   2 #> 27 662.18334   2.796728   2 #> 28  44.42593   2.527256   2 #> 29  37.15582   2.758993   2 #> 30 541.60332   2.548509   2 #> 31 939.70840   3.422456   2 #> 32 964.27264   2.524790   2 #>  #> [[3]] #>         ts magnitudes gen #> 1 953.9989   2.736655   3 #> 2 457.5478   2.568407   3 #> 3 478.6275   2.583727   3 #> 4 249.0294   2.597215   3 #> 5 618.0184   3.038113   3 #> 6 539.6357   2.679323   3 #> 7 684.8377   3.046859   3 #> 8 870.4581   2.731577   3 #> 9 543.5586   2.676903   3 #>    ## EXAMPLE 2: To generate a 1000 day catalogue including a M6.7 event on day 500  Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) generate_temporal_ETAS_synthetic(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000,   Ht = Ht ) #> [[1]] #>    ts magnitudes gen #> 1 500        6.7  -1 #>  #> [[2]] #>             ts magnitudes gen #> 1    500.03468   2.517916   0 #> 2    709.14606   2.798204   0 #> 3    500.75291   2.866192   0 #> 4    500.07879   2.860400   0 #> 5    548.76018   2.758913   0 #> 6    593.53922   2.836950   0 #> 7    558.86670   2.523324   0 #> 8    506.63864   3.151792   0 #> 9    598.17224   3.260699   0 #> 10   525.52952   3.084153   0 #> 11   501.52698   3.037129   0 #> 12   500.94190   2.901745   0 #> 13   500.26239   3.848851   0 #> 14   500.21673   2.538427   0 #> 15   527.43940   3.117615   0 #> 16   509.33470   4.004926   0 #> 17   507.49992   3.906931   0 #> 18   755.36464   2.727874   0 #> 19   500.54540   2.645535   0 #> 20   501.02902   4.183367   0 #> 21   505.65233   2.910780   0 #> 22   501.23760   2.757414   0 #> 23   500.18900   2.836621   0 #> 24   506.99932   2.533899   0 #> 25   566.81177   2.592869   0 #> 26   591.17288   2.803773   0 #> 27   570.38118   3.164425   0 #> 28   848.92618   3.744513   0 #> 29   863.32844   2.643986   0 #> 30   500.14122   2.850404   0 #> 31   703.13697   3.105893   0 #> 32   500.06110   2.639664   0 #> 33   500.87039   3.254951   0 #> 34   571.73813   2.813390   0 #> 35   502.70120   2.754283   0 #> 36   500.38285   2.534790   0 #> 37   653.97806   2.715607   0 #> 38   500.48784   2.721983   0 #> 39   500.46709   2.644630   0 #> 40   677.03915   3.128993   0 #> 41   513.11815   3.000937   0 #> 42   500.15076   3.247403   0 #> 43   525.37675   2.808099   0 #> 44   505.88039   3.700658   0 #> 45   501.37162   4.081326   0 #> 46   747.20020   2.531293   0 #> 47   500.19333   2.528295   0 #> 48   504.11633   2.511889   0 #> 49   503.87574   2.949571   0 #> 50   500.00642   2.899521   0 #> 51   500.98966   2.734649   0 #> 52   503.17815   3.497224   0 #> 53   500.14309   3.473407   0 #> 54   500.11188   3.528831   0 #> 55   990.43426   2.795311   0 #> 56   503.87386   3.276818   0 #> 57   507.47178   2.605142   0 #> 58   580.21525   2.607181   0 #> 59   511.79046   3.408396   0 #> 60   503.87120   2.666576   0 #> 61   507.29801   2.656728   0 #> 62   500.38676   2.806337   0 #> 63   559.30723   3.495800   0 #> 64   523.68429   4.828878   0 #> 65   504.82537   2.697068   0 #> 66   508.23374   2.564452   0 #> 67   500.13967   2.500380   0 #> 68   500.24525   2.653130   0 #> 69   501.14800   2.553956   0 #> 70   500.61629   2.530887   0 #> 71   505.09800   3.143656   0 #> 72   587.80451   3.382962   0 #> 73   523.11777   2.737918   0 #> 74   500.19287   2.774543   0 #> 75   511.82353   2.892895   0 #> 76   504.67255   2.810477   0 #> 77   500.68890   2.538337   0 #> 78   500.01348   2.680356   0 #> 79   504.73681   2.821956   0 #> 80   500.17791   2.522729   0 #> 81   501.68351   2.674007   0 #> 82   541.64153   2.755587   0 #> 83   500.11192   2.666162   0 #> 84   605.82230   2.864046   0 #> 85   505.87286   2.721683   0 #> 86   684.50142   2.914442   0 #> 87   500.62671   2.782359   0 #> 88   505.97017   2.512271   0 #> 89   500.39441   2.822193   0 #> 90   504.48887   3.765540   0 #> 91   500.00256   2.643868   0 #> 92   500.12594   3.177959   0 #> 93   500.01818   2.851388   0 #> 94   514.31101   2.953992   0 #> 95   521.30247   2.539771   0 #> 96   798.27453   3.020893   0 #> 97   514.01716   3.152866   0 #> 98   501.27221   2.607118   0 #> 99   500.17070   2.838390   0 #> 100  500.11150   2.857437   0 #> 101  528.96358   2.642490   0 #> 102  500.06267   2.969190   0 #> 103  501.09000   2.801597   0 #> 104  500.15008   2.528334   0 #> 105  500.12543   3.028813   0 #> 106  768.26452   2.559812   0 #> 107  501.34748   2.657105   0 #> 108  500.68562   3.621577   0 #> 109  734.86800   2.940725   0 #> 110  513.76184   2.672275   0 #> 111  503.95656   3.167533   0 #> 112  500.43065   2.737972   0 #> 113  500.79941   2.532174   0 #> 114  501.69771   2.528779   0 #> 115  500.69393   3.003745   0 #> 116  500.03260   2.789584   0 #> 117  500.30470   2.628906   0 #> 118  500.31582   2.925666   0 #> 119  518.90057   2.883596   0 #> 120  502.84466   3.361826   0 #> 121  511.23161   2.979487   0 #> 122  509.95962   2.546329   0 #> 123  505.00600   3.259864   0 #> 124  507.67041   2.513882   0 #> 125  548.87045   2.760472   0 #> 126  519.16220   2.921930   0 #> 127  501.46415   2.625843   0 #> 128  501.85392   3.010362   0 #> 129  531.76648   2.594626   0 #> 130  500.28004   3.239211   0 #> 131  500.34845   3.000968   0 #> 132  544.11307   2.522468   0 #> 133  503.00126   2.832335   0 #> 134  695.95558   2.700532   0 #> 135  503.01295   3.048490   0 #> 136  502.54365   2.694683   0 #> 137  524.36298   2.766654   0 #> 138  501.36243   2.553479   0 #> 139  554.44580   2.712562   0 #> 140  516.16871   3.423879   0 #> 141  500.13912   3.420540   0 #> 142  500.00520   2.543243   0 #> 143  527.16826   2.529821   0 #> 144  505.40735   3.221366   0 #> 145  500.40087   3.016087   0 #> 146  500.96135   2.874890   0 #> 147  503.37344   2.592161   0 #> 148  501.66726   3.591062   0 #> 149  618.60661   3.422556   0 #> 150  500.01908   2.545981   0 #> 151  501.05039   2.566085   0 #> 152  500.20727   3.680786   0 #> 153  500.70469   3.030976   0 #> 154  500.28117   3.783383   0 #> 155  785.76031   2.597479   0 #> 156  500.65384   2.771720   0 #> 157  503.74822   2.520780   0 #> 158  776.85079   2.953694   0 #> 159  502.31397   4.256859   0 #> 160  627.66353   3.037774   0 #> 161  501.01487   2.771014   0 #> 162  693.24404   2.939908   0 #> 163  500.09067   2.728318   0 #> 164  500.09451   2.650380   0 #> 165  527.77500   2.571104   0 #> 166  500.36338   3.325602   0 #> 167  504.14157   2.592718   0 #> 168  500.41758   2.929175   0 #> 169  504.59785   2.667797   0 #> 170  522.14053   2.819988   0 #> 171  525.45685   2.590256   0 #> 172  503.01708   3.554422   0 #> 173  513.63981   2.758496   0 #> 174  613.89680   3.245539   0 #> 175  501.71459   2.804685   0 #> 176  756.83558   2.864239   0 #> 177  502.53751   2.644592   0 #> 178  500.93567   2.957355   0 #> 179  500.36193   2.568229   0 #> 180  634.06698   3.332151   0 #> 181  520.91158   3.510130   0 #> 182  594.45604   3.442739   0 #> 183  527.85034   2.580488   0 #> 184  553.60854   2.705311   0 #> 185  520.51091   2.541388   0 #> 186  528.33507   2.645975   0 #> 187  566.94496   2.874310   0 #> 188  500.02286   2.621073   0 #> 189  500.16656   2.784239   0 #> 190  500.40776   2.708004   0 #> 191  537.25787   3.521843   0 #> 192  531.06971   4.109654   0 #> 193  572.45079   2.919927   0 #> 194  500.52296   2.912887   0 #> 195  513.50612   2.549714   0 #> 196  500.01962   3.237648   0 #> 197  502.09608   2.854444   0 #> 198  500.36866   2.885779   0 #> 199  515.96221   3.600205   0 #> 200  532.46570   3.457295   0 #> 201  521.11717   2.783070   0 #> 202  646.33050   2.889876   0 #> 203  927.69467   2.539860   0 #> 204  528.29524   2.589463   0 #> 205  518.53928   2.580049   0 #> 206  500.04761   4.072511   0 #> 207  513.73406   2.876355   0 #> 208  529.04032   2.744696   0 #> 209  501.39872   3.749619   0 #> 210  504.89567   2.793464   0 #> 211  500.00900   2.896792   0 #> 212  642.67162   2.848595   0 #> 213  506.06265   2.509441   0 #> 214  500.00051   3.035384   0 #> 215  500.27361   3.042823   0 #> 216  501.50827   2.714176   0 #> 217  513.64845   4.129719   0 #> 218  500.56099   2.571369   0 #> 219  506.08579   2.817267   0 #> 220  500.04361   2.721262   0 #> 221  500.03877   3.554291   0 #> 222  500.03674   5.169580   0 #> 223  642.61667   2.858246   0 #> 224  500.28994   2.565509   0 #> 225  500.02563   2.744767   0 #> 226  506.06353   2.697963   0 #> 227  790.62497   2.534111   0 #> 228  500.11354   2.566173   0 #> 229  500.02381   2.976079   0 #> 230  500.07791   2.922228   0 #> 231  500.03209   2.964691   0 #> 232  500.04605   2.588829   0 #> 233  513.55700   2.751133   0 #> 234  516.38558   2.846556   0 #> 235  505.44302   2.850616   0 #> 236  500.04058   3.863831   0 #> 237  500.84928   2.706851   0 #> 238  500.91720   2.577525   0 #> 239  500.83957   2.918865   0 #> 240  501.09969   3.037682   0 #> 241  500.42807   2.555013   0 #> 242  918.30842   3.020474   0 #> 243  505.59697   2.908418   0 #> 244  500.02811   2.671415   0 #> 245  510.79937   2.645485   0 #> 246  501.60321   4.005651   0 #> 247  501.73428   2.637824   0 #> 248  500.72420   2.595627   0 #> 249  858.44211   2.579664   0 #> 250  515.82352   2.924383   0 #> 251  505.22104   3.113660   0 #> 252  500.16786   2.603873   0 #> 253  532.87238   2.528451   0 #> 254  524.81591   3.253274   0 #> 255  511.45420   2.972529   0 #> 256  772.45546   2.732148   0 #> 257  506.39218   2.897887   0 #> 258  500.67887   2.815943   0 #> 259  500.08535   2.537082   0 #> 260  503.31673   2.554500   0 #> 261  557.12744   2.597357   0 #> 262  500.03022   3.687912   0 #> 263  500.00914   2.748703   0 #> 264  501.59083   3.516953   0 #> 265  501.90429   2.654149   0 #> 266  656.00789   2.520052   0 #> 267  682.81686   3.042098   0 #> 268  506.27761   2.783295   0 #> 269  765.70009   2.978778   0 #> 270  501.20885   4.659591   0 #> 271  500.52190   2.500299   0 #> 272  683.64596   2.915256   0 #> 273  504.31214   2.755154   0 #> 274  501.70595   3.491513   0 #> 275  500.32073   2.924647   0 #> 276  500.43375   2.561716   0 #> 277  632.43506   3.402181   0 #> 278  682.66363   3.016985   0 #> 279  543.91860   2.907228   0 #> 280  530.74265   2.821280   0 #> 281  526.34764   2.500365   0 #> 282  501.15194   2.726469   0 #> 283  979.00562   2.515774   0 #> 284  500.04876   2.726436   0 #> 285  651.91174   2.656885   0 #> 286  653.06172   2.770930   0 #> 287  528.01408   3.525426   0 #> 288  549.15554   2.628714   0 #> 289  500.74856   2.762250   0 #> 290  503.76250   2.632840   0 #> 291  501.39259   3.419860   0 #> 292  509.47936   3.345071   0 #> 293  515.46528   2.724260   0 #> 294  521.21999   2.626258   0 #> 295  502.73210   2.552117   0 #> 296  500.06021   2.757739   0 #> 297  500.22398   2.554190   0 #> 298  515.67005   2.898639   0 #> 299  539.83975   2.661735   0 #> 300  500.15974   3.976521   0 #> 301  504.47967   3.032048   0 #> 302  500.26911   2.503904   0 #> 303  704.60912   3.504055   0 #> 304  500.15825   2.961485   0 #> 305  550.54988   4.232773   0 #> 306  501.95527   3.006162   0 #> 307  507.50545   2.557050   0 #> 308  500.34774   2.563005   0 #> 309  500.23154   3.339713   0 #> 310  531.77092   2.735006   0 #> 311  500.01054   3.046019   0 #> 312  502.89433   2.743932   0 #> 313  501.00138   2.767235   0 #> 314  549.14069   2.675403   0 #> 315  501.70102   2.525251   0 #> 316  500.15502   2.565794   0 #> 317  500.02265   2.613786   0 #> 318  943.27209   2.690573   0 #> 319  747.88727   2.786801   0 #> 320  543.04954   2.994819   0 #> 321  510.74126   2.605469   0 #> 322  501.21870   2.902325   0 #> 323  500.87785   2.536073   0 #> 324  501.16634   2.539172   0 #> 325  500.00696   2.556698   0 #> 326  500.02553   3.156391   0 #> 327  500.14502   2.508813   0 #> 328  500.13949   2.795486   0 #> 329  500.28458   2.518560   0 #> 330  507.00982   2.582118   0 #> 331  576.92765   2.594594   0 #> 332  500.59511   2.641319   0 #> 333  500.10197   2.613351   0 #> 334  504.26018   2.617423   0 #> 335  501.55062   4.196820   0 #> 336  500.05208   3.003241   0 #> 337  500.04888   3.531004   0 #> 338  551.16652   2.935866   0 #> 339  515.72502   2.568367   0 #> 340  512.35947   3.297557   0 #> 341  683.35807   2.546262   0 #> 342  500.19324   3.637269   0 #> 343  500.73917   3.942115   0 #> 344  874.19602   2.779517   0 #> 345  528.14692   2.897416   0 #> 346  517.25895   3.341861   0 #> 347  502.00539   2.576233   0 #> 348  505.46939   3.629134   0 #> 349  525.79963   3.401370   0 #> 350  500.48650   2.667816   0 #> 351  500.11124   2.644478   0 #> 352  500.05786   2.726306   0 #> 353  515.63797   2.575913   0 #> 354  554.18023   2.990423   0 #> 355  502.33750   2.692204   0 #> 356  500.03458   2.685544   0 #> 357  501.77506   2.530982   0 #> 358  560.91721   2.663060   0 #> 359  500.18835   2.662967   0 #> 360  521.43386   3.251871   0 #> 361  500.42286   2.775951   0 #> 362  760.79396   3.022324   0 #> 363  502.19652   2.674208   0 #> 364  503.20895   2.653592   0 #> 365  501.88354   2.656370   0 #> 366  501.15538   3.070736   0 #> 367  500.13134   2.630626   0 #> 368  500.72785   2.715384   0 #> 369  500.31310   2.826799   0 #> 370  634.45205   3.359522   0 #> 371  519.98126   2.580173   0 #> 372  537.12534   2.863247   0 #> 373  515.27949   2.507103   0 #> 374  631.54300   2.763680   0 #> 375  500.50520   2.523551   0 #> 376  579.49312   2.941914   0 #> 377  500.07609   2.674787   0 #> 378  500.08976   2.615334   0 #> 379  500.20981   3.408178   0 #> 380  514.20732   2.751678   0 #> 381  603.35238   3.198350   0 #> 382  506.28284   2.681108   0 #> 383  614.24385   2.884288   0 #> 384  500.21906   2.507213   0 #> 385  880.82778   3.622330   0 #> 386  500.31699   3.371532   0 #> 387  521.46484   4.074299   0 #> 388  538.22945   2.545014   0 #> 389  500.07090   2.632578   0 #> 390  503.29426   3.372871   0 #> 391  506.26352   2.948203   0 #> 392  500.09531   2.786873   0 #> 393  507.06985   3.472663   0 #> 394  501.06093   3.280963   0 #> 395  504.89771   2.652241   0 #> 396  500.30345   2.677640   0 #> 397  528.76757   3.269097   0 #> 398  528.44299   4.335889   0 #> 399  529.29566   3.178722   0 #> 400  500.24243   3.230487   0 #> 401  501.07172   3.496287   0 #> 402  501.77590   2.593028   0 #> 403  501.88629   2.637028   0 #> 404  674.93424   3.366214   0 #> 405  837.46258   2.546915   0 #> 406  540.10075   2.993195   0 #> 407  500.05030   2.608722   0 #> 408  500.30860   2.515677   0 #> 409  514.37969   2.892510   0 #> 410  500.27110   3.486771   0 #> 411  549.51565   2.520434   0 #> 412  500.03466   2.691226   0 #> 413  500.39406   3.261239   0 #> 414  500.22817   3.183830   0 #> 415  500.90999   3.085086   0 #> 416  501.84027   2.802521   0 #> 417  508.57055   3.674688   0 #> 418  734.26265   3.543256   0 #> 419  500.85953   2.553276   0 #> 420  501.23959   3.501718   0 #> 421  535.78283   2.751052   0 #> 422  525.02373   2.521462   0 #> 423  500.14365   2.971212   0 #> 424  549.66231   2.582401   0 #> 425  500.41070   2.692542   0 #> 426  501.24431   2.712036   0 #> 427  500.21475   2.995990   0 #> 428  504.07786   2.624506   0 #> 429  573.64602   2.603051   0 #> 430  500.90835   3.539962   0 #> 431  539.42507   4.332635   0 #> 432  504.03600   3.325556   0 #> 433  536.07459   3.695361   0 #> 434  500.78640   2.565528   0 #> 435  896.86921   3.006337   0 #> 436  503.26773   2.606191   0 #> 437  501.20052   2.666644   0 #> 438  502.33860   3.065707   0 #> 439  504.02429   2.645910   0 #> 440  701.40417   2.664763   0 #> 441  501.66540   2.695325   0 #> 442  503.05057   2.549909   0 #> 443  502.99125   2.950874   0 #> 444  531.25126   2.820789   0 #> 445  593.13243   2.792520   0 #> 446  577.75179   2.920146   0 #> 447  509.89592   2.573994   0 #> 448  500.28683   2.981287   0 #> 449  514.51890   2.730273   0 #> 450  502.32799   2.728510   0 #> 451  501.07030   2.639014   0 #> 452  500.82523   2.910562   0 #> 453  500.42183   3.991519   0 #> 454  500.11654   2.656132   0 #> 455  500.34281   2.589762   0 #> 456  500.05021   2.821267   0 #> 457  500.42795   3.296707   0 #> 458  500.11808   3.091987   0 #> 459  521.91873   2.663287   0 #> 460  501.32900   3.044057   0 #> 461  500.00130   2.926381   0 #> 462  502.62945   2.591275   0 #> 463  505.65864   2.523606   0 #> 464  500.23744   2.887213   0 #> 465  500.07017   2.578864   0 #> 466  506.77276   2.547913   0 #> 467  517.47080   2.510482   0 #> 468  500.10999   2.573836   0 #> 469  515.75156   3.024480   0 #> 470  500.14114   2.829696   0 #> 471  500.09638   2.839538   0 #> 472  500.00256   2.638935   0 #> 473  501.77419   2.614350   0 #> 474  501.85513   2.601048   0 #> 475  500.38890   2.571427   0 #> 476  524.05651   2.943017   0 #> 477  500.01186   4.089014   0 #> 478  519.09573   2.665389   0 #> 479  504.24983   3.229893   0 #> 480  500.81515   2.763854   0 #> 481  503.57705   3.119841   0 #> 482  501.35745   3.224505   0 #> 483  500.27942   2.535099   0 #> 484  975.55560   2.537972   0 #> 485  538.46695   2.576055   0 #> 486  652.99586   2.933675   0 #> 487  500.04433   3.378790   0 #> 488  671.67969   2.606403   0 #> 489  676.09414   2.800783   0 #> 490  510.47662   2.596912   0 #> 491  503.51911   2.602216   0 #> 492  523.01370   3.077792   0 #> 493  502.32307   2.738703   0 #> 494  505.43871   2.825648   0 #> 495  513.39946   2.710560   0 #> 496  517.98909   2.803444   0 #> 497  511.33294   2.677779   0 #> 498  588.96604   2.603326   0 #> 499  500.84906   2.889967   0 #> 500  516.50325   2.679215   0 #> 501  500.51542   2.738626   0 #> 502  584.94046   2.583138   0 #> 503  505.28865   2.687575   0 #> 504  500.03189   4.861486   0 #> 505  508.81158   2.568708   0 #> 506  540.63214   3.198127   0 #> 507  500.44723   2.501612   0 #> 508  511.94305   2.538059   0 #> 509  536.07178   3.256335   0 #> 510  673.90893   2.592280   0 #> 511  500.00968   2.504845   0 #> 512  554.63221   2.565319   0 #> 513  515.68445   4.336594   0 #> 514  565.12400   4.264386   0 #> 515  532.26271   2.809438   0 #> 516  500.52257   3.748632   0 #> 517  502.01782   2.610771   0 #> 518  563.43421   2.518273   0 #> 519  501.02319   4.754902   0 #> 520  501.47685   3.045760   0 #> 521  509.08939   2.730065   0 #> 522  716.38110   2.529300   0 #> 523  967.72992   2.937099   0 #> 524  501.65027   2.867142   0 #> 525  500.25827   2.968712   0 #> 526  501.52092   3.028755   0 #> 527  500.85622   2.979348   0 #> 528  513.90224   2.558068   0 #> 529  500.09555   3.402909   0 #> 530  627.92476   2.624382   0 #> 531  501.69899   2.667154   0 #> 532  500.52492   2.640587   0 #> 533  505.56989   3.125347   0 #> 534  500.14319   3.465831   0 #> 535  503.12785   2.678332   0 #> 536  503.13255   2.799187   0 #> 537  525.13418   3.722905   0 #> 538  566.32903   2.644421   0 #> 539  501.91144   3.608194   0 #> 540  502.72357   3.731906   0 #> 541  512.99086   2.527214   0 #> 542  500.00588   2.534808   0 #> 543  500.03570   3.097795   0 #> 544  535.24600   3.241994   0 #> 545  542.29939   2.513793   0 #> 546  500.02708   3.532248   0 #> 547  500.28095   2.900235   0 #> 548  674.06154   2.506035   0 #> 549  503.38736   2.578895   0 #> 550  949.76294   2.578660   0 #> 551  500.29236   2.754143   0 #> 552  504.17774   3.311259   0 #> 553  537.89827   4.554645   0 #> 554  500.26289   3.084774   0 #> 555  643.89491   3.315187   0 #> 556  500.31222   2.647315   0 #> 557  509.74758   2.574533   0 #> 558  500.28394   2.674956   0 #> 559  510.49160   2.940850   0 #> 560  502.47086   2.910682   0 #> 561  609.10069   3.169791   0 #> 562  569.86687   2.814257   0 #> 563  527.56977   2.809401   0 #> 564  500.81700   2.730524   0 #> 565  500.06575   3.198198   0 #> 566  509.79951   2.536134   0 #> 567  600.64031   3.407563   0 #> 568  531.38854   2.767377   0 #> 569  516.36877   2.796332   0 #> 570  512.62842   3.535858   0 #> 571  500.80244   2.535592   0 #> 572  504.57240   2.706936   0 #> 573  566.83523   3.470649   0 #> 574  509.34014   3.032038   0 #> 575  500.05510   3.021033   0 #> 576  725.31642   5.074348   0 #> 577  605.88293   2.512345   0 #> 578  517.94702   2.855622   0 #> 579  500.07972   2.930044   0 #> 580  506.48330   2.622601   0 #> 581  556.86396   3.174048   0 #> 582  500.17817   2.621520   0 #> 583  524.45726   2.798765   0 #> 584  500.98429   2.568604   0 #> 585  503.52894   3.074617   0 #> 586  538.97469   2.522088   0 #> 587  519.64667   2.713807   0 #> 588  500.64218   3.382976   0 #> 589  502.79736   2.633002   0 #> 590  516.40736   3.206041   0 #> 591  720.64478   2.733526   0 #> 592  698.98640   2.780951   0 #> 593  500.00331   2.947449   0 #> 594  500.00054   2.650938   0 #> 595  502.47343   3.154907   0 #> 596  631.53130   3.347648   0 #> 597  502.08331   2.557920   0 #> 598  510.05969   2.792549   0 #> 599  500.17908   3.176941   0 #> 600  631.63221   3.221249   0 #> 601  519.20633   2.690270   0 #> 602  501.08034   2.964421   0 #> 603  712.95639   3.309240   0 #> 604  627.60578   2.892630   0 #> 605  500.58627   2.818168   0 #> 606  531.46712   3.136388   0 #> 607  500.03477   4.593349   0 #> 608  502.18538   3.031460   0 #> 609  500.15370   2.808476   0 #> 610  500.19986   2.927121   0 #> 611  879.83970   2.511280   0 #> 612  501.48878   2.984936   0 #> 613  559.39803   3.371421   0 #> 614  503.06105   2.775317   0 #> 615  501.10008   2.790478   0 #> 616  522.83637   2.697808   0 #> 617  500.00954   3.015629   0 #> 618  557.60178   2.929866   0 #> 619  505.03232   2.943004   0 #> 620  504.16023   2.710292   0 #> 621  579.34711   2.575637   0 #> 622  511.18536   3.134611   0 #> 623  500.18679   2.540085   0 #> 624  500.35455   2.514563   0 #> 625  500.52598   2.943208   0 #> 626  500.11696   2.614560   0 #> 627  500.20490   4.007961   0 #> 628  582.18523   2.528301   0 #> 629  503.52020   2.608921   0 #> 630  528.75003   2.770117   0 #> 631  501.78382   2.696868   0 #> 632  507.64541   2.521447   0 #> 633  589.15488   2.824773   0 #> 634  500.05318   3.699057   0 #> 635  589.84894   2.876868   0 #> 636  546.78219   2.777069   0 #> 637  500.17268   3.677300   0 #> 638  500.41126   2.864377   0 #> 639  503.83715   4.165664   0 #> 640  500.91015   2.543617   0 #> 641  500.05411   2.952833   0 #> 642  509.39864   3.141260   0 #> 643  500.11258   4.697191   0 #> 644  504.11343   2.988045   0 #> 645  506.56809   3.571973   0 #> 646  541.72064   3.271218   0 #> 647  567.45918   2.876521   0 #> 648  500.81437   2.526552   0 #> 649  517.44802   2.901284   0 #> 650  577.69061   2.950427   0 #> 651  500.17140   2.548601   0 #> 652  659.16827   2.528309   0 #> 653  520.65513   2.526208   0 #> 654  502.00069   2.743390   0 #> 655  500.31698   2.586222   0 #> 656  500.31524   2.815399   0 #> 657  504.48373   3.364751   0 #> 658  500.67153   3.618577   0 #> 659  501.64729   2.742620   0 #> 660  500.14436   2.941864   0 #> 661  500.88774   2.572520   0 #> 662  508.41679   2.543909   0 #> 663  506.01563   2.718967   0 #> 664  500.51244   2.903968   0 #> 665  500.23307   2.932322   0 #> 666  552.16766   2.521260   0 #> 667  509.30203   2.715994   0 #> 668  669.62510   2.829360   0 #> 669  679.82342   2.547234   0 #> 670  687.29816   2.882103   0 #> 671  500.06402   3.271368   0 #> 672  500.59119   3.392060   0 #> 673  501.14547   2.641881   0 #> 674  504.07443   3.054065   0 #> 675  500.17676   2.560891   0 #> 676  500.80028   2.905585   0 #> 677  517.48387   2.565645   0 #> 678  509.06288   2.582744   0 #> 679  500.07316   2.790094   0 #> 680  507.79185   2.688212   0 #> 681  503.01033   2.680079   0 #> 682  769.56190   2.547704   0 #> 683  500.45438   3.032530   0 #> 684  906.31845   2.934696   0 #> 685  545.02185   2.992885   0 #> 686  747.55792   2.790854   0 #> 687  507.04213   2.823383   0 #> 688  500.16030   3.787991   0 #> 689  532.21705   2.771714   0 #> 690  501.85070   2.771054   0 #> 691  500.17164   2.983241   0 #> 692  509.99376   2.693718   0 #> 693  506.32534   2.510472   0 #> 694  676.65015   2.563723   0 #> 695  504.40049   2.529314   0 #> 696  500.15953   3.253708   0 #> 697  915.81124   3.628423   0 #> 698  520.58883   3.165446   0 #> 699  500.03187   2.514762   0 #> 700  720.26615   2.781105   0 #> 701  500.13745   2.609612   0 #> 702  500.75409   3.072618   0 #> 703  764.07397   2.678363   0 #> 704  500.11511   2.695360   0 #> 705  501.92190   3.031921   0 #> 706  500.34389   2.756014   0 #> 707  504.23502   2.572108   0 #> 708  500.32391   3.355111   0 #> 709  500.51556   2.769870   0 #> 710  501.12781   2.989222   0 #> 711  607.21336   2.581535   0 #> 712  501.71929   3.230432   0 #> 713  519.51230   2.967697   0 #> 714  502.64766   3.754927   0 #> 715  501.21482   2.523960   0 #> 716  500.04956   3.365592   0 #> 717  500.37203   2.842213   0 #> 718  512.14744   2.813748   0 #> 719  500.87974   3.384710   0 #> 720  594.62478   3.187569   0 #> 721  563.51641   2.644722   0 #> 722  536.62366   3.797973   0 #> 723  500.15498   2.710515   0 #> 724  500.23084   3.315188   0 #> 725  502.85991   4.860401   0 #> 726  500.05756   2.689347   0 #> 727  500.96873   2.740816   0 #> 728  505.74043   3.109460   0 #> 729  638.83872   3.374025   0 #> 730  513.27906   2.638920   0 #> 731  500.02381   2.766188   0 #> 732  856.34935   3.084644   0 #> 733  500.14950   2.978746   0 #> 734  500.17937   3.031661   0 #> 735  646.05427   2.874136   0 #> 736  511.51202   2.761586   0 #> 737  510.79640   2.510531   0 #> 738  505.77459   3.623673   0 #> 739  502.40215   2.596628   0 #> 740  501.14013   2.588406   0 #> 741  501.93855   2.693810   0 #> 742  500.26683   2.568922   0 #> 743  500.12293   2.508200   0 #> 744  501.38388   2.766809   0 #> 745  500.01787   2.993192   0 #> 746  500.65025   2.661667   0 #> 747  702.48032   2.779925   0 #> 748  585.21708   3.233407   0 #> 749  501.01082   3.380480   0 #> 750  507.34705   3.345559   0 #> 751  507.71774   2.750509   0 #> 752  521.52393   2.996931   0 #> 753  527.94495   2.679950   0 #> 754  500.17990   2.758819   0 #> 755  501.15414   2.734532   0 #> 756  500.03941   2.748254   0 #> 757  500.03030   3.078202   0 #> 758  920.01935   3.301998   0 #> 759  500.12411   2.690413   0 #> 760  500.00704   2.775968   0 #> 761  512.33999   3.167779   0 #> 762  500.85212   3.179891   0 #> 763  500.08104   3.088760   0 #> 764  504.29165   2.765276   0 #> 765  501.36204   2.778809   0 #> 766  588.99744   3.156707   0 #> 767  538.12242   2.681765   0 #> 768  504.61640   2.608692   0 #> 769  528.62282   2.856201   0 #> 770  507.48830   2.915270   0 #> 771  501.54485   2.753340   0 #> 772  501.05755   3.152565   0 #> 773  757.12705   2.942044   0 #> 774  500.06117   2.649900   0 #> 775  761.69385   2.554739   0 #> 776  504.96855   3.694865   0 #> 777  513.34381   3.146460   0 #> 778  500.82028   2.974086   0 #> 779  633.84691   2.555501   0 #> 780  566.88437   2.949163   0 #> 781  503.98183   2.844730   0 #> 782  595.70272   2.588621   0 #> 783  501.59115   2.745102   0 #> 784  722.68616   2.878439   0 #> 785  500.06944   2.503402   0 #> 786  751.81213   3.882606   0 #> 787  500.26650   2.684676   0 #> 788  500.03487   2.698899   0 #> 789  502.64393   3.103696   0 #> 790  500.69505   2.714467   0 #> 791  516.36829   3.021345   0 #> 792  835.35575   2.715647   0 #> 793  505.48746   4.581557   0 #> 794  500.13199   3.464504   0 #> 795  500.33862   2.850935   0 #> 796  500.88191   2.847805   0 #> 797  500.51601   2.527137   0 #> 798  506.22005   2.943884   0 #> 799  614.43819   2.577045   0 #> 800  500.37910   3.496187   0 #> 801  501.45605   3.508748   0 #> 802  534.82967   2.682939   0 #> 803  502.42106   3.394275   0 #> 804  679.14179   3.912750   0 #> 805  500.12158   2.555775   0 #> 806  511.16457   2.785393   0 #> 807  587.96409   2.685027   0 #> 808  510.84211   2.535691   0 #> 809  504.73185   2.934991   0 #> 810  652.24007   3.439096   0 #> 811  507.77495   2.798138   0 #> 812  503.28358   2.526005   0 #> 813  500.00972   2.744693   0 #> 814  505.21830   2.929838   0 #> 815  519.85842   2.602875   0 #> 816  503.35136   2.847074   0 #> 817  511.16961   3.095524   0 #> 818  714.89637   2.917383   0 #> 819  500.31306   2.709880   0 #> 820  505.28192   2.829124   0 #> 821  537.44561   3.004300   0 #> 822  511.89355   2.744178   0 #> 823  761.59095   2.605273   0 #> 824  502.68784   2.671656   0 #> 825  513.36256   3.028899   0 #> 826  920.05445   3.622517   0 #> 827  503.73026   2.710537   0 #> 828  501.85948   2.582165   0 #> 829  500.54187   3.034438   0 #> 830  502.02638   2.664465   0 #> 831  500.42932   3.342089   0 #> 832  500.45257   3.706303   0 #> 833  502.09156   2.533585   0 #> 834  502.95149   2.512207   0 #> 835  500.10234   2.592983   0 #> 836  500.14049   2.753843   0 #> 837  636.92611   2.629243   0 #> 838  500.33712   4.026437   0 #> 839  605.89759   2.852185   0 #> 840  500.23088   3.144200   0 #> 841  522.06387   2.512194   0 #> 842  500.11320   3.179942   0 #> 843  500.10394   2.638965   0 #> 844  771.59237   2.960809   0 #> 845  503.03786   3.025611   0 #> 846  505.96710   2.508339   0 #> 847  974.04741   2.543301   0 #> 848  546.22778   3.209407   0 #> 849  500.06316   2.504119   0 #> 850  585.67798   2.655038   0 #> 851  512.11765   2.695778   0 #> 852  522.82190   2.654780   0 #> 853  521.13325   2.719460   0 #> 854  504.98813   2.801006   0 #> 855  500.17516   3.090106   0 #> 856  515.84158   2.798333   0 #> 857  500.17478   2.657472   0 #> 858  500.99370   2.877760   0 #> 859  660.83924   2.832859   0 #> 860  547.37228   2.665244   0 #> 861  795.28555   2.895593   0 #> 862  506.07098   3.404809   0 #> 863  501.45149   2.887583   0 #> 864  517.38575   4.380527   0 #> 865  500.76384   2.604238   0 #> 866  501.18626   2.663814   0 #> 867  500.03441   2.829464   0 #> 868  500.16048   3.103906   0 #> 869  500.02426   4.174738   0 #> 870  529.11459   2.571737   0 #> 871  501.73163   2.555196   0 #> 872  500.02018   2.666226   0 #> 873  538.34353   3.106942   0 #> 874  780.52891   2.780952   0 #> 875  885.43157   2.858741   0 #> 876  510.47513   2.639358   0 #> 877  562.59657   2.908883   0 #> 878  502.48464   4.082445   0 #> 879  520.44013   2.767540   0 #> 880  500.81665   3.450484   0 #> 881  500.17295   2.915464   0 #> 882  507.45921   2.859558   0 #> 883  500.00935   3.020108   0 #> 884  500.00212   2.676833   0 #> 885  508.05335   2.940533   0 #> 886  509.29000   2.576366   0 #> 887  588.30293   2.659725   0 #> 888  500.58723   3.150663   0 #> 889  500.25127   2.789561   0 #> 890  502.01702   2.638723   0 #> 891  513.89593   2.500669   0 #> 892  500.77139   2.580641   0 #> 893  514.72592   2.822864   0 #> 894  514.95311   3.057831   0 #> 895  503.76902   4.069364   0 #> 896  505.88254   4.438445   0 #> 897  500.05653   2.621657   0 #> 898  504.60451   2.925180   0 #> 899  846.75217   2.520264   0 #> 900  500.00248   2.648620   0 #> 901  518.93210   2.948051   0 #> 902  500.38907   3.235131   0 #> 903  503.75418   2.733631   0 #> 904  500.80390   3.038106   0 #> 905  500.05413   2.617870   0 #> 906  518.60749   2.882699   0 #> 907  503.18307   2.820915   0 #> 908  505.32047   2.702671   0 #> 909  678.99351   3.194078   0 #> 910  560.69211   2.513884   0 #> 911  500.25134   2.618726   0 #> 912  500.58414   3.368897   0 #> 913  506.87413   3.488047   0 #> 914  920.45232   2.562267   0 #> 915  506.85130   2.531678   0 #> 916  530.66092   3.032021   0 #> 917  500.83217   2.843213   0 #> 918  500.25146   2.679650   0 #> 919  515.51346   3.150747   0 #> 920  545.09911   3.641817   0 #> 921  500.02580   2.822049   0 #> 922  506.69000   3.855196   0 #> 923  500.79844   2.710191   0 #> 924  503.76526   2.918807   0 #> 925  500.36771   2.597785   0 #> 926  500.09652   4.057935   0 #> 927  501.89933   2.621992   0 #> 928  506.01809   4.731078   0 #> 929  508.24213   3.845904   0 #> 930  500.43594   2.735396   0 #> 931  500.05458   2.690786   0 #> 932  512.06593   2.565441   0 #> 933  501.41861   2.945496   0 #> 934  516.57575   2.631863   0 #> 935  512.20386   2.747446   0 #> 936  501.12941   3.480346   0 #> 937  500.05486   3.197846   0 #> 938  501.29158   2.540700   0 #> 939  624.42202   2.597810   0 #> 940  500.06410   3.282096   0 #> 941  502.80629   2.867672   0 #> 942  512.84705   3.482963   1 #> 943  910.12088   2.958052   1 #> 944  814.11516   2.738594   1 #> 945   43.29576   2.524591   1 #> 946  846.56035   3.687778   1 #> 947  118.31377   2.501842   1 #> 948  780.39901   3.237308   1 #> 949  710.97940   2.669715   1 #> 950  304.35452   2.678708   1 #> 951  736.74721   3.003720   1 #> 952   15.86756   2.721813   1 #> 953  328.51122   2.615029   1 #> 954  783.90131   3.114085   1 #> 955  288.97098   2.534097   1 #> 956  840.21360   2.534159   1 #> 957   78.87329   2.521694   1 #> 958  678.03105   4.087640   1 #> 959   66.96006   2.656303   1 #> 960  292.44984   2.892446   1 #> 961  315.11035   2.919217   1 #> 962   55.76442   2.744340   1 #> 963  392.46040   3.014879   1 #> 964  138.65173   3.874946   1 #> 965  274.84213   4.774641   1 #> 966  795.07856   2.681747   1 #> 967  909.37866   2.575041   1 #> 968  464.42314   3.104422   1 #> 969  821.58217   2.885638   1 #> 970  805.54160   3.578068   1 #> 971   98.69728   2.842913   1 #> 972  914.04438   2.952973   1 #> 973  953.44622   2.572973   1 #> 974  742.69392   3.356759   1 #> 975  116.52886   2.515311   1 #> 976  192.69557   2.874675   1 #> 977  545.94475   3.343335   1 #> 978  747.06984   3.565704   1 #> 979   17.55863   3.551691   1 #> 980  279.62359   2.612546   1 #> 981  699.66052   2.697096   1 #> 982  135.25666   2.706064   1 #> 983  712.51871   3.283536   1 #> 984  573.51232   2.857471   1 #> 985   15.53714   2.662460   1 #> 986   32.90112   2.823974   1 #> 987  258.67102   2.767825   1 #> 988  779.50824   2.995511   1 #> 989  529.86326   2.702392   1 #> 990  623.48347   2.647159   1 #> 991   23.77411   2.653833   1 #> 992  235.29082   3.071732   1 #> 993  771.94754   2.563235   1 #> 994  359.15264   3.211145   1 #> 995  926.70600   2.836616   1 #> 996  185.42851   2.535806   1 #> 997   97.42017   3.827344   1 #> 998  457.36536   3.677620   1 #> 999  440.54032   2.712745   1 #> 1000 930.77176   2.560234   1 #> 1001  54.47193   3.121603   1 #> 1002 404.03804   2.862503   1 #> 1003 427.71984   3.044879   1 #> 1004 181.06905   2.556412   1 #> 1005 750.75709   2.787985   1 #> 1006  38.86204   3.658732   1 #> 1007 507.55753   2.987711   1 #> 1008 389.31225   2.522032   1 #> 1009  49.36495   2.908172   1 #> 1010 233.03240   2.672868   1 #> 1011 695.37601   3.614268   1 #> 1012 422.33328   2.599861   1 #> 1013 556.42292   2.805222   1 #> 1014 678.80453   2.562269   1 #> 1015 812.78135   2.722421   1 #> 1016 657.71946   2.686782   1 #> 1017 545.20121   3.784721   1 #> 1018 651.89285   2.838054   1 #> 1019 898.22780   3.023555   1 #> 1020 138.05609   2.567027   1 #> 1021 251.27334   2.519035   1 #> 1022 164.09396   2.851651   1 #> 1023 957.29293   4.548983   1 #> 1024 629.96155   2.542261   1 #> 1025 631.56571   3.276630   1 #> 1026 409.09716   3.117812   1 #> 1027 714.90339   2.646556   1 #> 1028 276.56554   2.920475   1 #> 1029 709.76799   2.950249   1 #> 1030  33.98925   3.052557   1 #> 1031 660.22235   3.269345   1 #> 1032 879.40224   2.976222   1 #> 1033 882.08397   2.634129   1 #> 1034 818.29098   2.872361   1 #> 1035 780.47866   2.709465   1 #> 1036 300.82441   2.637538   1 #> 1037 157.81057   3.460745   1 #> 1038 663.32650   2.504440   1 #> 1039 854.81335   3.642880   1 #>  #> [[3]] #>            ts magnitudes gen #> 1   513.17242   3.675774   2 #> 2   502.76217   2.718244   2 #> 3   519.72183   2.766632   2 #> 4   671.92130   2.581473   2 #> 5   507.95855   2.585726   2 #> 6   501.13693   2.634798   2 #> 7   530.96702   3.002841   2 #> 8   511.08634   2.887636   2 #> 9   772.66397   2.744579   2 #> 10  572.21046   2.687938   2 #> 11  503.29296   2.628440   2 #> 12  510.50461   2.528710   2 #> 13  559.82322   3.368928   2 #> 14  524.03947   2.884605   2 #> 15  524.71558   3.251878   2 #> 16  528.10030   2.971830   2 #> 17  866.57238   2.711369   2 #> 18  525.69926   2.674084   2 #> 19  524.31898   2.546739   2 #> 20  570.02957   2.599174   2 #> 21  526.91381   2.522199   2 #> 22  524.70824   2.534248   2 #> 23  523.87416   2.571600   2 #> 24  531.88228   2.693542   2 #> 25  588.52879   2.695746   2 #> 26  589.85836   2.583224   2 #> 27  502.64105   4.007323   2 #> 28  506.67645   5.255879   2 #> 29  799.37643   3.452060   2 #> 30  525.15440   3.471474   2 #> 31  500.31730   2.771775   2 #> 32  507.36775   2.782432   2 #> 33  507.10160   2.692078   2 #> 34  501.18708   2.796062   2 #> 35  511.80826   2.818864   2 #> 36  502.28929   2.596632   2 #> 37  508.75487   2.695804   2 #> 38  501.89661   2.677177   2 #> 39  502.79644   2.659354   2 #> 40  567.45310   4.445738   2 #> 41  503.06502   3.057847   2 #> 42  500.69734   2.517838   2 #> 43  541.62978   2.505764   2 #> 44  501.10057   2.867278   2 #> 45  537.32792   3.351235   2 #> 46  531.71190   2.920472   2 #> 47  561.28826   2.681827   2 #> 48  674.33679   2.521854   2 #> 49  822.18653   2.855240   2 #> 50  529.35660   3.148807   2 #> 51  524.39487   3.239429   2 #> 52  522.94840   2.606569   2 #> 53  510.60031   3.227618   2 #> 54  500.49840   2.672315   2 #> 55  513.65781   2.606034   2 #> 56  508.07756   3.233727   2 #> 57  509.01773   2.539027   2 #> 58  515.51944   2.776384   2 #> 59  500.19641   2.519283   2 #> 60  500.18487   2.947293   2 #> 61  500.06758   3.398663   2 #> 62  503.20840   2.635031   2 #> 63  541.90562   2.971449   2 #> 64  500.24874   3.880502   2 #> 65  514.82767   2.566212   2 #> 66  587.78108   2.958827   2 #> 67  501.22766   3.337439   2 #> 68  504.19633   3.423410   2 #> 69  500.86814   2.953454   2 #> 70  504.32054   4.624905   2 #> 71  746.44810   2.500328   2 #> 72  500.27749   2.533856   2 #> 73  500.49564   2.918324   2 #> 74  509.30570   2.928047   2 #> 75  502.91361   2.579045   2 #> 76  606.31281   3.020202   2 #> 77  500.16387   2.847979   2 #> 78  726.66033   2.818651   2 #> 79  510.07085   2.873811   2 #> 80  590.57062   3.149200   2 #> 81  552.08165   4.323709   2 #> 82  507.34261   2.838348   2 #> 83  501.45772   3.695526   2 #> 84  605.81023   3.396327   2 #> 85  504.64410   2.588103   2 #> 86  920.63022   2.536262   2 #> 87  919.38152   2.776914   2 #> 88  507.94553   2.540349   2 #> 89  503.70368   2.592602   2 #> 90  500.50767   4.229336   2 #> 91  501.31043   2.528624   2 #> 92  501.53282   2.526919   2 #> 93  502.22597   2.594001   2 #> 94  501.57750   2.731083   2 #> 95  501.30321   2.597621   2 #> 96  501.22797   2.830220   2 #> 97  501.45817   2.619540   2 #> 98  553.67981   2.626955   2 #> 99  502.40694   2.684982   2 #> 100 503.76748   2.601898   2 #> 101 505.02856   3.591520   2 #> 102 501.42870   2.742027   2 #> 103 683.86793   2.773854   2 #> 104 632.51141   2.606303   2 #> 105 794.80396   2.765370   2 #> 106 500.91607   2.657555   2 #> 107 617.24378   2.926590   2 #> 108 559.95383   2.809783   2 #> 109 575.17127   3.189416   2 #> 110 550.56834   2.600869   2 #> 111 501.12157   2.736056   2 #> 112 705.65150   2.509337   2 #> 113 705.17597   2.654479   2 #> 114 705.56678   2.764444   2 #> 115 698.68034   4.018894   2 #> 116 559.08351   2.583439   2 #> 117 956.74734   2.522792   2 #> 118 550.92535   2.932146   2 #> 119 550.72702   4.037659   2 #> 120 552.25971   2.760066   2 #> 121 501.44785   2.879619   2 #> 122 577.14456   2.878497   2 #> 123 688.00122   2.895466   2 #> 124 501.57609   2.734676   2 #> 125 501.63248   2.534309   2 #> 126 536.09514   2.743644   2 #> 127 628.11249   2.760752   2 #> 128 500.12240   2.707187   2 #> 129 500.47332   2.515206   2 #> 130 500.96544   2.714656   2 #> 131 515.65846   3.244994   2 #> 132 577.55035   3.455285   2 #> 133 761.54109   2.607260   2 #> 134 635.66952   2.955954   2 #> 135 504.59602   3.248371   2 #> 136 500.21157   2.753100   2 #> 137 829.28707   2.521978   2 #> 138 622.29728   2.793498   2 #> 139 996.30086   2.560997   2 #> 140 521.77219   3.500903   2 #> 141 521.86426   2.740644   2 #> 142 571.27106   2.738488   2 #> 143 529.97118   2.981139   2 #> 144 608.88392   2.577306   2 #> 145 515.37321   3.080585   2 #> 146 986.48174   2.817379   2 #> 147 540.72540   2.999941   2 #> 148 502.05319   2.518942   2 #> 149 501.53056   2.518214   2 #> 150 508.78072   2.866589   2 #> 151 671.53001   2.659755   2 #> 152 840.33653   3.863186   2 #> 153 510.29613   3.308660   2 #> 154 509.67098   2.831390   2 #> 155 539.78715   2.813749   2 #> 156 625.33202   2.592395   2 #> 157 539.98556   3.097156   2 #> 158 540.61563   2.787229   2 #> 159 531.56028   3.071138   2 #> 160 973.59015   2.577796   2 #> 161 704.54802   2.990535   2 #> 162 665.21844   2.780673   2 #> 163 500.34392   4.321513   2 #> 164 500.25772   2.778643   2 #> 165 516.37127   2.610704   2 #> 166 500.99309   2.690446   2 #> 167 504.05867   2.700184   2 #> 168 523.44094   2.584581   2 #> 169 512.98769   2.580852   2 #> 170 606.83589   2.805623   2 #> 171 525.12655   3.863074   2 #> 172 500.35358   3.886656   2 #> 173 505.24113   3.023589   2 #> 174 504.27930   3.071728   2 #> 175 502.50304   3.299610   2 #> 176 500.08263   2.694928   2 #> 177 586.63421   2.691484   2 #> 178 509.68229   2.665679   2 #> 179 536.27476   2.823897   2 #> 180 500.96598   2.673884   2 #> 181 500.23314   3.161666   2 #> 182 507.35347   2.575278   2 #> 183 504.22469   2.776848   2 #> 184 500.12638   3.047798   2 #> 185 500.03536   2.532663   2 #> 186 512.33875   3.479090   2 #> 187 630.91866   3.296351   2 #> 188 502.68360   2.602529   2 #> 189 501.71114   2.818782   2 #> 190 535.16960   2.693733   2 #> 191 565.76982   3.130903   2 #> 192 516.88507   2.568142   2 #> 193 565.63747   3.077153   2 #> 194 565.59188   2.832182   2 #> 195 572.38328   3.355694   2 #> 196 565.58773   2.578280   2 #> 197 565.24587   2.624004   2 #> 198 600.88244   2.599408   2 #> 199 500.78177   2.691650   2 #> 200 502.89891   2.666765   2 #> 201 501.16111   2.694058   2 #> 202 553.37551   3.134612   2 #> 203 873.38436   2.844086   2 #> 204 501.39914   2.724249   2 #> 205 501.08164   2.850686   2 #> 206 501.17947   2.658088   2 #> 207 769.11355   2.546384   2 #> 208 501.35309   3.036552   2 #> 209 687.96863   2.772162   2 #> 210 504.50111   2.526006   2 #> 211 501.16671   2.699604   2 #> 212 667.51130   3.173169   2 #> 213 501.41902   2.918221   2 #> 214 502.52654   3.193670   2 #> 215 501.59869   2.522967   2 #> 216 508.71789   2.656702   2 #> 217 533.85227   2.542392   2 #> 218 522.00434   2.575529   2 #> 219 502.72612   3.865487   2 #> 220 502.91041   3.105567   2 #> 221 539.70757   2.721451   2 #> 222 500.47819   2.856121   2 #> 223 500.40991   2.783516   2 #> 224 500.62941   2.621712   2 #> 225 568.66281   2.665982   2 #> 226 538.15685   2.622404   2 #> 227 656.38976   2.970803   2 #> 228 503.80856   3.105102   2 #> 229 521.92052   2.846647   2 #> 230 520.88237   3.797823   2 #> 231 574.76241   3.014845   2 #> 232 659.10103   2.661211   2 #> 233 500.61272   4.307077   2 #> 234 725.34139   2.724951   2 #> 235 740.92250   2.599214   2 #> 236 728.71611   2.780693   2 #> 237 725.69287   2.691966   2 #> 238 725.46872   2.580213   2 #> 239 734.12362   2.674881   2 #> 240 725.48865   4.802213   2 #> 241 855.88098   2.616963   2 #> 242 786.64464   2.724914   2 #> 243 736.29385   2.666537   2 #> 244 725.90745   2.546362   2 #> 245 726.87625   3.544870   2 #> 246 725.82911   2.589824   2 #> 247 725.76007   3.370038   2 #> 248 726.08761   2.713746   2 #> 249 725.52441   3.082014   2 #> 250 731.69597   2.960460   2 #> 251 725.41015   3.301661   2 #> 252 728.70856   2.521203   2 #> 253 725.84092   3.536836   2 #> 254 728.00351   2.762922   2 #> 255 725.49018   3.118743   2 #> 256 731.49109   3.101313   2 #> 257 728.47446   4.505162   2 #> 258 922.27438   2.715046   2 #> 259 501.57514   2.631731   2 #> 260 534.66440   2.645547   2 #> 261 545.14088   3.342669   2 #> 262 634.86794   2.716147   2 #> 263 510.22434   2.995063   2 #> 264 712.98422   3.500875   2 #> 265 717.09566   2.510427   2 #> 266 501.78014   2.602275   2 #> 267 500.38263   3.693605   2 #> 268 500.69122   2.851934   2 #> 269 500.69441   2.807271   2 #> 270 514.66026   2.970757   2 #> 271 519.42853   2.944385   2 #> 272 767.26701   2.674024   2 #> 273 509.50293   2.976554   2 #> 274 502.69323   3.469636   2 #> 275 677.80435   3.468148   2 #> 276 500.05748   3.112306   2 #> 277 500.35286   3.255532   2 #> 278 550.59440   3.105088   2 #> 279 501.93027   2.683771   2 #> 280 541.00429   2.593780   2 #> 281 504.44798   2.520948   2 #> 282 507.94367   2.660509   2 #> 283 510.80654   2.519732   2 #> 284 571.78089   3.105913   2 #> 285 502.86882   3.173056   2 #> 286 526.47798   2.552919   2 #> 287 501.23634   2.809771   2 #> 288 526.16937   3.206373   2 #> 289 500.17656   2.662430   2 #> 290 500.90482   4.023511   2 #> 291 689.52272   2.515176   2 #> 292 500.28336   2.784996   2 #> 293 508.84599   2.819115   2 #> 294 501.49974   4.170791   2 #> 295 501.36253   2.553877   2 #> 296 515.29970   2.819742   2 #> 297 555.99842   2.876953   2 #> 298 501.68213   2.503568   2 #> 299 520.69189   3.640016   2 #> 300 529.29042   3.015000   2 #> 301 505.57735   2.854368   2 #> 302 502.39970   2.566842   2 #> 303 536.64345   2.759676   2 #> 304 821.42998   2.731221   2 #> 305 536.73136   2.616908   2 #> 306 503.16667   2.657352   2 #> 307 504.23353   2.662372   2 #> 308 608.44061   2.554275   2 #> 309 503.10623   3.199681   2 #> 310 676.80078   2.950341   2 #> 311 502.86770   2.747063   2 #> 312 505.88257   2.570044   2 #> 313 657.41406   2.794624   2 #> 314 503.41457   3.230105   2 #> 315 502.86591   2.603722   2 #> 316 579.41631   3.072538   2 #> 317 505.59283   2.989509   2 #> 318 717.89906   3.099320   2 #> 319 503.15799   2.823812   2 #> 320 503.16228   2.636598   2 #> 321 638.95141   2.737160   2 #> 322 501.50087   2.871140   2 #> 323 562.68079   3.057907   2 #> 324 572.56809   2.500339   2 #> 325 501.78994   2.576534   2 #> 326 500.39880   4.736113   2 #> 327 518.91330   2.875223   2 #> 328 501.64284   2.815823   2 #> 329 503.41289   2.921604   2 #> 330 589.08672   2.732984   2 #> 331 842.90196   2.774034   2 #> 332 568.45914   3.174480   2 #> 333 722.80685   3.122344   2 #> 334 805.85298   3.542039   2 #> 335 657.10281   2.618880   2 #> 336 505.90705   2.694990   2 #> 337 505.98644   2.542206   2 #> 338 505.61071   2.681137   2 #> 339 505.52454   3.426185   2 #> 340 815.70228   2.705514   2 #> 341 532.12122   2.993392   2 #> 342 509.57649   2.525930   2 #> 343 502.44589   2.874267   2 #> 344 658.02913   3.166591   2 #> 345 653.08551   2.565114   2 #> 346 652.35661   2.672183   2 #> 347 521.30796   2.536411   2 #> 348 511.92783   4.357232   2 #> 349 500.54569   2.774026   2 #> 350 503.15924   2.509260   2 #> 351 502.24913   2.895104   2 #> 352 977.32394   2.524578   2 #> 353 522.95492   2.520695   2 #> 354 530.19987   2.946616   2 #> 355 563.40177   2.648924   2 #> 356 509.48147   2.684776   2 #> 357 571.79295   2.979770   2 #> 358 502.95724   3.081874   2 #> 359 500.12611   2.582210   2 #> 360 782.95815   2.733729   2 #> 361 786.91365   2.603122   2 #> 362 516.25258   2.801310   2 #> 363 502.63138   3.132489   2 #> 364 522.76262   2.938435   2 #> 365 510.39995   2.571675   2 #> 366 515.09893   2.629305   2 #> 367 681.52389   3.283798   2 #> 368 504.04517   2.626338   2 #> 369 514.88225   4.250196   2 #> 370 504.57454   3.198197   2 #> 371 506.12367   2.524998   2 #> 372 506.20618   3.063231   2 #> 373 548.80068   2.919192   2 #> 374 500.90131   2.986268   2 #> 375 552.13733   2.889199   2 #> 376 725.31214   2.703836   2 #> 377 506.95957   3.075847   2 #> 378 631.56095   2.638986   2 #> 379 602.31654   3.731309   2 #> 380 556.09308   3.051087   2 #> 381 532.72524   3.482092   2 #> 382 591.03192   2.869893   2 #> 383 506.28933   2.600045   2 #> 384 843.67723   2.785421   2 #> 385 506.05258   2.973609   2 #> 386 506.74935   3.380995   2 #> 387 510.92122   2.748442   2 #> 388 547.92739   2.810028   2 #> 389 506.04768   3.153403   2 #> 390 544.75427   2.668537   2 #> 391 940.28233   2.619840   2 #> 392 848.64064   2.919120   2 #> 393 678.30994   2.616109   2 #> 394  85.72435   2.827274   2 #> 395  56.69368   2.818591   2 #> 396 841.36309   2.519344   2 #> 397 478.85144   3.995016   2 #> 398 281.53906   3.333430   2 #> 399 306.34105   2.517085   2 #> 400 311.93378   2.584483   2 #> 401 542.23400   3.658256   2 #> 402 364.21773   2.512120   2 #> 403 805.84799   3.029208   2 #> 404 282.98628   2.706112   2 #> 405 275.00952   2.752571   2 #> 406 274.88757   3.270342   2 #> 407 468.77866   3.333967   2 #> 408 342.19839   3.920727   2 #> 409 545.99409   2.620927   2 #> 410 754.82358   2.525827   2 #> 411 499.07964   2.542391   2 #> 412  17.92200   3.091823   2 #> 413 772.16056   2.556726   2 #> 414  97.72591   2.679866   2 #> 415 461.97541   2.512327   2 #> 416 809.67202   2.644219   2 #> 417 177.26130   2.737130   2 #> 418 934.41112   2.584896   2 #> 419 696.09196   3.408618   2 #> 420 164.28101   2.802425   2 #> 421 957.29883   3.059476   2 #> 422 957.37459   3.441267   2 #> 423 957.42066   3.002052   2 #> 424 984.19185   2.920450   2 #> 425 710.81734   2.664631   2 #> 426 882.99771   4.117857   2 #> 427 161.68813   2.621616   2 #> 428 854.96120   2.576639   2 #>  #> [[4]] #>           ts magnitudes gen #> 1   518.1342   3.107669   3 #> 2   531.0037   2.834234   3 #> 3   570.9492   3.132596   3 #> 4   538.6877   3.116283   3 #> 5   502.7368   2.545231   3 #> 6   594.8718   3.271871   3 #> 7   515.8670   2.724084   3 #> 8   509.7678   2.575346   3 #> 9   507.3965   3.162167   3 #> 10  565.7172   2.757933   3 #> 11  751.3467   2.552616   3 #> 12  532.8030   3.349820   3 #> 13  510.0140   2.500761   3 #> 14  658.9440   2.947347   3 #> 15  512.2083   2.669820   3 #> 16  507.6606   3.162627   3 #> 17  508.2261   2.653061   3 #> 18  666.2545   3.608126   3 #> 19  518.8933   4.184938   3 #> 20  508.6439   2.799896   3 #> 21  508.6506   2.756169   3 #> 22  864.7292   2.630086   3 #> 23  506.8504   2.874224   3 #> 24  621.6828   2.799845   3 #> 25  507.6757   3.595534   3 #> 26  532.7937   2.578283   3 #> 27  507.4364   3.064096   3 #> 28  506.7367   3.092761   3 #> 29  508.2744   2.944726   3 #> 30  506.9457   2.503949   3 #> 31  507.2013   2.898148   3 #> 32  506.7162   3.619438   3 #> 33  666.7588   3.560179   3 #> 34  815.1924   3.775174   3 #> 35  519.3600   2.582837   3 #> 36  502.2023   2.600594   3 #> 37  508.7159   3.895623   3 #> 38  568.1966   3.361286   3 #> 39  612.2064   2.515208   3 #> 40  569.7567   3.197641   3 #> 41  567.7971   3.716572   3 #> 42  568.1388   2.609759   3 #> 43  572.3021   3.232513   3 #> 44  529.4833   2.638520   3 #> 45  529.7910   4.051174   3 #> 46  653.5866   3.642017   3 #> 47  708.9923   2.774863   3 #> 48  508.0074   2.538787   3 #> 49  501.0858   3.672684   3 #> 50  504.3780   2.756240   3 #> 51  505.6085   2.720241   3 #> 52  504.6701   3.771722   3 #> 53  504.3328   2.545566   3 #> 54  504.4612   2.809011   3 #> 55  543.4741   2.513467   3 #> 56  526.1562   2.716589   3 #> 57  552.1763   2.643831   3 #> 58  552.8664   2.539434   3 #> 59  556.6795   2.588111   3 #> 60  552.1334   2.553941   3 #> 61  553.6419   2.992170   3 #> 62  552.0938   3.334620   3 #> 63  554.5262   3.756979   3 #> 64  557.7614   3.030313   3 #> 65  773.3310   2.725485   3 #> 66  520.5481   2.546573   3 #> 67  500.7192   3.465223   3 #> 68  796.2515   2.714588   3 #> 69  589.6592   3.268191   3 #> 70  706.4201   3.130366   3 #> 71  700.2853   2.577147   3 #> 72  720.6142   2.714703   3 #> 73  698.9908   2.703934   3 #> 74  646.9168   3.644696   3 #> 75  561.2717   2.683196   3 #> 76  543.3168   2.700060   3 #> 77  840.4330   3.040850   3 #> 78  841.0627   3.426148   3 #> 79  523.2823   2.707095   3 #> 80  675.2685   2.536307   3 #> 81  587.0866   2.665976   3 #> 82  503.5769   2.859314   3 #> 83  782.1826   2.877816   3 #> 84  504.2491   2.661744   3 #> 85  804.7875   2.975247   3 #> 86  729.7206   4.610941   3 #> 87  589.3376   2.503329   3 #> 88  500.2547   2.851635   3 #> 89  500.0558   2.874460   3 #> 90  632.5105   2.872371   3 #> 91  630.9642   2.692389   3 #> 92  502.7331   2.555515   3 #> 93  573.3430   2.908102   3 #> 94  572.9107   2.624748   3 #> 95  515.5249   3.178696   3 #> 96  522.3211   3.175060   3 #> 97  502.7429   2.878556   3 #> 98  502.9155   2.733783   3 #> 99  521.0276   2.749506   3 #> 100 551.0211   2.580432   3 #> 101 766.1001   2.712785   3 #> 102 500.5530   2.701839   3 #> 103 537.8730   2.901943   3 #> 104 659.3518   2.715681   3 #> 105 725.8722   3.377039   3 #> 106 765.8246   2.802581   3 #> 107 738.1677   3.089691   3 #> 108 727.0193   2.659754   3 #> 109 742.0377   3.690406   3 #> 110 889.9920   2.744014   3 #> 111 738.5036   2.575658   3 #> 112 726.7160   2.527536   3 #> 113 729.6843   2.782429   3 #> 114 725.5849   2.632222   3 #> 115 727.6874   2.503199   3 #> 116 729.3320   2.548018   3 #> 117 745.8664   2.581010   3 #> 118 731.8160   2.816910   3 #> 119 737.3842   3.084668   3 #> 120 728.5343   2.514419   3 #> 121 731.5147   2.952346   3 #> 122 740.5134   2.614289   3 #> 123 824.0522   2.519643   3 #> 124 635.1041   2.632213   3 #> 125 713.5168   2.613310   3 #> 126 508.2591   2.640009   3 #> 127 565.8472   2.561471   3 #> 128 504.4732   2.527803   3 #> 129 632.6867   2.524310   3 #> 130 632.4228   3.486533   3 #> 131 500.9099   3.483315   3 #> 132 525.5237   3.106607   3 #> 133 517.9390   2.508342   3 #> 134 542.6262   2.885648   3 #> 135 546.9397   2.571895   3 #> 136 576.0239   3.870328   3 #> 137 909.5020   3.132642   3 #> 138 510.0598   3.010342   3 #> 139 591.8152   3.239277   3 #> 140 657.7200   3.708942   3 #> 141 879.9842   2.916068   3 #> 142 505.6897   4.343766   3 #> 143 581.1913   2.543637   3 #> 144 500.4526   2.562016   3 #> 145 501.4215   2.795987   3 #> 146 502.1002   2.533847   3 #> 147 900.9271   3.838161   3 #> 148 676.2296   3.153019   3 #> 149 536.4828   2.732304   3 #> 150 652.5145   2.827844   3 #> 151 512.0440   2.641113   3 #> 152 512.6219   2.610604   3 #> 153 512.1580   2.540327   3 #> 154 814.7652   2.541879   3 #> 155 511.9522   3.516440   3 #> 156 512.9888   2.674241   3 #> 157 518.5657   2.989212   3 #> 158 518.5569   2.593278   3 #> 159 518.7009   2.975944   3 #> 160 548.6401   4.357844   3 #> 161 515.0614   3.310719   3 #> 162 516.6886   2.888530   3 #> 163 515.1198   3.090056   3 #> 164 515.9259   2.511202   3 #> 165 707.8867   2.680129   3 #> 166 602.4384   3.191203   3 #> 167 975.3469   3.190146   3 #> 168 678.4909   3.284699   3 #> 169 252.0459   2.723461   3 #> 170  57.6130   3.296459   3 #> 171 538.5480   2.855973   3 #> 172 479.0411   2.578317   3 #> 173 664.7025   3.012278   3 #> 174 295.7619   2.682879   3 #> 175 544.0091   3.275191   3 #> 176 276.3962   2.532005   3 #> 177 547.8836   2.651845   3 #> 178 918.3365   3.079331   3 #> 179 406.4458   2.638083   3 #> 180 961.5892   3.080482   3 #> 181 885.1279   3.425529   3 #> 182 884.0377   2.780241   3 #> 183 893.2497   2.741013   3 #>  #> [[5]] #>           ts magnitudes gen #> 1  518.75915   2.519973   4 #> 2  694.97554   2.683062   4 #> 3  519.96615   2.588463   4 #> 4  519.36416   2.590267   4 #> 5  522.84213   2.862504   4 #> 6  540.74517   2.804182   4 #> 7  573.01311   3.850748   4 #> 8  524.61032   3.076126   4 #> 9  514.07609   2.525393   4 #> 10 515.30987   2.652672   4 #> 11 728.57315   3.075705   4 #> 12 520.29794   3.490570   4 #> 13 509.54806   2.643509   4 #> 14 924.41392   2.687928   4 #> 15 569.99582   2.901504   4 #> 16 569.98931   2.586912   4 #> 17 564.06704   3.006145   4 #> 18 549.20018   2.505570   4 #> 19 653.91631   2.829418   4 #> 20 558.99187   2.936661   4 #> 21 501.78167   3.118777   4 #> 22 566.57468   3.247347   4 #> 23 886.90230   2.583651   4 #> 24 500.99678   4.090731   4 #> 25 720.69552   3.515414   4 #> 26 648.05129   2.755893   4 #> 27 730.57294   2.801470   4 #> 28 730.35078   2.977555   4 #> 29 756.33530   2.585211   4 #> 30 768.96290   2.661957   4 #> 31 769.54808   3.819563   4 #> 32 632.76610   2.654503   4 #> 33 522.78148   2.585052   4 #> 34 525.77091   3.112903   4 #> 35 513.48319   2.668059   4 #> 36 726.41442   2.774415   4 #> 37 738.42118   2.584374   4 #> 38 925.37438   2.940804   4 #> 39 632.45070   2.915171   4 #> 40 632.79239   3.464007   4 #> 41 548.98356   3.053564   4 #> 42 584.31109   3.335070   4 #> 43 669.29836   3.013331   4 #> 44 505.77702   2.512696   4 #> 45 513.23161   3.076381   4 #> 46 540.47327   2.622915   4 #> 47 507.76556   2.632503   4 #> 48 830.74200   3.180082   4 #> 49 548.64817   3.396260   4 #> 50 555.41147   2.960205   4 #> 51 548.65260   2.707310   4 #> 52 672.76423   2.824469   4 #> 53 516.70641   2.794248   4 #> 54 531.96843   2.631053   4 #> 55  57.71118   3.168600   4 #> 56  57.95550   2.819458   4 #> 57  57.66495   2.520518   4 #> 58 409.90506   2.810516   4 #> 59 885.23825   2.582967   4 #>  #> [[6]] #>           ts magnitudes gen #> 1  695.04949   2.603058   5 #> 2  573.06724   2.839349   5 #> 3  526.06991   2.745535   5 #> 4  779.81658   2.584000   5 #> 5  575.04835   2.754614   5 #> 6  530.25432   3.187171   5 #> 7  512.67532   4.634818   5 #> 8  502.18733   2.955846   5 #> 9  720.79556   3.122774   5 #> 10 730.98883   3.184975   5 #> 11 773.08925   2.530909   5 #> 12 562.59820   3.521473   5 #> 13 519.84525   2.999157   5 #> 14 633.85066   2.707828   5 #> 15 693.42922   3.789332   5 #> 16 550.84715   3.130705   5 #> 17 624.18246   3.227883   5 #> 18 673.02818   2.676361   5 #> 19 672.78757   2.915425   5 #> 20  66.16121   3.645171   5 #>  #> [[7]] #>          ts magnitudes gen #> 1  673.9341   2.670821   6 #> 2  516.5585   2.683568   6 #> 3  536.0114   4.423692   6 #> 4  609.6689   2.564527   6 #> 5  545.3010   3.278596   6 #> 6  517.7963   2.964229   6 #> 7  512.8751   2.586425   6 #> 8  512.8229   2.772287   6 #> 9  557.2637   2.840226   6 #> 10 556.4193   3.088411   6 #> 11 848.6770   2.524997   6 #>  #> [[8]] #>         ts magnitudes gen #> 1 619.6314   2.713446   7 #> 2 976.9520   2.618703   7 #> 3 536.0491   2.591306   7 #> 4 568.0584   2.617301   7 #>"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the posterior distribution of the expected number of events — get_posterior_N","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"Plot posterior distribution expected number events","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"","code":"get_posterior_N(input.list, domain.extension = 0.1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"input.list combined input file (link functions) bru output (marginals) domain.extension Percentage posterior quantiles extend domain specified scalar. Default set 0.10.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"list three objects: post.df: data.frame containing posterior informations posterior distribution number events post.plot : ggplot object showing posterior distribution expected number events post.plot.shaded : ggplot object showing posterior distribution expected number events, shaded region corresponds 0.025 0.975 quantiles distribution distribution number events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"Retrieve posterior distribution ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"","code":"get_posterior_param(input.list)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"input.list input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"list two elements: post.df : data.frame posterior distributions parameters columns x (value parameter), y (value posterior), param (parameter name) post.plot : ggplot object showing posterior distribution parameter","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS triggering function - used by inlabru — gt","title":"ETAS triggering function - used by inlabru — gt","text":"function returns value ETAS triggering function specified time t points history th, mh","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ETAS triggering function - used by inlabru — gt","text":"","code":"gt(theta, t, th, mh, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ETAS triggering function - used by inlabru — gt","text":"theta ETAS parameters list names K, alpha, c, p t Time function calculated, scalar vector th Time events history [days, months,...], scalar vector mh Magnitude events history, scalar vector M0 Minimum magnitude threshold, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ETAS triggering function - used by inlabru — gt","text":"value ETAS triggering function evaluated t history th, mh.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ETAS triggering function - used by inlabru — gt","text":"ETAS triggering function evaluated $$g(t - t_h | m_h) = K e^{\\alpha(m_h - M_0)} \\left( \\frac{t - t_h}{c} + 1\\right)^{-p}$$ \\(K, \\alpha, c > 0\\), \\(p \\geq 1\\) ETAS parameters, \\(t\\) (t) time function evaluated, considering past observation \\(t_h, m_h\\) (th, mh). function returns 0 \\(t_h > t\\). \\(t\\) scalar \\(t_h, m_h\\) vectors function returns vector, \\(t\\) vector \\(t_h, m_h\\) scalars, \\(t, t_h, m_h\\) vectors length. use \\(t\\) \\(t_h, m_h\\) vectors different lengths.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":null,"dir":"Reference","previous_headings":"","what":"HORUS Ita Catalogue — horus","title":"HORUS Ita Catalogue — horus","text":"HOmogenized instRUmental Seismic catalog (HORUS) Italy 1960 present, limited limited 1960-2019.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"HORUS Ita Catalogue — horus","text":"","code":"data(horus, package = \"ETAS.inlabru\")"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"HORUS Ita Catalogue — horus","text":"Original file format: Year: Origin Time (OT) year Mo: OT month Da: OT day Ho: OT hour Mi OT minute Se OT seconds fractions Lat epicenter N latitude (degrees) Lon epicenter E longitude (degrees) Depth hypocenter depth (km) Mw true proxy moment magnitude sigMw moment magnitude uncertainty Geo.Ita \"*\" indicates epicenter within Italian mainland territory, otherwise \" \" Geo.CPTI15 \"*\" indicates epicenter within spatial window CPTI15 catalog (Rovida et al., 2020, Bull Earth Eng, doi: 10.1007/s10518-020-00818-y) Ev..type \"x\" indicates event earthquake (e.g. explosion, eruption, landslide, ...) (since May 1st 2012) Iside.n. ISIDe id number (since April 16th 2005) ETAS.inlabru format: time_string: Data-time event, ISO 8601 format; format = \"%Y-%m-%dT%H:%M:%OS\" use .POSIXct() lon: Original Lon lat: Original Lat depth Original Depth M: Original Mw","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"HORUS Ita Catalogue — horus","text":"http://horus.bo.ingv./","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"HORUS Ita Catalogue — horus","text":"original entire HORUS catalog provided single tab separated ascii file: HORUS_Ita_Catalog.txt random second decimal digit added ML Md INGV bulletin (ISIDe) computing Mw proxies (Lolli et al., Seism. Res. Lett., 91, 3208-3222, doi: 10.1785/0220200148), HORUS_Ita_Catalog_o.txt original ML Md used compute Mw proxies. ETAS.inlabru includes reformatted version data HORUS_Ita_Catalog.txt data.frame, limited 1960-2019. data provided , express implied warranty given.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"HORUS Ita Catalogue — horus","text":"Barbara Lolli(1), Daniele Randazzo(1), Gianfranco Vannucci(1) Paolo Gasperini (2),(1) (2020). Homogenized Instrumental Seismic Catalog (HORUS) Italy 1960 Present, Seismol. Res. Lett, doi: 10.1785/0220200148. (1) Istituto Nazionale di Geofisica e Vulcanologia, Sezione di Bologna (2) Dipartimento di Fisica e Astronomia, Università di Bologna","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"Copula transformation Exponential standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"","code":"inv_exp_t(x, rate)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"x values Exponential distribution, vector. rate rate Exponential distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"Copula transformation Gamma standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"","code":"inv_gamma_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"x values Gamma distribution, vector. shape parameter Gamma distribution, scalar. b rate parameter Gamma distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"Copula transformation Log-Normal standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"","code":"inv_loggaus_t(x, m, s)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"x values Log-Normal distribution, vector. m mean logarithm Log-Normal distribution, scalar. s standard deviation logarithm Log-Normal distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"Copula transformation Uniform standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"","code":"inv_unif_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"x values Uniform distribution, vector. minimum Uniform distribution, scalar. b maximum Uniform distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the integral of the ETAS conditional intensity — lambda_N","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"Calculate number events time interval T1 T2 given imposed events ETAS","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"","code":"lambda_N(th.mu, th.K, th.alpha, th.c, th.p, T1, T2, M0, Ht, link.functions)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"th.mu Background rate, mu, internal parameter scale th.K ETAS triggering parameter K internal parameter scale th.alpha ETAS triggering parameter alpha internal parameter scale th.c ETAS triggering parameter c internal parameter scale th.p ETAS triggering parameter p internal parameter scale T1 Start temporal model domain. T2 End temporal model domain. M0 Minimum magnitude threshold Ht History process, set known events interval. must data.frame columns ts (time) magnitudes (magnitudes). link.functions list functions transform parameters internal scale ETAS scale","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"Integral ETAS conditional intensity T1 T2 minimum magnitude M0, .e. expected number events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":null,"dir":"Reference","previous_headings":"","what":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"Logarithm integral ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"","code":"log_Lambda_h(theta, th, mh, M0, T1, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"theta ETAS parameters data.frame(mu=mu, K=K, alpha=alpha, c=c, p=p). th Time parent event. mh Magnitude parent event M0 Minimum magnitude threshold T1 Start temporal model domain. T2 End temporal model domain.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"Logarithm integral ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"Copula transformation standard Normal distribution Log-Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"","code":"loggaus_t(x, m, s)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"x values standard Normal distribution, vector. m mean logarithm Log-Normal distribution, scalar. s standard deviation logarithm Log-Normal distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"Values Log-Normal distribution logarithmic mean m standard deviation s, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to calculate Omori's law — omori","title":"Function to calculate Omori's law — omori","text":"Function calculate Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to calculate Omori's law — omori","text":"","code":"omori(theta, t, ti)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to calculate Omori's law — omori","text":"theta ETAS parameters (list(mu = mu, K = K, alpha = alpha, c = c, p = p), parameters c p used t Time Omori's law evaluated ti Time event history","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to calculate Omori's law — omori","text":"Value Omori's law point t event happened ti","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"Function plot Omori's law corresponding different posterior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"","code":"omori_plot_posterior(   input.list,   post.samp = NULL,   n.samp = 10,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale post.samp data.frame containing posterior samples parameters. NULL, n.samp samples generated. n.samp different nrow(post.samp) n.samp rows uniformly sampled post.samp. Default NULL. n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"ggplot object","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"Function plot Omori's law corresponding different prior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"","code":"omori_plot_prior(input.list, n.samp = 10, t.end = 1, n.breaks = 100)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"input.list structured input list least one element: link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"ggplot object","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"Plot posterior densities ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"","code":"post_pairs_plot(   input.list = NULL,   n.samp = NULL,   post.samp = NULL,   max.batch = 1000 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp number samples draw posteriors plot post.samp data.frame columns mu, K, alpha, c, p rows corresponding different posterior samples. NULL function samples joint posterior distribution n.samp times. default NULL. max.batch parameter post_sampling function used case post.samp = NULL","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"list: elements post.samp.df:data.frame posterior samples nrow = n.samp columns mu, K, alpha, c, p corresponding ETAS parameters. post.samp NULL returns post.samp pair.plot: ggplot object reporting pair plot parameters samples. obtained using ggpairs function Ggally library","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from the posterior of the ETAS parameters — post_sampling","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"Sample posterior ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"","code":"post_sampling(input.list, n.samp, max.batch = 1000, ncore = 1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp number samples draw posteriors max.batch Maximum number posterior samples generated simultaneously. Default 1000. ncore Number cores used n.samp exceeds max.batch. Default 1","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"data.frame posterior samples nrow = n.samp columns mu, K, alpha, c, p corresponding ETAS parameters.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":null,"dir":"Reference","previous_headings":"","what":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"Return sample magnitudes drawn GR distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"","code":"sample_GR_magnitudes(n, beta.p, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"n Number events sample. beta.p Related b-value via b ln(10). M0 Minimum magnitude sample.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"list magnitudes length n drawn GR distribution.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"","code":"sample_GR_magnitudes(n = 100, beta.p = log(10), M0 = 2.5) #>   [1] 3.007689 2.531242 2.660215 2.504375 2.838084 2.556464 2.834041 3.100406 #>   [9] 3.442525 2.749136 3.275909 2.787313 3.750171 2.838903 3.352849 3.881637 #>  [17] 2.635724 2.692361 2.510657 2.603138 2.765580 2.631296 4.134467 2.519860 #>  [25] 2.542075 3.162062 2.775803 3.420327 3.678777 3.165728 2.763781 3.344643 #>  [33] 2.594058 3.357165 3.830766 2.917924 3.130917 3.302655 2.873186 2.510114 #>  [41] 2.511254 2.743747 4.043122 2.884689 2.514611 2.705101 2.995284 2.815562 #>  [49] 2.859585 3.183824 2.808628 2.502685 3.441492 2.823225 2.656924 2.785099 #>  [57] 3.384827 2.747749 2.642186 2.540582 2.794099 3.400476 3.247786 2.694186 #>  [65] 3.946790 2.849093 3.265481 2.623060 2.555226 2.642865 4.638380 2.837810 #>  [73] 2.813801 2.867377 3.148836 4.152825 2.543529 3.039666 2.624995 2.548595 #>  [81] 2.879399 2.910587 3.613320 3.504958 3.727964 2.544623 2.597399 2.709579 #>  [89] 2.933501 2.549140 3.106774 3.177916 2.519236 3.009467 3.363245 2.578821 #>  [97] 2.986720 3.193781 2.795598 2.999776"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"Generate sample new events data.frame(t_i, M_i) length n.ev one parent event occuring time t_h using ETAS model.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"","code":"sample_temporal_ETAS_daughters(theta, beta.p, th, n.ev, M0, T1, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). th Time parent event [days]. n.ev number events placed. M0 Minimum magnitude synthetic catalogue. T1 Start time synthetic catalogue [days]. T2 End time synthetic catalogue [days].","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"Generate sample new events data.frame(t_i, M_i) one parent","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":null,"dir":"Reference","previous_headings":"","what":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"Take previous parent events Ht=data.frame[ts, magnitudes] generates daughters events using ETAS model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"","code":"sample_temporal_ETAS_generation(theta, beta.p, Ht, M0, T1, T2, ncore = 1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). Ht set parent events form data.frame[ts, magnitudes] M0 minimum earthquake magnitude synthetic catalogue. T1 start time synthetic catalogue [days]. T2 end time synthetic catalogue [days]. ncore number compute cores use","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"Return one generation daughters parents Ht form data.frame(t_i, M_i).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"","code":"# The parents are specified in Ht Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) sample_temporal_ETAS_generation(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000,   Ht = Ht ) #>           ts magnitudes #> 1   500.6724   2.708629 #> 2   503.3743   3.035758 #> 3   903.7651   3.311891 #> 4   500.7319   2.605522 #> 5   500.2062   2.662880 #> 6   751.2403   3.431450 #> 7   697.3092   2.556834 #> 8   500.5329   2.582954 #> 9   501.6957   2.569172 #> 10  500.2183   4.129657 #> 11  806.8861   2.999269 #> 12  502.9061   3.303382 #> 13  500.0034   2.824883 #> 14  501.2348   3.027526 #> 15  528.2554   2.724215 #> 16  581.1571   2.998670 #> 17  500.7798   2.520054 #> 18  501.8617   2.943400 #> 19  500.2084   3.341067 #> 20  501.1042   2.676308 #> 21  588.3652   2.527724 #> 22  501.4970   3.322811 #> 23  583.5989   2.515212 #> 24  500.8545   2.567047 #> 25  500.3640   2.804496 #> 26  504.5733   3.868972 #> 27  502.5058   2.562528 #> 28  501.0820   4.007470 #> 29  609.0785   2.729125 #> 30  503.9707   3.062063 #> 31  516.7518   2.577766 #> 32  500.1511   2.867621 #> 33  510.2353   2.613154 #> 34  695.6870   2.800043 #> 35  500.4669   2.541890 #> 36  672.1933   2.536930 #> 37  544.5170   2.595021 #> 38  513.2818   4.171092 #> 39  514.4766   3.631831 #> 40  516.4735   2.750274 #> 41  500.2599   2.841817 #> 42  513.2031   2.670202 #> 43  500.2751   2.812867 #> 44  506.1178   2.991585 #> 45  853.2555   2.820182 #> 46  568.6071   2.612689 #> 47  513.0050   2.513372 #> 48  505.4027   2.501235 #> 49  500.2435   2.620517 #> 50  606.4963   2.546267 #> 51  505.1408   2.834724 #> 52  505.4747   2.912811 #> 53  536.8700   2.597887 #> 54  526.8193   2.580413 #> 55  514.9607   3.187467 #> 56  511.3805   2.731061 #> 57  500.4205   2.990417 #> 58  938.8417   2.585341 #> 59  500.6336   3.069241 #> 60  501.5576   2.605470 #> 61  501.9243   3.461591 #> 62  500.2682   3.030465 #> 63  506.4515   2.813887 #> 64  500.4649   2.822353 #> 65  524.5214   2.805940 #> 66  559.1335   3.328070 #> 67  500.4626   2.765715 #> 68  509.8236   2.592038 #> 69  503.9029   2.724874 #> 70  672.0207   2.729931 #> 71  500.4580   2.760105 #> 72  500.3673   2.874094 #> 73  501.9116   2.668816 #> 74  516.9487   3.246806 #> 75  502.6713   3.254389 #> 76  500.2236   2.654047 #> 77  500.7041   2.707288 #> 78  791.7461   2.788880 #> 79  526.3349   2.998788 #> 80  556.0315   2.838795 #> 81  500.0508   2.563076 #> 82  500.6370   3.280636 #> 83  502.2877   2.715572 #> 84  647.2617   2.853019 #> 85  509.5401   2.610021 #> 86  500.0587   2.811701 #> 87  512.4737   2.749630 #> 88  501.9203   2.930663 #> 89  593.7675   2.607314 #> 90  510.5376   2.589648 #> 91  500.0314   2.628158 #> 92  524.4908   3.265501 #> 93  507.4901   2.870807 #> 94  522.3791   2.721762 #> 95  569.8066   3.039438 #> 96  515.9565   2.527881 #> 97  557.2326   3.185063 #> 98  536.5104   3.290030 #> 99  500.8550   2.700876 #> 100 589.8733   2.907768 #> 101 500.6806   3.013497 #> 102 500.0650   3.221763 #> 103 516.4759   2.598039 #> 104 507.9262   2.799218 #> 105 500.4119   2.717233 #> 106 504.4172   2.563494 #> 107 517.4032   3.137490 #> 108 516.3944   3.944976 #> 109 503.1537   2.629354 #> 110 500.7344   2.625130 #> 111 500.0210   2.657414 #> 112 621.2062   2.539467 #> 113 598.2305   3.040439 #> 114 507.9300   3.144344 #> 115 505.7969   2.618811 #> 116 514.1491   2.682666 #> 117 537.8998   2.702271 #> 118 503.7727   2.668616 #> 119 500.0726   2.995234 #> 120 503.3440   2.577432 #> 121 837.7515   2.514657 #> 122 557.8585   2.601463 #> 123 807.0264   3.334803 #> 124 571.2620   3.425313 #> 125 504.0742   3.002305 #> 126 500.2070   2.808451 #> 127 503.8322   3.078980 #> 128 740.9757   2.729106 #> 129 503.2413   2.907092 #> 130 500.5458   2.697156 #> 131 503.5508   2.599324 #> 132 524.3462   2.648944 #> 133 501.4065   2.507283 #> 134 500.1636   2.720653 #> 135 645.7993   3.066712 #> 136 500.8613   3.191054 #> 137 527.1155   2.750098 #> 138 630.9933   2.538204 #> 139 965.5361   2.558061 #> 140 501.5938   2.655516 #> 141 510.2668   2.918899 #> 142 500.3787   2.609360 #> 143 500.6203   3.206459 #> 144 519.5632   2.504623 #> 145 507.0292   3.186984 #> 146 500.1822   2.946099 #> 147 500.0876   2.891447 #> 148 664.8272   2.797199 #> 149 500.2394   3.083286 #> 150 521.2709   4.265923 #> 151 528.6098   2.987476 #> 152 500.0150   2.863693 #> 153 664.2159   2.551694 #> 154 503.0994   2.534883 #> 155 507.8676   2.610181 #> 156 556.6167   3.083355 #> 157 501.6688   2.986971 #> 158 515.3478   2.618495 #> 159 500.4640   2.913370 #> 160 515.5393   3.838574 #> 161 509.6644   3.455941 #> 162 529.9184   2.551756 #> 163 510.8141   3.316142 #> 164 712.0922   2.513855 #> 165 503.4669   2.569146 #> 166 768.6725   3.914338 #> 167 516.1121   3.578684 #> 168 500.0819   2.879277 #> 169 506.1065   2.551611 #> 170 523.1839   2.656998 #> 171 501.3056   3.682916 #> 172 500.0372   2.875501 #> 173 500.0108   3.110171 #> 174 507.4589   4.242936 #> 175 524.2649   3.304029 #> 176 618.6736   2.746345 #> 177 500.7302   3.057265 #> 178 532.3653   4.026684 #> 179 507.5706   2.991409 #> 180 500.2540   2.595546 #> 181 500.2192   2.517112 #> 182 500.4586   2.739408 #> 183 503.3238   2.524513 #> 184 867.4410   2.967890 #> 185 500.3131   2.528390 #> 186 501.7979   2.587870 #> 187 500.0712   2.610472 #> 188 727.5810   2.621670 #> 189 886.2140   2.669801 #> 190 950.3493   3.384449 #> 191 504.7903   2.587673 #> 192 500.1909   3.640459 #> 193 608.7287   2.570462 #> 194 500.0420   2.553040 #> 195 501.2477   2.830917 #> 196 522.6440   2.873026 #> 197 902.1673   3.229768 #> 198 505.9660   2.905981 #> 199 532.6702   3.459637 #> 200 500.2504   2.596438 #> 201 500.0588   3.172116 #> 202 505.1115   2.603400 #> 203 527.9379   2.698035 #> 204 502.4126   2.825738 #> 205 500.4355   2.597170 #> 206 500.0589   3.425120 #> 207 500.4231   3.396272 #> 208 500.3540   2.581793 #> 209 500.4228   2.569346 #> 210 500.0573   2.730879 #> 211 554.6908   3.033575 #> 212 501.2373   2.558835 #> 213 600.8938   3.148752 #> 214 500.0154   3.428675 #> 215 518.0970   2.677501 #> 216 975.0125   2.677553 #> 217 500.0250   3.295848 #> 218 500.0811   2.828706 #> 219 500.3914   3.019915 #> 220 501.2757   2.893447 #> 221 506.6980   2.982557 #> 222 522.7299   2.907532 #> 223 500.1289   3.744428 #> 224 656.9166   2.522847 #> 225 503.1195   3.005328 #> 226 500.0005   3.289459 #> 227 541.2362   2.931255 #> 228 511.1224   2.820816 #> 229 511.9218   2.549946 #> 230 506.2940   2.573208 #> 231 501.8271   4.126407 #> 232 545.7071   2.531180 #> 233 505.4703   2.517101 #> 234 501.5999   2.513484 #> 235 500.7332   3.083532 #> 236 633.9385   2.603605 #> 237 500.1925   2.757253 #> 238 501.6121   2.666640 #> 239 500.0275   2.732392 #> 240 500.1394   2.524678 #> 241 501.3208   2.779324 #> 242 591.9939   4.357148 #> 243 550.3651   2.821012 #> 244 646.8113   3.408840 #> 245 538.5786   3.007492 #> 246 502.7696   2.540413 #> 247 793.9283   2.509404 #> 248 542.2192   2.555927 #> 249 501.2505   2.596906 #> 250 881.5512   2.636764 #> 251 507.5519   4.181507 #> 252 525.7598   2.650078 #> 253 503.9205   2.905406 #> 254 500.1968   2.837912 #> 255 507.6013   3.180229 #> 256 500.9778   2.882921 #> 257 500.6616   3.687951 #> 258 514.2530   2.504532 #> 259 500.8269   3.021648 #> 260 500.0640   3.540070 #> 261 998.0243   2.669426 #> 262 512.1281   3.885353 #> 263 567.3461   3.308651 #> 264 799.0245   2.568769 #> 265 507.2578   2.644925 #> 266 500.0196   3.164207 #> 267 911.7675   2.792014 #> 268 500.0555   2.968654 #> 269 506.6183   2.642500 #> 270 534.9595   2.636945 #> 271 500.4700   2.619258 #> 272 744.5182   3.043305 #> 273 500.9919   2.949728 #> 274 963.2863   3.359491 #> 275 500.0783   2.818265 #> 276 590.0360   2.884005 #> 277 500.8320   3.116399 #> 278 500.9915   2.583686 #> 279 503.1224   3.000570 #> 280 505.5316   2.911053 #> 281 591.0200   2.607473 #> 282 605.1713   3.542551 #> 283 600.0183   3.193057 #> 284 636.2717   2.704506 #> 285 529.4167   2.712643 #> 286 506.9402   2.837866 #> 287 501.6032   3.024691 #> 288 915.0326   3.387341 #> 289 502.3773   2.740072 #> 290 513.5015   2.621601 #> 291 511.6979   2.689577 #> 292 502.5340   2.741489 #> 293 500.1274   2.686147 #> 294 500.0013   2.594464 #> 295 500.0091   4.011659 #> 296 511.3117   3.058404 #> 297 500.5571   2.627703 #> 298 501.5608   3.096649 #> 299 500.9049   3.381504 #> 300 502.8022   2.680136 #> 301 624.3356   2.851878 #> 302 631.2688   2.586066 #> 303 505.8103   2.800679 #> 304 506.3750   2.946708 #> 305 528.3151   3.075382 #> 306 500.4847   2.586280 #> 307 501.0075   2.657976 #> 308 503.0130   2.711272 #> 309 502.7886   3.685075 #> 310 559.2017   2.728339 #> 311 508.0012   3.246399 #> 312 514.2321   2.751564 #> 313 500.8383   2.672941 #> 314 505.4327   2.637714 #> 315 500.6150   2.602978 #> 316 500.3027   2.589461 #> 317 501.0137   2.837399 #> 318 505.4030   2.629334 #> 319 503.9870   2.912950 #> 320 500.7577   2.574221 #> 321 656.5935   2.852332 #> 322 532.0638   2.524583 #> 323 501.1935   2.667079 #> 324 502.6032   3.413950 #> 325 501.5249   2.703664 #> 326 501.2018   2.597042 #> 327 500.2066   2.995815 #> 328 882.0515   2.819512 #> 329 504.0618   2.550525 #> 330 558.9003   3.512837 #> 331 512.5893   2.541887 #> 332 620.4905   2.633130 #> 333 500.0789   2.978569 #> 334 501.7587   3.428198 #> 335 500.0135   3.178192 #> 336 504.4995   3.347027 #> 337 500.1575   2.559173 #> 338 520.0729   2.662246 #> 339 516.8751   3.797009 #> 340 588.9195   2.681112 #> 341 500.4660   2.612463 #> 342 598.3706   2.698756 #> 343 519.4791   2.609252 #> 344 561.3420   3.379207 #> 345 596.0402   3.191158 #> 346 500.0235   2.623063 #> 347 536.5403   2.652483 #> 348 964.3189   2.807839 #> 349 500.1652   2.966371 #> 350 502.4632   2.920972 #> 351 768.3533   2.562743 #> 352 500.6011   3.032186 #> 353 511.4990   3.406780 #> 354 565.5220   3.001085 #> 355 500.0011   2.650032 #> 356 500.3980   2.658008 #> 357 530.6108   2.771283 #> 358 501.0042   2.534145 #> 359 503.2781   2.679589 #> 360 877.2250   2.744200 #> 361 500.4180   3.221419 #> 362 500.0899   3.083986 #> 363 500.0690   2.962652 #> 364 596.4117   2.502487 #> 365 539.5414   3.124487 #> 366 501.8727   2.556826 #> 367 509.8955   2.823231 #> 368 500.9729   2.659412 #> 369 501.2471   2.611363 #> 370 500.4263   2.883520 #> 371 627.5472   3.061440 #> 372 500.2319   2.967079 #> 373 500.4676   2.635375 #> 374 500.0602   2.622797 #> 375 512.6170   4.307877 #> 376 502.9438   3.199935 #> 377 508.7036   2.623697 #> 378 500.1100   2.699847 #> 379 878.2280   3.315359 #> 380 500.1422   2.507904 #> 381 500.3968   4.960207 #> 382 507.9951   2.603332 #> 383 505.6461   2.641593 #> 384 527.2362   3.324302 #> 385 500.1841   3.620992 #> 386 505.5665   2.514331 #> 387 500.1146   2.610932 #> 388 717.9010   2.654232 #> 389 503.5804   3.884605 #> 390 501.2785   2.713411 #> 391 502.9292   3.669403 #> 392 509.6911   2.553473 #> 393 526.9676   2.597252 #> 394 509.6879   2.623914 #> 395 503.4332   2.699351 #> 396 501.4653   2.609225 #> 397 500.3596   2.867765 #> 398 519.9431   2.653868 #> 399 500.2690   2.642301 #> 400 516.2742   2.687620 #> 401 514.5532   2.644013 #> 402 609.5650   2.705960 #> 403 500.0502   3.167896 #> 404 500.3440   2.684809 #> 405 500.3632   2.542024 #> 406 501.4042   2.741070 #> 407 694.3672   2.829597 #> 408 500.0658   3.774535 #> 409 509.6482   2.687983 #> 410 583.3148   2.879373 #> 411 500.9596   3.847890 #> 412 500.0319   2.536294 #> 413 519.2628   3.599724 #> 414 977.9685   2.961788 #> 415 503.2305   4.136993 #> 416 586.1006   3.060339 #> 417 712.3477   2.657387 #> 418 504.0444   3.094019 #> 419 713.6774   3.625464 #> 420 505.9589   3.221316 #> 421 875.1471   3.027644 #> 422 576.5796   2.701525 #> 423 722.2015   2.826606 #> 424 820.8002   2.503732 #> 425 500.4287   2.748120 #> 426 500.3554   2.880733 #> 427 500.4676   3.798512 #> 428 550.2936   2.618138 #> 429 500.7770   3.503527 #> 430 642.9605   2.875850 #> 431 501.3480   4.785830 #> 432 500.0119   2.849201 #> 433 984.6168   3.152119 #> 434 858.7142   2.761083 #> 435 541.8252   2.513636 #> 436 721.7042   2.589181 #> 437 531.1727   2.894863 #> 438 500.6629   4.151134 #> 439 500.0699   3.286937 #> 440 659.8638   2.723999 #> 441 500.8587   2.645384 #> 442 891.7555   2.771957 #> 443 500.0203   2.839996 #> 444 662.2178   2.569394 #> 445 500.2522   2.569013 #> 446 500.1027   3.143065 #> 447 503.2781   3.565160 #> 448 502.4894   3.446914 #> 449 563.1241   3.785457 #> 450 534.4662   2.647846 #> 451 514.9079   3.144840 #> 452 542.1847   3.706590 #> 453 522.3971   2.556245 #> 454 501.8668   2.898033 #> 455 525.8290   2.557792 #> 456 501.9801   2.512580 #> 457 500.3558   2.746641 #> 458 544.5946   2.765243 #> 459 500.2256   3.186598 #> 460 500.2738   2.724400 #> 461 500.0745   3.138669 #> 462 500.1443   2.604859 #> 463 745.9574   2.870946 #> 464 505.9452   4.588334 #> 465 500.4817   2.676725 #> 466 502.5795   2.661812 #> 467 727.6669   2.628191 #> 468 500.0069   3.397642 #> 469 514.6011   3.184709 #> 470 513.2818   2.792691 #> 471 505.7213   3.374586 #> 472 500.0680   3.208607 #> 473 501.4574   2.983090 #> 474 503.5118   2.634354 #> 475 500.3018   2.699302 #> 476 594.3726   4.119537 #> 477 500.7996   2.680801 #> 478 500.5622   3.582187 #> 479 500.1547   3.060740 #> 480 500.7774   3.975613 #> 481 542.3784   2.950609 #> 482 500.0699   3.124788 #> 483 509.9902   2.535581 #> 484 500.0240   3.135836 #> 485 503.8236   2.790805 #> 486 500.0286   3.150818 #> 487 503.4034   4.005875 #> 488 522.8647   5.157879 #> 489 500.0516   3.432636 #> 490 500.5289   3.176686 #> 491 500.8340   3.299659 #> 492 836.7263   2.716317 #> 493 501.3149   2.676937 #> 494 500.0406   2.548873 #> 495 723.2936   4.345036 #> 496 534.6017   2.625360 #> 497 935.7390   2.529008 #> 498 503.7581   3.018524 #> 499 509.7782   2.794469 #> 500 503.5220   2.588037 #> 501 508.9602   2.555942 #> 502 504.6024   2.599583 #> 503 500.2440   2.707109 #> 504 505.2431   3.459024 #> 505 552.8313   2.781474 #> 506 565.1252   2.965287 #> 507 520.2491   2.503821 #> 508 500.3577   2.714239 #> 509 514.9448   3.040832 #> 510 525.3483   2.854743 #> 511 502.0319   2.641153 #> 512 500.6231   2.914443 #> 513 500.0697   2.535703 #> 514 531.2606   2.581011 #> 515 647.5005   3.369636 #> 516 630.0327   2.679751 #> 517 501.2253   2.573520 #> 518 512.9739   2.759781 #> 519 974.4880   2.716630 #> 520 501.8442   2.674238 #> 521 532.9222   2.543050 #> 522 500.2093   2.742033 #> 523 533.7802   3.038436 #> 524 690.9386   3.284522 #> 525 500.8263   2.511898 #> 526 500.3571   2.960683 #> 527 500.0943   2.873625 #> 528 520.0899   2.570956 #> 529 500.0483   2.965845 #> 530 605.8099   3.282461 #> 531 515.6870   2.541269 #> 532 500.9521   3.144185 #> 533 519.6804   3.182363 #> 534 660.9818   3.781972 #> 535 503.0979   2.811361 #> 536 503.6775   2.603077 #> 537 506.4184   2.842961 #> 538 637.0095   2.655370 #> 539 500.2552   3.150569 #> 540 500.8857   2.762077 #> 541 723.2075   3.647792 #> 542 500.6736   2.591916 #> 543 502.4172   3.243465 #> 544 505.3221   2.521888 #> 545 503.6940   2.589644 #> 546 915.2731   2.617397 #> 547 500.7417   3.087276 #> 548 500.2786   2.749746 #> 549 647.1846   2.530906 #> 550 513.7734   2.566038 #> 551 501.8664   3.301652 #> 552 564.7712   3.441779 #> 553 537.3658   2.838262 #> 554 521.5808   3.291217 #> 555 505.0608   2.504160 #> 556 504.9777   2.702067 #> 557 706.6791   3.829892 #> 558 529.0712   2.636088 #> 559 862.3350   3.081330 #> 560 735.6121   2.809170 #> 561 516.8187   2.551208 #> 562 514.9688   3.126540 #> 563 519.0800   2.655980 #> 564 500.3362   3.136182 #> 565 500.0502   4.138182 #> 566 666.9816   2.545606 #> 567 528.1470   2.721899 #> 568 500.8334   3.005677 #> 569 529.2807   3.819396 #> 570 501.9294   2.642996 #> 571 500.2584   4.134674 #> 572 519.6756   2.980795 #> 573 500.0251   2.599317 #> 574 535.2119   3.144476 #> 575 540.8347   3.700314 #> 576 500.2862   3.382663 #> 577 500.0050   2.568756 #> 578 517.6797   2.513217 #> 579 533.5920   2.649710 #> 580 567.3783   2.834729 #> 581 500.1774   2.618617 #> 582 590.6660   2.985387 #> 583 500.4049   2.811679 #> 584 509.2250   3.452725 #> 585 650.4360   2.635487 #> 586 500.2238   2.511455 #> 587 545.8986   2.593512 #> 588 506.9796   2.642780 #> 589 502.1841   3.040315 #> 590 503.3176   2.591594 #> 591 503.0582   2.620476 #> 592 500.0643   3.007221 #> 593 505.5994   2.762912 #> 594 500.0043   2.712806 #> 595 500.2876   3.042221 #> 596 641.8828   3.528945 #> 597 504.7594   2.636233 #> 598 607.6098   2.806035 #> 599 606.6774   2.595178 #> 600 888.7990   2.872661 #> 601 500.9948   2.586341 #> 602 500.4387   2.640546 #> 603 502.4182   3.400327 #> 604 500.0011   3.399547 #> 605 535.8057   3.385732 #> 606 515.8493   3.127882 #> 607 849.4778   2.969207 #> 608 508.1391   2.640762 #> 609 555.3236   3.545528 #> 610 503.2670   2.535712 #> 611 504.9566   2.662463 #> 612 661.4500   2.515365 #> 613 504.8764   2.757277 #> 614 500.1673   2.873914 #> 615 502.7159   3.054059 #> 616 500.2339   2.831593 #> 617 587.2233   2.909679 #> 618 500.9311   3.267832 #> 619 502.1858   4.156871 #> 620 529.0922   2.545032 #> 621 500.3233   3.134901 #> 622 533.4596   2.983243 #> 623 574.0554   2.848096 #> 624 512.5318   2.702856 #> 625 500.9758   3.518720 #> 626 523.8455   3.871579 #> 627 500.5440   2.609316 #> 628 594.4016   2.562490 #> 629 501.7749   3.048464 #> 630 500.5948   2.500171 #> 631 500.8548   2.940363 #> 632 500.0590   2.657719 #> 633 610.3991   2.505657 #> 634 508.2000   2.614554 #> 635 504.2407   2.561335 #> 636 699.8998   2.530609 #> 637 586.6900   3.250895 #> 638 556.5709   3.142798 #> 639 501.8596   2.523418 #> 640 500.1086   3.091181 #> 641 501.0618   2.617372 #> 642 500.1364   2.580420 #> 643 500.0211   2.573286 #> 644 503.8083   2.535716 #> 645 875.8918   2.844923 #> 646 703.1688   2.568759 #> 647 640.1145   2.862304 #> 648 500.3256   3.550981 #> 649 500.8408   2.558588 #> 650 511.0021   3.527751 #> 651 537.8831   4.101897 #> 652 500.0064   3.450580 #> 653 506.6380   4.497502 #> 654 500.2733   3.877759 #> 655 517.1036   3.218884 #> 656 500.3367   2.785277 #> 657 500.0960   2.824206 #> 658 517.4491   2.750724 #> 659 554.4924   2.654182 #> 660 500.0813   2.763450 #> 661 502.8701   3.162190 #> 662 500.7859   3.591253 #> 663 500.1438   2.967496 #> 664 511.4741   3.398391 #> 665 879.2662   2.621537 #> 666 503.9942   2.965237 #> 667 712.9242   2.624186 #> 668 508.0369   2.528146 #> 669 615.4467   3.339219 #> 670 585.0751   2.515101 #> 671 500.1402   2.698544 #> 672 536.6735   2.540695 #> 673 500.0317   2.633630 #> 674 508.0844   2.833360 #> 675 500.0091   2.846773 #> 676 500.4840   4.083464 #> 677 500.2866   2.933347 #> 678 717.5902   3.737066 #> 679 615.7069   2.825134 #> 680 634.1153   2.648624 #> 681 510.6277   3.691724 #> 682 500.4131   3.847947 #> 683 505.6330   3.034432 #> 684 509.9282   2.679338 #> 685 500.1509   2.620331 #> 686 557.3505   2.683202 #> 687 504.8652   2.721648 #> 688 721.9471   2.697325 #> 689 500.1942   2.715738 #> 690 551.6782   2.570821 #> 691 500.0308   2.749835 #> 692 500.0466   2.557853 #> 693 501.8061   3.101487 #> 694 537.4835   2.520439 #> 695 500.5396   2.913859 #> 696 500.2643   2.709150 #> 697 573.2812   2.645995 #> 698 504.1292   2.965489 #> 699 502.3354   2.686096 #> 700 503.5180   2.899609 #> 701 517.7922   2.567816 #> 702 589.3426   2.562752 #> 703 896.1393   2.506699 #> 704 617.4682   3.003161 #> 705 779.3305   2.721895 #> 706 501.4389   2.765883 #> 707 500.1262   2.572656 #> 708 595.8092   2.536915 #> 709 500.0144   3.163561 #> 710 692.4988   2.529199 #> 711 500.0841   2.521590 #> 712 501.1204   3.265618 #> 713 500.1152   2.955055 #> 714 501.5888   2.731806 #> 715 502.0256   3.350556 #> 716 500.1813   2.664861 #> 717 500.2748   2.575625 #> 718 655.7417   2.572274 #> 719 656.7358   3.158459 #> 720 500.1786   2.652584 #> 721 501.6792   2.841593 #> 722 505.0471   2.778322 #> 723 791.6147   2.738326 #> 724 500.3054   2.734930 #> 725 507.2308   2.935081 #> 726 512.2888   2.725249 #> 727 510.3620   2.626473 #> 728 501.7085   2.742731 #> 729 602.1849   2.543808 #> 730 600.8561   2.744394 #> 731 532.9031   2.616811 #> 732 535.0984   2.505816 #> 733 572.4187   3.202310 #> 734 500.0136   2.635461 #> 735 501.1319   3.445607 #> 736 517.5626   2.592364 #> 737 511.1183   2.576481 #> 738 513.9911   2.676789 #> 739 537.0662   2.531106 #> 740 501.2397   2.670343 #> 741 500.3794   2.535403 #> 742 981.5004   3.126655 #> 743 510.7850   2.589416 #> 744 500.2314   2.798979 #> 745 501.4619   3.138398 #> 746 550.2780   2.541854 #> 747 500.5126   2.711298 #> 748 522.4314   2.800403 #> 749 561.8916   3.627712 #> 750 500.1502   2.769626 #> 751 536.4246   3.772875 #> 752 501.2839   3.048609 #> 753 501.6673   2.671091 #> 754 501.2257   3.323144 #> 755 547.5348   2.583070 #> 756 506.7082   2.655804 #> 757 500.6036   2.577332 #> 758 582.4258   2.614312 #> 759 505.4558   3.271449 #> 760 500.0615   2.634334 #> 761 527.0048   2.983885 #> 762 552.2874   2.685252 #> 763 500.3243   2.683790 #> 764 509.2757   2.645029 #> 765 503.3086   3.168704 #> 766 500.1383   2.583995 #> 767 616.4028   2.729809 #> 768 543.1517   2.811696 #> 769 500.8671   2.938541 #> 770 508.0031   2.904672 #> 771 500.1216   3.154245 #> 772 503.5640   2.778392 #> 773 500.1131   2.981911 #> 774 500.8859   2.663628 #> 775 500.9820   2.579683 #> 776 500.5808   2.574159 #> 777 500.4592   2.715600 #> 778 500.9553   2.689411 #> 779 500.1212   3.180490 #> 780 520.3050   2.516033 #> 781 500.0018   3.448409 #> 782 512.0381   2.976199 #> 783 500.0421   2.657153 #> 784 510.3068   3.568591 #> 785 500.9194   3.277813 #> 786 500.1027   2.633331 #> 787 759.1266   2.582335 #> 788 502.6489   2.516959 #> 789 500.3812   3.491941 #> 790 507.3611   2.538606 #> 791 500.6036   2.763418 #> 792 504.5065   3.253243 #> 793 501.5145   2.538073 #> 794 768.2635   2.912224 #> 795 508.2346   2.750631 #> 796 500.1206   2.971486 #> 797 500.7038   3.597857 #> 798 500.0837   2.901661 #> 799 741.1864   2.716523 #> 800 533.4889   2.769003 #> 801 856.2060   2.717180 #> 802 506.3229   2.704909 #> 803 500.0129   4.125607 #> 804 501.1207   2.598050 #> 805 500.0925   2.543785 #> 806 502.6341   3.411139 #> 807 509.8217   2.515357 #> 808 606.4102   2.715320 #> 809 591.4260   2.954487 #> 810 504.3470   3.471190 #> 811 751.9974   3.089428 #> 812 917.5854   2.752699 #> 813 799.1566   2.690390 #> 814 504.3299   3.112488 #> 815 561.6272   2.797929 #> 816 545.3689   2.598829 #> 817 934.9320   2.606196 #> 818 500.4096   3.040230 #> 819 509.1342   3.764050 #> 820 506.9030   2.524157 #> 821 508.4161   3.186670 #> 822 500.0470   2.755392 #> 823 517.1831   2.640999 #> 824 506.0924   3.169281 #> 825 532.5986   2.667106 #> 826 548.9308   4.594128 #> 827 506.0241   2.616338 #> 828 558.7766   2.742278 #> 829 501.0282   3.376925 #> 830 505.4254   3.587273 #> 831 500.2590   2.877865 #> 832 524.9862   2.540965 #> 833 527.1657   2.646087 #> 834 822.4392   2.699642 #> 835 501.8117   2.574821 #> 836 502.0889   3.023783 #> 837 500.1407   3.014481 #> 838 502.2576   2.571404 #> 839 824.6222   2.921669 #> 840 510.6923   2.881397 #> 841 502.6025   2.597217 #> 842 500.1236   2.640324 #> 843 503.9212   2.762005 #> 844 500.1468   2.519572 #> 845 500.3392   3.430177 #> 846 503.3599   2.985831 #> 847 503.2586   3.245373 #> 848 500.5455   3.520758 #> 849 906.0414   3.166848 #> 850 603.1405   2.740454 #> 851 842.4848   2.503246 #> 852 501.4284   2.919886 #> 853 500.4366   2.685310 #> 854 501.1846   2.638754 #> 855 500.4755   3.287633 #> 856 666.3597   2.791352 #> 857 500.6887   2.554595 #> 858 500.5921   3.211149 #> 859 520.1947   3.219226 #> 860 532.7253   2.811907 #> 861 508.4325   2.606546 #> 862 933.9092   2.542986 #> 863 500.1413   3.117340 #> 864 500.3216   3.479859 #> 865 500.2901   2.899408 #> 866 778.8449   2.614022 #> 867 500.2293   2.584768 #> 868 814.6585   2.564714 #> 869 501.0748   2.585687 #> 870 500.2172   2.536041 #> 871 500.3447   3.598979 #> 872 503.7328   2.987213 #> 873 830.4188   2.524041 #> 874 504.6346   3.140137 #> 875 502.1276   2.614638 #> 876 509.4042   2.531208 #> 877 546.3143   2.570324 #> 878 501.3334   2.651944 #> 879 983.8137   3.299595 #> 880 500.0647   3.486124 #> 881 501.9374   3.034322 #> 882 500.8931   2.530876 #> 883 530.6347   2.791842 #> 884 507.8694   2.709044 #> 885 671.5675   2.625100 #> 886 953.7387   2.567892 #> 887 536.0720   2.754780 #> 888 504.7948   2.772467 #> 889 852.6082   3.328853 #> 890 501.2625   3.900333 #> 891 968.5932   4.013416 #> 892 659.9914   2.623520 #> 893 500.1797   3.026900 #> 894 667.7392   3.547567 #> 895 502.6231   2.937088 #> 896 501.8580   2.931076 #> 897 509.1092   3.688203 #> 898 500.3412   2.776301 #> 899 500.0970   2.952328 #> 900 548.6123   3.319378 #> 901 515.5489   3.486775 #> 902 500.1423   2.504724 #> 903 508.8942   2.758224 #> 904 780.7263   2.787857 #> 905 504.8452   2.581489 #> 906 523.4632   2.906523 #> 907 500.1169   2.627120 #> 908 500.3615   2.534457 #> 909 526.1614   2.817208 #> 910 502.9242   2.922817 #> 911 500.1171   3.354207 #> 912 500.1023   2.504442 #> 913 500.4602   2.524801"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":null,"dir":"Reference","previous_headings":"","what":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"Sampling times events triggered parent th according ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"","code":"sample_temporal_ETAS_times(theta, n.ev, th, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). n.ev Number events return sample time domain (th, T2]. th Time parent event producing n.ev daughters. T2 End time model domain.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"t.sample list times interval [0, T2] distributed according ETAS triggering function.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — sample_temporal_injection_events","title":"Title — sample_temporal_injection_events","text":"Title","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — sample_temporal_injection_events","text":"","code":"sample_temporal_injection_events(   a = 50,   V.i = 1,   tau = 10,   beta.p,   M0,   T.i,   T2 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — sample_temporal_injection_events","text":"Induced event rate per unit volume. V.Injected volume tau Decay rate [days]. beta.p Related b-value via b ln(10). M0 Minimum magnitude threshold. T.Time injection [days]. T2 End temporal model domain [days].","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — sample_temporal_injection_events","text":"Catalogue parent events induced injection; data.frame(times, magnitudes)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a set of time bins for a specific event. — time_grid","title":"Generate a set of time bins for a specific event. — time_grid","text":"Generate set time bins specific event.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a set of time bins for a specific event. — time_grid","text":"","code":"time_grid(data.point, coef.t, delta.t, N.exp., T1., T2.)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a set of time bins for a specific event. — time_grid","text":"data.point Point binning calculated, list elements time (ts, scalar), event index (idx.p, scalar). Names mandatory changed coef.t TimeBinning parameter: look breaks_exp() delta.t TimeBinning parameter: look breaks_exp() N.exp. TimeBinning parameter: look breaks_exp() T1. Start temporal domain, scalar T2. End temporal domain scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a set of time bins for a specific event. — time_grid","text":"data.frame many rows number bins fixed number columns. columns t.start : starting point bin (minimum = T1.). t.end : end point bin. (maximum = T2.). t.bin.name : unique bin identifier. t.ref_layer : bin identifier calculations ts : time provided data.point idx.p : identifier provided data.point bins T1. T2. containing T1.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a set of time bins for a specific event. — time_grid","text":"","code":"## EXAMPLE 1 event <- list(ts = 0, idx.p = 1) time_grid(data.point = event, coef.t = 1, delta.t = 0.1, N.exp. = 8, T1. = 1, T2. = 20) #>   t.start t.end t.bin.name t.ref_layer ts idx.p #> 1     1.0   1.6    0.8-1.6   between-1  0     1 #> 2     1.6   3.2    1.6-3.2           6  0     1 #> 3     3.2   6.4    3.2-6.4           7  0     1 #> 4     6.4  12.8   6.4-12.8           8  0     1 #> 5    12.8  20.0    12.8-20      last-1  0     1"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"Function plot ETAS triggering function corresponding different posterior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"","code":"triggering_fun_plot(   input.list,   post.samp = NULL,   n.samp = 10,   magnitude = 4,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale post.samp data.frame containing posterior samples parameters. NULL, n.samp samples generated. n.samp different nrow(post.samp) n.samp rows uniformly sampled post.samp. Default NULL n.samp Number posterior samples, integer (default = 10). magnitude Magnitude event triggering function calculated, scalar (default = 4). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"ggplot object grey lines representing triggering function posterior sample. Black lines representing 0.025 0.975 quantiles function values calculated posterior sample. Horizontal red lines represents 0.025 0.975 quantiles sampled background rates.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"Function plot ETAS triggering function corresponding different prior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"","code":"triggering_fun_plot_prior(   input.list,   magnitude = 4,   n.samp = 10,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"input.list structured input list least one element: link.functions: list functions convert ETAS parameters INLA scale ETAS scale magnitude Magnitude event triggering function calculated, scalar (default = 4). n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"ggplot object grey lines representing triggering function posterior sample. Black lines representing 0.025 0.975 quantiles function values calculated posterior sample. Horizontal red lines represents 0.025 0.975 quantiles sampled background rates.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"Copula transformation standard Normal distribution Uniform distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"","code":"unif_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"x values standard Normal distribution, vector. minimum value Uniform distribution, scalar. b maximum value Uniform distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"values Uniform distribution b, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/news/index.html","id":"etasinlabru-development-version","dir":"Changelog","previous_headings":"","what":"ETAS.inlabru (development version)","title":"ETAS.inlabru (development version)","text":"Cleaned R package structure Added vignettes package website Renamed functions avoid “.” non-S3-method function names. Temporal.ETAS.* functions retain “.”, now.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/news/index.html","id":"etasinlabru-101","dir":"Changelog","previous_headings":"","what":"ETAS.inlabru 1.0.1","title":"ETAS.inlabru 1.0.1","text":"Initial package version.","code":""}]
