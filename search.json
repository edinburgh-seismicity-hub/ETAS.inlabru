[{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"load-packages","dir":"Articles","previous_headings":"Setup","what":"Load Packages","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"library(ETAS.inlabru) library(ggplot2)  library(rnaturalearth) library(terra) library(sf) library(ggspatial) library(rnaturalearthdata) library(dplyr) library(lubridate)  ## This is just the EPSG equivalent of WGS84 crs_wgs84 <- st_crs('EPSG:4326')"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"load-an-earthquake-catalogue","dir":"Articles","previous_headings":"","what":"Load an earthquake catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"Earthquake data stored -called earthquake catalogues. Many different catalogues exists region easy way decide one better. , provide HOmogenized instRUmental Seismic (HORUS) catalogue 1960 2020. can downloaded http://horus.bo.ingv./. subset (see data-raw/horus.R subset created) information Horus catalogue can loaded using data reports earthquake time string (time_string), longitude (lon) latitude (lat) epicentre, depth kilometres (depth), moment magnitude (M).","code":"# load ISIDE catalogue data(horus, package = \"ETAS.inlabru\")  # transform time string in Date object horus$time_date <- as.POSIXct(   horus$time_string,   format = \"%Y-%m-%dT%H:%M:%OS\" )  head(horus) #>           time_string     lon     lat depth    M           time_date #> 1 1960-01-03T20:19:34 15.3000 39.3000   290 6.34 1960-01-03 20:19:34 #> 2 1960-01-04T09:20:00 13.1667 43.1333     0 3.94 1960-01-04 09:20:00 #> 3 1960-01-06T15:17:34 12.7000 46.4833     4 4.69 1960-01-06 15:17:34 #> 4 1960-01-06T15:20:53 12.7000 46.4667     0 4.14 1960-01-06 15:20:53 #> 5 1960-01-06T15:31:00 12.7500 46.4333     0 3.00 1960-01-06 15:31:00 #> 6 1960-01-06T15:45:00 12.7500 46.4333     0 3.00 1960-01-06 15:45:00  # Set df_cat to be the catalogue we want to analyse and then use this below df_cat <- horus  # Add an integer id to each event df_cat$event_num <- seq.int(nrow(df_cat))  # Generate an sf version of the catalogue where the longitude and latitude are converted to a point object df_cat.sf<- st_as_sf(df_cat,                      coords = c(\"lon\", \"lat\"),                      crs = crs_wgs84)  head(df_cat.sf) #> Simple feature collection with 6 features and 5 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 12.7 ymin: 39.3 xmax: 15.3 ymax: 46.4833 #> Geodetic CRS:  WGS 84 #>           time_string depth    M           time_date event_num #> 1 1960-01-03T20:19:34   290 6.34 1960-01-03 20:19:34         1 #> 2 1960-01-04T09:20:00     0 3.94 1960-01-04 09:20:00         2 #> 3 1960-01-06T15:17:34     4 4.69 1960-01-06 15:17:34         3 #> 4 1960-01-06T15:20:53     0 4.14 1960-01-06 15:20:53         4 #> 5 1960-01-06T15:31:00     0 3.00 1960-01-06 15:31:00         5 #> 6 1960-01-06T15:45:00     0 3.00 1960-01-06 15:45:00         6 #>                  geometry #> 1       POINT (15.3 39.3) #> 2 POINT (13.1667 43.1333) #> 3    POINT (12.7 46.4833) #> 4    POINT (12.7 46.4667) #> 5   POINT (12.75 46.4333) #> 6   POINT (12.75 46.4333)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"get-map-and-extract-crs-for-the-map","dir":"Articles","previous_headings":"Load an earthquake catalogue","what":"Get map and extract crs for the map","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"download polygon file national boundary Italy use later notebook.","code":"italy.map <- ne_countries(country = 'Italy', returnclass = \"sf\", scale = 'medium') italy.crs <- crs(italy.map) print(italy.crs) #> [1] \"BOUNDCRS[\\n    SOURCECRS[\\n        GEOGCRS[\\\"unknown\\\",\\n            DATUM[\\\"World Geodetic System 1984\\\",\\n                ELLIPSOID[\\\"WGS 84\\\",6378137,298.257223563,\\n                    LENGTHUNIT[\\\"metre\\\",1]],\\n                ID[\\\"EPSG\\\",6326]],\\n            PRIMEM[\\\"Greenwich\\\",0,\\n                ANGLEUNIT[\\\"degree\\\",0.0174532925199433],\\n                ID[\\\"EPSG\\\",8901]],\\n            CS[ellipsoidal,2],\\n                AXIS[\\\"longitude\\\",east,\\n                    ORDER[1],\\n                    ANGLEUNIT[\\\"degree\\\",0.0174532925199433,\\n                        ID[\\\"EPSG\\\",9122]]],\\n                AXIS[\\\"latitude\\\",north,\\n                    ORDER[2],\\n                    ANGLEUNIT[\\\"degree\\\",0.0174532925199433,\\n                        ID[\\\"EPSG\\\",9122]]]]],\\n    TARGETCRS[\\n        GEOGCRS[\\\"WGS 84\\\",\\n            DATUM[\\\"World Geodetic System 1984\\\",\\n                ELLIPSOID[\\\"WGS 84\\\",6378137,298.257223563,\\n                    LENGTHUNIT[\\\"metre\\\",1]]],\\n            PRIMEM[\\\"Greenwich\\\",0,\\n                ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n            CS[ellipsoidal,2],\\n                AXIS[\\\"geodetic latitude (Lat)\\\",north,\\n                    ORDER[1],\\n                    ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n                AXIS[\\\"geodetic longitude (Lon)\\\",east,\\n                    ORDER[2],\\n                    ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n            ID[\\\"EPSG\\\",4326]]],\\n    ABRIDGEDTRANSFORMATION[\\\"Transformation from unknown to WGS84\\\",\\n        METHOD[\\\"Geocentric translations (geog2D domain)\\\",\\n            ID[\\\"EPSG\\\",9603]],\\n        PARAMETER[\\\"X-axis translation\\\",0,\\n            ID[\\\"EPSG\\\",8605]],\\n        PARAMETER[\\\"Y-axis translation\\\",0,\\n            ID[\\\"EPSG\\\",8606]],\\n        PARAMETER[\\\"Z-axis translation\\\",0,\\n            ID[\\\"EPSG\\\",8607]]]]\"  ggplot() +    geom_sf(data = italy.map) +    theme_bw() +   ggtitle(\"Map of the Italian territorial boundary and coastline\")"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"histogram-of-event-depths","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Histogram of event depths","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"hist(df_cat$depth, breaks=seq(650,-5,-1), xlim=c(-5,40), main=\"Histogram of depths\", xlab=\"Depth [km]\")"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"plot-of-event-magnitudes-using-natural-time","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Plot of event magnitudes using natural time","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"Natural time refers plot event evenly spaced along x-axis. advantage data occurs periods high activity spread , means can see structure data rates high. plot magnitude events y-axis natural time horizontal. observations : 40,000 events magnitude data cluster events \\(M=0\\) likely artefact catalogue generated period time data rounded 1 decimal place producing horizontal banding times, data rounded sensitivity lowest magnitudes varies time can seen changes lowest magnitudes","code":"ggplot(df_cat, aes(x=event_num, y=M))  +    geom_point(size = 0.1) +   ggtitle('Magnitude timeseries using natural time')"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"plot-of-event-magnitudes-using-date-time","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Plot of event magnitudes using date-time","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"present data previous plot, plotted data-time. Clustered events now sit top . get better representaion data density increases towards modern day magnitude incompleteness varyies time.  number events occuring year difficult assess plot, group data year count number events occuring year. plot shows number events recorded year gradually increasing. artefact due gradual increase sensitivity network, seismicity systematically increasing.","code":"ggplot(df_cat, aes(x=time_date, y=M)) +    geom_point(size = 0.1) +   ggtitle(\"Horus catalogue magnitude time series\") #> Warning: Removed 1 rows containing missing values (`geom_point()`). df_cat$Time <- as.Date(df_cat$time_date)   print(\"Extract year\") #> [1] \"Extract year\" # extract the year and convert to numeric format df_cat$Year <- as.numeric(format(df_cat$Time, \"%Y\"))  countEventsInYear <- df_cat %>%   group_by(Year) %>%   summarize(counts = n())  plot(countEventsInYear, type=\"l\", main=\"Annual number of events for whole catalogue\") # Filtered for M>4 ggplot(df_cat[df_cat$M>4,], aes(x=time_date, y=M)) +    geom_point(size = 0.1) +   ggtitle(\"Whole catalogue magnitude timeseries for M>4\") #> Warning: Removed 1 rows containing missing values (`geom_point()`). countEventsInYear <- df_cat[df_cat$M>=4,] %>%   group_by(Year) %>%   summarize(counts = n())  plot(countEventsInYear, type=\"l\", main=\"Annual number of events with M>=4\") abline(h=mean(countEventsInYear), col=2) #> Warning in mean.default(countEventsInYear): argument is not numeric or logical: #> returning NA"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"frequency-magnitude-analysis-for-horus-catalogue","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Frequency-magnitude analysis for Horus catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"traditional GR plot shows cumulative data (red) also show incremental data (black). personally prefer looking incremental data correlated therefore easier understand Poisson counting errors account uncertainty data. three domains standard GR plot. - low magnitudes always incompleteness due limitations monitoring network - requirement GR good model log-linear portion data slope stable, slope refered b-value - high magnitudes always fluctuations magnitudes due effect counting errors bins low rates","code":"minMag <- 1.5 maxMag <- max(df_cat$M)  mags <- df_cat[df_cat$M>minMag,]$M  tmp <- hist(mags, breaks=seq(minMag-0.05,maxMag+0.1,0.1), plot=FALSE)  N.counts <- length( tmp$counts) tmp$cumulativeCounts <- cumsum(tmp$counts[N.counts:1])[N.counts:1]  m.min <- 4 bin_m.min <- which(tmp$mids==m.min) freq_m.min <- tmp$counts[bin_m.min] b <- 1 x <- tmp$mids y <- freq_m.min * 10^(-b*(x-m.min)) y.cum <- tmp$cumulativeCounts[bin_m.min] * 10^(-b*(x-m.min))  ggplot() +   geom_point( aes(x=tmp$mids, y=tmp$counts) ) +   geom_point( aes(x=tmp$mids, y=tmp$cumulativeCounts) , color='red', pch=\"+\", size=2) +   scale_y_log10() +   ggtitle(paste(\"Frequency-magnitude plot with arbitary GR dist: b =\", b)) +   xlab(\"Magnitude\") +   ylab(\"log10(Frequency)\") +   geom_line(aes(x=x, y=y)) +   geom_line(aes(x=x, y=y.cum), color='red') +   geom_vline( xintercept=m.min, lty=2 ) #> Warning: Transformation introduced infinite values in continuous y-axis"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"b-value-stability-plot-for-the-events-in-the-horus-catalogue","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"b-value stability plot for the events in the Horus catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"minMag <- 0 maxMag <- max(df_cat$M, na.rm=TRUE) mags <- df_cat[df_cat$M>=minMag,]$M  x <- seq(minMag,maxMag,0.1)  b.stability.list <- c() b.error.list <- c() m.mean <- c()  b_utsu <- c() b_guttorp <- c() b_elst <- c() delta_b_utsu <- c() b_elst_lower <- c() b_elst_upper <- c()  max.index.x <- length(x)-5  for( i in 1:max.index.x ){   mag.threshold <- x[i]   mags.subset <- mags[mags > mag.threshold]      N <- length(mags.subset)   b_utsu[i] <- 1/( log(10)*(mean(mags.subset)-mag.threshold+0.05))   delta_b_utsu[i] <- log(10)*b_utsu[i]**2 * sqrt( sum((mags.subset - mean(mags.subset))**2)/(N*(N-1)))        b_guttorp[i] = 1/( 2*0.05*log(10))*log((mean(mags.subset)-mag.threshold+2*0.05)/(mean(mags.subset)-mag.threshold))        deltaMags <- diff(mags.subset)   deltaMags_p <- deltaMags[deltaMags>0.1]   N <- length(deltaMags_p)   b_elst[i] <- 1/(2*0.05* log(10)) * log((mean(deltaMags_p))/(mean(deltaMags_p)-0.1))   c = 10**(0.1*b_elst[i])   b_elst_lower[i] <- 1/(0.1 * log(10)) * log((c+sqrt(c/N))/(1+sqrt(c/N)))   b_elst_upper[i] <- 1/(0.1 * log(10)) * log((c-sqrt(c/N))/(1-sqrt(c/N))) }  ggplot() +   geom_line( aes(x=x[1:max.index.x], y=b_utsu) ) +   geom_line( aes(x=x[1:max.index.x], y=b_utsu+delta_b_utsu), color=2, lty=2 ) +   geom_line( aes(x=x[1:max.index.x], y=b_utsu-delta_b_utsu), color=2, lty=2 ) +   geom_line( aes(x=x[1:max.index.x], y=b_guttorp), color=3, lty=1 ) +   xlab(\"Magnitude threshold\") +   ylab(\"b-value estimate\") +   geom_hline(yintercept = 1, lty=3) +   geom_hline(yintercept = 0.85, lty=3) +   ggtitle(\"b-value stability plot for Horus catalogue\")"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"heatmap-of-the-events-in-the-horus-catalogue","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Heatmap of the events in the Horus catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"ggplot() +   geom_hex(data = df_cat[df_cat$M>3,], aes(x = lon, y = lat), bins = 50) +   scale_fill_continuous(type = \"viridis\") +   geom_sf(data = italy.map, fill=alpha(\"lightgrey\", 0), color = 'orange', size=0.2) +    ggtitle(\"Density plot for M>3 events\") +   theme_bw()"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"map-of-the-events-in-the-italian-horus-catalogue","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Map of the events in the Italian Horus catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"plot location seismicity map. outline Italy territory shown green.","code":"ggplot() +   geom_sf(data = df_cat.sf[df_cat$M>3,], size = 0.05) +   geom_sf(data = italy.map, fill=alpha(\"lightgrey\", 0), color = 'green', linewidth=0.7) +   geom_sf(data = df_cat.sf[df_cat$M>5,], size = 0.5, color='orange') +   geom_sf(data = df_cat.sf[df_cat$M>6,], size = 0.5, color='red') +   ggtitle(\"Map of event locations\")"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"analysis-if-the-laquila-sequence","dir":"Articles","previous_headings":"","what":"Analysis if the L’Aquila Sequence","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"focus L Aquila seismic sequence sufficient retain observations specific space-time-magnitude region include sequence interest. L’Aquila sequence, retain events magnitude greater equal \\(2.5\\) happened 2009 longitude \\((10.5, 16)\\) latitude \\((40.5, 45)\\). L’Aquila sequence selected way composed 1024 events. seismic sequence can selected similarly. selection convenient transform time string Date object select rows Horus catalogue verifying conditions. start.date = “2009-04-06 00:00:00 BST” end.date = “2010-01-01 00:00:00 BST” magnitude.completeness = 2.49 min.longitude = 13.00 max.longitude = 13.75 min.latitude = 42.2 max.latitude = 42.5","code":"eventDate <- ymd_hms( '2009-04-06 00:00:00' ) endDate <- eventDate + days(400) startDate <- eventDate - days(50) deltaLat <- 2.4 latLims <- c( 42.2,42.5) longLims <- c( 13, 13.75)  minMAG <- 0  # Subset the main catalogue df_cat.subset <- df_cat[df_cat$M >= minMAG, ] df_cat.subset <- df_cat.subset[ (df_cat.subset$lat>latLims[1]), ] df_cat.subset <- df_cat.subset[ (df_cat.subset$lat<latLims[2]), ] df_cat.subset <- df_cat.subset[ (df_cat.subset$lon>longLims[1]), ] df_cat.subset <- df_cat.subset[ (df_cat.subset$lon<longLims[2]), ]  head(df_cat.subset) #>             time_string     lon     lat depth    M           time_date #> 243 1961-03-25T10:40:00 13.3167 42.4333     0 3.64 1961-03-25 10:40:00 #> 295 1961-10-05T19:59:35 13.0167 42.3500     3 0.00 1961-10-05 19:59:35 #> 302 1961-10-31T00:00:00 13.0167 42.3500    10 3.94 1961-10-31 00:00:00 #> 303 1961-10-31T00:00:00 13.0167 42.3500    10 3.94 1961-10-31 00:00:00 #> 304 1961-10-31T13:37:18 13.0833 42.4167     4 4.64 1961-10-31 13:37:18 #> 305 1961-10-31T13:41:59 13.0833 42.4167     0 4.14 1961-10-31 13:41:59 #>     event_num       Time Year #> 243       243 1961-03-25 1961 #> 295       295 1961-10-05 1961 #> 302       302 1961-10-31 1961 #> 303       303 1961-10-31 1961 #> 304       304 1961-10-31 1961 #> 305       305 1961-10-31 1961"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"plot-of-the-event-magnitude-time-series-laquila","dir":"Articles","previous_headings":"Analysis if the L’Aquila Sequence","what":"Plot of the event magnitude time series: l’Aquila","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"ggplot() +    geom_point(data=df_cat.subset[df_cat.subset$M>3,], aes(time_date, lat), size=0.1) +   geom_point(data=df_cat.subset[df_cat.subset$M>5,], aes(time_date, lat), size=1.2, color='orange') +   geom_point(data=df_cat.subset[df_cat.subset$M>6,], aes(time_date, lat), size=1.5, color='red') +   ggtitle(\"L'Aquila latitude-time plot\") +   geom_rect(aes(xmin = as.POSIXct(startDate), xmax = as.POSIXct(endDate), ymin = latLims[1], ymax = latLims[2]), alpha = 0.4, fill='blue', color='blue') minMag <- 0 maxMag <- max(df_cat.subset$M, na.rm=TRUE)  mags <- df_cat.subset[df_cat.subset$M>=minMag,]$M  tmp <- hist(mags, breaks=seq(minMag-0.05,maxMag+0.4,0.1), plot=FALSE)  N.counts <- length( tmp$counts) tmp$cumulativeCounts <- cumsum(tmp$counts[N.counts:1])[N.counts:1]  m.min <- 4 bin_m.min <- which(tmp$mids==m.min) freq_m.min <- tmp$counts[bin_m.min] b <- 1. x <- tmp$mids y <- freq_m.min * 10^(-b*(x-m.min)) y.cum <- tmp$cumulativeCounts[bin_m.min] * 10^(-b*(x-m.min))  ggplot() +   geom_point( aes(x=tmp$mids, y=tmp$counts) ) +   geom_point( aes(x=tmp$mids, y=tmp$cumulativeCounts) , color='red', pch=\"+\") +   scale_y_log10() +   ggtitle(paste(\"Frequency-magnitude plot with arbitary GR dist: b =\", b)) +   xlab(\"Magnitude\") +   ylab(\"log10(Frequency)\") +   geom_line(aes(x=x, y=y)) +   geom_line(aes(x=x, y=y.cum), color='red') +   geom_vline( xintercept=m.min, lty=2 ) #> Warning: Transformation introduced infinite values in continuous y-axis #> Transformation introduced infinite values in continuous y-axis"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"b-value-stability-plot-laquila","dir":"Articles","previous_headings":"Analysis if the L’Aquila Sequence","what":"b-value stability plot: l’Aquila","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"minMag <- 0 maxMag <- max(df_cat.subset$M, na.rm=TRUE) mags <- df_cat.subset[df_cat.subset$M>=minMag,]$M  x <- seq(minMag,maxMag,0.1)  b.stability.list <- c() b.error.list <- c() m.mean <- c()  b_utsu <- c() b_guttorp <- c() b_elst <- c() delta_b_utsu <- c() b_elst_lower <- c() b_elst_upper <- c()  max.index.x <- length(x)-5  for( i in 1:max.index.x ){   mag.threshold <- x[i]   mags.subset <- mags[mags > mag.threshold]      N <- length(mags.subset)   b_utsu[i] <- 1/( log(10)*(mean(mags.subset)-mag.threshold+0.05))   delta_b_utsu[i] <- log(10)*b_utsu[i]**2 * sqrt( sum((mags.subset - mean(mags.subset))**2)/(N*(N-1)))        b_guttorp[i] = 1/( 2*0.05*log(10))*log((mean(mags.subset)-mag.threshold+2*0.05)/(mean(mags.subset)-mag.threshold))        deltaMags <- diff(mags.subset)   deltaMags_p <- deltaMags[deltaMags>0.1]   N <- length(deltaMags_p)   b_elst[i] <- 1/(2*0.05* log(10)) * log((mean(deltaMags_p))/(mean(deltaMags_p)-0.1))   c = 10**(0.1*b_elst[i])   b_elst_lower[i] <- 1/(0.1 * log(10)) * log((c+sqrt(c/N))/(1+sqrt(c/N)))   b_elst_upper[i] <- 1/(0.1 * log(10)) * log((c-sqrt(c/N))/(1-sqrt(c/N))) }  ggplot() +   geom_line( aes(x=x[1:max.index.x], y=b_utsu) ) +   geom_line( aes(x=x[1:max.index.x], y=b_utsu+delta_b_utsu), color=2, lty=2 ) +   geom_line( aes(x=x[1:max.index.x], y=b_utsu-delta_b_utsu), color=2, lty=2 ) +   geom_line( aes(x=x[1:max.index.x], y=b_guttorp), color=3, lty=1 ) +   xlab(\"Magnitude threshold\") +   ylab(\"b-value estimate\") +   geom_hline(yintercept = 1, lty=3) +   geom_hline(yintercept = 0.85, lty=3) +   ggtitle(\"b-value stability plot for the l'Aquila catalogue\") #> Warning: Removed 2 rows containing missing values (`geom_line()`). #> Removed 2 rows containing missing values (`geom_line()`)."},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/generateSyntheticCatalogues.html","id":"create-catalogue","dir":"Articles","previous_headings":"","what":"Create catalogue","title":"2a Temporal Model: Generating synthetic temporal ETAS catalogues","text":"define ETAS parameters define model domain specify history generate ETAS sample plot results","code":"mu <- 1070. / 365 K <- 0.089 alpha <- 2.29 c <- 0.011 p <- 1.08  modelledDuration <- 10 # [days]  M0 <- 2  theta_etas <- data.frame(mu = mu, K = K, alpha = alpha, c = c, p = p)  Ht <- data.frame(ts = c(0., 1.5), magnitudes = c(6.7, 7.))  samp.etas.list <- generate_temporal_ETAS_synthetic(theta = theta_etas, beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = Ht)  ggplot() +   geom_point(data = samp.etas.list[[1]], aes(x = ts, y = magnitudes), color = \"red\") +   geom_point(data = samp.etas.list[[2]], aes(x = ts, y = magnitudes), color = \"green\") +   xlim(0, modelledDuration) +   ggtitle(\"M7 plus background and ETAS\") combined.M7.ETAS.cat <- bind_rows(samp.etas.list)  combined.M7.ETAS.cat <- bind_rows(samp.etas.list) combined.M7.ETAS.cat <- combined.M7.ETAS.cat[order(combined.M7.ETAS.cat$ts), ]  combined.M7.ETAS.cat$ID <- seq(1, length(combined.M7.ETAS.cat$ts))  ggplot() +   geom_point(data = combined.M7.ETAS.cat, aes(x = ID, y = magnitudes), color = \"red\") #+ #  geom_ma(data = combined.M7.ETAS.cat, aes(x=ID, y=magnitudes), ma_fun = SMA, n = 10)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sampleFromETASpriors.html","id":"sampling-etas-priors","dir":"Articles","previous_headings":"","what":"Sampling ETAS Priors","title":"2b Temporal Model: Presenting samples drawn from the ETAS priors","text":"important check priors broad enough expect model parameterisation lie within . notebook shows draw samples priors present resulting triggering functions.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"multiple-analyses-of-two-catalogues-using-different-initial-values","dir":"Articles","previous_headings":"","what":"Multiple analyses of two catalogues using different initial values","title":"Sensitivity to starting point","text":"inlabru algorithm takes initial guess mode parameters inverting iteratively updates initial guess. potential may bad initial conditions find different solutions runtime differ depending upon solution converges. notebook, explore robustness posteriors two synthetic catalogues true parameters known. catalogues contain 2000 days data. One catalogue contain large event second contains M6.7 event day 1000.","code":"library(ETAS.inlabru)  library(tidyquant) library(gridExtra) library(grid) library(lemon) library(ggplot2) library(ggpubr) library(GGally)  library(inlabru) library(INLA) library(ETAS.inlabru)  # inla.setOption(pardiso.license=\"~/sys/licences/pardiso.lic\")  library(dplyr)  # Increase num.threads if you have more cores on your computer INLA::inla.setOption(num.threads = 2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"define-the-parameters-for-the-synthetic-catalogues-and-starting-values-for-inversion","dir":"Articles","previous_headings":"Multiple analyses of two catalogues using different initial values","what":"Define the parameters for the synthetic catalogues and starting values for inversion","title":"Sensitivity to starting point","text":"","code":"# Parameters we use to generate synthetics, which we will refer to as the 'true' parameters mu <- 0.1 K <- 0.089 alpha <- 2.29 c <- 0.11 p <- 1.08  # Format the true ETAS parameters for code to generate the synthetics theta_etas <- data.frame(mu = mu, K = K, alpha = alpha, c = c, p = p)  # A dataframe containing different starting values for the algorithm startingValues <- data.frame(   mu = c(5., mu),   K = c(1., K),   alpha = c(5., alpha),   c = c(0.3, c),   p = c(1.5, p) ) nRealisations <- length(startingValues$mu)   # Temporal duration of the synthetic catalogue in days modelledDuration <- 1000 # [days]  # The minimum magnitude that will be modelled M0 <- 2.5"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"generate-new-catalogues-and-save-them","dir":"Articles","previous_headings":"Multiple analyses of two catalogues using different initial values","what":"Generate new catalogues and save them","title":"Sensitivity to starting point","text":"vignette use Rmd caching, can save catalogues files explicitly:","code":"############ #### Generate the first catalogue with no large events  samp.etas.list <- generate_temporal_ETAS_synthetic(   theta = theta_etas,   beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = NULL )  quiet.ETAS.cat <- bind_rows(samp.etas.list) quiet.ETAS.cat <- quiet.ETAS.cat[order(quiet.ETAS.cat$ts), ] # quiet.ETAS.cat <- na.omit(quiet.ETAS.cat) ############ #### Generate the second catalogue with a M6.7 event on day 1000  Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) # Impose a M6.7 event on day 1000  samp.etas.list <- generate_temporal_ETAS_synthetic(theta = theta_etas, beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = Ht)  M6p7.ETAS.cat <- bind_rows(samp.etas.list) M6p7.ETAS.cat <- M6p7.ETAS.cat[order(M6p7.ETAS.cat$ts), ] # save(M6p7.ETAS.cat,file=\"M6p7_ETAS_cat.Rda\") # save(quiet.ETAS.cat,file=\"quiet.ETAS.cat.Rda\")"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"load-the-catalogues","dir":"Articles","previous_headings":"Present the catalogues","what":"Load the catalogues","title":"Sensitivity to starting point","text":"read saved object files:","code":"# load(\"M6p7_ETAS_cat.Rda\") # load(\"quiet.ETAS.cat.Rda\")"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-properties-of-the-catalogues","dir":"Articles","previous_headings":"Present the catalogues","what":"Plot properties of the catalogues","title":"Sensitivity to starting point","text":"","code":"plots <- list()  plots[[1]] <- ggplot() +   geom_point(data = quiet.ETAS.cat, aes(x = ts, y = magnitudes), size = 0.1, alpha = 0.5) +   xlim(0, modelledDuration) +   ggtitle(paste(\"A.  Unseeded catalog, nEvents =\", length(quiet.ETAS.cat$ts))) +   ylim(2, 7) +   xlab(\"Time [days]\") +   ylab(\"Magnitude\") +   theme_bw()  plots[[2]] <- ggplot() +   geom_point(data = M6p7.ETAS.cat, aes(x = ts, y = magnitudes), size = 0.1, alpha = 0.5) +   xlim(0, modelledDuration) +   ggtitle(paste(\"B.  Catalog seeded with M6.7 event on day 500, nEvents =\", length(M6p7.ETAS.cat$ts))) +   ylim(2, 7) +   xlab(\"Time [days]\") +   ylab(\"Magnitude\") +   theme_bw()   plt <- grid.arrange(plots[[1]], plots[[2]], ncol = 1, nrow = 2) # ggsave(\"initialConditionCats.png\", plt) # ggsave(\"initialConditionCats.pdf\", plt)"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"analysis-of-quiet-catalogue","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Analysis of quiet catalogue","title":"Sensitivity to starting point","text":"","code":"list.output.quietScenario <- list()  for (i in seq_len(nRealisations)) {   if (exists(\"list.input\")) remove(\"list.input\")    # Load a set of parameters that we will need to tweak for this application   fpath <- system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\")   list.input <- create_input_list_temporal_noCatalogue(fpath)    ####################   # Tweak the variables loaded from the input file   list.input$M0 <- M0   list.input$time.int <- c(0, modelledDuration)   list.input$T12 <- c(0, modelledDuration)    # Change the starting location, measured on the ETAS scale   list.input$mu.init <- startingValues$mu[i]   list.input$alpha.init <- startingValues$alpha[i]   list.input$K.init <- startingValues$K[i]   list.input$c.init <- startingValues$c[i]   list.input$p.init <- startingValues$p[i]    link.f <- list(     mu = \\(x) gamma_t(x, a_mu, b_mu),     K = \\(x) loggaus_t(x, a_K, b_K),     alpha = \\(x) unif_t(x, a_alpha, b_alpha),     c_ = \\(x) unif_t(x, a_c, b_c),     p = \\(x) unif_t(x, a_p, b_p)   )    # initial value - convert from ETAS scale to internal scale   list.input$th.init <- list(     th.mu = inv_gamma_t(list.input$mu.init, list.input$a_mu, list.input$b_mu),     th.K = inv_loggaus_t(list.input$K.init, list.input$a_K, list.input$b_K),     th.alpha = inv_unif_t(list.input$alpha.init, list.input$a_alpha, list.input$b_alpha),     th.c = inv_unif_t(list.input$c.init, list.input$a_c, list.input$b_c),     th.p = inv_unif_t(list.input$p.init, list.input$a_p, list.input$b_p)   )    # Define options for inlabru   if (is.null(list.input$max_step)) {     list.input$bru.opt.list <- list(       bru_verbose = 0, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       # bru_method = list(max_step = 0.5),       bru_initial = list.input$th.init     ) # parameters initial values   } else {     list.input$bru.opt.list <- list(       bru_verbose = 0, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       bru_method = list(max_step = list.input$max_step),       bru_initial = list.input$th.init     ) # parameters initial values   }    ## Add out catalogue to the input list   list.input$catalog <- data.frame(     time_diff = quiet.ETAS.cat$ts,     magnitudes = quiet.ETAS.cat$magnitudes   )    ## Add the catalogue formatted for bru   list.input$catalog.bru <- data.frame(     ts = quiet.ETAS.cat$ts,     magnitudes = quiet.ETAS.cat$magnitudes,     idx.p = seq_len(nrow(quiet.ETAS.cat))   )    ## Input list is now formatted   ####################    ## Run the model according to the input list   ETAS.model.fit <- Temporal.ETAS.fit(list.input)    ## Small bit of post processing   list.output.quietScenario[[i]] <- append(list.input, list(model.fit = ETAS.model.fit))   list.output.quietScenario[[i]]$runtime <- sum(list.output.quietScenario[[i]]$model.fit$bru_timings$Time)   list.output.quietScenario[[i]]$nEvents <- length(list.output.quietScenario[[i]]$catalog[, 1]) } #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  0.348856  #> Finish model fitting  #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  0.3291237  #> Finish model fitting"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"analysis-of-m6-7-catalogue","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Analysis of M6.7 catalogue","title":"Sensitivity to starting point","text":"","code":"list.output.M6p7Scenario <- list()  for (i in seq_len(nRealisations)) {   if (exists(\"list.input\")) {     remove(list.input)   }    # Load a set of parameters that we will need to tweak for this application   fpath <- system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\")   list.input <- create_input_list_temporal_noCatalogue(fpath)    ####################   # Tweak the variables laoded from the input file   list.input$M0 <- M0   list.input$time.int <- c(0, modelledDuration)   list.input$T12 <- c(0, modelledDuration)    # Change the starting location, measured on the ETAS scale   list.input$mu.init <- startingValues$mu[i]   list.input$alpha.init <- startingValues$alpha[i]   list.input$K.init <- startingValues$K[i]   list.input$c.init <- startingValues$c[i]   list.input$p.init <- startingValues$p[i]    link.f <- list(     mu = \\(x) gamma_t(x, a_mu, b_mu),     K = \\(x) loggaus_t(x, a_K, b_K),     alpha = \\(x) unif_t(x, a_alpha, b_alpha),     c_ = \\(x) unif_t(x, a_c, b_c),     p = \\(x) unif_t(x, a_p, b_p)   )    # initial value - convert from ETAS scale to internal scale   list.input$th.init <- list(     th.mu = inv_gamma_t(list.input$mu.init, list.input$a_mu, list.input$b_mu),     th.K = inv_loggaus_t(list.input$K.init, list.input$a_K, list.input$b_K),     th.alpha = inv_unif_t(list.input$alpha.init, list.input$a_alpha, list.input$b_alpha),     th.c = inv_unif_t(list.input$c.init, list.input$a_c, list.input$b_c),     th.p = inv_unif_t(list.input$p.init, list.input$a_p, list.input$b_p)   )    # Define options for inlabru   if (is.null(list.input$max_step)) {     list.input$bru.opt.list <- list(       bru_verbose = 3, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       # bru_method = list(max_step = 0.5),       bru_initial = list.input$th.init     ) # parameters initial values   } else {     list.input$bru.opt.list <- list(       bru_verbose = 3, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       bru_method = list(max_step = list.input$max_step),       bru_initial = list.input$th.init     ) # parameters initial values   }    ## Add out catalogue to the input list   list.input$catalog <- data.frame(     time_diff = M6p7.ETAS.cat$ts,     magnitudes = M6p7.ETAS.cat$magnitudes   )    ## Add the catalogue formatted for bru   list.input$catalog.bru <- data.frame(     ts = M6p7.ETAS.cat$ts,     magnitudes = M6p7.ETAS.cat$magnitudes,     idx.p = seq_len(nrow(M6p7.ETAS.cat))   )    ## Input list is now formatted   ####################    ## Run the model according to the input list   ETAS.model.fit <- Temporal.ETAS.fit(list.input)    ## Small bit of post processing   list.output.M6p7Scenario[[i]] <- append(list.input, list(model.fit = ETAS.model.fit))   list.output.M6p7Scenario[[i]]$runtime <- sum(list.output.M6p7Scenario[[i]]$model.fit$bru_timings$Time)   list.output.M6p7Scenario[[i]]$nEvents <- length(list.output.M6p7Scenario[[i]]$catalog[, 1]) } #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  7.238997 #> iinla: Evaluate component inputs #> iinla: Evaluate component linearisations #> iinla: Evaluate component simplifications #> iinla: Evaluate predictor linearisation #> iinla: Construct inla stack #> iinla: Model initialisation completed #> iinla: Iteration 1 [max:100] #> iinla: Step rescaling: 93.39%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Iteration 2 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 123.6%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 1540% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 3 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 91.17%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 2190% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 4 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 120.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 1110% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 5 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 104.4%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 605% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 6 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 107%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 232% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 7 [max:100] #> iinla: Step rescaling: 99.97%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 211% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 8 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.8%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 166% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 9 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.5%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 153% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 10 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.4%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 139% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 11 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.4%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 127% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 12 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 116% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 13 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 107% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 14 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 98.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 15 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 91.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 16 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 84.5% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 17 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 78.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 18 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 72.7% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 19 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 67.6% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 20 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 62.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 21 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 58.5% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 22 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 54.5% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 23 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 50.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 24 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 47.4% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 25 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 44.2% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 26 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 41.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 27 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 38.6% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 28 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 36% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 29 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 33.7% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 30 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 31.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 31 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 29.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 32 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 27.6% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 33 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 25.8% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 34 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 24.2% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 35 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 22.6% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 36 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 21.2% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 37 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 19.9% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 38 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 18.6% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 39 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 17.4% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 40 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 16.3% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 41 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 15.3% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 42 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 14.4% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 43 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 13.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 44 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 12.6% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 45 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 11.8% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 46 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 11.1% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 47 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 10.4% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 48 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 9.77% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Convergence criterion met, running final INLA integration with known theta mode. #> iinla: Iteration 49 [max:100] #> Finish model fitting  #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  7.361631 #> iinla: Evaluate component inputs #> iinla: Evaluate component linearisations #> iinla: Evaluate component simplifications #> iinla: Evaluate predictor linearisation #> iinla: Construct inla stack #> iinla: Model initialisation completed #> iinla: Iteration 1 [max:100] #> iinla: Step rescaling: 93.31%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Iteration 2 [max:100] #> iinla: Step rescaling: 98.36%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 40.9% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 3 [max:100] #> iinla: Step rescaling: 99.92%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 21.8% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 4 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 14% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 5 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 8.78% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Convergence criterion met, running final INLA integration with known theta mode. #> iinla: Iteration 6 [max:100] #> Finish model fitting"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-posteriors-with-corresponding-starting-values","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions > Analysis of M6.7 catalogue","what":"Plot posteriors with corresponding starting values","title":"Sensitivity to starting point","text":"","code":"plots <- list()  trueParas <- data.frame(value = c(mu, K, alpha, c, p), param = c(\"mu\", \"K\", \"alpha\", \"c\", \"p\"))  post.list <- get_posterior_param(input.list = list.output.quietScenario[[1]]) post.df <- post.list[[1]] post.df$id <- 1  for (i in 2:nRealisations) {   post.list <- get_posterior_param(input.list = list.output.quietScenario[[i]])   post.df.tmp <- post.list[[1]]   post.df.tmp$id <- i    post.df <- rbind(post.df, post.df.tmp) }  plots[[1]] <- ggplot(post.df, aes(x = x, y = y, group = id, color = factor(id), lty = factor(id))) +   geom_line() +   # scale_x_discrete(guide = guide_axis(check.overlap = TRUE)) +   facet_wrap(facets = vars(param), scales = \"free\", labeller = label_parsed, nrow = 1) +   geom_vline(aes(xintercept = value),     data = trueParas, color = \"black\", linetype = 2,     label = \"True value\"   ) +   labs(color = \"Initial ETAS Para. Set\", linetype = \"Initial ETAS Para. Set\") +   ggtitle(paste(\"A.  Inversion of a 1000 day catalogue with no large events, nEvents =\", length(quiet.ETAS.cat$ts))) +   xlab(\"ETAS Posteriors\") +   theme_bw() +   theme(axis.text.x = element_text(angle = 45, hjust = 1)) +   theme(legend.position = \"hidden\") +   theme(plot.title = element_text(size = 12)) #> Warning in geom_vline(aes(xintercept = value), data = trueParas, color = #> \"black\", : Ignoring unknown parameters: `label` trueParas <- data.frame(value = c(mu, K, alpha, c, p), param = c(\"mu\", \"K\", \"alpha\", \"c\", \"p\"))  post.list <- get_posterior_param(input.list = list.output.M6p7Scenario[[1]]) post.df <- post.list[[1]] post.df$id <- 2  for (i in 2:nRealisations) {   post.list <- get_posterior_param(input.list = list.output.M6p7Scenario[[i]])   post.df.tmp <- post.list[[1]]   post.df.tmp$id <- i    post.df <- rbind(post.df, post.df.tmp) }  plots[[2]] <- ggplot(post.df, aes(x = x, y = y, group = id, color = factor(id), lty = factor(id))) +   geom_line() +   # scale_x_discrete(guide = guide_axis(check.overlap = TRUE)) +   facet_wrap(facets = vars(param), scales = \"free\", labeller = label_parsed, nrow = 1) +   geom_vline(aes(xintercept = value),     data = trueParas, color = \"black\", linetype = 2,     label = \"True value\"   ) +   labs(color = \"Initial ETAS Para. Set\", linetype = \"Initial ETAS Para. Set\") +   ggtitle(paste(\"B. Inversion of a 1000 day catalogue with a M6.7 on day 500, nEvents =\", length(M6p7.ETAS.cat$ts))) +   xlab(\"ETAS Posteriors\") +   theme_bw() +   theme(axis.text.x = element_text(angle = 45, hjust = 1)) +   theme(legend.position = \"hidden\") +   theme(plot.title = element_text(size = 12)) #> Warning in geom_vline(aes(xintercept = value), data = trueParas, color = #> \"black\", : Ignoring unknown parameters: `label` plt <- grid_arrange_shared_legend(plots[[1]], plots[[2]], ncol = 1, nrow = 2, position = \"bottom\") plt #> TableGrob (2 x 1) \"arrange\": 2 grobs #>   z     cells    name              grob #> 1 1 (1-1,1-1) arrange   gtable[arrange] #> 2 2 (2-2,1-1) arrange gtable[guide-box] # ggsave(\"initialCondition_posteriors.png\", plt) # ggsave(\"initialCondition_posteriors.pdf\", plt)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"explore-etas-triggering-function-using-posterior-samples","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Explore ETAS triggering function using posterior samples","title":"Sensitivity to starting point","text":"","code":"plot_triggering <- list() plot_triggering[[1]] <- triggering_fun_plot(list.output.quietScenario[[1]], magnitude = 4, n.samp = 100) +   ggtitle(\"C. M4 triggering function\") +   theme_bw() +   ylim(0, 5.5) +   theme(plot.title = element_text(size = 8))  plot_triggering[[2]] <- triggering_fun_plot(list.output.M6p7Scenario[[1]], magnitude = 4, n.samp = 100) +   ggtitle(\"D. M4 triggering function\") +   theme_bw() +   ylim(0, 5.5) +   theme(plot.title = element_text(size = 8))  plot_triggering[[3]] <- triggering_fun_plot(list.output.quietScenario[[1]], magnitude = 6.7, n.samp = 100) +   ggtitle(\"E. M6.7 triggering function\") +   theme_bw() +   ylim(0, 1700) +   theme(plot.title = element_text(size = 8))   plot_triggering[[4]] <- triggering_fun_plot(list.output.M6p7Scenario[[1]], magnitude = 6.7, n.samp = 100) +   ggtitle(\"F. M6.7 triggering function\") +   theme_bw() +   ylim(0, 1700) +   theme(plot.title = element_text(size = 8))   plt <- grid.arrange(plot_triggering[[1]], plot_triggering[[3]], plot_triggering[[2]], plot_triggering[[4]], ncol = 2, nrow = 2, top = \"Triggering function variability\") +   theme(plot.title = element_text(size = 8)) #> Warning: Removed 27 rows containing missing values (`geom_line()`). #> Warning: Removed 1 row containing missing values (`geom_line()`). plt #> NULL  # ggsave(\"trigFuncVariability_runin.png\", plt) # ggsave(\"trigFuncVariability_runin.pdf\", plt) plot_omori <- list() plot_omori[[1]] <- omori_plot_posterior(list.output.quietScenario[[1]], n.samp = 100) +   ggtitle(\"A. Omori decay\") +   theme_bw() +   ylim(0, 1) +   theme(plot.title = element_text(size = 8))   plot_omori[[2]] <- omori_plot_posterior(list.output.M6p7Scenario[[1]], n.samp = 100) +   ggtitle(\"B. Omori decay\") +   theme_bw() +   ylim(0, 1) +   theme(plot.title = element_text(size = 8)) plt <- grid.arrange(plot_omori[[1]], plot_triggering[[1]], plot_triggering[[3]], plot_omori[[2]], plot_triggering[[2]], plot_triggering[[4]], ncol = 3, nrow = 2, top = \"Triggering  function variability\", left = \"M6.7 baseline            Unseeded baseline\") #> Warning: Removed 27 rows containing missing values (`geom_line()`). #> Warning: Removed 1 row containing missing values (`geom_line()`). plt #> TableGrob (3 x 4) \"arrange\": 8 grobs #>   z     cells    name                 grob #> 1 1 (2-2,2-2) arrange       gtable[layout] #> 2 2 (2-2,3-3) arrange       gtable[layout] #> 3 3 (2-2,4-4) arrange       gtable[layout] #> 4 4 (3-3,2-2) arrange       gtable[layout] #> 5 5 (3-3,3-3) arrange       gtable[layout] #> 6 6 (3-3,4-4) arrange       gtable[layout] #> 7 7 (1-1,2-4) arrange text[GRID.text.1299] #> 8 8 (1-3,1-1) arrange text[GRID.text.1300]  # ggsave(\"trigFuncVariability_runin.png\", plt) # ggsave(\"trigFuncVariability_runin.pdf\", plt)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-the-samples-from-the-joint-posteriors-as-pairs-plots","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Plot the samples from the joint posteriors as pairs plots","title":"Sensitivity to starting point","text":"","code":"post_pairs_plot(list.output.quietScenario[[1]], n.samp = 1000)$pair.plot post_pairs_plot(list.output.M6p7Scenario[[1]], n.samp = 1000)$pair_plot #> NULL"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"inlabru-convergence-diagnostics","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"inlabru convergence diagnostics","title":"Sensitivity to starting point","text":"can also assess convergence inlabru method , using bru_convergence_plot() function. can reveal starting values inlabru estimation unreasonable, better starting values nonlinear iterations might speed computations.","code":"bru_convergence_plot(list.output.quietScenario[[1]]$model.fit) bru_convergence_plot(list.output.quietScenario[[2]]$model.fit) bru_convergence_plot(list.output.M6p7Scenario[[1]]$model.fit) bru_convergence_plot(list.output.M6p7Scenario[[2]]$model.fit)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"introduction-to-etas-model","dir":"Articles","previous_headings":"","what":"Introduction to ETAS model","title":"2d Temporal Model: Tutorial on real data","text":"tutorial, show use ETAS.inlabru R-package fit temporal ETAS model real earthquakes data. tutorial shows prepare data, fit model, retrieve posterior distribution parameters posterior distribution quantities interest, generate synthetic catalogues fitted model, produce forecasts seismicity. Epidemic-Type Aftershock Sequence (ETAS) model belongs family Hawkes () point processes. temporal Hawkes process point process model conditional intensity given \\[ \\lambda(t | \\mathcal H_t) = \\mu + \\sum_{t_h \\\\mathcal H_t} g(t- t_h) \\] \\(\\mathcal H_t\\) history process time \\(t\\). Generally speaking \\(\\mathcal H_t\\) contains events occurred \\(t\\). quantity \\(\\mu > 0\\) usually called , interpreted rate events occur spontaneously. function \\(g(t-t_h)\\) called function (excitation function, simply kernel) measures influence event \\(t_h\\) time \\(t\\). look \\(g(t-t_h)\\) function \\(t\\) intensity point process representing offspring event \\(t_h\\). seismology offspring event called , two terms used synonyms. essence, Hawkes process model can seen superposition background process intensity \\(\\mu\\) aftershock processes generated observations \\(\\mathcal H_t\\) one intensity \\(g(t-t_h)\\). makes Hawkes process model particularly suitable describe phenomena event ability trigger additional events, phenomena characterized cascades events earthquakes, infectious diseases, wildfires, financial crisis, similar. ETAS model particular instance Hawkes process model proven particularly suitable model earthquake occurrence. Earthquakes usually described modelled marked time points marking variable magnitude event. history process composed time-magnitude pairs, namely \\(\\mathcal H_t = \\{(t_h,m_h), h = 1,...,N_h\\}\\). Various slightly different ETAS formulations exist, usually characterized slightly different triggering functions, one implemented ETAS.inlabru R-package conditional intensity given \\[ \\lambda(t | \\mathcal H_t) = \\mu + \\sum_{t_h \\\\mathcal H_t} K \\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] \\(M_0\\) cutoff magnitude \\(m_h \\geq M_0\\) \\(h\\). value decided priori based quality catalogue used. parameters model : \\(\\mu \\geq 0\\), background rate \\(K \\geq 0\\) general productivity parameter, plays role determining average number aftershocks induced event catalogue. \\(\\alpha \\geq 0\\) magnitude scaling parameter, determines number aftershocks changes based magnitude event generating aftershocks. non-negative reflect fact stronger earthquakes generate aftershocks. \\(c > 0\\) time offset parameter, smaller values associated catalogues fewer missing events. \\(p > 1\\) aftershock decay parameter, determines rate aftershock activity decreases time. greater 1 otherwise event may generate infinite number aftershocks infinite interval time thought unphysical.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"priors","dir":"Articles","previous_headings":"","what":"Priors","title":"2d Temporal Model: Tutorial on real data","text":"Bayesian analysis need decide priors parameters. approximation method use considers parameters two different scales: original ETAS scale, internal scale. internal scale used package perform calculations. internal scale parameters constraint standard normal distribution prior. need set priors parameters ETAS scale. done considering copula transformation \\(\\eta(X)\\) \\(X \\sim N(0,1)\\) , \\(\\eta(X)\\) desired distribution. ETAS.inlabru R-package provides four different functions corresponding three different distributions: gamma_t(X, , b) Gamma distribution shape parameter \\(\\) rate \\(b\\). distribution mean \\(/b\\) variance \\(/b^2\\). unit_t(X, , b) Uniform distribution \\(\\) \\(b\\). exp_t(X, r) Exponential distribution rate \\(r\\). loggaus_t(X, m ,s) Log-Gaussian distribution mean logarithm \\(m\\) standard deviation logarithm \\(s\\). code generate 1000 observations normal distribution, transform using functions provided package, shows empirical density estimated sample.  package also provide inverse functions retrieve value parameter internal scale value ETAS scale provided. example decided priors going use analysis, need store corresponding copula transformations list. list one element parameter model (\\(5\\)), element list must name corresponding parameter. names fixed mu, K, alpha, c_, p. parameter \\(c\\) referred c_ avoid clashing names R function c(). useful inverse functions also, list used set initial value parameters later. code assumes parameter \\(\\mu\\) Gamma distribution prior parameters \\(0.3\\) \\(0.6\\), parameters \\(K, \\alpha,\\) \\(c\\) Uniform prior \\((0,10)\\), parameter \\(p\\) Uniform prior \\((1,10)\\).","code":"# obtain sample from standard normal distribution X <- rnorm(1000) # apply copula transformations gamma.X <- gamma_t(X, 1, 2) unif.X <- unif_t(X, 0, 1) exp.X <- exp_t(X, 1) loggaus.X <- loggaus_t(X, 0.5, 0.5)  # build data.frame for plotting df.to.plot <- rbind(   data.frame(     value = X,     distribution = \"Std Normal\"   ),   data.frame(     value = gamma.X,     distribution = \"Gamma\"   ),   data.frame(     value = unif.X,     distribution = \"Uniform\"   ),   data.frame(     value = exp.X,     distribution = \"Exponential\"   ),   data.frame(     value = loggaus.X,     distribution = \"Log-Gaussian\"   ) ) # plot them ggplot(df.to.plot, aes(value)) +   geom_histogram() +   theme_bw() +   facet_wrap(facets = ~distribution, scales = \"free\") #> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. inv_gamma_t(gamma_t(1.2, 1, 2), 1, 2) #> [1] 1.2 inv_unif_t(unif_t(1.2, 1, 2), 1, 2) #> [1] 1.2 inv_exp_t(exp_t(1.2, 1), 1) #> [1] 1.2 inv_loggaus_t(loggaus_t(1.2, 1, 2), 1, 2) #> [1] 1.2 # set copula transformations list link.f <- list(   mu = \\(x) gamma_t(x, 0.3, 0.6),   K = \\(x) unif_t(x, 0, 10),   alpha = \\(x) unif_t(x, 0, 10),   c_ = \\(x) unif_t(x, 0, 10),   p = \\(x) unif_t(x, 1, 10) )  # set inverse copula transformations list inv.link.f <- list(   mu = \\(x) inv_gamma_t(x, 0.3, 0.6),   K = \\(x) inv_unif_t(x, 0, 10),   alpha = \\(x) inv_unif_t(x, 0, 10),   c_ = \\(x) inv_unif_t(x, 0, 10),   p = \\(x) inv_unif_t(x, 1, 10) )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"laquila-seismic-sequence","dir":"Articles","previous_headings":"","what":"L’Aquila seismic sequence","title":"2d Temporal Model: Tutorial on real data","text":"Earthquake data stored -called earthquake catalogues. Many different catalogues exists region easy way decide one better. , provide subset HOmogenized instRUmental Seismic (HORUS) catalogue 1960 2020. can downloaded http://horus.bo.ingv./. See data-raw/horus.R details subset created original data set. HORUS catalogue subset can accessed directly using horus ETAS.inlabru::horus: documentation data set available via ?horus. data reports earthquake time string (time_string), longitude (lon) latitude (lat) epicentre, depth kilometres (depth), moment magnitude (M). focus L’Aquila seismic sequence sufficient retain observations specific space-time-magnitude region include sequence interest. L’Aquila sequence, retain events magnitude greater equal \\(2.5\\) happened 2009 longitude \\((10.5, 16)\\) latitude \\((40.5, 45)\\). L’Aquila sequence selected way composed 1024 events. seismic sequence can selected similarly. selection convenient transform time string Date object select rows Horus catalogue verifying conditions. data can visually represented plotting time event magnitude. shows clustering observations correspondance high magnitude events. L’Aquila seismic sequence, times versus magnitudes","code":"# load ISIDE catalogue head(horus) #>           time_string     lon     lat depth    M #> 1 1960-01-03T20:19:34 15.3000 39.3000   290 6.34 #> 2 1960-01-04T09:20:00 13.1667 43.1333     0 3.94 #> 3 1960-01-06T15:17:34 12.7000 46.4833     4 4.69 #> 4 1960-01-06T15:20:53 12.7000 46.4667     0 4.14 #> 5 1960-01-06T15:31:00 12.7500 46.4333     0 3.00 #> 6 1960-01-06T15:45:00 12.7500 46.4333     0 3.00 # transform time string in Date object horus$time_date <- as.POSIXct(   horus$time_string,   format = \"%Y-%m-%dT%H:%M:%OS\" )  # set up parameters for selection start.date <- as.POSIXct(\"2009-01-01T00:00:00\", format = \"%Y-%m-%dT%H:%M:%OS\") end.date <- as.POSIXct(\"2010-01-01T00:00:00\", format = \"%Y-%m-%dT%H:%M:%OS\") min.longitude <- 10.5 max.longitude <- 16 min.latitude <- 40.5 max.latitude <- 45 M0 <- 2.5  # set up conditions for selection aquila.sel <- (horus$time_date >= start.date) &   (horus$time_date < end.date) &   (horus$lon >= min.longitude) &   (horus$lon <= max.longitude) &   (horus$lat >= min.latitude) &   (horus$lat <= max.latitude) &   (horus$M >= M0)  # select aquila <- horus[aquila.sel, ] ggplot(aquila, aes(time_date, M)) +   geom_point() +   theme_bw()"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"data-preparation-to-model-fitting","dir":"Articles","previous_headings":"","what":"Data preparation to model fitting","title":"2d Temporal Model: Tutorial on real data","text":"need prepare data.frame used input data fit ETAS model. data.frame must three columns: ts time difference starting date occurrence time events (measured days example), magnitudes magnitude events, idx.p index column different value event. names fixed changed , need set initial values parameters list containing inlabru options used. initial values stored list elements th.mu, th.K, th.alpha, th.c, th.p corresponds ETAS parameters. initial values must provided internal scale therefore useful retrieve using inverse copula transformations set . way, can find values parameters internal scale given value parameters ETAS scale. example uses \\(\\mu = 0.5, K = 0.1, \\alpha = 1, c = 0.1,\\) \\(p = 1.1\\) initial values. crucial set initial values cause numerical problems, general achieved setting initial values zero. values provided worked well various examples. Lastly, need set list inlabru options. main elements list : bru_verbose: number indicating type diagnostic output. Set 0 output. bru_max_iter: maximum number iterations. set max_step inlabru algorithm stops stopping criterion met. However, setting max_step values smaller 1 forces algorithm run exactly bru_max_iter iterations. bru_method: relevant , thing may need set max_step argument. algorithm converge without fixing max_step suggest try fix value 1, experience \\(0.5\\) \\(0.2\\) works well. example line setting bru_method commented. bru_initial: list initial values created . Note: option list, one can also set number threads allowed INLA , e.g. num.threads = 8. override global option set beginning tutorial. code likely run many different systems, using global setting easier manage.","code":"# set up data.frame for model fitting aquila.bru <- data.frame(   ts = as.numeric(     difftime(aquila$time_date, start.date, units = \"days\")   ),   magnitudes = aquila$M,   idx.p = 1:nrow(aquila) ) # set up list of initial values th.init <- list(   th.mu = inv.link.f$mu(0.5),   th.K = inv.link.f$K(0.1),   th.alpha = inv.link.f$alpha(1),   th.c = inv.link.f$c_(0.1),   th.p = inv.link.f$p(1.1) ) # set up list of bru options bru.opt.list <- list(   bru_verbose = 3, # type of visual output   bru_max_iter = 70, # maximum number of iterations   # bru_method = list(max_step = 0.5),   bru_initial = th.init # parameters' initial values )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"model-fitting","dir":"Articles","previous_headings":"","what":"Model fitting","title":"2d Temporal Model: Tutorial on real data","text":"function Temporal.ETAS fit ETAS model returns bru object output. required inputs : total.data: data.frame containing observed events. format described previous Section. M0: cutoff magnitude. events total.data must magnitude greater equal number. T1: starting time time interval want fit model. T2: end time time interval want fit model. link.functions: list copula transformation functions format described previous sections. coef.t., delta.t., N.max.: parameters temporal binning. binning strategy described Appendix B paper Approximation Bayesian Hawkes process inlabru. parameters corresponds coef.t.\\(=\\delta\\), delta.t.\\(=\\Delta\\), N.max.\\(=n_{\\max}\\). bru.opt: list inlabru options described previous Section.","code":"# set starting and time of the time interval used for model fitting. In this case, we use the interval covered by the data. T1 <- 0 T2 <- max(aquila.bru$ts) + 0.2 # fit the model aquila.fit <- Temporal.ETAS(   total.data = aquila.bru,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  2.667483"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"create-input-list","dir":"Articles","previous_headings":"","what":"Create input list","title":"2d Temporal Model: Tutorial on real data","text":"model fitted package ETAS.inlabru offers various functions visually explore output. require input list. list must different elements depending function going use. retrieve posterior parameters sample posterior parameters need two elements: model.fit: output Temporal.ETAS link.functions: list copula transformations","code":"# create input list to explore model output input_list <- list(   model.fit = aquila.fit,   link.functions = link.f )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"check-marginal-posterior-distributions","dir":"Articles","previous_headings":"","what":"Check marginal posterior distributions","title":"2d Temporal Model: Tutorial on real data","text":"function get_posterior_param can use retrieve marginal posteriors parameters ETAS scale. function returns list elements: post.df: data.frame containing posterior parameters. data.frame three columns, x value parameter, y corresponding value posterior, param indicates ETAS parameter x y referring . post.plot: ggplot object containing plot marginal posteriors parameters","code":"# get marginal posterior information post.list <- get_posterior_param(input.list = input_list)  # plot marginal posteriors post.list$post.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"sample-the-joint-posterior-and-make-pair-plot","dir":"Articles","previous_headings":"","what":"Sample the joint posterior and make pair plot","title":"2d Temporal Model: Tutorial on real data","text":"function post_sampling generate samples joint posterior ETAS parameters. function takes input: input.list: list model.fit element link.functions elements described . n.samp: number posterior samples. max.batch: number posterior samples generated simultaneously. n.samp\\(>\\)max.batch, , samples generated parallel batches maximum size equal max.batch. Default \\(1000\\). ncore: number cores used parallel n.samp\\(>\\)max.batch. function returns data.frame columns corresponding ETAS parameters posterior samples can used analyse correlation parameters. function post_pairs_plot generate pair plot posterior samples taken input. function 4 arguments need specified. input : post.samp: data.frame samples joint posterior distribution parameters. NULL samples generated function . input.list: input list arguments model.fit link.functions used generate posterior samples. used post.samp = NULL. Default NULL. n.samp: number posterior samples. NULL, samples post.samp used. post.samp NULL, n.samp samples generated joint posterior. post.samp n.samp NULL n.samp samples randomly (uniformly replacement) selected post.samp. Default NULL max.batch number posterior samples generated simultaneously. used post.samp NULL. Default NULL function returns list two elements: post.samp posterior samples, pair.plot ggplot object containing pair plot.","code":"post.samp <- post_sampling(   input.list = input_list,   n.samp = 1000,   max.batch = 1000,   ncore = 1 )  head(post.samp) #>          mu         K    alpha          c        p #> 1 0.2891900 0.1390311 2.413904 0.07262829 1.180244 #> 2 0.3408133 0.1443367 2.435482 0.07025947 1.214066 #> 3 0.2558231 0.1834828 2.408376 0.05343864 1.165728 #> 4 0.2952213 0.1162077 2.446593 0.07699642 1.166865 #> 5 0.2775213 0.1094046 2.434099 0.09802999 1.194178 #> 6 0.2476919 0.1246622 2.453869 0.06700295 1.159281 pair.plot <- post_pairs_plot(   post.samp = post.samp,   input.list = NULL,   n.samp = NULL,   max.batch = 1000 ) #> Registered S3 method overwritten by 'GGally': #>   method from    #>   +.gg   ggplot2 pair.plot$pair.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"check-posterior-number-of-events","dir":"Articles","previous_headings":"","what":"Check posterior number of events","title":"2d Temporal Model: Tutorial on real data","text":"quantity interest posterior distribution number events. can accessed using function get_posterior_N requires input list. However, list needs additional elements respect one used now. Specifically, need add T12 extremes time interval want calculate number events, M0 cutoff magnitude, catalog.bru data.frame containing observed events. latter format total.data used Temporal.ETAS function. function returns list three elements: post.plot plot distribution, post.plot.shaded plot distribution shaded regions representing \\(95\\%\\) interval distribution, post.df data.frame used generate plots. vertical line plots represent number events catalog.bru element input list.","code":"# set additional elements of the list input_list$T12 <- c(T1, T2) input_list$M0 <- M0 input_list$catalog.bru <- aquila.bru N.post <- get_posterior_N(input.list = input_list) N.post$post.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"posterior-of-the-triggering-function-and-omori-law","dir":"Articles","previous_headings":"","what":"Posterior of the triggering function and Omori law","title":"2d Temporal Model: Tutorial on real data","text":"functions triggering_fun_plot triggering_fun_plot_prior plot, respectively, quantiles posterior prior distribution triggering function \\(g(t-t_h, mh)\\), namely, \\[ g(t - t_h, m_h) = K\\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] function takes input input.list: input list defined functions used previously. post.samp: data.frame samples posterior distribution parameters. NULL, n.samp samples generated posterior. n.samp: number posterior samples parameters used generated. magnitude: magnitude event (\\(m_h\\)). t.end: maximum value \\(t\\) plot. n.breaks: number breaks interval \\((0, \\texttt{t.end})\\) divided. function returns ggplot object. sample parameters triggering function \\(0\\) t.end calculated. black solid lines represents \\(95\\%\\) posterior interval function, grey lines represent triggering function calculated posterior samples, horizontal red lines represent \\(95\\%\\) posterior interval background rate \\(\\mu\\). function triggering_fun_plot_prior value parameters sampled according prior distribution rather posterior, therefore, need specify posterior samples data.frame.   functions omori_plot_posterior omori_plot_prior functions triggering_fun_plot triggering_fun_plot_prior considering \\[ \\left(\\frac{t- t_h}{c} + 1\\right)^{-p} \\] instead whole triggering function without background rate.","code":"triggering_fun_plot(   input.list = input_list,   post.samp = post.samp,   n.samp = NULL, magnitude = 4,   t.end = 5, n.breaks = 100 ) triggering_fun_plot_prior(input.list = input_list, magnitude = 4, n.samp = 1000, t.end = 10) omori_plot_posterior(input.list = input_list, post.samp = post.samp, n.samp = NULL, t.end = 5) omori_plot_prior(input.list = input_list, n.samp = 1000, t.end = 5)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"generate-synthetic-catalogues-from-model","dir":"Articles","previous_headings":"","what":"Generate synthetic catalogues from model","title":"2d Temporal Model: Tutorial on real data","text":"earthquake forecast usually composed collection synthetic catalogues model. package ETAS.inlabru provides function generate synthetic catalogues given set parameters. can used produce forecasts simply produce synthetic catalogues. function generate synthetic catalogues called generate_temporal_ETAS_synthetic takes input theta: list ETAS parameters names mu, K, alpha, c, p, corresponding ETAS parameters. beta.p: parameter magnitude distribution M0: cutoff magnitude, generated event magnitude greater M0. T1: starting time catalogue (unit measure depends unit used fit model). T2: end time catalogue (unit measure depends unit used fit model). Ht: set known events. can also T1 T2, useful want generate catalogues imposed events. Regarding magnitude distribution, exponential, specificically assume \\[ m - M_0 \\sim \\text{Exp}(\\beta) \\] parameter \\(\\beta\\) usually estimated independently ETAS parameters. use maximum likelihood estimator \\(\\beta\\) given \\[ \\hat\\beta = \\frac{1}{\\bar{m} - M_0} \\] \\(\\bar m\\) mean observed magnitudes values. function returns list data.frame, element output list corresponds different generation. data.frame three columns: occurence time (ts), magnitude (magnitudes), generation identifier (gen). generation identifier uses following convention, \\(-1\\) indicates events Ht time T1 T2, \\(0\\) indicates first generation offspring events gen equal \\(-1\\), \\(1\\) indicates background events, \\(2\\) offspring events gen equal \\(0\\) \\(1\\), \\(3\\) indicates offspring events gen equal \\(2\\), \\(4\\) indicates offspring events gen equal \\(3\\), . obtain unique data.frame containing simulated events sufficient bind rows generations. example generate 1 synthetic catalogue using parameters one posterior samples generated . catalogue covers time span L’Aquila catalogue impose greatest event sequence.  can easily generate multiple catalogues. code generates 8 catalogues using different samples posterior distribution parameters. red point indicates event imposed last panel represents observed L’Aquila sequence.","code":"# maximum likelihood estimator for beta beta.p <- 1 / (mean(aquila.bru$magnitudes) - M0) synth.cat.list <- generate_temporal_ETAS_synthetic(   theta = post.samp[1, ], # ETAS parameters   beta.p = beta.p, # magnitude distribution parameter   M0 = M0, # cutoff magnitude   T1 = T1, # starting time   T2 = T2, # end time   Ht = aquila.bru[which.max(aquila.bru$magnitudes), ] # known events ) # merge into unique data.frame synth.cat.df <- do.call(rbind, synth.cat.list) # order events by time synth.cat.df <- synth.cat.df[order(synth.cat.df$ts), ]  ggplot(synth.cat.df, aes(ts, magnitudes, color = as.factor(gen))) +   geom_point(size = 0.5) set.seed(2) n.cat <- 8 # generate catalogues as list of lists multi.synth.cat.list <- lapply(seq_len(n.cat), \\(x) generate_temporal_ETAS_synthetic(   theta = post.samp[x, ],   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = aquila.bru[which.max(aquila.bru$magnitudes), ] ))  # store catalogues as list of data.frames multi.synth.cat.list.df <- lapply(multi.synth.cat.list, \\(x) do.call(rbind, x)) # set catalogue identifier multi.synth.cat.list.df <- lapply(seq_len(n.cat), \\(x) cbind(multi.synth.cat.list.df[[x]],   cat.idx = x )) # merge catalogues in unique data.frame multi.synth.cat.df <- do.call(rbind, multi.synth.cat.list.df)  # we need to bing the synthetics with the observed catalogue for plotting cat.df.for.plotting <- rbind(   multi.synth.cat.df,   cbind(aquila.bru[, c(\"ts\", \"magnitudes\")],     gen = NA,     cat.idx = \"observed\"   ) )  # plot them ggplot(cat.df.for.plotting, aes(ts, magnitudes)) +   geom_point(size = 0.5) +   geom_point(     data = aquila.bru[which.max(aquila.bru$magnitudes), ],     mapping = aes(ts, magnitudes),     color = \"red\"   ) +   facet_wrap(facets = ~cat.idx)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"forecasting","dir":"Articles","previous_headings":"","what":"Forecasting","title":"2d Temporal Model: Tutorial on real data","text":"earthquake forecast usually collection synthetic catalogues generated model. bayesian models can reflect uncertainty parameters values generating synthetic catalogue composing forecast using different set parameters sampled join posterior distribution. can generate forecasts using function Temporal.ETAS.forecast. function takes input post.samp: data.frame samples posterior distribution parameters format described previous sections. n.cat: number synthetic catalogues composing forecast. n.cat greater nrow(post.samp), rows post.samp sampled uniformly replacement n.cat times. n.cat smaller nrow(post.samp), , rows post.samp sampled uniformly without replacement n.cat times. n.cat NULL equal nrow(post.samp), , post.samp used . ncore: number cores used generate synthetic catalogues parallel. remaining inputs (beta.p, M0, T1, T2, Ht) ones used generate_temporal_ETAS_synthetic. output function list two elements: fore.df n.cat. element fore.df data.frame synthetic catalogues binded together row, multi.synth.cat.df created . element n.cat just number catalogues generated. need n.cat zero-events catalogues appear fore.df, corresponding cat.idx value missing. Therefore need n.cat recover total number catalogues. code creates daily forecast 24 hours starting 1 minute event greatest magnitude sequence. starting date end date forecast expressed unit used catalogue fit model (days case). Day zero correspond start.date stated beginning document example \\(2009-01-01 00:00:00\\). forecast generated assuming known events catalogue occurred forecasting period. can easily retrieve predictive distribution number events forecasting period looking frequencies catalogue identifiers appears fore.df element. Indeed, number rows fore.df cat.idx value represents number events synthetic catalogue. , frequency catalogue identifier appears fore.df$cat.idx correspond number events catalogue. allows easily retrieve predictive distribution number events using code . remark case can use function table find frequencies elements fore.df$cat.idx. catalogue identifier zero-events catalogues present fore.df$cat.idx. using table lead zero probability zero events day, quantity crucial intersted probability earthquake activity (probability least one event).","code":"# express 1 minute in days min.in.days <- 1 / (24 * 60) # find time of the event with the greatest magnitude t.max.mag <- aquila.bru$ts[which.max(aquila.bru$magnitudes)] # set starting time of the forecasting period T1.fore <- t.max.mag + min.in.days # set forecast length fore.length <- 1 # set end time of the forecasting period T2.fore <- T1.fore + fore.length # set known data Ht.fore <- aquila.bru[aquila.bru$ts < T1.fore, ]  # produce forecast daily.fore <- Temporal.ETAS.forecast(   post.samp = post.samp, # ETAS parameters posterior samples   n.cat = nrow(post.samp), # number of synthetic catalogues   beta.p = beta.p, # magnitude distribution parameter   M0 = M0, # cutoff magnitude   T1 = T1.fore, # forecast starting time   T2 = T2.fore, # forecast end time   Ht = Ht.fore, # known events   ncore = 3 ) # number of cores # find number of events per catalogue N.fore <- vapply(   seq_len(daily.fore$n.cat),   \\(x) sum(daily.fore$fore.df$cat.idx == x), 0 ) # find number of observed events in the forecasting period N.obs <- sum(aquila.bru$ts >= T1.fore & aquila.bru$ts <= T2.fore) # plot the distribution ggplot() +   geom_histogram(aes(x = N.fore, y = after_stat(density)), binwidth = 1) +   geom_vline(xintercept = N.obs) +   xlim(100, 500) #> Warning: Removed 21 rows containing non-finite values (`stat_bin()`). #> Warning: Removed 2 rows containing missing values (`geom_bar()`)."},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"2c Temporal Model: Tutorial on synthetic data","text":"tutorial shows use ETAS.inlabru package generate synthetic catalogue temporal ETAS model fit ETAS model data. also show retrieve posterior distribution parameters quantity interest. brief introduction ETAS model refer tutorial real earthquake data.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"generate-a-synthetic-catalogue","dir":"Articles","previous_headings":"","what":"Generate a synthetic catalogue","title":"2c Temporal Model: Tutorial on synthetic data","text":"function generate_temporal_ETAS_synthetic() can used generate synthetic catalogues temporal ETAS model fixed parameters spanning given interval time. generate_temporal_ETAS_synthetic() takes input theta: list ETAS parameters names mu, K, alpha, c, p, corresponding ETAS parameters. beta.p: parameter magnitude distribution M0: cutoff magnitude, generated event magnitude greater M0. T1: starting time catalogue (unit measure depends unit used fit model). T2: end time catalogue (unit measure depends unit used fit model). Ht: set known events. can also T1 T2, useful want generate catalogues imposed events. NULL events imposed. function returns list data.frame, element output list corresponds different generation. data.frame three columns: occurence time (ts), magnitude (magnitudes), generation identifier (gen). generation identifier uses following convention, \\(-1\\) indicates events Ht time T1 T2, \\(0\\) indicates first generation offspring events gen equal \\(-1\\), \\(1\\) indicates background events, \\(2\\) offspring events gen equal \\(0\\) \\(1\\), \\(3\\) indicates offspring events gen equal \\(2\\), \\(4\\) indicates offspring events gen equal \\(3\\), . obtain unique data.frame containing simulated events sufficient bind rows generations. code generates synthetic catalogue events magnitude greater \\(2.5\\) according temporal ETAS model parameters equal vector true.param. value parameters equal posterior mean parameters obtained fitting model L’Aquila seismic sequence done tutorial real data. Also parameter \\(\\beta\\) magnitude distribution comes example. output function list data.frames convenient transform single data.frame binding rows data.frames list. synthetic catalogue composed total \\(288\\) events \\(112\\) background events \\(176\\) aftershocks. can easily retrieve numbers looking gen column data. code plot occurrence time events magnitude color indicating generation event time evolution cumulative number events. multiplot function provided inlabru R-package can used combine plots.","code":"set.seed(111) # set true ETAS parameters true.param <- list(mu = 0.30106014, K = 0.13611399, alpha = 2.43945301, c = 0.07098607, p = 1.17838741) # set magnitude distribution parameter beta.p <- 2.353157 # set cutoff magnitude M0 <- 2.5 # set starting time of the synthetic catalogue T1 <- 0 # set end time of the synthetic catalogue T2 <- 365 # generate the catalogue - it returns a list of data.frames synth.cat.list <- generate_temporal_ETAS_synthetic(   theta = true.param,   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = NULL,   ncore = 1 ) synth.cat.df <- do.call(rbind, synth.cat.list) head(synth.cat.df) #>           ts magnitudes gen #> 1 135.204031   2.661688   1 #> 2 187.947198   2.632073   1 #> 3 137.847074   3.073890   1 #> 4 152.693124   2.653628   1 #> 5   3.890113   2.686633   1 #> 6 194.287763   3.035756   1 c(N = nrow(synth.cat.df), N.bkg = sum(synth.cat.df$gen == 1), N.after = sum(synth.cat.df$gen > 1)) #>       N   N.bkg N.after  #>     288     112     176 pl1 <- ggplot(synth.cat.df, aes(ts, magnitudes, color = as.factor(gen))) +   geom_point() +   labs(color = \"gen\")  t.breaks <- T1:T2 N.cumsum <- vapply(t.breaks, \\(x) sum(synth.cat.df$ts < x), 0) df.to.cumsum.plot <- data.frame(ts = t.breaks, N.cum = N.cumsum) pl2 <- ggplot(df.to.cumsum.plot, aes(ts, N.cum)) +   geom_line() +   ylab(\"cumulative number of events\")  inlabru::multiplot(pl1, pl2, cols = 2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"prepare-data-for-model-fitting","dir":"Articles","previous_headings":"","what":"Prepare data for model fitting","title":"2c Temporal Model: Tutorial on synthetic data","text":"order fit model synthetic catalogue need set parameters priors set initial value parameters set inlabru options prepare data model fitting set priors need create list copula transformation (simply link) functions. method works internal representation parameters parameter Gaussian distribution. need function transform parameters original ETAS scale set prior . ETAS.inlabru package offers four different functions corresponding four different prior distributions. functions gamma_t, unif_t, exp_t, loggaus_t corresponds Gamma distribution, Uniform distribution, Exponential distribution Log-Gaussian distribution. also provide inverse functions retrieve value parameters internal scale given value ETAS scale. inv_gamma_t, inv_unif_t, exp_t, inv_loggaus_t. example going consider following priors parameters \\[\\begin{align*} \\mu & \\sim \\Gamma(0.3, 0.6) \\\\ K & \\sim \\text{Unif}(0,10) \\\\ \\alpha & \\sim \\text{Unif}(0,10) \\\\ c & \\sim \\text{Unif}(0,10) \\\\ p & \\sim \\text{Unif}(1,10) \\end{align*}\\] list link functions corresponding priors initial value parameters inlabru algorithm must specified internal scale parameters. reason, useful create list inverse link functions can specify initial value parameters ETAS scale easily retrieve corresponding value parameters internal scale. can done shown initial value parameters specified list names th.mu, th.K, th.alpha, th.c, th.p, , example, th.mu corresponds initial value parameter \\(\\mu\\) internal scale. initial value parameters important ensure algorithm able converge. Indeed, start algorithm values parameters causing numerical problems, may prevent algorithm converge. experience, setting initial values parameter (e.g. \\(< 10^{-5}\\)) (e.g. \\(> 10^2\\)) safe choice. code uses following initial values parameters \\(\\mu_{\\text{init}} = 0.5, K_{\\text{init}} = 0.1, \\alpha_{\\text{init}} = 1, c_{\\text{init}} = 0.1, p_{\\text{init}} = 1.1\\) Also inlabru options provided list, main elements list : bru_verbose: number indicating type visual output. Set 0 output. bru_max_iter: maximum number iterations. set max_step inlabru algorithm stops stopping criterion met. However, setting max_step values smaller 1 forces algorithm run exactly bru_max_iter iterations. bru_method: relevant , thing may need set max_step argument. algorithm converge without fixing max_step suggest try fix value 1, experience \\(0.5\\) \\(0.2\\) works well. example line setting bru_method commented. bru_initial: list initial values created . Lastly, need prepare data model fitting. data must provided data.frame least 3 columns names ts corresponding occurrence time events, magnitudes corresponding magnitude, idx.p event identifier. events data.frame must sorted respect occurrence time. synthetic catalogue generated beginning already columns ts magnitudes, sorted generation time. code sort rows data.frame adds event identifier","code":"# set copula transformations list link.f <- list(   mu = \\(x) gamma_t(x, 0.3, 0.6),   K = \\(x) unif_t(x, 0, 10),   alpha = \\(x) unif_t(x, 0, 10),   c_ = \\(x) unif_t(x, 0, 10),   p = \\(x) unif_t(x, 1, 10) ) # set inverse copula transformations list inv.link.f <- list(   mu = \\(x) inv_gamma_t(x, 0.3, 0.6),   K = \\(x) inv_unif_t(x, 0, 10),   alpha = \\(x) inv_unif_t(x, 0, 10),   c_ = \\(x) inv_unif_t(x, 0, 10),   p = \\(x) inv_unif_t(x, 1, 10) ) # set up list of initial values th.init <- list(   th.mu = inv.link.f$mu(0.5),   th.K = inv.link.f$K(0.1),   th.alpha = inv.link.f$alpha(1),   th.c = inv.link.f$c_(0.1),   th.p = inv.link.f$p(1.1) ) # set up list of bru options bru.opt.list <- list(   bru_verbose = 3, # type of visual output   bru_max_iter = 70, # maximum number of iterations   # bru_method = list(max_step = 0.5),   bru_initial = th.init ) # parameters initial values # sort catalogue by occurrence time synth.cat.df <- synth.cat.df[order(synth.cat.df$ts), ] # add event identifier synth.cat.df$idx.p <- seq_len(nrow(synth.cat.df))"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"model-fitting","dir":"Articles","previous_headings":"","what":"Model Fitting","title":"2c Temporal Model: Tutorial on synthetic data","text":"function Temporal.ETAS fit ETAS model returns bru object output. required inputs : total.data: data.frame containing observed events. format described previous Section. M0: cutoff magnitude. events total.data must magnitude greater equal number. T1: starting time time interval want fit model. T2: end time time interval want fit model. link.functions: list copula transformation functions format described previous sections. coef.t., delta.t., N.max.: parameters temporal binning. binning strategy described Appendix B paper Approximation Bayesian Hawkes process inlabru. parameters corresponds coef.t.\\(=\\delta\\), delta.t.\\(=\\Delta\\), N.max.\\(=n_{\\max}\\). bru.opt: list inlabru options described previous Section.","code":"synth.fit <- Temporal.ETAS(   total.data = synth.cat.df,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  0.7186234"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"check-marginal-posterior-distributions","dir":"Articles","previous_headings":"","what":"Check marginal posterior distributions","title":"2c Temporal Model: Tutorial on synthetic data","text":"order retrieve marginal posterior distributions parameter need provide list containing two elements: model.fit bru object containing fitted model, link.functions list link functions created . list created, function get_posterior_param returns marginal posterior distribution parameters ETAS scale. function returns list two elements: post.df data.frame three columns, x indicating value parameter, y indicating corresponding value marginal posterior distribution, param parameter identifier. output list also contains post.plot ggplot object containing plot marginal posterior distributions parameter. code retrieve marginal posterior distribution parameters plot along true value parameters represented vertical dashed lines.","code":"# create input list to explore model output input_list <- list(   model.fit = synth.fit,   link.functions = link.f ) # retrieve marginal posterior distributions post.list <- get_posterior_param(input.list = input_list)  # create data.frame of true value of parameters df.true.param <- data.frame(   x = unlist(true.param),   param = names(true.param) ) # add to the marginal posterior distribution of the parameters the true value of the parameters. post.list$post.plot +   geom_vline(     data = df.true.param,     mapping = aes(xintercept = x), linetype = 2   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"sampling-the-joint-posterior-distribution","dir":"Articles","previous_headings":"","what":"Sampling the joint posterior distribution","title":"2c Temporal Model: Tutorial on synthetic data","text":"function post_sampling generate samples joint posterior ETAS parameters. function takes input: input.list: list model.fit element link.functions elements described . n.samp: number posterior samples. max.batch: number posterior samples generated simultaneously. n.samp\\(>\\)max.batch, , samples generated parallel batches maximum size equal max.batch. Default \\(1000\\). ncore: number cores used parallel n.samp\\(>\\)max.batch. function returns data.frame columns corresponding ETAS parameters posterior samples can used estimate posterior distribution functions parameters.","code":"post.samp <- post_sampling(   input.list = input_list,   n.samp = 1000,   max.batch = 1000,   ncore = 1 ) head(post.samp) #>          mu          K    alpha         c        p #> 1 0.2993227 0.04095418 2.553485 0.3402233 1.438275 #> 2 0.3165012 0.04173735 2.506610 0.1886587 1.215065 #> 3 0.3483552 0.04505685 2.574011 0.1366821 1.179886 #> 4 0.3702138 0.03184421 2.671650 0.2234041 1.311962 #> 5 0.3432687 0.04241239 2.586393 0.2146971 1.280426 #> 6 0.3407215 0.06920514 2.431187 0.1579358 1.227530"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"triggering-function-and-omori-law","dir":"Articles","previous_headings":"","what":"Triggering function and Omori law","title":"2c Temporal Model: Tutorial on synthetic data","text":"Interesting functions parameters triggering function Omori law. can estimate posterior distribution functions using samples joint posterior distribution parameters obtained previous section. functions triggering_fun_plot provides plot quantiles posterior distribution triggering function \\(g(t-t_h, mh)\\), namely, \\[ g(t - t_h, m_h) = K\\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] function takes input input.list: input list defined functions used previously. post.samp: data.frame samples posterior distribution parameters. NULL, n.samp samples generated posterior. n.samp: number posterior samples parameters used generated. magnitude: magnitude event (\\(m_h\\)). t.end: maximum value \\(t\\) plot. n.breaks: number breaks interval \\((0, \\texttt{t.end})\\) divided. function returns ggplot object. sample parameters triggering function \\(0\\) t.end calculated. black solid lines represents \\(95\\%\\) posterior interval function, grey lines represent triggering function calculated posterior samples, horizontal red lines represent \\(95\\%\\) posterior interval background rate \\(\\mu\\). function triggering_plot_prior using parameters sampled priors parameters. code creates plot posterior triggering function adds triggering function calculated true parameter values blue. need add argument M0 input_list use function triggering_fun_plot.  functions omori_plot_posterior function triggering_fun_plot considering \\[ \\left(\\frac{t- t_h}{c} + 1\\right)^{-p} \\] instead whole triggering function without background rate.","code":"# add cutoff magnitude to input_list input_list$M0 <- M0  # generate triggering function plot trig.plot <- triggering_fun_plot(   input.list = input_list,   post.samp = post.samp,   n.samp = NULL, magnitude = 4,   t.end = 5, n.breaks = 100 )  # set times at which calculate the true triggering function t.breaks <- seq(1e-6, 5, length.out = 100) # calculate the function true.trig <- gt(unlist(true.param), t = t.breaks, th = 0, mh = 4, M0 = M0) # store in data.frame for plotting true.trig.df <- data.frame(ts = t.breaks, trig.fun = true.trig)  # add the true triggering function to the plot trig.plot +   geom_line(     data = true.trig.df,     mapping = aes(x = ts, y = trig.fun), color = \"blue\"   ) omori.plot <- omori_plot_posterior(input.list = input_list, post.samp = post.samp, n.samp = NULL, t.end = 5)  true.omori <- omori(theta = unlist(true.param), t = t.breaks, ti = 0) true.omori.df <- data.frame(ts = t.breaks, omori.fun = true.omori)  omori.plot +   geom_line(     data = true.omori.df,     mapping = aes(x = ts, y = omori.fun), color = \"blue\"   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"comparison-between-different-fitted-models","dir":"Articles","previous_headings":"","what":"Comparison between different fitted models","title":"2c Temporal Model: Tutorial on synthetic data","text":"interesting fit model multiple synthetic catalogues compare parameters posterior distributions obtained different catalogues. section, going generate second synthetic catalogue, fit model, compare posterior distributions ones obtained . second catalogue impose large event magnitude \\(6\\) happening midpoint time interval. first step set data.frame known events generate second synthetic catalogue Counting number background events aftershocks case slightly different . fact, count imposed event background event, aftershocks need include also event gen = 0 ones induced imposed event case 192. comparison number events two catalogues. Notice background events roughly expected given time interval . , just need set data.frame model fitting. inputs can use ones created first model fit. Now, extract marginal posterior distributions, need create input_list second model fit. Now, can retrieve marginal posterior distributions provided model fitted second catalogue compare ones obtained .  process shown can extended multiple (\\(>2\\)) input catalogues order study parameters identifiable. Also, using characteristics input catalogue catalogue identifier can study change posterior distribution characteristic input catalogue changes. interesting example number events catalogue, studying marginal posterior distributions change increase decrease number events.","code":"# set up data.frame of imposed events Ht.imposed <- data.frame(   ts = mean(c(T1, T2)),   magnitudes = 6 ) # generate second catalogue set.seed(1) synth.cat.list.2 <- generate_temporal_ETAS_synthetic(   theta = true.param,   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = Ht.imposed,   ncore = 1 ) # transform it in a data.frame synth.cat.df.2 <- do.call(rbind, synth.cat.list.2) sum(synth.cat.df.2$gen == 0) #> [1] 192 rbind(   first = c(     N = nrow(synth.cat.df),     N.bkg = sum(synth.cat.df$gen == 1),     N.after = sum(synth.cat.df$gen > 1)   ),   second = c(     N = nrow(synth.cat.df.2),     N.bkg = sum(synth.cat.df.2$gen == 1 | synth.cat.df.2$gen == -1),     N.after = sum(synth.cat.df.2$gen > 1 | synth.cat.df.2$gen == 0)   ) ) #>          N N.bkg N.after #> first  288   112     176 #> second 408   104     304 synth.cat.df.2 <- synth.cat.df.2[order(synth.cat.df.2$ts), ] synth.cat.df.2$idx.p <- seq_len(nrow(synth.cat.df.2))  synth.fit.2 <- Temporal.ETAS(   total.data = synth.cat.df.2,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  0.9818034 input_list.2 <- list(   model.fit = synth.fit.2,   link.functions = link.f ) # retrieve marginal posterior distributions post.list.2 <- get_posterior_param(input.list = input_list.2)  # set model identifier post.list$post.df$cat.used <- \"first catalogue\" post.list.2$post.df$cat.used <- \"second catalogue\"  # bind marginal posterior data.frames bind.post.df <- rbind(post.list$post.df, post.list.2$post.df)  # plot them ggplot(bind.post.df, aes(x = x, y = y, color = cat.used)) +   geom_line() +   facet_wrap(facets = ~param, scales = \"free\") +   xlab(\"param\") +   ylab(\"pdf\") +   geom_vline(     data = df.true.param,     mapping = aes(xintercept = x), linetype = 2   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Francesco Serafini. Author, maintainer. Mark Naylor. Author, thesis advisor. Finn Lindgren. Author, thesis advisor.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Mark Naylor, & Francesco Serafini (2023). edinburgh-seismicity-hub/ETAS.inlabru: Temporal Hawkes (v1.0.1).  Zenodo. https://doi.org/10.5281/zenodo.7515785 Mark Naylor, Francesco Serafini, Finn Lindgren (2023). doi:10.3389/fams.2023.1126759, https://www.frontiersin.org/articles/10.3389/fams.2023.1126759 Francesco Serafini, Finn Lindgren, Mark Naylor (2023). doi:10.1002/env.2798, https://onlinelibrary.wiley.com/doi/abs/10.1002/env.2798","code":"@Misc{,   title = {edinburgh-seismicity-hub/ETAS.inlabru: Temporal Hawkes},   author = {Mark Naylor and Francesco Serafini},   publisher = {Zenodo},   year = {2023},   number = {v1.0.1},   url = {https://doi.org/10.5281/zenodo.7515785},   doi = {10.5281/zenodo.7515785}, } @Article{,   title = {Bayesian modelling of the temporal evolution of seismicity using the ETAS.inlabru R-package},   author = {Mark Naylor and Francesco Serafini and Finn Lindgren},   journal = {Frontiers in Applied Mathematics and Statistics},   year = {2023},   doi = {10.3389/fams.2023.1126759},   url = {https://www.frontiersin.org/articles/10.3389/fams.2023.1126759}, } @Article{,   title = {Approximation of Bayesian Hawkes process with inlabru},   author = {{Serafini} and {Francesco} and {Lindgren} and {Finn} and {Naylor} and {Mark}},   journal = {Environmetrics},   year = {2023},   doi = {10.1002/env.2798},   url = {https://onlinelibrary.wiley.com/doi/abs/10.1002/env.2798}, }"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"etasinlabru","dir":"","previous_headings":"","what":"Bayesian ETAS model for modelling seismic sequences with inlabru","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"R package implements ETAS Hawkes process modelling seismicity Online documentation: https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"authors","dir":"","previous_headings":"","what":"Authors","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Dr Francesco Serafini Dr Mark Naylor , School GeoSciences, University Edinburgh Prof Finn Lindgren , School Mathematics, University Edinburgh Dr Kirsty Bayliss , Global Earthquake Model (GEM)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"funding","dir":"","previous_headings":"","what":"Funding","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"study funded yhe Real-Time Earthquake Risk Reduction Resilient Europe RISE project , received funding European Union’s Horizon 2020 Research Innovation Program grant Agreement 821115. Naylor additionally funded NSFGEO-NERC grant NE/R000794/1. Bayliss funded EPSRC Studentship.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"ETAS.inlabru work, need install R-INLA inlabru: inlabru (see https://inlabru-org.github.io/inlabru/): CRAN release, development version, R-INLA (see https://www.r-inla.org/download-install): can install development version ETAS.inlabru GitHub ","code":"install.packages(\"inlabru\") # install.packages(\"remotes\") remotes::install_github(\"inlabru-org/inlabru\") install.packages(   \"INLA\",   repos = c(getOption(\"repos\"), INLA=\"https://inla.r-inla-download.org/R/testing\"),   dep = TRUE ) # install.packages(\"remotes\") remotes::install_github(\"edinburgh-seismicity-hub/ETAS.inlabru\")"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"file-structure-in-package","dir":"","previous_headings":"Terminology and planning suggestions","what":"File structure in package","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"ETAS.triggering.function.R : Contains ETAS specific model functions HawkesProcess.R : Generic Hawkes code intended integration back inlabru generateSyntheticCatalogues.R : Contains iterative Hawkes functions generating triggered events actual triggering functions reside ETAS file introduce models temporalBinning.R : Code generate time bins make integration scheme efficient plottingFunctions.R : lets put standard plotting functions setupInlabruInputs.R : Put functions generating input.list ","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"terminology","dir":"","previous_headings":"","what":"Terminology","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Let’s specific just temporal clear function names spatial spatial-temporal later Might anything bad? tried modify just theta","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"implemented","dir":"","previous_headings":"","what":"Implemented","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Generation synthetic ETAS catalogues ETAS.inlabru demonstration notebook","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"in-development","dir":"","previous_headings":"","what":"In development","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Add inversion modelling based original code Modify implementation generic Hawkes code can go inlabru ETAS triggering function code stay package Implement time varying incompleteness model Farnaz Kamranzad","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"roadmap","dir":"","previous_headings":"","what":"Roadmap","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Implement incompleteness fix Integrate spatial modelling","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/ETAS.inlabru-package.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru — ETAS.inlabru-package","title":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru — ETAS.inlabru-package","text":"Modelling inversion ETAS model seismicity using inlabru Epidemic Type Aftershock Sequence (ETAS) model designed model earthquakes triggered previous events. statistics, referred Hawkes process. code can used generate synthetic ETAS catalogues can also include seeded events model specific sequences. also implement Bayesian inversion scheme using Integrated Nested Laplace Approximation (INLA) using inlabru. temporal model, given training catalogue times magnitudes, code returns joint posteriors ETAS parameters. future roadmap, include tools model spatial distribution spatio-temporal evolution seismic sequences.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/ETAS.inlabru-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru — ETAS.inlabru-package","text":"Maintainer: Francesco Serafini francesco.serafini@newcastle.ac.uk (ORCID) Authors: Mark Naylor mark.naylor@ed.ac.uk (ORCID) [thesis advisor] Finn Lindgren Finn.Lindgren@ed.ac.uk (ORCID) [thesis advisor]","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":null,"dir":"Reference","previous_headings":"","what":"Injection Rate function calculations — IntInjectionIntensity","title":"Injection Rate function calculations — IntInjectionIntensity","text":"Forward time integrated function exponential rate decay, inverse","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Injection Rate function calculations — IntInjectionIntensity","text":"","code":"IntInjectionIntensity(a = 50, V.i = 1, tau = 10, T.i, T2)  Inv_IntInjectionIntensity(   a = 50,   V.i = 1,   tau = 10,   T.i,   number.injected.events )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Injection Rate function calculations — IntInjectionIntensity","text":"Event rate per unit volume injected V.Injected volume tau Decay rate [days] T.Time injection event T2 End temporal model domain number.injected.events number expected injected events, used inverse.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Injection Rate function calculations — IntInjectionIntensity","text":"IntInjectionIntensity returns forward time integrated function exponential rate decay. Inv_IntInjectionIntensity returns end time corresponding given expected number injected events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":null,"dir":"Reference","previous_headings":"","what":"Integrated Omori's law — Int_ETAS_time_trig_function","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"Integrated Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"","code":"Int_ETAS_time_trig_function(theta, th, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p) th Time past event [days] start temporal domain, vector. T2 End temporal domain, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"Value integral Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"function returns integral Omori's law, namely $$\\int_{t_h}^{T_2} \\left(\\frac{t - t_h}{c} + 1\\right)^{-p} dt$$","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"Inverse integrated Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"","code":"Inv_Int_ETAS_time_trig_function(theta, omega, th)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p) omega Value integral inverted, vector th Time integral calculated scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"Value start temporal domain used calculate integral","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"Considering integral Omori's law $$\\omega = \\int_{t_h}^{T_2}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} dt$$ function applied value \\(\\omega\\) returns value \\(t_h\\).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to calculate the integral of Omori's law — It_df","title":"Function to calculate the integral of Omori's law — It_df","text":"Function calculate integral Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to calculate the integral of Omori's law — It_df","text":"","code":"It_df(param_, time.df)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to calculate the integral of Omori's law — It_df","text":"param_ ETAS parameters vector (\\(\\mu, K, \\alpha, c, p\\)), \\(c, p\\) used. time.df output function time_grid()","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to calculate the integral of Omori's law — It_df","text":"vector integral values bin provided time.df","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"Fits remporal ETAS model returns results. function decomposes input.list `Hawkes.bru2`` function.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"","code":"Temporal.ETAS.fit(input.list)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"input.list input data parameters passed inlabru via structured list. output function create_input_list_temporal_withCatalogue create_input_list_temporal_noCatalogue","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"fitted model bru object, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — Temporal.ETAS.forecast","title":"Title — Temporal.ETAS.forecast","text":"Title","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — Temporal.ETAS.forecast","text":"","code":"Temporal.ETAS.forecast(post.samp, n.cat, beta.p, M0, T1, T2, Ht, ncore = 1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — Temporal.ETAS.forecast","text":"post.samp data.frame containing samples posterior distribution ETAS parameters. row data.frame corresponds different sample parameters order \\(\\mu\\), \\(K\\), \\(\\alpha\\), \\(c\\), \\(p\\). n.cat number synthetic catalogues composing forecast. n.cat greater nrow(post.samp), , n.cat rows sampled uniformly replacement post.samp. n.cat smaller nrow(post.samp), , n.cat rows sampled uniformly without replacement post.samp. n.cat NULL equal nrow(post.samp), post.samp used nrow(post.samp) catalogues generated. beta.p parameter magnitude distribution M0 cutoff magnitude, synthetic events magnitude greater value. T1 starting time forecast T2 end time forecast Ht set known events ncore number cores used generate synthetic catalogues parallel.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — Temporal.ETAS.forecast","text":"list two elements: fore.df data.frame containing synthetic catalogues composing forecast. data.frame four columns, ts occurrence time, magnitudes magnitude, gen generation event, cat.idx catalogue identifier second element output list n.cat number synthetic catalogues generated.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to fit Hawkes process model — Temporal.ETAS","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"function fit temporal ETAS model using inlabru.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"","code":"Temporal.ETAS(   total.data,   M0,   T1,   T2,   link.functions = NULL,   coef.t.,   delta.t.,   N.max.,   bru.opt )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"total.data Observed events: data.frame columns time (ts), magnitude (magnitudes), event identifier (idx.p). Column names must changed. M0 Minimum magnitude threshold, scalar T1 Start temporal model domain, scalar [measure unit sample.s$ts]. T2 End temporal model domain, scalar [measure unit sample.s$ts]. link.functions Functions transform parameters internal INLA scale ETAS scale. must list functions names (mu, K, alpha, c_, p) coef.t. TimeBinning parameter: parameter regulating relative length successive bins, scalar. delta.t. TimeBinning parameter: parameter regulating bins' width, scalar. N.max. TimeBinning parameter: parameter regulating Number bins (= N.max + 2), scalar. bru.opt Runtime options inlabru: See https://inlabru-org.github.io/inlabru/reference/bru_call_options.html, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"fitted model 'bru' object, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":null,"dir":"Reference","previous_headings":"","what":"Find breaks point for 1D grid — breaks_exp","title":"Find breaks point for 1D grid — breaks_exp","text":"breaks_exp return breaks points one dimensional grid depending three parameters, see details","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find breaks point for 1D grid — breaks_exp","text":"","code":"breaks_exp(start.grid, end.grid, coef.t = 2, delta.t, N.exp. = 10)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find breaks point for 1D grid — breaks_exp","text":"start.grid Starting point grid, scalar. end.grid End point grid, scalar. coef.t TimeBinning parameter: \\(\\delta > 0\\) determines relative length subsequent intervals, scalar. delta.t TimeBinning parameter: \\(\\Delta > 0\\) determines length intervals, scalar. N.exp. TimeBinning parameter: \\(n_{max} >0\\) determines maximum number intervals, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find breaks point for 1D grid — breaks_exp","text":"vector containing grid points","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Find breaks point for 1D grid — breaks_exp","text":"grid calculated follows $$t, t + \\Delta, t + \\Delta(1 + \\delta), t + \\Delta(1 + \\delta)^2,...., T$$ \\(t\\) start.grid argument, \\(T\\) end.grid argument, \\(n_{max}\\) maximum value exponent","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find breaks point for 1D grid — breaks_exp","text":"","code":"breaks_exp(start.grid = 1, end.grid = 100, coef.t = 1, delta.t = 1, N.exp. = 3) #> [1]   1   2   3   5   9 100 breaks_exp(start.grid = 1, end.grid = 100, coef.t = 1, delta.t = 1, N.exp. = 10) #> [1]   1   2   3   5   9  17  33  65 100"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to compute the integral of Omori's law efficiently — compute_grid","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"Function compute integral Omori's law efficiently","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"","code":"compute_grid(param., list.input_)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"param. ETAS parameters vector (\\(\\mu, K, \\alpha, c, p\\)), \\(c, p\\) used. list.input_ list containing information calculate integrals efficiently. list created inside Temporal.ETAS function Two elements used time.sel selection rows output time_grid unique t.ref_layer value, data.frame. Imapping mapper unique names provided time.sel original rows output time_grid(), vector.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"vector length list.input_$Imapping integral Omori's law bin.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS conditional intensity - used by inlabru — cond_lambda","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"Function calculate value ETAS model conditional intensity specified time given history process.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"","code":"cond_lambda(theta, t, th, mh, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"theta ETAS parameters list names mu, K, alpha, c, p t Time conditional intensity evaluated, scalar th Time events history process, vector mh Magnitudes events history process, vector M0 Minimum magnitude threshold","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"Value ETAS conditional intensity calculated t history th, mh, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"function takes single value t returns ETAS conditional intensity calculated t history th, mh. ETAS conditional intensity given $$\\lambda(t | \\mathcal H_t) = \\mu + \\sum_{h: (t_h,m_h) \\\\mathcal H_t} K e^{\\alpha(m_h - M_0)} \\left( \\frac{t - t_h}{c} + 1\\right)^{-p}$$ use t vector.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"Function create default input list ETAS Hawkes temporal model catalogue specified input file","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"","code":"create_input_list_temporal_noCatalogue(input_path, num.threads = NULL)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"input_path Input file path string num.threads Optional argument number threads used parallel processing","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"formatted input.list elements required temporal Hawkes model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"","code":"create_input_list_temporal_noCatalogue(   system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\") ) #> $catalog #> NULL #>  #> $catalog.bru #> NULL #>  #> $time.int #> NULL #>  #> $T12 #> [1] \"T1\"  \" T2\" #>  #> $lat.int #> [1] -90  90 #>  #> $lon.int #> [1] -180  180 #>  #> $M0 #> NULL #>  #> $mu.init #> [1] 0.25 #>  #> $K.init #> [1] 0.3 #>  #> $alpha.init #> [1] 1.6 #>  #> $c.init #> [1] 0.2 #>  #> $p.init #> [1] 1.1 #>  #> $a_mu #> [1] 0.5 #>  #> $b_mu #> [1] 0.5 #>  #> $a_K #> [1] -1 #>  #> $b_K #> [1] 0.5 #>  #> $a_alpha #> [1] 0 #>  #> $b_alpha #> [1] 10 #>  #> $a_c #> [1] 0 #>  #> $b_c #> [1] 1 #>  #> $a_p #> [1] 1 #>  #> $b_p #> [1] 2 #>  #> $max_iter #> [1] 100 #>  #> $max_step #> NULL #>  #> $link.functions #> $link.functions$mu #> function (x)  #> gamma_t(x, a_mu, b_mu) #> <bytecode: 0x56523d6b8388> #> <environment: 0x56523d6b6da8> #>  #> $link.functions$K #> function (x)  #> loggaus_t(x, a_K, b_K) #> <bytecode: 0x56523d6b80b0> #> <environment: 0x56523d6b6da8> #>  #> $link.functions$alpha #> function (x)  #> unif_t(x, a_alpha, b_alpha) #> <bytecode: 0x56523d6b7dd8> #> <environment: 0x56523d6b6da8> #>  #> $link.functions$c_ #> function (x)  #> unif_t(x, a_c, b_c) #> <bytecode: 0x56523d6b7b00> #> <environment: 0x56523d6b6da8> #>  #> $link.functions$p #> function (x)  #> unif_t(x, a_p, b_p) #> <bytecode: 0x56523d6b7828> #> <environment: 0x56523d6b6da8> #>  #>  #> $bru.opt.list #> $bru.opt.list$bru_verbose #> [1] 3 #>  #> $bru.opt.list$bru_max_iter #> [1] 100 #>  #> $bru.opt.list$num.threads #> NULL #>  #> $bru.opt.list$bru_initial #> $bru.opt.list$bru_initial$th.mu #> [1] -0.2978078 #>  #> $bru.opt.list$bru_initial$th.K #> [1] -0.4079456 #>  #> $bru.opt.list$bru_initial$th.alpha #> [1] -0.9944579 #>  #> $bru.opt.list$bru_initial$th.c #> [1] -0.8416212 #>  #> $bru.opt.list$bru_initial$th.p #> [1] -1.281552 #>  #>  #>  #> $coef.t #> [1] 1 #>  #> $delta.t #> [1] 0.1 #>  #> $Nmax #> [1] 8 #>  #> $n.periods #> [1] 120 #>  #> $period.length #> [1] 1 #>  #> $start.date.fore #> NULL #>  #> $magnitude.update #> [1] 5.5 #>  #> $output.name #> [1] \"report_ETAS\" #>"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"Function create default input file ETAS Hawkes temporal model catalogue specified input file.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"","code":"create_input_list_temporal_withCatalogue(input_path, num.threads = NULL)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"input_path path txt file containing experiment's information num.threads Optional argument number threads used parallel processing","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"formatted input.list elements required temporal Hawkes model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"Copula transformation standard Normal distribution Exponential distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"","code":"exp_t(x, r)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"x values standard Normal distribution, vector. r rate exponential distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"values Exponential distribution rate r, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"Copula transformation standard Normal distribution Gamma distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"","code":"gamma_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"x values standard Normal distribution, vector. shape parameter gamma distribution scalar. b rate parameter gamma distribution scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"values Gamma distribution shape rate b, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":null,"dir":"Reference","previous_headings":"","what":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"Generates synthetic catalogue using ETAS model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"","code":"generate_temporal_ETAS_synthetic(   theta,   beta.p,   M0,   T1,   T2,   Ht = NULL,   ncore = 1 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). M0 minimum magnitude synthetic catalogue. T1 start time synthetic catalogue [days]. T2 end time synthetic catalogue [days]. Ht catalogue history impose synthetic sequence. ncore Integer number compute cores use.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"data.frame temporal catalogue columns [t_i, M_i, gen_i] , t_i times,  M_i magnitudes, gen_i includes information generation number","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"","code":"## EXAMPLE 1: Generate a 1000 day synthetic ETAS catalogue  generate_temporal_ETAS_synthetic(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000 ) #> [[1]] #>           ts magnitudes gen #> 1  812.41028   2.634024   1 #> 2   65.80643   2.524817   1 #> 3  676.79157   3.349449   1 #> 4  292.64721   3.869252   1 #> 5   14.02419   2.504032   1 #> 6  506.28407   2.926779   1 #> 7  945.95438   4.467509   1 #> 8  878.38456   3.005159   1 #> 9  505.36765   2.554419   1 #> 10 531.39447   2.724372   1 #> 11 454.13975   2.611816   1 #> 12 173.17218   2.864132   1 #> 13 128.02773   2.735620   1 #> 14 902.30700   2.939433   1 #> 15 438.91344   3.111458   1 #> 16  96.21037   3.179390   1 #> 17 725.55187   2.529684   1 #> 18 546.48254   2.824914   1 #> 19 181.80727   3.462968   1 #> 20  34.23263   2.647770   1 #> 21 204.39536   2.639274   1 #> 22 934.87150   2.631908   1 #> 23 774.99396   2.588742   1 #> 24 167.85360   2.639725   1 #> 25 174.83255   2.888337   1 #> 26 804.42050   3.403510   1 #> 27 750.72143   3.264693   1 #> 28 824.29884   3.910853   1 #> 29 913.46759   3.309940   1 #> 30 987.67751   2.543407   1 #> 31 665.36491   2.604953   1 #> 32 154.30595   3.636749   1 #> 33 598.34822   2.783615   1 #> 34 382.44313   2.892288   1 #> 35 658.81054   3.181686   1 #> 36 898.77408   2.806586   1 #> 37 228.37305   2.502527   1 #> 38 578.67487   3.150004   1 #> 39 214.56354   3.026623   1 #> 40 720.69303   2.999983   1 #> 41 321.87203   2.516185   1 #> 42 546.82375   3.324854   1 #> 43 477.45476   2.809548   1 #> 44 240.04787   2.584690   1 #> 45  59.52152   2.827894   1 #> 46 411.87608   3.173595   1 #> 47 470.56794   2.644505   1 #> 48 789.06654   3.275511   1 #> 49 723.36695   2.920735   1 #> 50 709.29552   3.258155   1 #> 51 709.91257   2.836473   1 #> 52  63.67478   3.657548   1 #> 53 325.87562   3.178380   1 #> 54 939.19385   3.107458   1 #> 55 428.30586   3.022784   1 #> 56 457.11090   2.557328   1 #> 57 798.68992   2.759847   1 #> 58 209.73651   2.586910   1 #> 59 593.96737   3.591285   1 #> 60 863.78362   2.929253   1 #> 61 965.59647   2.708078   1 #> 62 855.36744   3.605128   1 #> 63 769.22289   3.040222   1 #> 64 776.32801   2.569811   1 #> 65 929.97621   2.579359   1 #> 66 669.11539   3.208789   1 #> 67 322.79189   2.999575   1 #> 68 242.47499   2.751393   1 #> 69 274.92721   2.728930   1 #> 70 379.06918   3.426554   1 #> 71 878.32502   2.984700   1 #> 72 157.75990   2.796019   1 #> 73 666.45583   3.955225   1 #> 74 559.59410   2.534217   1 #> 75 661.93382   2.872714   1 #> 76 887.10453   3.527632   1 #> 77 106.80787   2.918321   1 #> 78 820.08435   2.802664   1 #> 79 724.12789   2.811915   1 #> 80 935.90995   2.508783   1 #> 81 439.46591   2.837323   1 #> 82 252.39431   2.650880   1 #> 83 414.31724   3.198059   1 #> 84 899.92750   2.671172   1 #> 85 181.35394   2.794647   1 #> 86 841.29844   2.552798   1 #> 87 883.75163   3.306310   1 #> 88 702.58153   2.535656   1 #> 89 606.46258   2.565977   1 #> 90 906.27458   2.571927   1 #> 91 732.03324   2.871523   1 #> 92 142.53207   2.611887   1 #> 93 387.36067   3.237761   1 #> 94 224.78706   3.429364   1 #> 95 680.04168   2.986816   1 #> 96 307.75532   2.972447   1 #> 97 163.96134   3.379791   1 #>  #> [[2]] #>           ts magnitudes gen #> 1  529.79886   2.821059   2 #> 2  459.21027   2.711808   2 #> 3  293.67554   3.129606   2 #> 4  956.03466   3.835116   2 #> 5  946.68018   2.809235   2 #> 6  946.86474   3.512442   2 #> 7  946.88935   2.558148   2 #> 8  983.87738   2.538881   2 #> 9  950.11597   2.679084   2 #> 10 946.53340   2.585625   2 #> 11 454.40883   2.648432   2 #> 12 824.43279   2.841322   2 #> 13 235.28749   2.544542   2 #> 14 229.19256   3.144426   2 #> 15  59.54916   2.509631   2 #> 16 875.40906   2.687850   2 #> 17 412.22621   2.838297   2 #> 18  63.68500   3.183435   2 #> 19 688.81905   2.591947   2 #> 20 434.86684   3.262360   2 #> 21 666.94895   2.534130   2 #> 22 900.04338   3.736267   2 #> 23 868.28224   2.917914   2 #> 24 449.74803   3.244596   2 #> 25 373.86949   2.925448   2 #> 26 225.01287   3.050084   2 #> 27 534.26502   2.744896   2 #>  #> [[3]] #>         ts magnitudes gen #> 1 974.5522   2.717253   3 #> 2 956.4115   2.604558   3 #> 3 900.2773   3.144259   3 #>    ## EXAMPLE 2: To generate a 1000 day catalogue including a M6.7 event on day 500  Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) generate_temporal_ETAS_synthetic(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000,   Ht = Ht ) #> [[1]] #>    ts magnitudes gen #> 1 500        6.7  -1 #>  #> [[2]] #>              ts magnitudes gen #> 1    508.725255   2.897868   0 #> 2    500.346279   2.886402   0 #> 3    503.956430   4.785214   0 #> 4    734.202562   2.896375   0 #> 5    555.011849   3.142560   0 #> 6    500.298429   2.744892   0 #> 7    501.485875   2.520632   0 #> 8    543.636832   2.755271   0 #> 9    500.517290   3.187099   0 #> 10   747.543846   3.020367   0 #> 11   933.591755   2.848550   0 #> 12   500.316940   2.719561   0 #> 13   502.307789   2.554470   0 #> 14   547.855804   2.942851   0 #> 15   598.048154   3.011131   0 #> 16   501.602580   2.924756   0 #> 17   500.649752   3.819724   0 #> 18   733.214696   2.775052   0 #> 19   802.808431   2.658530   0 #> 20   500.037923   3.621537   0 #> 21   505.248159   2.601891   0 #> 22   501.436416   2.687163   0 #> 23   500.092251   2.656913   0 #> 24   532.488406   2.790985   0 #> 25   609.013718   2.918225   0 #> 26   597.134459   2.891562   0 #> 27   613.287823   3.022256   0 #> 28   503.384671   3.608889   0 #> 29   500.537072   2.674677   0 #> 30   500.013819   2.506562   0 #> 31   500.095719   2.846713   0 #> 32   500.933429   2.509827   0 #> 33   501.970283   2.524605   0 #> 34   506.067828   2.832126   0 #> 35   683.948446   3.976293   0 #> 36   500.163300   3.673928   0 #> 37   890.871191   3.371324   0 #> 38   987.803212   3.375853   0 #> 39   515.225258   2.813178   0 #> 40   505.511598   2.572833   0 #> 41   591.448442   2.783919   0 #> 42   627.139530   2.877049   0 #> 43   596.368251   2.588321   0 #> 44   500.349530   2.523635   0 #> 45   504.016550   2.958574   0 #> 46   837.376882   2.967867   0 #> 47   500.109601   2.662726   0 #> 48   500.069465   3.237165   0 #> 49   500.072436   2.662906   0 #> 50   500.042796   3.152082   0 #> 51   541.246856   4.635608   0 #> 52   500.703507   2.537124   0 #> 53   500.282902   3.150551   0 #> 54   572.964100   3.285953   0 #> 55   677.276110   2.671025   0 #> 56   505.264831   2.513584   0 #> 57   502.973202   2.986803   0 #> 58   500.021266   2.775712   0 #> 59   511.209808   2.743580   0 #> 60   723.641896   3.605515   0 #> 61   502.098784   2.923687   0 #> 62   513.845889   2.700769   0 #> 63   508.456346   3.134375   0 #> 64   507.241926   2.608287   0 #> 65   504.732979   2.674593   0 #> 66   500.284226   2.583947   0 #> 67   536.684001   3.083696   0 #> 68   506.739037   2.665986   0 #> 69   504.111492   2.622705   0 #> 70   523.243156   2.704119   0 #> 71   557.645656   2.820866   0 #> 72   516.553841   3.193287   0 #> 73   542.429396   2.528280   0 #> 74   711.476752   2.611572   0 #> 75   505.549043   2.652448   0 #> 76   502.603702   3.209562   0 #> 77   568.944496   2.720767   0 #> 78   501.164074   2.912684   0 #> 79   542.077094   3.366419   0 #> 80   560.584556   2.510481   0 #> 81   651.659597   2.693339   0 #> 82   517.676694   2.732166   0 #> 83   501.378489   2.784049   0 #> 84   500.129770   2.645504   0 #> 85   500.655206   2.851091   0 #> 86   501.949638   2.752538   0 #> 87   500.671651   2.593425   0 #> 88   500.074277   2.555689   0 #> 89   502.131144   2.761475   0 #> 90   504.488166   2.573360   0 #> 91   547.062141   3.697375   0 #> 92   500.497022   2.795371   0 #> 93   502.540356   2.512618   0 #> 94   525.847819   2.857642   0 #> 95   565.423523   2.633571   0 #> 96   558.074807   2.978232   0 #> 97   501.026566   2.546400   0 #> 98   574.677015   2.758671   0 #> 99   720.315374   3.051012   0 #> 100  500.266307   2.658795   0 #> 101  503.593705   3.034258   0 #> 102  670.350106   2.766448   0 #> 103  500.493285   2.570316   0 #> 104  504.815354   2.731146   0 #> 105  509.028008   4.689226   0 #> 106  501.778449   2.679475   0 #> 107  597.138319   3.186019   0 #> 108  501.121094   2.553617   0 #> 109  746.471359   3.139057   0 #> 110  500.163841   2.925807   0 #> 111  521.419816   2.718565   0 #> 112  503.343023   2.771579   0 #> 113  517.655376   2.753192   0 #> 114  830.371476   2.549421   0 #> 115  501.650615   3.245001   0 #> 116  504.389109   2.741200   0 #> 117  611.143883   2.534049   0 #> 118  736.052653   2.721405   0 #> 119  500.962891   2.859010   0 #> 120  506.961257   2.602454   0 #> 121  527.312625   3.228899   0 #> 122  504.954192   2.659461   0 #> 123  502.141292   2.589807   0 #> 124  526.234983   2.705783   0 #> 125  500.638644   3.089239   0 #> 126  500.059625   2.606697   0 #> 127  725.517241   3.976653   0 #> 128  658.269324   3.799662   0 #> 129  555.992025   2.619577   0 #> 130  616.296243   2.695711   0 #> 131  500.253871   2.651269   0 #> 132  545.019261   2.733517   0 #> 133  575.085311   3.523283   0 #> 134  501.403159   2.914429   0 #> 135  502.495759   2.582963   0 #> 136  500.863017   3.120455   0 #> 137  508.778961   2.522310   0 #> 138  541.565378   2.619415   0 #> 139  500.475477   2.739168   0 #> 140  500.270475   3.675433   0 #> 141  501.204721   2.934786   0 #> 142  500.625583   2.843067   0 #> 143  507.825709   2.868991   0 #> 144  500.691188   3.528839   0 #> 145  516.355382   2.596683   0 #> 146  805.716355   2.949842   0 #> 147  500.003954   2.750313   0 #> 148  522.077909   2.528010   0 #> 149  501.210666   3.274279   0 #> 150  602.472461   2.616197   0 #> 151  513.659133   2.843930   0 #> 152  500.663750   2.689105   0 #> 153  510.963897   3.366682   0 #> 154  522.600544   2.688731   0 #> 155  614.637702   2.509009   0 #> 156  527.019625   2.526551   0 #> 157  877.519347   2.541657   0 #> 158  680.952814   2.646322   0 #> 159  500.477345   2.612846   0 #> 160  500.663132   3.115156   0 #> 161  500.330086   3.266014   0 #> 162  509.908940   3.338836   0 #> 163  500.504672   2.510119   0 #> 164  500.466114   3.614969   0 #> 165  500.441921   3.766217   0 #> 166  500.879215   3.262574   0 #> 167  500.004235   2.562112   0 #> 168  565.490940   3.248015   0 #> 169  500.076843   2.712696   0 #> 170  500.190932   2.510428   0 #> 171  500.466906   2.877229   0 #> 172  500.543919   3.079900   0 #> 173  598.524052   2.554814   0 #> 174  502.574628   2.503031   0 #> 175  503.446985   2.514415   0 #> 176  562.518045   2.681020   0 #> 177  532.893294   2.549289   0 #> 178  500.650228   2.612189   0 #> 179  503.091579   2.555571   0 #> 180  501.240620   2.722392   0 #> 181  500.024889   2.850611   0 #> 182  536.185045   2.891978   0 #> 183  500.361950   2.661718   0 #> 184  500.744518   2.547442   0 #> 185  500.183234   2.610893   0 #> 186  500.279948   2.811480   0 #> 187  500.522697   2.509612   0 #> 188  510.659770   3.865953   0 #> 189  507.483973   3.023555   0 #> 190  593.404715   4.064764   0 #> 191  500.402195   2.963852   0 #> 192  528.161914   2.994763   0 #> 193  502.801377   2.504986   0 #> 194  582.730230   2.709031   0 #> 195  501.919071   2.694055   0 #> 196  500.110428   2.683996   0 #> 197  500.587460   2.518227   0 #> 198  500.023240   2.621676   0 #> 199  502.131189   3.001813   0 #> 200  500.006670   2.723487   0 #> 201  501.075440   2.511671   0 #> 202  514.994749   2.668222   0 #> 203  845.650267   2.553714   0 #> 204  540.124441   2.558160   0 #> 205  503.465483   2.712929   0 #> 206  847.217600   2.507459   0 #> 207  500.608700   2.553017   0 #> 208  508.136022   2.689730   0 #> 209  516.143998   2.721260   0 #> 210  515.746957   3.008923   0 #> 211  507.720064   2.895438   0 #> 212  501.157698   2.821126   0 #> 213  500.028963   3.472835   0 #> 214  500.079420   2.908472   0 #> 215  500.030337   3.336475   0 #> 216  758.653557   2.667893   0 #> 217  500.026843   2.794806   0 #> 218  501.277425   2.514612   0 #> 219  531.433368   3.308837   0 #> 220  500.391368   2.644101   0 #> 221  564.814306   2.791535   0 #> 222  500.394046   2.589801   0 #> 223  570.834058   2.657954   0 #> 224  502.864685   3.581861   0 #> 225  500.024344   2.530850   0 #> 226  651.362540   2.968487   0 #> 227  500.470925   2.842960   0 #> 228  500.098599   2.674924   0 #> 229  539.356064   2.754734   0 #> 230  573.389605   2.658067   0 #> 231  614.920685   2.733907   0 #> 232  502.096020   3.292027   0 #> 233  545.330825   3.011867   0 #> 234  500.337341   2.533162   0 #> 235  512.208342   2.590957   0 #> 236  991.347600   2.562842   0 #> 237  500.192432   2.617049   0 #> 238  501.939633   2.642611   0 #> 239  500.641632   2.784152   0 #> 240  530.240241   2.538597   0 #> 241  843.271071   2.799975   0 #> 242  514.920775   3.296449   0 #> 243  500.960570   2.785252   0 #> 244  500.826391   3.531060   0 #> 245  502.826337   2.533129   0 #> 246  502.201435   3.577559   0 #> 247  504.706523   2.610708   0 #> 248  500.041191   2.676326   0 #> 249  518.493408   3.212574   0 #> 250  851.547552   2.587907   0 #> 251  787.757912   2.620246   0 #> 252  675.155691   3.409414   0 #> 253  524.848046   3.004676   0 #> 254  508.863525   3.552545   0 #> 255  532.801651   3.226842   0 #> 256  505.738045   2.590875   0 #> 257  500.041506   2.779221   0 #> 258  504.989668   3.501986   0 #> 259  500.089394   2.962683   0 #> 260  593.732134   3.227095   0 #> 261  500.307656   2.766600   0 #> 262  501.188258   2.547587   0 #> 263  501.199571   2.998090   0 #> 264  505.217448   2.566930   0 #> 265  500.925592   2.947989   0 #> 266  513.615221   2.575511   0 #> 267  500.152031   3.501141   0 #> 268  504.600901   3.468629   0 #> 269  501.993222   2.682823   0 #> 270  508.112198   2.787877   0 #> 271  843.693961   3.918671   0 #> 272  500.092120   2.730471   0 #> 273  502.851737   2.616863   0 #> 274  505.976554   3.360966   0 #> 275  500.261605   2.866187   0 #> 276  562.678193   3.259982   0 #> 277  502.066488   2.957522   0 #> 278  822.941951   2.572948   0 #> 279  523.543036   2.661193   0 #> 280  500.110122   3.573173   0 #> 281  500.518839   2.559459   0 #> 282  577.628940   2.623902   0 #> 283  501.357353   2.894810   0 #> 284  838.668846   2.848299   0 #> 285  500.026655   3.384256   0 #> 286  638.215118   2.858516   0 #> 287  501.143050   3.301318   0 #> 288  500.036559   2.889543   0 #> 289  798.397970   3.970584   0 #> 290  560.746663   2.757515   0 #> 291  634.538409   3.078655   0 #> 292  690.610396   2.708153   0 #> 293  500.546555   2.596717   0 #> 294  510.183159   2.712959   0 #> 295  500.633453   2.933496   0 #> 296  883.895317   2.979450   0 #> 297  500.071157   2.629447   0 #> 298  500.727028   2.577982   0 #> 299  500.188885   2.739329   0 #> 300  500.107965   2.942766   0 #> 301  510.170729   2.792797   0 #> 302  500.798522   2.662746   0 #> 303  515.784256   2.741055   0 #> 304  500.167701   2.530416   0 #> 305  510.163177   2.832903   0 #> 306  504.343102   2.779211   0 #> 307  500.623878   2.660580   0 #> 308  525.922342   2.529072   0 #> 309  500.076636   2.719906   0 #> 310  541.530331   2.930239   0 #> 311  519.710311   2.662717   0 #> 312  500.188865   2.894507   0 #> 313  500.021173   3.545637   0 #> 314  511.302982   2.863825   0 #> 315  500.258103   4.713548   0 #> 316  541.469826   2.754426   0 #> 317  502.482309   3.255395   0 #> 318  501.123453   3.217969   0 #> 319  500.023120   2.711647   0 #> 320  601.842108   2.694409   0 #> 321  501.252281   2.754739   0 #> 322  514.297290   2.503017   0 #> 323  512.628945   2.866796   0 #> 324  500.126034   2.833822   0 #> 325  513.251794   2.576981   0 #> 326  525.412750   2.537707   0 #> 327  512.414431   3.000908   0 #> 328  502.609532   2.530253   0 #> 329  517.196296   3.745285   0 #> 330  500.537439   3.316653   0 #> 331  500.137227   3.059633   0 #> 332  501.143816   3.007243   0 #> 333  560.129328   3.568201   0 #> 334  583.155851   2.678779   0 #> 335  500.144531   2.896061   0 #> 336  892.291476   2.618261   0 #> 337  636.346401   4.567919   0 #> 338  555.174721   2.798247   0 #> 339  602.322820   2.575343   0 #> 340  501.463068   2.522917   0 #> 341  503.373575   3.351776   0 #> 342  501.583398   2.833245   0 #> 343  500.921597   2.532695   0 #> 344  500.058400   2.510265   0 #> 345  679.293065   2.547893   0 #> 346  500.041494   2.850873   0 #> 347  517.973392   2.587644   0 #> 348  500.325368   2.722912   0 #> 349  500.356702   2.846867   0 #> 350  513.960430   2.614374   0 #> 351  500.855268   2.532513   0 #> 352  958.900324   2.562506   0 #> 353  500.045887   2.670003   0 #> 354  500.312999   2.549166   0 #> 355  501.684993   2.704026   0 #> 356  570.660734   3.271902   0 #> 357  752.915273   2.566271   0 #> 358  500.158855   3.475744   0 #> 359  818.444554   2.521279   0 #> 360  529.956900   2.851023   0 #> 361  500.394409   2.599150   0 #> 362  701.072920   2.697055   0 #> 363  677.578620   3.130454   0 #> 364  503.817309   2.667688   0 #> 365  500.500453   2.578195   0 #> 366  500.581129   3.606710   0 #> 367  505.882730   2.811252   0 #> 368  504.737800   2.799834   0 #> 369  500.257641   2.745120   0 #> 370  500.226970   3.079830   0 #> 371  500.438639   2.640388   0 #> 372  500.115226   2.816974   0 #> 373  526.498029   2.601372   0 #> 374  500.008790   2.771777   0 #> 375  502.124682   3.503653   0 #> 376  501.223787   2.683341   0 #> 377  500.085841   2.648461   0 #> 378  500.006531   2.522818   0 #> 379  586.958150   2.734375   0 #> 380  500.003126   2.860967   0 #> 381  502.977818   3.393177   0 #> 382  500.002174   2.701648   0 #> 383  757.786067   3.015525   0 #> 384  503.695672   2.508649   0 #> 385  526.594628   3.199714   0 #> 386  514.727545   2.573290   0 #> 387  584.579323   2.648130   0 #> 388  500.078683   3.383745   0 #> 389  500.384003   2.990713   0 #> 390  528.562112   2.814519   0 #> 391  833.257103   2.953158   0 #> 392  505.641697   2.702841   0 #> 393  889.119946   3.031239   0 #> 394  500.523946   3.224537   0 #> 395  500.039148   2.702138   0 #> 396  539.397392   2.625623   0 #> 397  565.689872   2.646765   0 #> 398  501.407169   3.371951   0 #> 399  500.426041   2.653695   0 #> 400  505.214859   2.671097   0 #> 401  500.806392   2.603195   0 #> 402  877.615363   2.955380   0 #> 403  500.041261   3.655646   0 #> 404  687.633281   2.633937   0 #> 405  502.228625   2.691904   0 #> 406  500.203253   2.856537   0 #> 407  500.616068   2.992740   0 #> 408  516.384780   2.581337   0 #> 409  501.133759   2.797265   0 #> 410  505.873487   2.914529   0 #> 411  528.797904   2.871224   0 #> 412  500.791447   2.707178   0 #> 413  501.490029   2.599015   0 #> 414  501.566488   2.999979   0 #> 415  503.102397   2.834211   0 #> 416  500.052501   2.594805   0 #> 417  500.029702   3.259778   0 #> 418  500.333971   2.509826   0 #> 419  501.103333   2.718912   0 #> 420  500.273383   2.628552   0 #> 421  537.762354   3.123600   0 #> 422  500.265349   2.851668   0 #> 423  510.633898   2.760192   0 #> 424  506.419830   3.294071   0 #> 425  500.852625   2.987801   0 #> 426  500.009341   2.968975   0 #> 427  501.345782   3.210525   0 #> 428  500.253497   2.798963   0 #> 429  500.294373   2.967334   0 #> 430  500.511814   2.787452   0 #> 431  511.661282   2.501359   0 #> 432  598.631909   2.709996   0 #> 433  500.277525   2.774625   0 #> 434  506.276509   2.655905   0 #> 435  511.622129   2.731050   0 #> 436  598.291326   2.691261   0 #> 437  501.158760   2.704328   0 #> 438  505.232864   3.179597   0 #> 439  539.759155   3.099345   0 #> 440  834.578552   2.600040   0 #> 441  501.332927   2.727154   0 #> 442  504.894677   2.542404   0 #> 443  505.720175   2.994341   0 #> 444  500.050066   2.526880   0 #> 445  504.411874   2.895205   0 #> 446  500.663053   2.827109   0 #> 447  500.379548   2.843157   0 #> 448  501.174108   3.015756   0 #> 449  503.943766   2.639910   0 #> 450  507.003832   2.958694   0 #> 451  500.146912   2.856646   0 #> 452  501.165485   3.046248   0 #> 453  626.190667   3.199048   0 #> 454  608.524048   3.414212   0 #> 455  505.444794   2.923690   0 #> 456  578.667072   3.729571   0 #> 457  501.084632   3.111185   0 #> 458  500.483225   2.568742   0 #> 459  500.028951   2.886396   0 #> 460  500.206670   3.537702   0 #> 461  658.833534   2.726147   0 #> 462  500.096755   2.698408   0 #> 463  503.016142   2.955888   0 #> 464  500.904686   3.142903   0 #> 465  545.566988   3.260158   0 #> 466  513.298939   2.657492   0 #> 467  623.826986   2.641244   0 #> 468  501.413603   3.065291   0 #> 469  500.218514   2.624751   0 #> 470  501.609388   2.704481   0 #> 471  500.624069   2.716713   0 #> 472  501.175148   2.604712   0 #> 473  510.663537   2.791638   0 #> 474  502.205497   2.606765   0 #> 475  886.255295   2.633421   0 #> 476  500.029638   2.592045   0 #> 477  500.030437   2.629672   0 #> 478  504.255895   2.526622   0 #> 479  501.981440   3.228144   0 #> 480  602.967896   2.698633   0 #> 481  500.369359   2.595738   0 #> 482  502.090058   3.120162   0 #> 483  555.730569   3.488361   0 #> 484  535.873865   2.766348   0 #> 485  534.463310   2.777670   0 #> 486  504.377549   2.559239   0 #> 487  519.907840   2.521628   0 #> 488  500.904893   2.604531   0 #> 489  508.320157   2.859942   0 #> 490  500.221712   2.590726   0 #> 491  502.816779   2.620458   0 #> 492  500.370666   2.666302   0 #> 493  500.109571   2.565347   0 #> 494  501.244505   2.505060   0 #> 495  500.160089   2.735674   0 #> 496  500.124553   2.655445   0 #> 497  501.833863   3.115242   0 #> 498  500.129163   2.804268   0 #> 499  501.093030   3.933208   0 #> 500  530.930911   3.235421   0 #> 501  502.266542   3.274967   0 #> 502  500.645436   3.143631   0 #> 503  556.690789   2.667842   0 #> 504  501.626548   2.505678   0 #> 505  500.010686   3.009626   0 #> 506  501.521968   2.833608   0 #> 507  500.004569   2.501022   0 #> 508  500.769214   2.762139   0 #> 509  500.356152   2.631851   0 #> 510  500.146746   2.654351   0 #> 511  502.438934   4.586436   0 #> 512  509.590905   2.724981   0 #> 513  500.161452   2.524919   0 #> 514  930.003146   2.729096   0 #> 515  501.197244   2.574598   0 #> 516  592.137837   2.909470   0 #> 517  501.270122   2.524427   0 #> 518  510.535310   3.332436   0 #> 519  514.561417   2.569246   0 #> 520  507.169766   2.635494   0 #> 521  501.033908   2.528272   0 #> 522  503.168332   2.554429   0 #> 523  500.638228   2.926425   0 #> 524  500.163089   2.704579   0 #> 525  595.358500   3.264568   0 #> 526  504.257602   3.205151   0 #> 527  503.348807   2.651455   0 #> 528  503.283055   2.558490   0 #> 529  516.078290   2.693437   0 #> 530  500.507518   2.634896   0 #> 531  502.578649   2.710029   0 #> 532  818.316869   2.587053   0 #> 533  500.179795   2.886014   0 #> 534  549.465695   2.881138   0 #> 535  500.126297   3.053328   0 #> 536  500.047895   2.578816   0 #> 537  501.155398   2.513797   0 #> 538  535.128198   2.578258   0 #> 539  502.097725   2.531654   0 #> 540  658.915545   2.581209   0 #> 541  837.501389   2.695122   0 #> 542  609.863464   2.756005   0 #> 543  538.391330   2.627769   0 #> 544  501.278099   2.614003   0 #> 545  501.017224   2.501723   0 #> 546  626.592405   3.329900   0 #> 547  502.735592   2.564567   0 #> 548  628.905746   2.531487   0 #> 549  500.164071   2.750745   0 #> 550  500.385270   2.891120   0 #> 551  501.870326   3.328711   0 #> 552  512.700297   3.018939   0 #> 553  576.474976   3.226076   0 #> 554  507.663387   2.520947   0 #> 555  500.005428   2.600308   0 #> 556  962.875145   2.566105   0 #> 557  547.542732   2.668345   0 #> 558  500.704340   3.229601   0 #> 559  516.001332   2.517126   0 #> 560  580.378672   2.834436   0 #> 561  500.163599   2.664444   0 #> 562  501.085216   3.472439   0 #> 563  594.398892   3.570131   0 #> 564  507.515922   2.530668   0 #> 565  545.647520   2.814306   0 #> 566  771.200970   3.181731   0 #> 567  508.543410   2.732734   0 #> 568  750.274618   2.593342   0 #> 569  599.651079   3.871239   0 #> 570  577.955952   2.504420   0 #> 571  500.048575   4.219575   0 #> 572  511.854005   2.642103   0 #> 573  580.416545   2.639292   0 #> 574  874.779027   3.920681   0 #> 575  500.336013   2.992880   0 #> 576  511.354118   3.737716   0 #> 577  501.021928   2.581634   0 #> 578  641.148808   2.828636   0 #> 579  500.102896   3.442032   0 #> 580  516.593707   2.665615   0 #> 581  880.729760   2.875633   0 #> 582  511.692656   2.775903   0 #> 583  500.162691   2.528732   0 #> 584  500.066492   2.596738   0 #> 585  500.371170   2.767145   0 #> 586  506.270889   2.763641   0 #> 587  507.849669   3.475812   0 #> 588  505.320973   3.660678   0 #> 589  500.043205   3.378653   0 #> 590  511.178787   2.983002   0 #> 591  500.722291   2.626694   0 #> 592  511.205146   2.880538   0 #> 593  628.497764   2.534651   0 #> 594  500.014058   2.781993   0 #> 595  500.874704   3.642450   0 #> 596  501.662361   2.732400   0 #> 597  501.541773   4.016979   0 #> 598  513.601701   2.640559   0 #> 599  500.006774   2.926130   0 #> 600  518.887087   2.586392   0 #> 601  500.154696   2.977718   0 #> 602  500.821149   2.552737   0 #> 603  594.343072   2.601840   0 #> 604  502.931969   2.552367   0 #> 605  536.717825   2.637543   0 #> 606  931.812672   3.217459   0 #> 607  504.434248   2.872355   0 #> 608  500.318050   3.060417   0 #> 609  500.004099   2.597551   0 #> 610  809.887714   2.519032   0 #> 611  504.075497   2.770777   0 #> 612  502.678856   2.763548   0 #> 613  504.152426   3.001312   0 #> 614  500.076252   2.927308   0 #> 615  514.386480   2.724593   0 #> 616  500.696145   2.650062   0 #> 617  556.624772   2.557774   0 #> 618  592.901157   2.761488   0 #> 619  500.309638   4.093942   0 #> 620  500.226150   3.312412   0 #> 621  504.545272   2.953007   0 #> 622  884.764198   2.620317   0 #> 623  500.249813   3.356678   0 #> 624  902.663745   3.399626   0 #> 625  500.069302   2.944362   0 #> 626  679.518000   3.248921   0 #> 627  500.630912   3.181149   0 #> 628  519.898737   3.098783   0 #> 629  500.160220   2.693394   0 #> 630  501.069149   2.601584   0 #> 631  504.587017   2.938627   0 #> 632  500.278523   3.425989   0 #> 633  522.291411   2.633639   0 #> 634  501.515342   2.706722   0 #> 635  511.776330   3.931964   0 #> 636  549.764745   2.787533   0 #> 637  515.122397   2.760537   0 #> 638  528.175711   2.528929   0 #> 639  533.374457   3.199082   0 #> 640  836.812478   2.669827   0 #> 641  505.203695   2.993459   0 #> 642  502.379314   2.513679   0 #> 643  514.483117   2.555925   0 #> 644  685.609233   2.563909   0 #> 645  500.589549   2.538355   0 #> 646  504.869136   2.654338   0 #> 647  677.628492   2.815559   0 #> 648  500.304734   2.548850   0 #> 649  500.003136   2.514483   0 #> 650  500.316277   2.889869   0 #> 651  500.473126   2.512386   0 #> 652  500.179698   3.528800   0 #> 653  500.902462   2.717465   0 #> 654  500.024486   3.328296   0 #> 655  500.272698   3.049816   0 #> 656  500.187776   2.940297   0 #> 657  500.420127   2.952345   0 #> 658  520.925806   2.785009   0 #> 659  500.005604   2.580043   0 #> 660  500.224408   3.024197   0 #> 661  500.126979   3.124309   0 #> 662  540.520264   2.699290   0 #> 663  509.674784   3.210749   0 #> 664  829.425042   2.903914   0 #> 665  500.109252   2.966590   0 #> 666  500.884255   2.866184   0 #> 667  531.030580   2.518934   0 #> 668  509.255607   2.635198   0 #> 669  500.036836   2.707851   0 #> 670  536.459090   4.324783   0 #> 671  501.187141   3.893433   0 #> 672  538.552503   2.771059   0 #> 673  563.414566   2.534287   0 #> 674  507.364945   2.789975   0 #> 675  503.462656   2.691501   0 #> 676  500.148835   3.036759   0 #> 677  500.489223   2.535079   0 #> 678  501.276435   2.540446   0 #> 679  517.593024   3.042339   0 #> 680  514.154232   2.548997   0 #> 681  500.079966   2.588372   0 #> 682  500.000051   2.699129   0 #> 683  500.162127   2.769228   0 #> 684  501.045461   2.660259   0 #> 685  501.051951   2.551895   0 #> 686  500.473490   2.903557   0 #> 687  544.050452   2.679210   0 #> 688  529.736890   3.311351   0 #> 689  565.492738   2.633390   0 #> 690  814.006644   2.723462   0 #> 691  518.968427   2.994773   0 #> 692  500.058894   3.297908   0 #> 693  759.550490   2.779497   0 #> 694  602.439289   2.656746   0 #> 695  504.695453   2.604888   0 #> 696  500.345697   2.741832   0 #> 697  534.153590   3.169967   0 #> 698  542.540585   2.711282   0 #> 699  511.118767   2.892987   0 #> 700  509.088941   3.108090   0 #> 701  792.049130   2.610916   0 #> 702  500.714456   2.921859   0 #> 703  542.286243   3.450649   0 #> 704  500.689739   2.641887   0 #> 705  515.611590   3.004898   0 #> 706  863.175603   3.041358   0 #> 707  682.324263   2.908734   0 #> 708  503.623974   2.769974   0 #> 709  515.398064   2.784783   0 #> 710  501.072879   2.750877   0 #> 711  504.104833   2.998307   0 #> 712  500.263854   2.521628   0 #> 713  509.275404   2.591030   0 #> 714  500.007176   3.368959   0 #> 715  500.574947   2.608094   0 #> 716  500.036020   2.836972   0 #> 717  500.008418   2.696214   0 #> 718  528.216523   3.227328   0 #> 719  508.932321   2.658948   0 #> 720  518.564766   2.872741   0 #> 721  734.053102   3.298394   0 #> 722  501.915316   2.547154   0 #> 723  517.956619   2.653495   0 #> 724  500.980294   2.961461   0 #> 725  529.699185   2.568803   0 #> 726  503.463778   3.062725   0 #> 727  500.374252   2.926317   0 #> 728  500.355810   3.093372   0 #> 729  503.179900   2.576916   0 #> 730  548.963197   2.852096   0 #> 731  500.035028   2.842690   0 #> 732  539.078041   2.507630   0 #> 733  500.536830   2.651434   0 #> 734  541.298257   2.906501   0 #> 735  501.247498   2.764831   0 #> 736  671.468219   2.579450   0 #> 737  503.484251   2.521694   0 #> 738  500.938342   2.640871   0 #> 739  500.036206   3.815731   0 #> 740  816.198007   2.866116   0 #> 741  632.684529   2.808520   0 #> 742  501.860773   2.569802   0 #> 743  500.684837   2.561469   0 #> 744  504.636676   3.492240   0 #> 745  519.618220   2.695952   0 #> 746  502.226689   2.735006   0 #> 747  500.068139   2.981448   0 #> 748  879.689566   2.511906   0 #> 749  500.657083   3.075543   0 #> 750  500.948350   2.787709   0 #> 751  500.464081   2.686921   0 #> 752  500.514374   3.682701   0 #> 753  500.399752   2.960519   0 #> 754  512.077821   2.629827   0 #> 755  559.382432   2.722355   0 #> 756  679.162473   2.832635   0 #> 757  506.661772   4.435734   0 #> 758  575.623783   2.734978   0 #> 759  595.392063   2.809036   0 #> 760  506.507241   2.800855   0 #> 761  504.640368   2.863344   0 #> 762  501.937077   4.139887   0 #> 763  608.901100   2.827607   0 #> 764  636.960391   4.638574   0 #> 765  591.018842   2.952695   0 #> 766  500.190142   2.776086   0 #> 767  570.555630   3.605268   0 #> 768  762.010046   2.802778   0 #> 769  500.267273   2.506911   0 #> 770  506.356558   2.889306   0 #> 771  682.270270   2.578739   0 #> 772  963.892736   2.886652   0 #> 773  500.196102   3.211686   0 #> 774  504.017697   2.550208   0 #> 775  645.188092   3.023681   0 #> 776  500.053447   2.894812   0 #> 777  502.930994   2.881313   0 #> 778  501.320981   2.619830   0 #> 779  500.995333   3.043749   0 #> 780  685.771142   2.585108   0 #> 781  506.058443   2.564389   0 #> 782  766.358990   2.765534   0 #> 783  506.503192   2.679017   0 #> 784  503.273184   2.655776   0 #> 785  526.001671   2.779019   0 #> 786  500.129214   2.631864   0 #> 787  500.024178   2.818051   0 #> 788  503.750104   2.647121   0 #> 789  691.089802   2.684738   0 #> 790  500.105731   2.769284   0 #> 791  543.063488   2.671600   0 #> 792  528.540883   3.044894   0 #> 793  509.408951   2.992828   0 #> 794  526.429128   2.590996   0 #> 795  510.637887   3.136502   0 #> 796  505.063427   3.233171   0 #> 797  502.042537   2.945970   0 #> 798  501.682275   3.610090   0 #> 799  500.815975   2.696640   0 #> 800  500.986562   3.660363   0 #> 801  621.107355   3.004697   0 #> 802  500.002443   2.629808   0 #> 803  863.453804   2.716618   0 #> 804  523.129449   2.700991   0 #> 805  523.332915   2.663966   0 #> 806  532.339052   3.759852   0 #> 807  500.793002   2.628336   0 #> 808  501.305603   2.647785   0 #> 809  501.187352   3.146639   0 #> 810  502.781910   2.671664   0 #> 811  502.735697   3.367123   0 #> 812  507.751381   2.553249   0 #> 813  504.069194   2.744236   0 #> 814  517.205545   3.109937   0 #> 815  756.519495   2.932995   0 #> 816  500.246271   2.676662   0 #> 817  500.287018   2.500391   0 #> 818  544.928079   4.160073   0 #> 819  502.489837   2.597443   0 #> 820  500.566648   3.385149   0 #> 821  500.368230   3.597017   0 #> 822  584.914005   2.774662   0 #> 823  500.238908   2.512713   0 #> 824  500.777994   3.334252   0 #> 825  501.245594   3.575989   0 #> 826  514.238300   2.504484   0 #> 827  500.106475   3.615573   0 #> 828  500.320949   2.501128   0 #> 829  586.851661   2.787281   0 #> 830  510.068779   3.612489   0 #> 831  500.120260   2.777472   0 #> 832  500.477689   4.184681   0 #> 833  500.161439   2.654550   0 #> 834  513.854200   2.900214   0 #> 835  506.209812   2.861188   0 #> 836  517.662413   3.180174   0 #> 837  500.127399   2.543809   0 #> 838  500.115914   2.728031   0 #> 839  500.881015   2.648359   0 #> 840  500.771764   2.929239   0 #> 841  527.170423   2.524886   0 #> 842  515.173219   2.821094   0 #> 843  500.082211   2.556381   0 #> 844  519.939403   2.897822   0 #> 845  792.346632   2.745537   0 #> 846  674.385195   2.621883   0 #> 847  512.571941   4.904990   0 #> 848  500.242769   2.708684   0 #> 849  500.174228   2.561546   0 #> 850  511.353903   2.667759   0 #> 851  504.090296   2.927983   0 #> 852  500.036061   2.509884   0 #> 853  500.123293   2.603046   0 #> 854  500.050626   3.522661   0 #> 855  502.084083   2.687766   0 #> 856  500.007822   2.518636   0 #> 857  500.108596   2.502571   0 #> 858  500.628637   3.423303   0 #> 859  656.450996   2.644670   0 #> 860  506.031276   3.047236   0 #> 861  508.029523   3.153206   0 #> 862  796.998663   2.726440   0 #> 863  500.269545   3.435961   0 #> 864  501.475307   2.578183   0 #> 865  500.526520   2.510253   0 #> 866  753.667916   2.668160   0 #> 867  502.044739   2.906863   0 #> 868  500.526978   2.555667   0 #> 869  801.266170   3.265614   0 #> 870  500.121065   2.615944   0 #> 871  506.550949   2.804021   0 #> 872  500.849428   2.508314   0 #> 873  509.310602   2.677960   0 #> 874  533.805837   2.893046   0 #> 875  500.080208   3.861234   0 #> 876  500.364364   3.209542   0 #> 877  504.906817   2.792534   0 #> 878  539.773488   3.460288   0 #> 879  714.078419   2.749481   0 #> 880   15.667084   2.506554   1 #> 881  558.623573   2.779444   1 #> 882  263.305812   2.576705   1 #> 883  783.335726   2.762158   1 #> 884  260.573347   3.161712   1 #> 885   28.086805   2.741944   1 #> 886  819.509427   2.596051   1 #> 887  632.039932   2.610678   1 #> 888   80.157336   2.536739   1 #> 889  200.135045   3.253967   1 #> 890  163.174289   2.587168   1 #> 891   60.353212   2.691235   1 #> 892  369.769332   3.368460   1 #> 893  855.392665   2.585258   1 #> 894  452.043753   2.820920   1 #> 895  948.646191   2.717473   1 #> 896  630.468078   2.852281   1 #> 897  397.478907   2.780198   1 #> 898  745.163575   2.899369   1 #> 899  475.601808   2.539763   1 #> 900  861.314505   2.587800   1 #> 901  671.795972   2.751589   1 #> 902   33.064772   2.744155   1 #> 903  412.163367   3.160207   1 #> 904  186.342516   3.014794   1 #> 905  407.295252   3.582373   1 #> 906  597.533896   2.911505   1 #> 907  648.106463   3.235007   1 #> 908  474.129618   3.242801   1 #> 909  335.280995   2.704893   1 #> 910  103.252789   3.448410   1 #> 911  149.459687   2.734805   1 #> 912  747.338946   2.671683   1 #> 913  520.955364   2.996931   1 #> 914  291.742187   2.572312   1 #> 915  359.759469   2.637359   1 #> 916  304.436145   2.814960   1 #> 917  351.785178   2.616604   1 #> 918  552.517639   2.806332   1 #> 919  459.238205   2.867914   1 #> 920  336.427974   2.539081   1 #> 921  360.470745   2.513454   1 #> 922  981.670504   2.860723   1 #> 923   32.580053   3.000935   1 #> 924  840.831048   2.568378   1 #> 925  326.891832   2.536832   1 #> 926  917.799294   3.090956   1 #> 927  739.741520   2.708224   1 #> 928  546.230188   2.793296   1 #> 929  789.881160   2.577762   1 #> 930   70.591389   2.742851   1 #> 931  257.601032   2.686919   1 #> 932  172.410805   3.396446   1 #> 933  276.117183   2.587343   1 #> 934  876.843354   2.929087   1 #> 935   45.926931   2.832373   1 #> 936  473.790934   3.586488   1 #> 937  133.384306   2.585944   1 #> 938  666.015986   2.731516   1 #> 939  997.270320   3.037984   1 #> 940  245.002841   3.117876   1 #> 941  848.704614   2.798219   1 #> 942  135.689391   2.814526   1 #> 943  405.243436   3.544873   1 #> 944  487.223305   2.500668   1 #> 945  218.401433   2.702546   1 #> 946  466.231015   3.706727   1 #> 947  549.089431   2.911473   1 #> 948  720.937244   2.575228   1 #> 949  381.029116   2.723851   1 #> 950  939.067785   2.774915   1 #> 951  809.556426   3.296426   1 #> 952  401.912369   2.560571   1 #> 953  388.256343   2.809548   1 #> 954    9.562927   3.091468   1 #> 955  536.098270   2.539051   1 #> 956  131.355319   4.139949   1 #> 957  743.643147   2.640162   1 #> 958  725.601984   2.523317   1 #> 959  770.610994   3.619096   1 #> 960  150.965165   3.045343   1 #> 961  620.411078   3.362363   1 #> 962  147.982988   2.555559   1 #> 963  555.683984   2.804426   1 #> 964  465.837976   3.517465   1 #> 965  896.546970   2.879149   1 #> 966  618.629586   2.569284   1 #> 967  316.435512   2.605936   1 #> 968  478.709590   3.061028   1 #> 969  779.702932   2.523049   1 #> 970  586.938226   3.590171   1 #> 971  210.985703   2.667676   1 #> 972  867.532372   2.600777   1 #> 973  102.380835   2.581937   1 #> 974  926.813072   2.584060   1 #> 975  843.353162   2.730698   1 #> 976  855.881217   3.169992   1 #> 977  464.091086   2.512067   1 #> 978  708.380438   3.225728   1 #> 979  795.390216   3.196429   1 #> 980  574.413284   2.812768   1 #> 981   33.689809   2.630869   1 #> 982  701.591095   2.535079   1 #> 983  199.169804   2.629085   1 #> 984  927.883975   5.483728   1 #> 985  609.820848   3.043110   1 #> 986  468.242031   3.328476   1 #> 987  102.801860   2.724161   1 #> 988  710.985181   2.969655   1 #> 989  774.111327   3.067889   1 #> 990  992.951898   2.848188   1 #> 991  365.379052   3.639894   1 #> 992  185.617087   3.367773   1 #> 993   89.508984   2.924758   1 #> 994  338.395476   2.748753   1 #> 995  756.453738   2.843721   1 #> 996  431.721820   2.579178   1 #> 997  281.137344   2.568184   1 #> 998  510.834974   2.731835   1 #> 999   96.895749   3.004970   1 #> 1000 919.961667   2.752844   1 #> 1001 187.738294   4.073395   1 #>  #> [[3]] #>             ts magnitudes gen #> 1   504.646587   2.649324   2 #> 2   504.079740   2.964170   2 #> 3   586.936109   2.517217   2 #> 4   988.200614   2.716676   2 #> 5   512.671678   2.766123   2 #> 6   558.154096   2.862845   2 #> 7   764.014471   2.691565   2 #> 8   503.965287   3.544638   2 #> 9   560.458405   2.771901   2 #> 10  570.343446   3.283684   2 #> 11  504.953548   3.864934   2 #> 12  575.699807   2.983609   2 #> 13  508.352789   2.906066   2 #> 14  510.590343   2.992052   2 #> 15  592.219736   2.563818   2 #> 16  501.092727   2.895903   2 #> 17  977.023668   2.531536   2 #> 18  531.862686   3.087977   2 #> 19  500.135591   2.662363   2 #> 20  500.089641   2.603618   2 #> 21  501.310229   3.364921   2 #> 22  500.271023   2.724256   2 #> 23  500.057418   2.563353   2 #> 24  684.820156   3.287014   2 #> 25  683.975480   3.424956   2 #> 26  516.783937   2.851211   2 #> 27  837.472934   2.892589   2 #> 28  500.184756   2.500011   2 #> 29  541.374970   3.314722   2 #> 30  579.929042   3.890213   2 #> 31  569.013835   3.010840   2 #> 32  783.252939   2.532716   2 #> 33  556.428144   3.438197   2 #> 34  541.406043   2.594682   2 #> 35  608.536676   3.451319   2 #> 36  594.097977   2.795267   2 #> 37  541.565652   2.560951   2 #> 38  520.041336   2.742778   2 #> 39  507.499875   2.684116   2 #> 40  647.509400   2.829516   2 #> 41  579.837231   2.935788   2 #> 42  582.908825   2.680815   2 #> 43  518.245641   2.586423   2 #> 44  620.037520   3.464977   2 #> 45  510.800642   2.574402   2 #> 46  510.028731   2.757000   2 #> 47  509.251640   2.686893   2 #> 48  511.105369   2.663269   2 #> 49  758.782291   3.164901   2 #> 50  509.521606   2.772631   2 #> 51  509.137249   3.464324   2 #> 52  510.419417   2.608511   2 #> 53  526.247218   2.560120   2 #> 54  542.004605   2.795578   2 #> 55  502.017066   2.636060   2 #> 56  510.641978   3.354216   2 #> 57  505.520439   2.916737   2 #> 58  743.367538   2.574832   2 #> 59  658.510323   2.547649   2 #> 60  502.055931   2.882441   2 #> 61  648.781130   2.507002   2 #> 62  511.257030   3.767868   2 #> 63  686.888115   4.607694   2 #> 64  503.819708   2.502752   2 #> 65  501.346863   2.638423   2 #> 66  501.340475   3.245071   2 #> 67  597.182955   2.666083   2 #> 68  802.444550   2.832115   2 #> 69  784.350228   2.649028   2 #> 70  782.529113   3.247425   2 #> 71  593.479161   3.068119   2 #> 72  724.782665   2.880373   2 #> 73  541.928090   2.713830   2 #> 74  501.415447   2.962650   2 #> 75  500.112538   3.493724   2 #> 76  591.759969   2.588891   2 #> 77  500.707805   2.570858   2 #> 78  571.115347   2.699381   2 #> 79  504.775124   2.923808   2 #> 80  504.227425   3.177825   2 #> 81  651.630305   2.512496   2 #> 82  615.463242   3.762014   2 #> 83  507.471392   2.650689   2 #> 84  557.076392   4.980611   2 #> 85  820.944940   2.961247   2 #> 86  525.049392   2.798273   2 #> 87  843.780729   2.954539   2 #> 88  843.874304   2.851681   2 #> 89  925.476421   2.566679   2 #> 90  800.359553   2.506357   2 #> 91  806.695974   2.762034   2 #> 92  799.263771   3.133485   2 #> 93  644.804909   2.750859   2 #> 94  511.362125   2.883154   2 #> 95  500.349399   3.097039   2 #> 96  520.088988   2.611554   2 #> 97  501.325169   2.853571   2 #> 98  501.921524   2.783376   2 #> 99  927.767976   3.516375   2 #> 100 521.417114   3.640639   2 #> 101 745.933389   2.684339   2 #> 102 572.141922   3.890322   2 #> 103 579.492504   2.666712   2 #> 104 517.301889   2.772123   2 #> 105 500.234942   2.782150   2 #> 106 525.837744   2.662845   2 #> 107 602.354894   2.533382   2 #> 108 561.061166   3.005952   2 #> 109 637.226144   3.592009   2 #> 110 636.814740   2.602759   2 #> 111 636.683580   2.957143   2 #> 112 929.239567   3.076957   2 #> 113 958.949842   2.938753   2 #> 114 520.679422   3.431903   2 #> 115 880.239602   3.348705   2 #> 116 501.203613   2.558512   2 #> 117 596.190561   2.715095   2 #> 118 500.113685   2.615799   2 #> 119 648.788147   3.556609   2 #> 120 910.855369   2.865363   2 #> 121 500.954706   2.523704   2 #> 122 652.877431   2.519621   2 #> 123 760.284732   2.775696   2 #> 124 504.053545   2.683427   2 #> 125 502.399041   2.676217   2 #> 126 796.100496   2.657172   2 #> 127 572.548272   2.949493   2 #> 128 538.062700   2.602320   2 #> 129 510.207277   3.040062   2 #> 130 746.431480   2.890582   2 #> 131 502.273800   2.717259   2 #> 132 619.611982   2.880213   2 #> 133 646.950326   2.531113   2 #> 134 500.572117   2.524065   2 #> 135 500.252069   2.838515   2 #> 136 556.468906   3.497527   2 #> 137 503.056449   3.047942   2 #> 138 633.890531   3.298129   2 #> 139 528.759416   2.838279   2 #> 140 562.949967   3.165670   2 #> 141 555.842859   4.626431   2 #> 142 513.373860   2.696867   2 #> 143 500.252308   2.688386   2 #> 144 503.033568   2.523155   2 #> 145 502.246474   2.690961   2 #> 146 535.320546   3.134580   2 #> 147 502.650253   3.886730   2 #> 148 504.982632   2.953555   2 #> 149 816.702955   2.628930   2 #> 150 502.597099   2.981394   2 #> 151 578.782287   3.055130   2 #> 152 775.018632   2.554645   2 #> 153 504.288934   2.572572   2 #> 154 876.795451   2.953015   2 #> 155 513.918228   2.908846   2 #> 156 511.145468   2.712633   2 #> 157 767.255431   2.510745   2 #> 158 557.252001   3.008312   2 #> 159 505.447013   2.510671   2 #> 160 752.465990   2.992329   2 #> 161 500.110193   2.935001   2 #> 162 776.828514   2.525202   2 #> 163 500.662529   2.542596   2 #> 164 876.583768   2.541946   2 #> 165 909.062712   2.513642   2 #> 166 874.906305   2.502211   2 #> 167 875.032512   2.979070   2 #> 168 875.325254   2.833641   2 #> 169 511.371422   2.981650   2 #> 170 684.172208   2.656054   2 #> 171 502.874138   2.870249   2 #> 172 764.891031   2.649751   2 #> 173 503.708697   2.915623   2 #> 174 548.268306   2.596669   2 #> 175 745.468361   3.813633   2 #> 176 503.373826   2.639742   2 #> 177 500.542780   2.707849   2 #> 178 530.862340   2.909394   2 #> 179 893.365948   2.504332   2 #> 180 934.937040   2.576162   2 #> 181 684.202220   5.151876   2 #> 182 687.169972   2.903264   2 #> 183 500.456330   2.890577   2 #> 184 500.249522   3.016014   2 #> 185 500.866814   3.017584   2 #> 186 554.391690   2.839346   2 #> 187 545.781715   2.631068   2 #> 188 834.622931   2.724940   2 #> 189 536.668359   2.651281   2 #> 190 518.350561   2.723978   2 #> 191 571.544578   2.537216   2 #> 192 519.544751   2.817380   2 #> 193 505.165803   2.586283   2 #> 194 529.809245   2.501011   2 #> 195 501.230040   2.942177   2 #> 196 759.809568   3.044003   2 #> 197 760.361100   2.582130   2 #> 198 592.416004   2.618813   2 #> 199 528.628442   3.251538   2 #> 200 735.362953   3.188981   2 #> 201 550.729113   3.758452   2 #> 202 501.104868   2.723945   2 #> 203 509.433462   2.845612   2 #> 204 506.707195   2.846266   2 #> 205 550.702992   2.693005   2 #> 206 511.918573   3.572616   2 #> 207 747.869718   2.672286   2 #> 208 502.836999   2.920589   2 #> 209 501.993460   2.757827   2 #> 210 637.239628   2.888380   2 #> 211 654.919914   2.532841   2 #> 212 636.995807   2.908059   2 #> 213 699.006923   2.760913   2 #> 214 769.326164   3.410934   2 #> 215 637.077321   3.117503   2 #> 216 645.327721   2.717535   2 #> 217 500.160051   5.513856   2 #> 218 510.028516   2.823834   2 #> 219 740.758404   2.976194   2 #> 220 502.841902   2.913923   2 #> 221 501.722986   2.798600   2 #> 222 806.598301   2.745385   2 #> 223 632.151578   3.222562   2 #> 224 503.001152   2.664001   2 #> 225 500.385638   3.428847   2 #> 226 506.938897   2.502857   2 #> 227 505.819048   2.531963   2 #> 228 520.745011   2.570283   2 #> 229 502.638762   2.812353   2 #> 230 500.464487   2.792306   2 #> 231 500.680886   2.712576   2 #> 232 594.981307   2.888270   2 #> 233 527.289796   2.676867   2 #> 234 512.836639   2.565190   2 #> 235 539.325247   2.818611   2 #> 236 823.737687   2.535004   2 #> 237 521.077589   3.639352   2 #> 238 526.392742   2.759589   2 #> 239 536.576533   3.356142   2 #> 240 563.362733   2.613948   2 #> 241 518.849726   2.597420   2 #> 242 519.141845   2.647931   2 #> 243 528.175850   3.299642   2 #> 244 525.690709   2.581878   2 #> 245 513.450454   3.601968   2 #> 246 513.018380   2.555006   2 #> 247 537.650303   2.888829   2 #> 248 517.865885   2.799010   2 #> 249 513.133524   2.827393   2 #> 250 514.582101   2.644831   2 #> 251 959.938820   3.122342   2 #> 252 501.078462   2.746410   2 #> 253 500.620404   2.825263   2 #> 254 524.570397   3.042994   2 #> 255 523.670607   3.004023   2 #> 256 819.655901   2.595133   2 #> 257 214.016693   2.703526   2 #> 258 423.347877   3.028713   2 #> 259 665.708679   2.710549   2 #> 260 110.108685   2.848268   2 #> 261 337.446003   2.973270   2 #> 262 194.206153   2.556465   2 #> 263 172.649867   3.099596   2 #> 264 150.264393   3.493238   2 #> 265 488.902175   3.033316   2 #> 266 474.164277   2.536424   2 #> 267   9.984834   2.616170   2 #> 268 133.610663   2.802545   2 #> 269 689.123538   3.309598   2 #> 270 135.054663   2.633668   2 #> 271 131.907217   2.658066   2 #> 272 796.573532   2.779521   2 #> 273 669.548135   2.886706   2 #> 274 481.192722   2.836864   2 #> 275 896.752914   3.150256   2 #> 276 616.775735   2.600350   2 #> 277 795.502077   2.624104   2 #> 278 955.183610   2.554208   2 #> 279 929.002872   2.572735   2 #> 280 927.970363   2.949941   2 #> 281 927.920652   2.763094   2 #> 282 928.195709   2.979805   2 #> 283 931.252796   2.628100   2 #> 284 928.003954   3.662042   2 #> 285 971.838246   3.001894   2 #> 286 932.172579   2.674840   2 #> 287 935.301730   2.857790   2 #> 288 928.116374   2.743188   2 #> 289 930.986159   2.521992   2 #> 290 927.912610   2.503691   2 #> 291 957.333564   3.381335   2 #> 292 942.082795   2.544045   2 #> 293 928.574869   3.352973   2 #> 294 928.242503   2.605081   2 #> 295 985.562757   3.756340   2 #> 296 932.454875   2.881410   2 #> 297 932.728905   2.749757   2 #> 298 928.393385   2.548420   2 #> 299 927.944796   2.897149   2 #> 300 928.028559   2.732982   2 #> 301 970.091612   3.199930   2 #> 302 928.089316   3.276359   2 #> 303 933.968632   2.668759   2 #> 304 952.574114   2.563680   2 #> 305 929.054952   2.717990   2 #> 306 929.884797   3.275984   2 #> 307 945.541992   2.569350   2 #> 308 930.371573   2.701120   2 #> 309 930.021026   2.636056   2 #> 310 927.897708   3.291739   2 #> 311 935.455957   2.687961   2 #> 312 939.452346   3.038406   2 #> 313 928.202463   2.720140   2 #> 314 949.083667   3.060565   2 #> 315 927.992897   2.506714   2 #> 316 929.769556   2.534842   2 #> 317 978.666842   2.523562   2 #> 318 969.344966   2.881253   2 #> 319 966.177132   2.948469   2 #> 320 928.884140   4.313861   2 #> 321 927.922531   3.010827   2 #> 322 928.130827   3.029371   2 #> 323 935.913012   3.111553   2 #> 324 927.966663   2.685830   2 #> 325 368.608592   3.509314   2 #> 326 658.756158   2.608924   2 #> 327 365.424748   2.651054   2 #> 328  92.684387   2.748908   2 #> 329 190.557201   2.540837   2 #> 330 230.910864   2.563354   2 #>  #> [[4]] #>           ts magnitudes gen #> 1   505.7829   2.840429   3 #> 2   504.9577   3.341812   3 #> 3   523.4965   2.994727   3 #> 4   510.7229   3.150303   3 #> 5   913.2598   2.928315   3 #> 6   685.4185   2.792650   3 #> 7   511.5691   2.767836   3 #> 8   510.4643   3.716211   3 #> 9   553.5117   2.822544   3 #> 10  565.3780   2.878032   3 #> 11  574.8556   2.551895   3 #> 12  511.2630   2.802218   3 #> 13  689.7390   4.276883   3 #> 14  768.0210   2.638320   3 #> 15  693.5967   3.012608   3 #> 16  995.4669   2.637318   3 #> 17  690.1476   2.569449   3 #> 18  617.1454   3.973151   3 #> 19  509.5870   3.179804   3 #> 20  557.1493   2.643859   3 #> 21  961.3971   2.850008   3 #> 22  959.5694   2.513292   3 #> 23  558.2271   2.833935   3 #> 24  580.2277   2.634764   3 #> 25  589.1923   2.523805   3 #> 26  558.0499   2.741137   3 #> 27  557.2221   4.070674   3 #> 28  557.1341   2.615964   3 #> 29  557.2743   2.638432   3 #> 30  620.8717   2.768348   3 #> 31  681.3362   2.739795   3 #> 32  560.3932   2.832404   3 #> 33  564.8772   3.581118   3 #> 34  649.6399   3.231036   3 #> 35  557.9623   2.595503   3 #> 36  571.2413   2.523765   3 #> 37  557.8428   2.568598   3 #> 38  663.6748   2.988265   3 #> 39  559.1637   2.673687   3 #> 40  559.2615   2.570673   3 #> 41  853.4502   3.216773   3 #> 42  799.6191   3.491978   3 #> 43  885.0308   2.605888   3 #> 44  765.6306   2.614400   3 #> 45  505.8183   2.741911   3 #> 46  655.8613   2.724715   3 #> 47  557.8169   2.537776   3 #> 48  556.2547   2.857538   3 #> 49  555.8900   2.828099   3 #> 50  652.2108   2.791127   3 #> 51  558.9881   2.942437   3 #> 52  953.2983   2.705725   3 #> 53  569.8102   2.750445   3 #> 54  556.4103   2.968546   3 #> 55  557.8878   3.105630   3 #> 56  583.4242   2.587836   3 #> 57  556.0176   2.698343   3 #> 58  559.8832   3.067382   3 #> 59  556.2916   2.650785   3 #> 60  504.3791   3.345387   3 #> 61  506.2847   2.633490   3 #> 62  827.3955   2.820034   3 #> 63  838.0464   2.801780   3 #> 64  920.9706   3.091665   3 #> 65  926.3518   3.201770   3 #> 66  894.4071   2.584669   3 #> 67  876.9391   2.687858   3 #> 68  716.2886   2.832978   3 #> 69  684.4486   2.607172   3 #> 70  686.7737   2.667200   3 #> 71  685.3481   2.518080   3 #> 72  684.4687   2.683973   3 #> 73  689.2312   2.672916   3 #> 74  686.5411   3.064888   3 #> 75  984.8859   2.973868   3 #> 76  705.3422   2.615727   3 #> 77  684.2910   3.686198   3 #> 78  701.2232   3.260501   3 #> 79  735.3953   2.826002   3 #> 80  684.3059   2.534751   3 #> 81  684.3239   2.740529   3 #> 82  743.8592   2.693243   3 #> 83  925.1064   2.605339   3 #> 84  691.9296   2.947636   3 #> 85  841.4523   2.547662   3 #> 86  692.1009   2.871581   3 #> 87  684.2897   2.641381   3 #> 88  684.2215   2.545947   3 #> 89  684.9729   3.369724   3 #> 90  768.5624   3.228049   3 #> 91  521.4259   2.785968   3 #> 92  530.0102   2.592287   3 #> 93  556.2985   2.615498   3 #> 94  555.5748   2.555048   3 #> 95  550.8670   3.225386   3 #> 96  515.1936   2.799336   3 #> 97  511.9820   2.672289   3 #> 98  550.2036   2.988463   3 #> 99  504.2741   2.669060   3 #> 100 630.0243   2.700502   3 #> 101 508.7388   2.579266   3 #> 102 501.1933   2.518591   3 #> 103 507.9611   3.849360   3 #> 104 500.9880   3.394575   3 #> 105 500.7009   3.635249   3 #> 106 502.0275   2.600185   3 #> 107 559.8951   2.801960   3 #> 108 632.8372   2.964173   3 #> 109 501.4598   2.857889   3 #> 110 500.3494   2.698445   3 #> 111 504.4239   2.959887   3 #> 112 507.6840   3.937874   3 #> 113 513.9927   2.521322   3 #> 114 508.7459   2.984142   3 #> 115 509.7637   3.142238   3 #> 116 502.9540   2.765042   3 #> 117 501.9586   2.678156   3 #> 118 508.7351   2.514573   3 #> 119 588.9033   2.731063   3 #> 120 515.6614   3.151413   3 #> 121 640.6696   2.732887   3 #> 122 527.6715   3.453903   3 #> 123 501.7547   2.625082   3 #> 124 502.5397   3.003056   3 #> 125 933.9263   2.521219   3 #> 126 500.9597   2.554252   3 #> 127 577.5887   3.180230   3 #> 128 505.8412   2.517047   3 #> 129 844.7308   2.932985   3 #> 130 512.2450   2.774865   3 #> 131 513.2214   2.874934   3 #> 132 502.1561   2.625912   3 #> 133 738.7419   3.026137   3 #> 134 515.9046   2.823965   3 #> 135 828.9574   2.676130   3 #> 136 875.9367   3.225892   3 #> 137 664.3388   3.827153   3 #> 138 508.3796   3.703278   3 #> 139 830.9150   2.906340   3 #> 140 824.6157   2.524068   3 #> 141 522.5056   2.540167   3 #> 142 620.5323   2.857985   3 #> 143 541.0399   3.322497   3 #> 144 542.8061   3.065264   3 #> 145 541.3681   4.601824   3 #> 146 563.4346   2.584596   3 #> 147 643.1363   2.718644   3 #> 148 427.9726   3.526780   3 #> 149 955.1852   3.781125   3 #> 150 928.0330   2.649441   3 #> 151 932.5969   2.638031   3 #> 152 957.7330   2.827367   3 #> 153 935.4820   2.616680   3 #> 154 929.6281   2.537872   3 #> 155 979.3871   3.230252   3 #> 156 933.1016   2.716356   3 #> 157 959.1315   2.543470   3 #> 158 939.6914   2.513188   3 #> 159 930.8544   3.161680   3 #> 160 960.2170   4.096308   3 #>  #> [[5]] #>          ts magnitudes gen #> 1  944.7896   2.511345   4 #> 2  526.7988   3.362712   4 #> 3  917.1702   2.741162   4 #> 4  558.1721   2.524134   4 #> 5  561.2561   2.619692   4 #> 6  557.8959   2.503358   4 #> 7  603.3869   2.672131   4 #> 8  581.4264   2.538510   4 #> 9  581.5455   2.619851   4 #> 10 565.0853   2.956955   4 #> 11 659.2165   3.465126   4 #> 12 558.2503   3.342107   4 #> 13 560.7516   2.551201   4 #> 14 800.1175   3.271357   4 #> 15 559.8243   3.396771   4 #> 16 796.0573   3.843859   4 #> 17 985.2126   4.098536   4 #> 18 686.3401   2.576368   4 #> 19 557.7947   3.303085   4 #> 20 552.7622   2.523490   4 #> 21 515.2763   4.474736   4 #> 22 510.2761   2.604245   4 #> 23 509.6884   2.642607   4 #> 24 554.1094   3.129457   4 #> 25 537.7539   3.113321   4 #> 26 507.4303   2.507897   4 #> 27 585.9942   2.780396   4 #> 28 717.1127   2.707869   4 #> 29 664.4044   2.864633   4 #> 30 541.1569   2.673674   4 #> 31 586.2219   2.777131   4 #> 32 665.2224   2.898808   4 #> 33 542.0204   4.124950   4 #> 34 544.9775   3.671214   4 #> 35 541.7322   2.530849   4 #> 36 739.3459   2.593861   4 #> 37 559.2246   2.984474   4 #> 38 707.1398   2.709706   4 #> 39 663.3500   2.560872   4 #> 40 859.7228   2.828666   4 #> 41 656.7991   4.058441   4 #> 42 429.6853   2.512682   4 #> 43 973.8610   2.968659   4 #> 44 960.8005   3.139424   4 #> 45 966.9887   2.505304   4 #> 46 960.2700   4.479062   4 #>  #> [[6]] #>          ts magnitudes gen #> 1  529.9789   2.680055   5 #> 2  872.7090   2.669028   5 #> 3  796.0672   3.158529   5 #> 4  515.3395   2.760853   5 #> 5  574.6365   3.091417   5 #> 6  515.3199   2.544548   5 #> 7  515.3176   3.187799   5 #> 8  522.2920   2.975191   5 #> 9  517.8383   2.681193   5 #> 10 555.2996   3.604741   5 #> 11 547.1526   2.807667   5 #> 12 432.1515   3.678588   5 #> 13 973.0559   2.902209   5 #> 14 970.7514   2.944001   5 #> 15 960.2734   3.046276   5 #> 16 961.7962   2.554036   5 #> 17 960.3374   2.817351   5 #>  #> [[7]] #>         ts magnitudes gen #> 1 502.9889   2.690730   6 #> 2 970.8642   2.768451   6 #>  #> [[8]] #>         ts magnitudes gen #> 1 503.4266   2.731502   7 #> 2 971.6651   2.634997   7 #>"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the posterior distribution of the expected number of events — get_posterior_N","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"Plot posterior distribution expected number events","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"","code":"get_posterior_N(input.list, domain.extension = 0.1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"input.list combined input file (link functions) bru output (marginals) domain.extension Percentage posterior quantiles extend domain specified scalar. Default set 0.10.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"list three objects: post.df: data.frame containing posterior informations posterior distribution number events post.plot : ggplot object showing posterior distribution expected number events post.plot.shaded : ggplot object showing posterior distribution expected number events, shaded region corresponds 0.025 0.975 quantiles distribution distribution number events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"Retrieve posterior distribution ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"","code":"get_posterior_param(input.list)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"input.list input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"list two elements: post.df : data.frame posterior distributions parameters columns x (value parameter), y (value posterior), param (parameter name) post.plot : ggplot object showing posterior distribution parameter","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS triggering function - used by inlabru — gt","title":"ETAS triggering function - used by inlabru — gt","text":"function returns value ETAS triggering function specified time t points history th, mh","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ETAS triggering function - used by inlabru — gt","text":"","code":"gt(theta, t, th, mh, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ETAS triggering function - used by inlabru — gt","text":"theta ETAS parameters list names K, alpha, c, p t Time function calculated, scalar vector th Time events history [days, months,...], scalar vector mh Magnitude events history, scalar vector M0 Minimum magnitude threshold, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ETAS triggering function - used by inlabru — gt","text":"value ETAS triggering function evaluated t history th, mh.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ETAS triggering function - used by inlabru — gt","text":"ETAS triggering function evaluated $$g(t - t_h | m_h) = K e^{\\alpha(m_h - M_0)} \\left( \\frac{t - t_h}{c} + 1\\right)^{-p}$$ \\(K, \\alpha, c > 0\\), \\(p \\geq 1\\) ETAS parameters, \\(t\\) (t) time function evaluated, considering past observation \\(t_h, m_h\\) (th, mh). function returns 0 \\(t_h > t\\). \\(t\\) scalar \\(t_h, m_h\\) vectors function returns vector, \\(t\\) vector \\(t_h, m_h\\) scalars, \\(t, t_h, m_h\\) vectors length. use \\(t\\) \\(t_h, m_h\\) vectors different lengths.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":null,"dir":"Reference","previous_headings":"","what":"HORUS Ita Catalogue — horus","title":"HORUS Ita Catalogue — horus","text":"HOmogenized instRUmental Seismic catalog (HORUS) Italy 1960 present, limited limited 1960-2019.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"HORUS Ita Catalogue — horus","text":"","code":"horus"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"HORUS Ita Catalogue — horus","text":"Original file format: Year: Origin Time (OT) year Mo: OT month Da: OT day Ho: OT hour Mi OT minute Se OT seconds fractions Lat epicenter N latitude (degrees) Lon epicenter E longitude (degrees) Depth hypocenter depth (km) Mw true proxy moment magnitude sigMw moment magnitude uncertainty Geo.Ita \"*\" indicates epicenter within Italian mainland territory, otherwise \" \" Geo.CPTI15 \"*\" indicates epicenter within spatial window CPTI15 catalog (Rovida et al., 2020, Bull Earth Eng, doi: 10.1007/s10518-020-00818-y) Ev..type \"x\" indicates event earthquake (e.g. explosion, eruption, landslide, ...) (since May 1st 2012) Iside.n. ISIDe id number (since April 16th 2005) ETAS.inlabru format: time_string: Data-time event, ISO 8601 format; format = \"%Y-%m-%dT%H:%M:%OS\" use .POSIXct() lon: Original Lon lat: Original Lat depth Original Depth M: Original Mw","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"HORUS Ita Catalogue — horus","text":"http://horus.bo.ingv./","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"HORUS Ita Catalogue — horus","text":"original entire HORUS catalog provided single tab separated ascii file: HORUS_Ita_Catalog.txt random second decimal digit added ML Md INGV bulletin (ISIDe) computing Mw proxies (Lolli et al., Seism. Res. Lett., 91, 3208-3222, doi: 10.1785/0220200148), HORUS_Ita_Catalog_o.txt original ML Md used compute Mw proxies. ETAS.inlabru includes reformatted version data HORUS_Ita_Catalog.txt data.frame, limited 1960-2019. data provided , express implied warranty given.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"HORUS Ita Catalogue — horus","text":"Barbara Lolli(1), Daniele Randazzo(1), Gianfranco Vannucci(1) Paolo Gasperini (2),(1) (2020). Homogenized Instrumental Seismic Catalog (HORUS) Italy 1960 Present, Seismol. Res. Lett, doi: 10.1785/0220200148. (1) Istituto Nazionale di Geofisica e Vulcanologia, Sezione di Bologna (2) Dipartimento di Fisica e Astronomia, Università di Bologna","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"Copula transformation Exponential standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"","code":"inv_exp_t(x, rate)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"x values Exponential distribution, vector. rate rate Exponential distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"Copula transformation Gamma standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"","code":"inv_gamma_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"x values Gamma distribution, vector. shape parameter Gamma distribution, scalar. b rate parameter Gamma distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"Copula transformation Log-Normal standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"","code":"inv_loggaus_t(x, m, s)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"x values Log-Normal distribution, vector. m mean logarithm Log-Normal distribution, scalar. s standard deviation logarithm Log-Normal distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"Copula transformation Uniform standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"","code":"inv_unif_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"x values Uniform distribution, vector. minimum Uniform distribution, scalar. b maximum Uniform distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the integral of the ETAS conditional intensity — lambda_N","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"Calculate number events time interval T1 T2 given imposed events ETAS","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"","code":"lambda_N(th.mu, th.K, th.alpha, th.c, th.p, T1, T2, M0, Ht, link.functions)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"th.mu Background rate, mu, internal parameter scale th.K ETAS triggering parameter K internal parameter scale th.alpha ETAS triggering parameter alpha internal parameter scale th.c ETAS triggering parameter c internal parameter scale th.p ETAS triggering parameter p internal parameter scale T1 Start temporal model domain. T2 End temporal model domain. M0 Minimum magnitude threshold Ht History process, set known events interval. must data.frame columns ts (time) magnitudes (magnitudes). link.functions list functions transform parameters internal scale ETAS scale","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"Integral ETAS conditional intensity T1 T2 minimum magnitude M0, .e. expected number events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":null,"dir":"Reference","previous_headings":"","what":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"Logarithm integral ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"","code":"log_Lambda_h(theta, th, mh, M0, T1, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"theta ETAS parameters data.frame(mu=mu, K=K, alpha=alpha, c=c, p=p). th Time parent event. mh Magnitude parent event M0 Minimum magnitude threshold T1 Start temporal model domain. T2 End temporal model domain.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"Logarithm integral ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"Copula transformation standard Normal distribution Log-Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"","code":"loggaus_t(x, m, s)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"x values standard Normal distribution, vector. m mean logarithm Log-Normal distribution, scalar. s standard deviation logarithm Log-Normal distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"Values Log-Normal distribution logarithmic mean m standard deviation s, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to calculate Omori's law — omori","title":"Function to calculate Omori's law — omori","text":"Function calculate Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to calculate Omori's law — omori","text":"","code":"omori(theta, t, ti)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to calculate Omori's law — omori","text":"theta ETAS parameters (list(mu = mu, K = K, alpha = alpha, c = c, p = p), parameters c p used t Time Omori's law evaluated ti Time event history","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to calculate Omori's law — omori","text":"Value Omori's law point t event happened ti","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"Function plot Omori's law corresponding different posterior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"","code":"omori_plot_posterior(   input.list,   post.samp = NULL,   n.samp = 10,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale post.samp data.frame containing posterior samples parameters. NULL, n.samp samples generated. n.samp different nrow(post.samp) n.samp rows uniformly sampled post.samp. Default NULL. n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"ggplot object","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"Function plot Omori's law corresponding different prior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"","code":"omori_plot_prior(input.list, n.samp = 10, t.end = 1, n.breaks = 100)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"input.list structured input list least one element: link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"ggplot object","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"Plot posterior densities ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"","code":"post_pairs_plot(   input.list = NULL,   n.samp = NULL,   post.samp = NULL,   max.batch = 1000 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp number samples draw posteriors plot post.samp data.frame columns mu, K, alpha, c, p rows corresponding different posterior samples. NULL function samples joint posterior distribution n.samp times. default NULL. max.batch parameter post_sampling function used case post.samp = NULL","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"list: elements post.samp.df:data.frame posterior samples nrow = n.samp columns mu, K, alpha, c, p corresponding ETAS parameters. post.samp NULL returns post.samp pair.plot: ggplot object reporting pair plot parameters samples. obtained using ggpairs function Ggally library","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from the posterior of the ETAS parameters — post_sampling","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"Sample posterior ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"","code":"post_sampling(input.list, n.samp, max.batch = 1000, ncore = 1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp number samples draw posteriors max.batch Maximum number posterior samples generated simultaneously. Default 1000. ncore Number cores used n.samp exceeds max.batch. Default 1","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"data.frame posterior samples nrow = n.samp columns mu, K, alpha, c, p corresponding ETAS parameters.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":null,"dir":"Reference","previous_headings":"","what":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"Return sample magnitudes drawn GR distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"","code":"sample_GR_magnitudes(n, beta.p, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"n Number events sample. beta.p Related b-value via b ln(10). M0 Minimum magnitude sample.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"list magnitudes length n drawn GR distribution.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"","code":"sample_GR_magnitudes(n = 100, beta.p = log(10), M0 = 2.5) #>   [1] 2.632878 2.676134 2.694814 3.017989 3.470684 2.752862 3.503269 3.139232 #>   [9] 2.586712 2.722126 3.407909 2.920272 2.770988 2.880628 2.564768 2.997532 #>  [17] 2.721633 3.502604 3.300557 3.167451 2.820069 2.811805 2.692171 2.898037 #>  [25] 2.779079 2.576262 3.012381 2.872905 2.853814 3.335978 2.580713 2.641847 #>  [33] 2.826267 3.324128 3.286321 2.640113 2.711905 2.901053 2.831060 2.667802 #>  [41] 2.968899 2.552127 2.978324 2.837532 2.808011 3.530522 2.789843 3.021983 #>  [49] 2.720403 2.999510 2.621295 2.666981 2.738694 3.113511 2.795748 2.734515 #>  [57] 2.518574 2.765600 2.631320 3.318151 2.770479 3.042488 2.557768 2.739265 #>  [65] 2.871252 4.818865 4.053415 2.775965 2.531767 2.753756 3.099269 2.530121 #>  [73] 3.187882 2.790600 2.701128 2.980297 2.686721 2.649560 3.343401 3.175714 #>  [81] 3.447281 3.452329 3.454182 2.613825 2.561642 3.070681 2.507231 2.864969 #>  [89] 2.511315 2.811638 2.584537 2.589863 2.648366 2.947747 2.556875 3.877823 #>  [97] 2.863665 3.160762 2.816635 4.152567"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"Generate sample new events data.frame(t_i, M_i) length n.ev one parent event occuring time t_h using ETAS model.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"","code":"sample_temporal_ETAS_daughters(theta, beta.p, th, n.ev, M0, T1, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). th Time parent event [days]. n.ev number events placed. M0 Minimum magnitude synthetic catalogue. T1 Start time synthetic catalogue [days]. T2 End time synthetic catalogue [days].","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"Generate sample new events data.frame(t_i, M_i) one parent","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":null,"dir":"Reference","previous_headings":"","what":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"Take previous parent events Ht=data.frame[ts, magnitudes] generates daughters events using ETAS model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"","code":"sample_temporal_ETAS_generation(theta, beta.p, Ht, M0, T1, T2, ncore = 1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). Ht set parent events form data.frame[ts, magnitudes] M0 minimum earthquake magnitude synthetic catalogue. T1 start time synthetic catalogue [days]. T2 end time synthetic catalogue [days]. ncore number compute cores use","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"Return one generation daughters parents Ht form data.frame(t_i, M_i).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"","code":"# The parents are specified in Ht Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) sample_temporal_ETAS_generation(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000,   Ht = Ht ) #>           ts magnitudes #> 1   824.4296   2.904637 #> 2   500.0044   2.503628 #> 3   500.2048   3.562306 #> 4   611.6499   2.607387 #> 5   534.9798   2.798465 #> 6   500.0037   2.997920 #> 7   531.9458   2.689464 #> 8   615.1042   2.932604 #> 9   501.0753   3.047092 #> 10  574.4797   2.542990 #> 11  506.8380   2.934863 #> 12  500.4225   3.328572 #> 13  616.0030   3.086416 #> 14  528.2508   3.185515 #> 15  506.7256   2.940384 #> 16  500.6198   2.607485 #> 17  502.3842   3.095644 #> 18  500.4632   3.040764 #> 19  502.4261   2.941064 #> 20  579.0497   2.736512 #> 21  500.2437   2.938768 #> 22  511.7648   2.555693 #> 23  500.7929   2.908122 #> 24  501.3857   2.829680 #> 25  500.0444   2.919386 #> 26  500.8602   3.222591 #> 27  502.4585   2.729275 #> 28  500.0355   3.028881 #> 29  534.4866   2.849612 #> 30  500.5476   2.528320 #> 31  536.5222   2.792691 #> 32  501.2514   3.187916 #> 33  516.3211   2.620714 #> 34  610.2782   2.775212 #> 35  732.0010   2.752253 #> 36  507.8344   2.974433 #> 37  512.3274   3.062010 #> 38  594.5989   2.869021 #> 39  500.0656   3.223694 #> 40  500.6874   2.797696 #> 41  510.0233   3.181488 #> 42  500.3173   4.969958 #> 43  749.7797   3.375901 #> 44  500.0474   3.869970 #> 45  501.1146   2.793059 #> 46  996.0863   2.508792 #> 47  502.5156   3.184327 #> 48  507.2519   2.531396 #> 49  500.3418   3.061137 #> 50  646.3317   2.765206 #> 51  599.1182   3.256753 #> 52  576.4921   2.578649 #> 53  500.0558   2.919077 #> 54  500.0538   4.006331 #> 55  502.1953   3.794840 #> 56  526.3133   2.756533 #> 57  501.8486   2.597020 #> 58  510.2120   2.840159 #> 59  503.0516   2.573542 #> 60  501.7379   3.086274 #> 61  510.7124   2.590051 #> 62  733.1850   2.625916 #> 63  500.0383   2.637245 #> 64  806.1191   3.599807 #> 65  627.5088   2.887452 #> 66  500.5351   2.805650 #> 67  503.5637   2.617039 #> 68  503.1982   2.578723 #> 69  613.8385   2.570253 #> 70  500.1650   3.080249 #> 71  502.3658   3.022732 #> 72  591.5481   2.836748 #> 73  590.7910   2.823095 #> 74  500.0298   2.638857 #> 75  689.4882   3.426415 #> 76  501.0780   2.694317 #> 77  500.2353   3.167549 #> 78  501.0897   2.505195 #> 79  500.1655   2.504656 #> 80  633.0200   2.776394 #> 81  500.0769   2.531469 #> 82  500.2838   2.542847 #> 83  572.2482   2.836334 #> 84  725.6549   2.944653 #> 85  500.7796   2.673310 #> 86  681.8487   3.656985 #> 87  554.0120   2.506799 #> 88  500.4379   2.628597 #> 89  505.7127   2.705813 #> 90  502.2837   2.696151 #> 91  597.7102   3.018359 #> 92  618.3649   2.829709 #> 93  529.2954   2.716883 #> 94  550.5542   3.584554 #> 95  500.0401   3.013984 #> 96  500.9977   2.500982 #> 97  501.7052   4.217087 #> 98  509.6487   3.746033 #> 99  530.9766   2.612223 #> 100 503.0758   3.986786 #> 101 500.0774   2.528960 #> 102 500.0758   2.674039 #> 103 500.6729   2.500675 #> 104 505.0218   2.595732 #> 105 503.7066   2.807549 #> 106 502.9556   2.635551 #> 107 575.6162   2.586629 #> 108 500.6262   2.528446 #> 109 502.5967   2.850458 #> 110 552.6283   2.839010 #> 111 501.9482   3.336478 #> 112 516.9146   3.201654 #> 113 500.2300   2.515280 #> 114 518.6590   2.516212 #> 115 500.1643   2.521105 #> 116 559.9414   2.794493 #> 117 503.0613   2.690794 #> 118 500.6134   2.529641 #> 119 583.0832   2.663509 #> 120 502.9130   4.997936 #> 121 500.4139   2.502357 #> 122 521.4812   2.639320 #> 123 503.9010   3.468081 #> 124 503.9858   2.866505 #> 125 500.0880   2.761424 #> 126 505.1419   2.741248 #> 127 546.4291   2.649822 #> 128 569.2387   2.666600 #> 129 500.0092   3.991193 #> 130 500.1087   2.579695 #> 131 500.8691   3.208640 #> 132 573.5161   2.564487 #> 133 506.9980   2.585093 #> 134 500.5092   3.377655 #> 135 500.0388   3.028382 #> 136 500.0167   3.097897 #> 137 516.9636   2.507704 #> 138 521.5376   2.547528 #> 139 500.2040   5.390264 #> 140 502.2469   3.042264 #> 141 834.3386   2.695599 #> 142 503.6126   3.591990 #> 143 515.8617   2.831046 #> 144 516.1131   2.674923 #> 145 517.6164   2.889726 #> 146 500.0225   2.538903 #> 147 841.9674   2.897317 #> 148 508.6524   2.879085 #> 149 512.6439   2.865836 #> 150 502.5337   2.649745 #> 151 500.8379   2.744516 #> 152 503.8589   3.189360 #> 153 504.0210   6.026063 #> 154 507.9932   2.982496 #> 155 500.0440   2.573297 #> 156 500.6432   2.854414 #> 157 500.1743   2.847444 #> 158 501.4964   2.973918 #> 159 500.0065   2.624726 #> 160 500.4599   2.735149 #> 161 502.6578   3.688571 #> 162 523.6830   3.464266 #> 163 501.7162   3.600215 #> 164 834.4670   3.400002 #> 165 500.7123   2.947809 #> 166 500.5751   2.818184 #> 167 650.4674   3.001597 #> 168 949.8135   2.554575 #> 169 500.0072   4.145222 #> 170 500.2405   2.569550 #> 171 500.7795   3.827577 #> 172 538.4536   2.504288 #> 173 918.0576   3.650719 #> 174 501.7553   3.195315 #> 175 573.4048   2.593757 #> 176 539.5236   2.520174 #> 177 500.6065   3.571523 #> 178 500.1964   2.691678 #> 179 500.1312   3.009435 #> 180 500.1919   2.633282 #> 181 500.4617   2.564265 #> 182 506.1671   2.602873 #> 183 500.0964   2.665532 #> 184 500.2579   2.638328 #> 185 526.7997   2.888404 #> 186 957.1753   4.535124 #> 187 500.0385   2.605925 #> 188 738.5285   2.680028 #> 189 504.7192   2.752458 #> 190 559.2870   2.889310 #> 191 520.2111   2.554953 #> 192 514.2411   2.849433 #> 193 501.7213   2.690208 #> 194 515.1866   2.512444 #> 195 895.6510   2.668474 #> 196 500.1155   3.544616 #> 197 500.9658   2.906489 #> 198 500.6433   3.015906 #> 199 601.0194   2.570364 #> 200 513.1650   2.581438 #> 201 500.0724   2.836419 #> 202 535.1096   3.006887 #> 203 643.8909   3.291954 #> 204 576.8062   2.605364 #> 205 502.8035   3.095388 #> 206 500.1391   3.494897 #> 207 501.2606   3.293267 #> 208 500.0504   3.220709 #> 209 500.0467   2.529234 #> 210 500.0076   2.574837 #> 211 560.1524   2.595337 #> 212 506.5761   4.397024 #> 213 502.1996   2.678615 #> 214 716.7088   2.691994 #> 215 500.5352   2.583764 #> 216 503.5222   2.805145 #> 217 500.1793   2.596993 #> 218 502.1807   2.854050 #> 219 500.2112   2.714524 #> 220 549.6277   2.697312 #> 221 500.5487   2.817767 #> 222 848.0571   2.774184 #> 223 505.2292   2.799026 #> 224 501.3245   2.636614 #> 225 500.7932   3.010863 #> 226 504.9643   2.544332 #> 227 500.2496   2.543229 #> 228 575.2539   2.515905 #> 229 549.7474   3.143640 #> 230 500.5512   2.598451 #> 231 534.9000   3.006140 #> 232 500.0141   2.533254 #> 233 500.1225   2.794583 #> 234 560.3697   3.471887 #> 235 500.3129   3.043054 #> 236 500.0091   2.671337 #> 237 508.0578   2.772004 #> 238 500.0461   3.150330 #> 239 500.7409   2.533118 #> 240 500.6920   2.650804 #> 241 500.2056   2.738119 #> 242 500.0215   2.734856 #> 243 504.9111   2.633854 #> 244 617.1223   3.376562 #> 245 539.8637   2.844092 #> 246 710.2770   3.052102 #> 247 519.3694   2.740764 #> 248 502.4250   2.766497 #> 249 504.1399   3.725207 #> 250 507.7901   2.732859 #> 251 753.4573   2.660427 #> 252 500.8078   2.566791 #> 253 594.2954   2.696445 #> 254 515.7145   2.880189 #> 255 500.0058   2.718727 #> 256 500.3436   2.944460 #> 257 500.1212   2.801308 #> 258 560.6524   3.017181 #> 259 501.4942   3.499802 #> 260 500.0494   2.727924 #> 261 764.6693   3.285050 #> 262 501.5109   2.749403 #> 263 820.1157   2.913248 #> 264 518.1861   2.962571 #> 265 502.4265   2.599203 #> 266 500.4742   2.556926 #> 267 505.7151   2.657214 #> 268 500.2281   2.560443 #> 269 509.9868   3.339461 #> 270 501.1276   2.909430 #> 271 500.3637   2.566822 #> 272 524.3030   3.398156 #> 273 620.8783   2.617385 #> 274 654.0402   3.464276 #> 275 940.0874   2.540446 #> 276 500.4112   4.176546 #> 277 503.3217   2.781612 #> 278 559.2902   2.587073 #> 279 504.0439   2.508646 #> 280 609.2632   2.707750 #> 281 799.4103   2.562009 #> 282 500.2620   2.737869 #> 283 500.3241   3.827455 #> 284 509.5441   2.507064 #> 285 687.2828   2.728914 #> 286 513.8693   2.790651 #> 287 501.4089   3.087128 #> 288 502.9353   3.040889 #> 289 503.8251   3.231109 #> 290 500.0331   3.458690 #> 291 524.7971   4.845859 #> 292 918.8725   2.756486 #> 293 500.6388   3.117376 #> 294 500.4805   2.585429 #> 295 510.0175   2.987663 #> 296 517.0502   2.575909 #> 297 526.7825   3.136574 #> 298 502.6731   2.506613 #> 299 500.9815   2.538740 #> 300 500.7121   3.627205 #> 301 501.9276   2.715825 #> 302 500.6054   2.629958 #> 303 602.8693   3.837152 #> 304 510.3182   2.851432 #> 305 507.4686   2.833051 #> 306 500.0748   3.749660 #> 307 563.3444   3.638029 #> 308 845.0316   2.510796 #> 309 500.3139   2.534743 #> 310 500.1700   3.958436 #> 311 500.2350   2.534250 #> 312 668.3567   4.403258 #> 313 543.7584   3.934958 #> 314 505.0502   2.887903 #> 315 502.8518   2.627528 #> 316 586.8585   2.930558 #> 317 503.4739   3.619118 #> 318 553.2088   2.998839 #> 319 500.2173   2.633300 #> 320 535.9850   2.866851 #> 321 505.7009   3.645679 #> 322 512.9644   2.566343 #> 323 503.7717   2.567335 #> 324 500.2749   2.970704 #> 325 500.6951   3.002390 #> 326 648.9742   2.584209 #> 327 500.0797   2.879322 #> 328 500.1166   2.889186 #> 329 500.5184   3.036878 #> 330 544.8170   3.938308 #> 331 500.0783   3.603182 #> 332 500.2384   2.663702 #> 333 500.9798   2.510353 #> 334 598.4827   3.732479 #> 335 500.0365   3.212856 #> 336 500.3173   2.609232 #> 337 502.2583   4.810690 #> 338 666.6294   3.718605 #> 339 518.2590   3.094968 #> 340 500.6148   2.876952 #> 341 502.1301   3.523187 #> 342 500.0692   2.529250 #> 343 503.3211   2.629775 #> 344 568.4826   2.612428 #> 345 532.5226   3.112414 #> 346 507.0263   3.343606 #> 347 512.6736   4.224579 #> 348 672.5243   4.389062 #> 349 501.9912   2.666465 #> 350 500.4395   2.717836 #> 351 501.4741   2.527498 #> 352 500.0946   2.587600 #> 353 500.0061   2.746001 #> 354 674.4228   3.985852 #> 355 526.1835   2.682776 #> 356 547.1088   2.810685 #> 357 559.0858   2.965068 #> 358 528.1859   2.535787 #> 359 500.3956   2.671945 #> 360 505.3590   3.179100 #> 361 500.1339   2.658357 #> 362 502.9915   2.612836 #> 363 567.4506   2.594709 #> 364 503.9136   2.572506 #> 365 527.2388   3.080817 #> 366 509.3120   2.727321 #> 367 505.5412   2.510385 #> 368 500.6428   2.818688 #> 369 500.0055   3.091043 #> 370 549.9152   3.502069 #> 371 501.1244   3.085439 #> 372 503.7075   2.673668 #> 373 517.5840   2.766986 #> 374 501.2474   2.967376 #> 375 614.9570   2.676426 #> 376 527.9371   2.842599 #> 377 506.2119   3.738176 #> 378 500.2594   3.141547 #> 379 501.0500   2.729002 #> 380 501.0466   3.927445 #> 381 502.9221   2.934090 #> 382 500.1324   2.697263 #> 383 564.2833   2.609624 #> 384 504.5784   2.540768 #> 385 519.0577   3.944275 #> 386 530.6528   2.565194 #> 387 558.0860   2.584993 #> 388 519.3830   3.618114 #> 389 500.1162   2.841108 #> 390 542.7116   2.829247 #> 391 824.6890   2.657951 #> 392 501.8093   5.534364 #> 393 683.6589   3.548375 #> 394 909.5032   4.558709 #> 395 500.0075   2.953684 #> 396 500.1365   2.650993 #> 397 859.7496   2.744210 #> 398 575.8939   3.734488 #> 399 500.5581   2.798551 #> 400 501.5609   2.510146 #> 401 500.4823   3.583527 #> 402 500.5971   2.681826 #> 403 501.1262   3.695302 #> 404 576.7425   2.585474 #> 405 500.2223   2.521895 #> 406 500.0973   3.040335 #> 407 500.0173   2.734205 #> 408 500.0511   2.653063 #> 409 505.9067   3.012623 #> 410 535.9477   3.168136 #> 411 501.2141   2.890024 #> 412 501.5403   2.653545 #> 413 523.5208   3.484656 #> 414 500.1076   2.942546 #> 415 500.4789   2.703980 #> 416 503.7064   2.553682 #> 417 500.1107   2.570753 #> 418 500.2335   2.574692 #> 419 755.6511   3.492642 #> 420 500.0467   2.614133 #> 421 550.6117   2.660394 #> 422 528.1210   2.846776 #> 423 500.0493   2.710357 #> 424 502.5875   2.995435 #> 425 505.2547   3.349462 #> 426 505.0071   3.255278 #> 427 500.6835   3.802839 #> 428 500.0688   2.622278 #> 429 501.4410   2.514316 #> 430 510.7543   2.867480 #> 431 518.1271   3.415241 #> 432 506.9072   2.569598 #> 433 912.0009   3.024328 #> 434 529.7164   2.609702 #> 435 500.0595   2.858909 #> 436 501.8637   2.747871 #> 437 501.1930   2.748198 #> 438 500.4929   2.731314 #> 439 512.6348   2.724831 #> 440 501.1852   3.114133 #> 441 574.2013   3.962086 #> 442 557.1139   3.126797 #> 443 500.3252   2.515660 #> 444 504.0866   2.856375 #> 445 508.1129   2.852823 #> 446 500.9497   2.611675 #> 447 878.7247   4.528434 #> 448 500.8169   2.525437 #> 449 502.7792   3.068813 #> 450 593.7066   3.026699 #> 451 500.0618   3.221949 #> 452 500.3136   2.888623 #> 453 501.1139   2.631318 #> 454 500.4683   2.816858 #> 455 556.6537   3.676350 #> 456 500.1463   2.651252 #> 457 658.0541   2.500283 #> 458 511.0016   4.072084 #> 459 510.5586   2.584329 #> 460 500.1256   3.239673 #> 461 535.5941   2.703185 #> 462 502.7300   2.714176 #> 463 500.0170   3.062900 #> 464 758.8396   2.592774 #> 465 538.5597   3.649583 #> 466 504.1737   2.578151 #> 467 510.7124   2.602931 #> 468 507.4009   3.456753 #> 469 519.8055   3.025635 #> 470 701.7981   2.732691 #> 471 509.7941   2.769976 #> 472 517.4700   2.606473 #> 473 500.0991   2.779824 #> 474 505.6702   3.465329 #> 475 501.2697   2.682856 #> 476 501.1627   2.523052 #> 477 936.9558   2.947301 #> 478 503.0822   2.854686 #> 479 516.7761   2.550266 #> 480 502.1481   3.115227 #> 481 500.0891   2.628497 #> 482 504.7302   2.808910 #> 483 505.4984   2.633107 #> 484 500.5661   2.994285 #> 485 500.0912   2.804205 #> 486 633.7378   2.633337 #> 487 500.7172   2.548813 #> 488 500.4298   2.874947 #> 489 509.3834   2.736223 #> 490 500.3820   4.477557 #> 491 850.8021   2.510527 #> 492 535.2182   2.987420 #> 493 508.2258   3.595019 #> 494 500.6423   3.050725 #> 495 527.0060   2.869434 #> 496 500.1866   2.600502 #> 497 500.0137   3.218102 #> 498 507.4219   2.650011 #> 499 602.7822   3.009006 #> 500 926.9435   2.690844 #> 501 501.2883   2.726516 #> 502 514.3721   2.536910 #> 503 638.9192   2.703138 #> 504 505.1121   2.504207 #> 505 512.1709   2.641368 #> 506 527.7036   3.178762 #> 507 504.0563   2.937374 #> 508 531.1832   2.520262 #> 509 621.7445   3.435882 #> 510 501.9804   2.680011 #> 511 500.6277   2.771770 #> 512 501.4134   3.017852 #> 513 500.9852   2.903280 #> 514 500.4984   3.327989 #> 515 624.1832   3.306320 #> 516 500.9520   2.945034 #> 517 532.3412   2.751897 #> 518 517.5464   2.547468 #> 519 507.9598   2.907586 #> 520 501.1830   2.955978 #> 521 500.3544   2.536104 #> 522 500.5318   2.862303 #> 523 500.1883   3.850963 #> 524 500.9027   2.523640 #> 525 590.8694   2.849613 #> 526 570.0417   3.034797 #> 527 500.8558   3.655397 #> 528 541.1405   4.319814 #> 529 500.0653   2.514236 #> 530 514.5844   2.520600 #> 531 501.7555   3.149631 #> 532 524.5292   2.631552 #> 533 518.2843   2.715653 #> 534 590.1419   2.709309 #> 535 500.8511   3.129081 #> 536 504.0344   2.652516 #> 537 501.2934   2.528960 #> 538 561.6299   2.539697 #> 539 500.1828   2.553671 #> 540 500.5037   2.864873 #> 541 590.1988   2.631014 #> 542 515.4884   3.690027 #> 543 500.0103   2.585823 #> 544 554.7981   2.521570 #> 545 500.2819   3.748891 #> 546 500.3776   4.413794 #> 547 512.9267   3.008420 #> 548 884.7166   3.092588 #> 549 500.0599   2.528974 #> 550 814.1289   2.860943 #> 551 500.4852   2.569369 #> 552 680.0028   2.731692 #> 553 505.4277   4.042529 #> 554 500.2693   3.017205 #> 555 500.7573   3.001054 #> 556 510.0574   2.849942 #> 557 500.0150   2.848358 #> 558 501.1682   2.558415 #> 559 500.2707   2.526076 #> 560 501.1972   2.828629 #> 561 500.0191   2.972712 #> 562 500.7465   2.529273 #> 563 500.4452   2.680056 #> 564 526.5037   2.823229 #> 565 528.1686   2.899254 #> 566 507.7324   2.558356 #> 567 501.0377   3.599453 #> 568 502.1953   2.524280 #> 569 500.4232   3.007684 #> 570 715.2793   2.615678 #> 571 501.5625   2.793077 #> 572 500.2046   3.298954 #> 573 925.6805   2.679331 #> 574 656.6875   3.025036 #> 575 555.9157   2.597362 #> 576 534.7760   2.816305 #> 577 500.2040   3.965478 #> 578 659.1674   2.974767 #> 579 648.6646   2.992182 #> 580 500.4297   2.676542 #> 581 505.0444   2.616110 #> 582 529.3336   2.672942 #> 583 571.7930   3.380596 #> 584 500.1568   3.087031 #> 585 500.0995   2.754877 #> 586 690.7793   3.124989 #> 587 516.9268   2.803621 #> 588 635.5186   3.209711 #> 589 500.0674   2.540109 #> 590 611.5078   2.814966 #> 591 505.4102   2.833607 #> 592 521.6001   3.804093 #> 593 676.0842   2.508151 #> 594 510.2874   2.591041 #> 595 501.3405   2.630470 #> 596 501.5973   2.733991 #> 597 874.3648   2.666817 #> 598 504.7641   3.986693 #> 599 501.7188   2.555890 #> 600 506.6351   2.579509 #> 601 504.2569   2.762361 #> 602 597.1763   2.794855 #> 603 501.1305   2.555351 #> 604 585.9843   3.516571 #> 605 501.9653   2.911250 #> 606 830.5563   2.654890 #> 607 985.6020   2.801263 #> 608 500.1395   2.861272 #> 609 500.0651   2.957665 #> 610 503.9266   2.748597 #> 611 500.1055   2.851891 #> 612 505.8632   2.718407 #> 613 586.3397   2.509411 #> 614 501.1087   2.538113 #> 615 528.3707   2.598527 #> 616 989.7110   2.809273 #> 617 500.0380   3.408376 #> 618 604.4274   2.688647 #> 619 513.0225   2.652344 #> 620 519.4142   2.909906 #> 621 505.3063   3.225537 #> 622 542.9263   2.795550 #> 623 500.8283   3.553440 #> 624 500.2355   2.643225 #> 625 948.3053   2.522742 #> 626 503.4538   2.694223 #> 627 551.1980   2.825260 #> 628 512.0229   2.728367 #> 629 591.8821   2.757878 #> 630 627.4405   2.877726 #> 631 500.3296   2.729168 #> 632 500.4171   2.724906 #> 633 504.1089   2.504643 #> 634 500.8695   3.526588 #> 635 547.1204   2.512471 #> 636 541.1811   4.037319 #> 637 500.3340   2.526496 #> 638 500.4336   3.115463 #> 639 500.0792   3.286342 #> 640 500.4810   2.540604 #> 641 504.6983   3.913501 #> 642 572.5735   2.943173 #> 643 676.5162   2.830444 #> 644 519.8628   2.769368 #> 645 516.9042   3.038317 #> 646 501.3975   2.583715 #> 647 513.9658   2.779191 #> 648 610.6955   3.126611 #> 649 501.0495   2.849617 #> 650 639.8291   2.571180 #> 651 500.0104   2.625540 #> 652 500.0921   2.525275 #> 653 553.2683   2.581491 #> 654 946.8503   2.549061 #> 655 500.6723   3.364098 #> 656 500.1404   3.312360 #> 657 779.8345   2.546954 #> 658 516.3018   2.520254 #> 659 500.1140   2.682008 #> 660 501.4612   2.874934 #> 661 576.1437   2.678410 #> 662 500.0421   2.536650 #> 663 502.2554   2.579787 #> 664 508.9367   2.842047 #> 665 500.9933   2.555593 #> 666 501.4086   2.520998 #> 667 500.5999   3.104276 #> 668 501.5524   4.905193 #> 669 500.0216   2.852259 #> 670 505.3811   2.692761 #> 671 500.5432   2.613637 #> 672 501.2938   2.508818 #> 673 636.4693   3.634259 #> 674 500.2026   2.681481 #> 675 503.5783   2.791880 #> 676 500.5412   2.878080 #> 677 500.0304   2.588260 #> 678 506.9759   2.656019 #> 679 501.2553   3.394150 #> 680 677.7449   2.599568 #> 681 652.5325   2.662619 #> 682 500.8369   2.832681 #> 683 529.8879   2.995772 #> 684 574.6410   2.576517 #> 685 540.1223   3.319400 #> 686 512.1856   2.768431 #> 687 850.7864   2.964961 #> 688 501.6250   2.517670 #> 689 500.5843   2.701593 #> 690 502.4613   3.237101 #> 691 500.2651   2.614115 #> 692 500.0294   2.793993 #> 693 527.7095   2.688694 #> 694 514.2410   3.249544 #> 695 501.1485   2.758623 #> 696 500.2531   2.599016 #> 697 505.8154   3.009661 #> 698 500.5443   2.787204 #> 699 526.3947   3.337115 #> 700 500.0651   2.620416 #> 701 768.3517   2.698039 #> 702 794.6463   2.555307 #> 703 501.4585   2.824158 #> 704 736.9375   3.149488 #> 705 500.7900   2.649539 #> 706 500.0789   3.215791 #> 707 626.7284   2.847953 #> 708 505.4348   3.292124 #> 709 514.3551   2.980342 #> 710 500.5377   2.514669 #> 711 503.5652   3.132857 #> 712 500.2649   2.976392 #> 713 600.2804   2.779591 #> 714 500.0379   2.852308 #> 715 500.2295   2.719981 #> 716 520.7353   2.681594 #> 717 502.2227   2.835516 #> 718 515.1539   2.786304 #> 719 511.1116   2.582743 #> 720 501.6506   2.964699 #> 721 502.7936   7.222986 #> 722 501.8574   2.527927 #> 723 563.0944   2.948700 #> 724 514.4486   2.913589 #> 725 503.9833   3.538407 #> 726 500.0194   2.802606 #> 727 897.4698   4.163847 #> 728 652.3954   2.649528 #> 729 500.6756   3.675008 #> 730 511.4973   2.601174 #> 731 500.0180   2.764482 #> 732 517.0430   2.659647 #> 733 500.0307   2.558077 #> 734 748.9550   3.113456 #> 735 500.5770   2.586582 #> 736 504.5731   2.658875 #> 737 542.1214   2.687179 #> 738 509.0817   3.018431 #> 739 500.3615   2.716657 #> 740 517.0296   2.579133 #> 741 503.2998   3.034042 #> 742 500.0397   2.801990 #> 743 501.3858   2.562065 #> 744 501.5828   3.172430 #> 745 565.9607   4.002366 #> 746 524.1276   3.367847 #> 747 500.1485   3.148275 #> 748 500.3723   2.774075 #> 749 508.0369   3.051593 #> 750 918.9603   2.802660 #> 751 507.1382   2.803264 #> 752 505.0021   2.856614 #> 753 500.9321   2.769260 #> 754 686.9968   3.330766 #> 755 501.0775   2.649601 #> 756 500.3831   3.046403 #> 757 500.8497   2.533377 #> 758 502.5113   2.680920 #> 759 500.3274   2.848718 #> 760 501.4285   2.756648 #> 761 500.2024   2.511871 #> 762 590.1364   3.292884 #> 763 502.0811   2.804426 #> 764 537.5504   2.934660 #> 765 866.2205   3.034279 #> 766 524.4274   3.417022 #> 767 500.0084   2.923624 #> 768 500.8085   3.464259 #> 769 501.6496   2.563605 #> 770 500.3402   2.704654 #> 771 500.0140   2.722807 #> 772 540.3227   2.675427 #> 773 500.3379   3.171330 #> 774 897.1486   4.012605 #> 775 841.3687   3.736737 #> 776 527.3043   2.636880 #> 777 500.1232   4.437972 #> 778 501.4668   2.600512 #> 779 505.0232   2.569034 #> 780 500.0452   2.578375 #> 781 508.3264   3.860424 #> 782 620.3113   2.791193 #> 783 550.2819   2.511812 #> 784 500.0388   2.545130 #> 785 500.2031   2.798283 #> 786 500.6718   2.719143 #> 787 881.8512   2.533321 #> 788 500.1996   2.606354 #> 789 545.5047   2.708744 #> 790 550.7995   3.313938 #> 791 500.3145   2.737922 #> 792 531.1331   2.729920 #> 793 518.6789   5.122923 #> 794 547.5393   2.651714 #> 795 504.5128   4.067501 #> 796 743.9594   2.618129 #> 797 503.7429   2.749147 #> 798 500.0578   2.844747 #> 799 500.2809   2.551194 #> 800 500.4380   2.722233 #> 801 576.2975   2.675405 #> 802 514.1009   2.541079 #> 803 501.4925   2.811121 #> 804 600.1017   2.724561 #> 805 500.4938   2.718365 #> 806 507.8105   2.548214 #> 807 557.3947   3.861163 #> 808 601.4173   2.553035 #> 809 564.5104   3.420954 #> 810 549.8945   2.740696 #> 811 500.1690   2.918493 #> 812 501.4929   3.292739 #> 813 500.0633   2.665097 #> 814 582.0045   2.541728 #> 815 505.8407   2.603371 #> 816 501.0493   2.526708 #> 817 502.9144   3.237254 #> 818 506.4728   3.196678 #> 819 500.7162   3.136145 #> 820 559.2081   2.602162 #> 821 514.0412   2.934428 #> 822 700.5137   2.628887 #> 823 500.3557   2.672022 #> 824 504.3813   2.597235 #> 825 500.2663   2.966246 #> 826 502.8149   3.311398 #> 827 501.7081   2.835854 #> 828 552.8401   2.634408 #> 829 504.3634   3.826157 #> 830 532.6482   3.221479 #> 831 565.2445   2.618579 #> 832 501.0441   2.624174 #> 833 510.5599   2.676041 #> 834 500.1111   2.805417 #> 835 500.2576   2.528595 #> 836 500.2171   2.991787 #> 837 500.7502   2.639046 #> 838 508.3820   2.556454 #> 839 723.6078   2.695996 #> 840 572.5499   2.859076 #> 841 500.1383   3.507091 #> 842 500.8709   3.438990 #> 843 540.7489   2.662232 #> 844 500.0349   2.897096 #> 845 526.3725   2.612879 #> 846 554.4499   2.881823 #> 847 962.9955   2.626334 #> 848 506.5421   3.447950 #> 849 585.8880   2.778952 #> 850 525.2438   2.555480 #> 851 501.5371   3.084815 #> 852 705.3597   2.639119 #> 853 984.9357   2.703293 #> 854 609.8377   2.578313 #> 855 674.0899   2.518190 #> 856 501.6828   2.575319 #> 857 500.1537   4.291300 #> 858 546.3710   3.668140 #> 859 500.5318   3.149582 #> 860 502.7172   2.666535 #> 861 500.4217   2.553361 #> 862 502.2581   2.782043 #> 863 571.8114   3.009670 #> 864 500.4908   2.691605 #> 865 500.2092   2.677313 #> 866 500.1353   3.301702 #> 867 746.9184   2.917686 #> 868 514.6405   2.676420 #> 869 508.6638   2.559894 #> 870 503.7013   2.808807 #> 871 500.1501   2.971782 #> 872 653.7341   3.000899 #> 873 530.6330   2.547904 #> 874 520.3469   3.018430 #> 875 501.0519   2.754940 #> 876 501.8825   2.531086 #> 877 500.2558   3.038099 #> 878 502.8363   3.234223 #> 879 500.0228   3.920177 #> 880 505.1956   3.325659 #> 881 505.9361   3.733778 #> 882 681.7125   3.515259 #> 883 527.9436   3.388809 #> 884 500.0014   2.877260 #> 885 502.0865   2.996803 #> 886 840.7030   3.025462 #> 887 502.6566   3.144881 #> 888 500.1574   2.520699 #> 889 510.0041   3.073603 #> 890 500.0012   2.585873 #> 891 500.0170   2.632997 #> 892 500.1971   3.366667 #> 893 500.9641   2.718618 #> 894 530.0226   3.165944 #> 895 503.5989   2.741465 #> 896 500.7978   3.583914 #> 897 509.6230   3.332962 #> 898 501.3613   2.762210 #> 899 501.2704   3.190970 #> 900 672.4974   2.860232 #> 901 502.7433   6.852627 #> 902 504.6425   3.081329 #> 903 572.2925   2.569388 #> 904 604.2970   2.597638 #> 905 503.5677   2.617001 #> 906 502.6949   3.285519 #> 907 563.3260   2.794154 #> 908 538.5002   2.947571 #> 909 510.0750   2.813526 #> 910 500.7267   2.723732 #> 911 500.7932   2.660402 #> 912 507.9184   3.063705 #> 913 503.1148   3.037844 #> 914 505.3743   2.709545"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":null,"dir":"Reference","previous_headings":"","what":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"Sampling times events triggered parent th according ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"","code":"sample_temporal_ETAS_times(theta, n.ev, th, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). n.ev Number events return sample time domain (th, T2]. th Time parent event producing n.ev daughters. T2 End time model domain.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"t.sample list times interval [0, T2] distributed according ETAS triggering function.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — sample_temporal_injection_events","title":"Title — sample_temporal_injection_events","text":"Title","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — sample_temporal_injection_events","text":"","code":"sample_temporal_injection_events(   a = 50,   V.i = 1,   tau = 10,   beta.p,   M0,   T.i,   T2 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — sample_temporal_injection_events","text":"Induced event rate per unit volume. V.Injected volume tau Decay rate [days]. beta.p Related b-value via b ln(10). M0 Minimum magnitude threshold. T.Time injection [days]. T2 End temporal model domain [days].","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — sample_temporal_injection_events","text":"Catalogue parent events induced injection; data.frame(times, magnitudes)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a set of time bins for a specific event. — time_grid","title":"Generate a set of time bins for a specific event. — time_grid","text":"Generate set time bins specific event.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a set of time bins for a specific event. — time_grid","text":"","code":"time_grid(data.point, coef.t, delta.t, N.exp., T1., T2.)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a set of time bins for a specific event. — time_grid","text":"data.point Point binning calculated, list elements time (ts, scalar), event index (idx.p, scalar). Names mandatory changed coef.t TimeBinning parameter: look breaks_exp() delta.t TimeBinning parameter: look breaks_exp() N.exp. TimeBinning parameter: look breaks_exp() T1. Start temporal domain, scalar T2. End temporal domain scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a set of time bins for a specific event. — time_grid","text":"data.frame many rows number bins fixed number columns. columns t.start : starting point bin (minimum = T1.). t.end : end point bin. (maximum = T2.). t.bin.name : unique bin identifier. t.ref_layer : bin identifier calculations ts : time provided data.point idx.p : identifier provided data.point bins T1. T2. containing T1.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a set of time bins for a specific event. — time_grid","text":"","code":"## EXAMPLE 1 event <- list(ts = 0, idx.p = 1) time_grid(data.point = event, coef.t = 1, delta.t = 0.1, N.exp. = 8, T1. = 1, T2. = 20) #>   t.start t.end t.bin.name t.ref_layer ts idx.p #> 1     1.0   1.6    0.8-1.6   between-1  0     1 #> 2     1.6   3.2    1.6-3.2           6  0     1 #> 3     3.2   6.4    3.2-6.4           7  0     1 #> 4     6.4  12.8   6.4-12.8           8  0     1 #> 5    12.8  20.0    12.8-20      last-1  0     1"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"Function plot ETAS triggering function corresponding different posterior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"","code":"triggering_fun_plot(   input.list,   post.samp = NULL,   n.samp = 10,   magnitude = 4,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale post.samp data.frame containing posterior samples parameters. NULL, n.samp samples generated. n.samp different nrow(post.samp) n.samp rows uniformly sampled post.samp. Default NULL n.samp Number posterior samples, integer (default = 10). magnitude Magnitude event triggering function calculated, scalar (default = 4). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"ggplot object grey lines representing triggering function posterior sample. Black lines representing 0.025 0.975 quantiles function values calculated posterior sample. Horizontal red lines represents 0.025 0.975 quantiles sampled background rates.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"Function plot ETAS triggering function corresponding different prior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"","code":"triggering_fun_plot_prior(   input.list,   magnitude = 4,   n.samp = 10,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"input.list structured input list least one element: link.functions: list functions convert ETAS parameters INLA scale ETAS scale magnitude Magnitude event triggering function calculated, scalar (default = 4). n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"ggplot object grey lines representing triggering function posterior sample. Black lines representing 0.025 0.975 quantiles function values calculated posterior sample. Horizontal red lines represents 0.025 0.975 quantiles sampled background rates.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"Copula transformation standard Normal distribution Uniform distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"","code":"unif_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"x values standard Normal distribution, vector. minimum value Uniform distribution, scalar. b maximum value Uniform distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"values Uniform distribution b, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/news/index.html","id":"etasinlabru-development-version","dir":"Changelog","previous_headings":"","what":"ETAS.inlabru (development version)","title":"ETAS.inlabru (development version)","text":"Cleaned R package structure Added vignettes package website Renamed functions avoid “.” non-S3-method function names. Temporal.ETAS.* functions retain “.”, now.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/news/index.html","id":"etasinlabru-101","dir":"Changelog","previous_headings":"","what":"ETAS.inlabru 1.0.1","title":"ETAS.inlabru 1.0.1","text":"Initial package version.","code":""}]
