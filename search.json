[{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"load-packages","dir":"Articles","previous_headings":"Setup","what":"Load Packages","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"library(ETAS.inlabru) library(ggplot2)  library(rnaturalearth) library(terra) library(sf) library(ggspatial) library(rnaturalearthdata) library(dplyr) library(lubridate)  ## This is just the EPSG equivalent of WGS84 crs_wgs84 <- st_crs('EPSG:4326')"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"load-an-earthquake-catalogue","dir":"Articles","previous_headings":"","what":"Load an earthquake catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"Earthquake data stored -called earthquake catalogues. Many different catalogues exists region easy way decide one better. , provide HOmogenized instRUmental Seismic (HORUS) catalogue 1960 2020. can downloaded http://horus.bo.ingv./. subset (see data-raw/horus.R subset created) information Horus catalogue can loaded using data reports earthquake time string (time_string), longitude (lon) latitude (lat) epicentre, depth kilometres (depth), moment magnitude (M).","code":"# load HORUS catalogue data(horus, package = \"ETAS.inlabru\")  # transform time string in Date object horus$time_date <- as.POSIXct(   horus$time_string,   format = \"%Y-%m-%dT%H:%M:%OS\" )  head(horus) #>           time_string     lon     lat depth    M           time_date #> 1 1960-01-03T20:19:34 15.3000 39.3000   290 6.34 1960-01-03 20:19:34 #> 2 1960-01-04T09:20:00 13.1667 43.1333     0 3.94 1960-01-04 09:20:00 #> 3 1960-01-06T15:17:34 12.7000 46.4833     4 4.69 1960-01-06 15:17:34 #> 4 1960-01-06T15:20:53 12.7000 46.4667     0 4.14 1960-01-06 15:20:53 #> 5 1960-01-06T15:31:00 12.7500 46.4333     0 3.00 1960-01-06 15:31:00 #> 6 1960-01-06T15:45:00 12.7500 46.4333     0 3.00 1960-01-06 15:45:00  # Set df_cat to be the catalogue we want to analyse and then use this below df_cat <- horus  # Add an integer id to each event df_cat$event_num <- seq.int(nrow(df_cat))  # Generate an sf version of the catalogue where the longitude and latitude are converted to a point object df_cat.sf<- st_as_sf(df_cat,                      coords = c(\"lon\", \"lat\"),                      crs = crs_wgs84)  head(df_cat.sf) #> Simple feature collection with 6 features and 5 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 12.7 ymin: 39.3 xmax: 15.3 ymax: 46.4833 #> Geodetic CRS:  WGS 84 #>           time_string depth    M           time_date event_num #> 1 1960-01-03T20:19:34   290 6.34 1960-01-03 20:19:34         1 #> 2 1960-01-04T09:20:00     0 3.94 1960-01-04 09:20:00         2 #> 3 1960-01-06T15:17:34     4 4.69 1960-01-06 15:17:34         3 #> 4 1960-01-06T15:20:53     0 4.14 1960-01-06 15:20:53         4 #> 5 1960-01-06T15:31:00     0 3.00 1960-01-06 15:31:00         5 #> 6 1960-01-06T15:45:00     0 3.00 1960-01-06 15:45:00         6 #>                  geometry #> 1       POINT (15.3 39.3) #> 2 POINT (13.1667 43.1333) #> 3    POINT (12.7 46.4833) #> 4    POINT (12.7 46.4667) #> 5   POINT (12.75 46.4333) #> 6   POINT (12.75 46.4333)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"get-map-and-extract-crs-for-the-map","dir":"Articles","previous_headings":"Load an earthquake catalogue","what":"Get map and extract crs for the map","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"download polygon file national boundary Italy use later notebook.","code":"italy.map <- ne_countries(country = 'Italy', returnclass = \"sf\", scale = 'medium') italy.crs <- crs(italy.map) print(italy.crs) #> [1] \"BOUNDCRS[\\n    SOURCECRS[\\n        GEOGCRS[\\\"unknown\\\",\\n            DATUM[\\\"World Geodetic System 1984\\\",\\n                ELLIPSOID[\\\"WGS 84\\\",6378137,298.257223563,\\n                    LENGTHUNIT[\\\"metre\\\",1]],\\n                ID[\\\"EPSG\\\",6326]],\\n            PRIMEM[\\\"Greenwich\\\",0,\\n                ANGLEUNIT[\\\"degree\\\",0.0174532925199433],\\n                ID[\\\"EPSG\\\",8901]],\\n            CS[ellipsoidal,2],\\n                AXIS[\\\"longitude\\\",east,\\n                    ORDER[1],\\n                    ANGLEUNIT[\\\"degree\\\",0.0174532925199433,\\n                        ID[\\\"EPSG\\\",9122]]],\\n                AXIS[\\\"latitude\\\",north,\\n                    ORDER[2],\\n                    ANGLEUNIT[\\\"degree\\\",0.0174532925199433,\\n                        ID[\\\"EPSG\\\",9122]]]]],\\n    TARGETCRS[\\n        GEOGCRS[\\\"WGS 84\\\",\\n            DATUM[\\\"World Geodetic System 1984\\\",\\n                ELLIPSOID[\\\"WGS 84\\\",6378137,298.257223563,\\n                    LENGTHUNIT[\\\"metre\\\",1]]],\\n            PRIMEM[\\\"Greenwich\\\",0,\\n                ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n            CS[ellipsoidal,2],\\n                AXIS[\\\"geodetic latitude (Lat)\\\",north,\\n                    ORDER[1],\\n                    ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n                AXIS[\\\"geodetic longitude (Lon)\\\",east,\\n                    ORDER[2],\\n                    ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n            ID[\\\"EPSG\\\",4326]]],\\n    ABRIDGEDTRANSFORMATION[\\\"Transformation from unknown to WGS84\\\",\\n        METHOD[\\\"Geocentric translations (geog2D domain)\\\",\\n            ID[\\\"EPSG\\\",9603]],\\n        PARAMETER[\\\"X-axis translation\\\",0,\\n            ID[\\\"EPSG\\\",8605]],\\n        PARAMETER[\\\"Y-axis translation\\\",0,\\n            ID[\\\"EPSG\\\",8606]],\\n        PARAMETER[\\\"Z-axis translation\\\",0,\\n            ID[\\\"EPSG\\\",8607]]]]\"  ggplot() +    geom_sf(data = italy.map) +    theme_bw() +   ggtitle(\"Map of the Italian territorial boundary and coastline\")"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"histogram-of-event-depths","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Histogram of event depths","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"histogram depth data 1km bins initially looks reasonable except artefact cluster events zero depth.  However, reduce bin width 100m see artefacts data. spikes 0, 5, 10 11km artefacts depth estimation, one cause algorithms may got stuck starting values. magnitude time series shows completeness intermediate deep events improved time.","code":"hist(df_cat$depth, breaks=seq(650,-5,-1), xlim=c(-5,40), main=\"Histogram of depths, 1km bins\", xlab=\"Depth [km]\") hist(df_cat$depth, breaks=seq(650,-5,-0.1), xlim=c(-5,40), main=\"Histogram of depths (100m bins)\", xlab=\"Depth [km]\") ggplot(df_cat, aes(x=time_date, y=depth))  +    geom_point(size = 0.1) +   ylim(620,0) +   ggtitle('Depth timeseries using natural time') #> Warning: Removed 3 rows containing missing values (`geom_point()`)."},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"plot-of-event-magnitudes-using-natural-time","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Plot of event magnitudes using natural time","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"Natural time refers plot event evenly spaced along x-axis. advantage data occurs periods high activity spread , means can see structure data rates high. plot magnitude events y-axis natural time horizontal. observations : 40,000 events magnitude data cluster events \\(M=0\\) likely artefact catalogue generated period time data rounded 1 decimal place producing horizontal banding times, data rounded sensitivity lowest magnitudes varies time can seen changes lowest magnitudes","code":"ggplot(df_cat, aes(x=event_num, y=M))  +    geom_point(size = 0.1) +   ggtitle('Magnitude timeseries using natural time')"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"plot-of-event-magnitudes-using-date-time","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Plot of event magnitudes using date-time","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"present data previous plot, plotted data-time. Clustered events now sit top . get better representaion data density increases towards modern day magnitude incompleteness varyies time.  number events occuring year difficult assess plot, group data year count number events occuring year. plot shows number events recorded year gradually increasing. artefact due gradual increase sensitivity network, seismicity systematically increasing.","code":"ggplot(df_cat, aes(x=time_date, y=M)) +    geom_point(size = 0.1) +   ggtitle(\"Horus catalogue magnitude time series\") #> Warning: Removed 1 rows containing missing values (`geom_point()`). df_cat$Time <- as.Date(df_cat$time_date)   print(\"Extract year\") #> [1] \"Extract year\" # extract the year and convert to numeric format df_cat$Year <- as.numeric(format(df_cat$Time, \"%Y\"))  countEventsInYear <- df_cat %>%   group_by(Year) %>%   summarize(counts = n())  plot(countEventsInYear, type=\"l\", main=\"Annual number of events for whole catalogue\") # Filtered for M>4 ggplot(df_cat[df_cat$M>4,], aes(x=time_date, y=M)) +    geom_point(size = 0.1) +   ggtitle(\"Whole catalogue magnitude timeseries for M>4\") #> Warning: Removed 1 rows containing missing values (`geom_point()`). countEventsInYear <- df_cat[df_cat$M>=4,] %>%   group_by(Year) %>%   summarize(counts = n())  plot(countEventsInYear, type=\"l\", main=\"Annual number of events with M>=4\") abline(h=mean(countEventsInYear), col=2) #> Warning in mean.default(countEventsInYear): argument is not numeric or logical: #> returning NA"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"frequency-magnitude-analysis-for-horus-catalogue","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Frequency-magnitude analysis for Horus catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"traditional GR plot shows cumulative data (red) also show incremental data (black). personally prefer looking incremental data correlated therefore easier understand Poisson counting errors account uncertainty data. three domains standard GR plot. - low magnitudes always incompleteness due limitations monitoring network - requirement GR good model log-linear portion data slope stable, slope refered b-value - high magnitudes always fluctuations magnitudes due effect counting errors bins low rates","code":"minMag <- 1.5 maxMag <- max(df_cat$M)  mags <- df_cat[df_cat$M>minMag,]$M  tmp <- hist(mags, breaks=seq(minMag-0.05,maxMag+0.1,0.1), plot=FALSE)  N.counts <- length( tmp$counts) tmp$cumulativeCounts <- cumsum(tmp$counts[N.counts:1])[N.counts:1]  m.min <- 4 bin_m.min <- which(tmp$mids==m.min) freq_m.min <- tmp$counts[bin_m.min] b <- 1 x <- tmp$mids y <- freq_m.min * 10^(-b*(x-m.min)) y.cum <- tmp$cumulativeCounts[bin_m.min] * 10^(-b*(x-m.min))  ggplot() +   geom_point( aes(x=tmp$mids, y=tmp$counts) ) +   geom_point( aes(x=tmp$mids, y=tmp$cumulativeCounts) , color='red', pch=\"+\", size=2) +   scale_y_log10() +   ggtitle(paste(\"Frequency-magnitude plot with arbitary GR dist: b =\", b)) +   xlab(\"Magnitude\") +   ylab(\"log10(Frequency)\") +   geom_line(aes(x=x, y=y)) +   geom_line(aes(x=x, y=y.cum), color='red') +   geom_vline( xintercept=m.min, lty=2 ) #> Warning: Transformation introduced infinite values in continuous y-axis"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"b-value-stability-plot-for-the-events-in-the-horus-catalogue","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"b-value stability plot for the events in the Horus catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"minMag <- 2 maxMag <- max(df_cat$M, na.rm=TRUE) mags <- df_cat[df_cat$M>=minMag,]$M  x <- seq(minMag,maxMag,0.1)  b.stability.list <- c() b.error.list <- c() m.mean <- c()  b_utsu <- c() b_guttorp <- c() b_elst <- c() delta_b_utsu <- c() b_elst_lower <- c() b_elst_upper <- c()  max.index.x <- length(x)-5  for( i in 1:max.index.x ){   mag.threshold <- x[i]   mags.subset <- mags[mags > mag.threshold]      N <- length(mags.subset)   b_utsu[i] <- 1/( log(10)*(mean(mags.subset)-mag.threshold+0.05))   delta_b_utsu[i] <- log(10)*b_utsu[i]**2 * sqrt( sum((mags.subset - mean(mags.subset))**2)/(N*(N-1)))        b_guttorp[i] = 1/( 2*0.05*log(10))*log((mean(mags.subset)-mag.threshold+2*0.05)/(mean(mags.subset)-mag.threshold))        deltaMags <- diff(mags.subset)   deltaMags_p <- deltaMags[deltaMags>0.1]   N <- length(deltaMags_p)   b_elst[i] <- 1/(2*0.05* log(10)) * log((mean(deltaMags_p))/(mean(deltaMags_p)-0.1))   c = 10**(0.1*b_elst[i])   b_elst_lower[i] <- 1/(0.1 * log(10)) * log((c+sqrt(c/N))/(1+sqrt(c/N)))   b_elst_upper[i] <- 1/(0.1 * log(10)) * log((c-sqrt(c/N))/(1-sqrt(c/N))) }  ggplot() +   geom_line( aes(x=x[1:max.index.x], y=b_utsu) ) +   geom_line( aes(x=x[1:max.index.x], y=b_utsu+delta_b_utsu), color=2, lty=2 ) +   geom_line( aes(x=x[1:max.index.x], y=b_utsu-delta_b_utsu), color=2, lty=2 ) +   geom_line( aes(x=x[1:max.index.x], y=b_guttorp), color=3, lty=1 ) +   xlab(\"Magnitude threshold\") +   ylab(\"b-value estimate\") +   geom_hline(yintercept = 1, lty=3) +   geom_hline(yintercept = 0.85, lty=3) +   ggtitle(\"b-value stability plot for Horus catalogue\")"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"heatmap-of-the-events-in-the-horus-catalogue","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Heatmap of the events in the Horus catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"ggplot() +   geom_hex(data = df_cat[df_cat$M>3,], aes(x = lon, y = lat), bins = 50) +   scale_fill_continuous(type = \"viridis\") +   geom_sf(data = italy.map, fill=alpha(\"lightgrey\", 0), color = 'orange', size=0.2) +    ggtitle(\"Density plot for M>3 events\") +   theme_bw()"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"map-of-the-events-in-the-italian-horus-catalogue","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Map of the events in the Italian Horus catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"plot location seismicity map. outline Italy territory shown green.","code":"ggplot() +   geom_sf(data = df_cat.sf[df_cat$M>3,], size = 0.05) +   geom_sf(data = italy.map, fill=alpha(\"lightgrey\", 0), color = 'green', linewidth=0.7) +   geom_sf(data = df_cat.sf[df_cat$M>5,], size = 0.5, color='orange') +   geom_sf(data = df_cat.sf[df_cat$M>6,], size = 0.5, color='red') +   ggtitle(\"Map of event locations\") eventDate <- ymd_hms( '2009-04-06 00:00:00' ) endDate <- eventDate + days(400) startDate <- eventDate - days(50) deltaLat <- 2.4 latLims <- c( 42.2,42.5) longLims <- c( 13, 13.75)  ggplot() +    geom_point(data=df_cat[df_cat$M>3,], aes(time_date, lat), size=0.1) +   geom_point(data=df_cat[df_cat$M>5,], aes(time_date, lat), size=1.2, color='orange') +   geom_point(data=df_cat[df_cat$M>6,], aes(time_date, lat), size=1.5, color='red') +   ggtitle(\"Italian latitude-time plot\")  +   geom_rect(aes(xmin = as.POSIXct(startDate), xmax = as.POSIXct(endDate), ymin = latLims[1], ymax = latLims[2]), alpha = 0.4, fill='blue', color='blue') #> Warning: Removed 1 rows containing missing values (`geom_point()`)."},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"analysis-if-the-laquila-sequence","dir":"Articles","previous_headings":"","what":"Analysis if the L’Aquila Sequence","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"focus L Aquila seismic sequence sufficient retain observations specific space-time-magnitude region include sequence interest. L’Aquila sequence, retain events magnitude greater equal \\(2.5\\) happened 2009 longitude \\((10.5, 16)\\) latitude \\((40.5, 45)\\). L’Aquila sequence selected way composed 1024 events. seismic sequence can selected similarly. selection convenient transform time string Date object select rows Horus catalogue verifying conditions. start.date = “2009-04-06 00:00:00 BST” end.date = “2010-01-01 00:00:00 BST” magnitude.completeness = 2.49 min.longitude = 13.00 max.longitude = 13.75 min.latitude = 42.2 max.latitude = 42.5","code":"eventDate <- ymd_hms( '2009-04-06 00:00:00' ) endDate <- eventDate + days(400) startDate <- eventDate - days(50) deltaLat <- 2.4 latLims <- c( 42.2,42.5) longLims <- c( 13, 13.75)  minMAG <- 0  # Subset the main catalogue df_cat.subset <- df_cat[df_cat$M >= minMAG, ] df_cat.subset <- df_cat.subset[ (df_cat.subset$lat>latLims[1]), ] df_cat.subset <- df_cat.subset[ (df_cat.subset$lat<latLims[2]), ] df_cat.subset <- df_cat.subset[ (df_cat.subset$lon>longLims[1]), ] df_cat.subset <- df_cat.subset[ (df_cat.subset$lon<longLims[2]), ]  head(df_cat.subset) #>             time_string     lon     lat depth    M           time_date #> 243 1961-03-25T10:40:00 13.3167 42.4333     0 3.64 1961-03-25 10:40:00 #> 295 1961-10-05T19:59:35 13.0167 42.3500     3 0.00 1961-10-05 19:59:35 #> 302 1961-10-31T00:00:00 13.0167 42.3500    10 3.94 1961-10-31 00:00:00 #> 303 1961-10-31T00:00:00 13.0167 42.3500    10 3.94 1961-10-31 00:00:00 #> 304 1961-10-31T13:37:18 13.0833 42.4167     4 4.64 1961-10-31 13:37:18 #> 305 1961-10-31T13:41:59 13.0833 42.4167     0 4.14 1961-10-31 13:41:59 #>     event_num       Time Year #> 243       243 1961-03-25 1961 #> 295       295 1961-10-05 1961 #> 302       302 1961-10-31 1961 #> 303       303 1961-10-31 1961 #> 304       304 1961-10-31 1961 #> 305       305 1961-10-31 1961"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"plot-of-the-event-magnitude-time-series-laquila","dir":"Articles","previous_headings":"Analysis if the L’Aquila Sequence","what":"Plot of the event magnitude time series: l’Aquila","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"ggplot() +    geom_point(data=df_cat.subset[df_cat.subset$M>3,], aes(time_date, lat), size=0.1) +   geom_point(data=df_cat.subset[df_cat.subset$M>5,], aes(time_date, lat), size=1.2, color='orange') +   geom_point(data=df_cat.subset[df_cat.subset$M>6,], aes(time_date, lat), size=1.5, color='red') +   ggtitle(\"L'Aquila latitude-time plot\") +   geom_rect(aes(xmin = as.POSIXct(startDate), xmax = as.POSIXct(endDate), ymin = latLims[1], ymax = latLims[2]), alpha = 0.4, fill='blue', color='blue') minMag <- 0 maxMag <- max(df_cat.subset$M, na.rm=TRUE)  mags <- df_cat.subset[df_cat.subset$M>=minMag,]$M  tmp <- hist(mags, breaks=seq(minMag-0.05,maxMag+0.4,0.1), plot=FALSE)  N.counts <- length( tmp$counts) tmp$cumulativeCounts <- cumsum(tmp$counts[N.counts:1])[N.counts:1]  m.min <- 4 bin_m.min <- which(tmp$mids==m.min) freq_m.min <- tmp$counts[bin_m.min] b <- 1. x <- tmp$mids y <- freq_m.min * 10^(-b*(x-m.min)) y.cum <- tmp$cumulativeCounts[bin_m.min] * 10^(-b*(x-m.min))  ggplot() +   geom_point( aes(x=tmp$mids, y=tmp$counts) ) +   geom_point( aes(x=tmp$mids, y=tmp$cumulativeCounts) , color='red', pch=\"+\") +   scale_y_log10() +   ggtitle(paste(\"Frequency-magnitude plot with arbitary GR dist: b =\", b)) +   xlab(\"Magnitude\") +   ylab(\"log10(Frequency)\") +   geom_line(aes(x=x, y=y)) +   geom_line(aes(x=x, y=y.cum), color='red') +   geom_vline( xintercept=m.min, lty=2 ) #> Warning: Transformation introduced infinite values in continuous y-axis #> Transformation introduced infinite values in continuous y-axis"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"b-value-stability-plot-laquila","dir":"Articles","previous_headings":"Analysis if the L’Aquila Sequence","what":"b-value stability plot: l’Aquila","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"minMag <- 0 maxMag <- max(df_cat.subset$M, na.rm=TRUE) mags <- df_cat.subset[df_cat.subset$M>=minMag,]$M  x <- seq(minMag,maxMag,0.1)  b.stability.list <- c() b.error.list <- c() m.mean <- c()  b_utsu <- c() b_guttorp <- c() b_elst <- c() delta_b_utsu <- c() b_elst_lower <- c() b_elst_upper <- c()  max.index.x <- length(x)-5  for( i in 1:max.index.x ){   mag.threshold <- x[i]   mags.subset <- mags[mags > mag.threshold]      N <- length(mags.subset)   b_utsu[i] <- 1/( log(10)*(mean(mags.subset)-mag.threshold+0.05))   delta_b_utsu[i] <- log(10)*b_utsu[i]**2 * sqrt( sum((mags.subset - mean(mags.subset))**2)/(N*(N-1)))        b_guttorp[i] = 1/( 2*0.05*log(10))*log((mean(mags.subset)-mag.threshold+2*0.05)/(mean(mags.subset)-mag.threshold))        deltaMags <- diff(mags.subset)   deltaMags_p <- deltaMags[deltaMags>0.1]   N <- length(deltaMags_p)   b_elst[i] <- 1/(2*0.05* log(10)) * log((mean(deltaMags_p))/(mean(deltaMags_p)-0.1))   c = 10**(0.1*b_elst[i])   b_elst_lower[i] <- 1/(0.1 * log(10)) * log((c+sqrt(c/N))/(1+sqrt(c/N)))   b_elst_upper[i] <- 1/(0.1 * log(10)) * log((c-sqrt(c/N))/(1-sqrt(c/N))) }  ggplot() +   geom_line( aes(x=x[1:max.index.x], y=b_utsu) ) +   geom_line( aes(x=x[1:max.index.x], y=b_utsu+delta_b_utsu), color=2, lty=2 ) +   geom_line( aes(x=x[1:max.index.x], y=b_utsu-delta_b_utsu), color=2, lty=2 ) +   geom_line( aes(x=x[1:max.index.x], y=b_guttorp), color=3, lty=1 ) +   xlab(\"Magnitude threshold\") +   ylab(\"b-value estimate\") +   geom_hline(yintercept = 1, lty=3) +   geom_hline(yintercept = 0.85, lty=3) +   ggtitle(\"b-value stability plot for the l'Aquila catalogue\") #> Warning: Removed 2 rows containing missing values (`geom_line()`). #> Removed 2 rows containing missing values (`geom_line()`)."},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/generateSyntheticCatalogues.html","id":"create-catalogue","dir":"Articles","previous_headings":"","what":"Create catalogue","title":"2a Temporal Model: Generating synthetic temporal ETAS catalogues","text":"define ETAS parameters define model domain specify history generate ETAS sample plot results","code":"mu <- 1070. / 365 K <- 0.089 alpha <- 2.29 c <- 0.011 p <- 1.08  modelledDuration <- 10 # [days]  M0 <- 2  theta_etas <- data.frame(mu = mu, K = K, alpha = alpha, c = c, p = p)  Ht <- data.frame(ts = c(0., 1.5), magnitudes = c(6.7, 7.))  samp.etas.list <- generate_temporal_ETAS_synthetic(theta = theta_etas, beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = Ht)  ggplot() +   geom_point(data = samp.etas.list[[1]], aes(x = ts, y = magnitudes), color = \"red\") +   geom_point(data = samp.etas.list[[2]], aes(x = ts, y = magnitudes), color = \"green\") +   xlim(0, modelledDuration) +   ggtitle(\"M7 plus background and ETAS\") combined.M7.ETAS.cat <- bind_rows(samp.etas.list)  combined.M7.ETAS.cat <- bind_rows(samp.etas.list) combined.M7.ETAS.cat <- combined.M7.ETAS.cat[order(combined.M7.ETAS.cat$ts), ]  combined.M7.ETAS.cat$ID <- seq(1, length(combined.M7.ETAS.cat$ts))  ggplot() +   geom_point(data = combined.M7.ETAS.cat, aes(x = ID, y = magnitudes), color = \"red\") #+ #  geom_ma(data = combined.M7.ETAS.cat, aes(x=ID, y=magnitudes), ma_fun = SMA, n = 10)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sampleFromETASpriors.html","id":"sampling-etas-priors","dir":"Articles","previous_headings":"","what":"Sampling ETAS Priors","title":"2b Temporal Model: Presenting samples drawn from the ETAS priors","text":"important check priors broad enough expect model parameterisation lie within . notebook shows draw samples priors present resulting triggering functions.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"multiple-analyses-of-two-catalogues-using-different-initial-values","dir":"Articles","previous_headings":"","what":"Multiple analyses of two catalogues using different initial values","title":"Sensitivity to starting point","text":"inlabru algorithm takes initial guess mode parameters inverting iteratively updates initial guess. potential may bad initial conditions find different solutions runtime differ depending upon solution converges. notebook, explore robustness posteriors two synthetic catalogues true parameters known. catalogues contain 2000 days data. One catalogue contain large event second contains M6.7 event day 1000.","code":"library(ETAS.inlabru)  library(tidyquant) library(gridExtra) library(grid) library(lemon) library(ggplot2) library(ggpubr) library(GGally)  library(inlabru) library(INLA) library(ETAS.inlabru)  # inla.setOption(pardiso.license=\"~/sys/licences/pardiso.lic\")  library(dplyr)  # Increase num.threads if you have more cores on your computer INLA::inla.setOption(num.threads = 2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"define-the-parameters-for-the-synthetic-catalogues-and-starting-values-for-inversion","dir":"Articles","previous_headings":"Multiple analyses of two catalogues using different initial values","what":"Define the parameters for the synthetic catalogues and starting values for inversion","title":"Sensitivity to starting point","text":"","code":"# Parameters we use to generate synthetics, which we will refer to as the 'true' parameters mu <- 0.1 K <- 0.089 alpha <- 2.29 c <- 0.11 p <- 1.08  # Format the true ETAS parameters for code to generate the synthetics theta_etas <- data.frame(mu = mu, K = K, alpha = alpha, c = c, p = p)  # A dataframe containing different starting values for the algorithm startingValues <- data.frame(   mu = c(5., mu),   K = c(1., K),   alpha = c(5., alpha),   c = c(0.3, c),   p = c(1.5, p) ) nRealisations <- length(startingValues$mu)   # Temporal duration of the synthetic catalogue in days modelledDuration <- 1000 # [days]  # The minimum magnitude that will be modelled M0 <- 2.5"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"generate-new-catalogues-and-save-them","dir":"Articles","previous_headings":"Multiple analyses of two catalogues using different initial values","what":"Generate new catalogues and save them","title":"Sensitivity to starting point","text":"vignette use Rmd caching, can save catalogues files explicitly:","code":"############ #### Generate the first catalogue with no large events  samp.etas.list <- generate_temporal_ETAS_synthetic(   theta = theta_etas,   beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = NULL )  quiet.ETAS.cat <- bind_rows(samp.etas.list) quiet.ETAS.cat <- quiet.ETAS.cat[order(quiet.ETAS.cat$ts), ] # quiet.ETAS.cat <- na.omit(quiet.ETAS.cat) ############ #### Generate the second catalogue with a M6.7 event on day 1000  Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) # Impose a M6.7 event on day 1000  samp.etas.list <- generate_temporal_ETAS_synthetic(theta = theta_etas, beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = Ht)  M6p7.ETAS.cat <- bind_rows(samp.etas.list) M6p7.ETAS.cat <- M6p7.ETAS.cat[order(M6p7.ETAS.cat$ts), ] # save(M6p7.ETAS.cat,file=\"M6p7_ETAS_cat.Rda\") # save(quiet.ETAS.cat,file=\"quiet.ETAS.cat.Rda\")"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"load-the-catalogues","dir":"Articles","previous_headings":"Present the catalogues","what":"Load the catalogues","title":"Sensitivity to starting point","text":"read saved object files:","code":"# load(\"M6p7_ETAS_cat.Rda\") # load(\"quiet.ETAS.cat.Rda\")"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-properties-of-the-catalogues","dir":"Articles","previous_headings":"Present the catalogues","what":"Plot properties of the catalogues","title":"Sensitivity to starting point","text":"","code":"plots <- list()  plots[[1]] <- ggplot() +   geom_point(data = quiet.ETAS.cat, aes(x = ts, y = magnitudes), size = 0.1, alpha = 0.5) +   xlim(0, modelledDuration) +   ggtitle(paste(\"A.  Unseeded catalog, nEvents =\", length(quiet.ETAS.cat$ts))) +   ylim(2, 7) +   xlab(\"Time [days]\") +   ylab(\"Magnitude\") +   theme_bw()  plots[[2]] <- ggplot() +   geom_point(data = M6p7.ETAS.cat, aes(x = ts, y = magnitudes), size = 0.1, alpha = 0.5) +   xlim(0, modelledDuration) +   ggtitle(paste(\"B.  Catalog seeded with M6.7 event on day 500, nEvents =\", length(M6p7.ETAS.cat$ts))) +   ylim(2, 7) +   xlab(\"Time [days]\") +   ylab(\"Magnitude\") +   theme_bw()   plt <- grid.arrange(plots[[1]], plots[[2]], ncol = 1, nrow = 2) #> Warning: Removed 1 rows containing missing values (`geom_point()`). # ggsave(\"initialConditionCats.png\", plt) # ggsave(\"initialConditionCats.pdf\", plt)"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"analysis-of-quiet-catalogue","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Analysis of quiet catalogue","title":"Sensitivity to starting point","text":"","code":"list.output.quietScenario <- list()  for (i in seq_len(nRealisations)) {   if (exists(\"list.input\")) remove(\"list.input\")    # Load a set of parameters that we will need to tweak for this application   fpath <- system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\")   list.input <- create_input_list_temporal_noCatalogue(fpath)    ####################   # Tweak the variables loaded from the input file   list.input$M0 <- M0   list.input$time.int <- c(0, modelledDuration)   list.input$T12 <- c(0, modelledDuration)    # Change the starting location, measured on the ETAS scale   list.input$mu.init <- startingValues$mu[i]   list.input$alpha.init <- startingValues$alpha[i]   list.input$K.init <- startingValues$K[i]   list.input$c.init <- startingValues$c[i]   list.input$p.init <- startingValues$p[i]    link.f <- list(     mu = \\(x) gamma_t(x, a_mu, b_mu),     K = \\(x) loggaus_t(x, a_K, b_K),     alpha = \\(x) unif_t(x, a_alpha, b_alpha),     c_ = \\(x) unif_t(x, a_c, b_c),     p = \\(x) unif_t(x, a_p, b_p)   )    # initial value - convert from ETAS scale to internal scale   list.input$th.init <- list(     th.mu = inv_gamma_t(list.input$mu.init, list.input$a_mu, list.input$b_mu),     th.K = inv_loggaus_t(list.input$K.init, list.input$a_K, list.input$b_K),     th.alpha = inv_unif_t(list.input$alpha.init, list.input$a_alpha, list.input$b_alpha),     th.c = inv_unif_t(list.input$c.init, list.input$a_c, list.input$b_c),     th.p = inv_unif_t(list.input$p.init, list.input$a_p, list.input$b_p)   )    # Define options for inlabru   if (is.null(list.input$max_step)) {     list.input$bru.opt.list <- list(       bru_verbose = 0, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       # bru_method = list(max_step = 0.5),       bru_initial = list.input$th.init     ) # parameters initial values   } else {     list.input$bru.opt.list <- list(       bru_verbose = 0, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       bru_method = list(max_step = list.input$max_step),       bru_initial = list.input$th.init     ) # parameters initial values   }    ## Add out catalogue to the input list   list.input$catalog <- data.frame(     time_diff = quiet.ETAS.cat$ts,     magnitudes = quiet.ETAS.cat$magnitudes   )    ## Add the catalogue formatted for bru   list.input$catalog.bru <- data.frame(     ts = quiet.ETAS.cat$ts,     magnitudes = quiet.ETAS.cat$magnitudes,     idx.p = seq_len(nrow(quiet.ETAS.cat))   )    ## Input list is now formatted   ####################    ## Run the model according to the input list   ETAS.model.fit <- Temporal.ETAS.fit(list.input)    ## Small bit of post processing   list.output.quietScenario[[i]] <- append(list.input, list(model.fit = ETAS.model.fit))   list.output.quietScenario[[i]]$runtime <- sum(list.output.quietScenario[[i]]$model.fit$bru_timings$Time)   list.output.quietScenario[[i]]$nEvents <- length(list.output.quietScenario[[i]]$catalog[, 1]) } #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  0.7107782  #> Finish model fitting  #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  0.6730323  #> Finish model fitting"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"analysis-of-m6-7-catalogue","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Analysis of M6.7 catalogue","title":"Sensitivity to starting point","text":"","code":"list.output.M6p7Scenario <- list()  for (i in seq_len(nRealisations)) {   if (exists(\"list.input\")) {     remove(list.input)   }    # Load a set of parameters that we will need to tweak for this application   fpath <- system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\")   list.input <- create_input_list_temporal_noCatalogue(fpath)    ####################   # Tweak the variables laoded from the input file   list.input$M0 <- M0   list.input$time.int <- c(0, modelledDuration)   list.input$T12 <- c(0, modelledDuration)    # Change the starting location, measured on the ETAS scale   list.input$mu.init <- startingValues$mu[i]   list.input$alpha.init <- startingValues$alpha[i]   list.input$K.init <- startingValues$K[i]   list.input$c.init <- startingValues$c[i]   list.input$p.init <- startingValues$p[i]    link.f <- list(     mu = \\(x) gamma_t(x, a_mu, b_mu),     K = \\(x) loggaus_t(x, a_K, b_K),     alpha = \\(x) unif_t(x, a_alpha, b_alpha),     c_ = \\(x) unif_t(x, a_c, b_c),     p = \\(x) unif_t(x, a_p, b_p)   )    # initial value - convert from ETAS scale to internal scale   list.input$th.init <- list(     th.mu = inv_gamma_t(list.input$mu.init, list.input$a_mu, list.input$b_mu),     th.K = inv_loggaus_t(list.input$K.init, list.input$a_K, list.input$b_K),     th.alpha = inv_unif_t(list.input$alpha.init, list.input$a_alpha, list.input$b_alpha),     th.c = inv_unif_t(list.input$c.init, list.input$a_c, list.input$b_c),     th.p = inv_unif_t(list.input$p.init, list.input$a_p, list.input$b_p)   )    # Define options for inlabru   if (is.null(list.input$max_step)) {     list.input$bru.opt.list <- list(       bru_verbose = 3, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       # bru_method = list(max_step = 0.5),       bru_initial = list.input$th.init     ) # parameters initial values   } else {     list.input$bru.opt.list <- list(       bru_verbose = 3, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       bru_method = list(max_step = list.input$max_step),       bru_initial = list.input$th.init     ) # parameters initial values   }    ## Add out catalogue to the input list   list.input$catalog <- data.frame(     time_diff = M6p7.ETAS.cat$ts,     magnitudes = M6p7.ETAS.cat$magnitudes   )    ## Add the catalogue formatted for bru   list.input$catalog.bru <- data.frame(     ts = M6p7.ETAS.cat$ts,     magnitudes = M6p7.ETAS.cat$magnitudes,     idx.p = seq_len(nrow(M6p7.ETAS.cat))   )    ## Input list is now formatted   ####################    ## Run the model according to the input list   ETAS.model.fit <- Temporal.ETAS.fit(list.input)    ## Small bit of post processing   list.output.M6p7Scenario[[i]] <- append(list.input, list(model.fit = ETAS.model.fit))   list.output.M6p7Scenario[[i]]$runtime <- sum(list.output.M6p7Scenario[[i]]$model.fit$bru_timings$Time)   list.output.M6p7Scenario[[i]]$nEvents <- length(list.output.M6p7Scenario[[i]]$catalog[, 1]) } #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  11.68495 #> iinla: Evaluate component inputs #> iinla: Evaluate component linearisations #> iinla: Evaluate component simplifications #> iinla: Evaluate predictor linearisation #> iinla: Construct inla stack #> iinla: Model initialisation completed #> iinla: Iteration 1 [max:100] #> iinla: Step rescaling: 94.35%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Iteration 2 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 127.7%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 1690% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 3 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 2640% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 4 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 126.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 949% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 5 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 106.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 624% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 6 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 92.83%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 312% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 7 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 107.6%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 292% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 8 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.4%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 255% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 9 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.8%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 203% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 10 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.7%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 187% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 11 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.7%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 172% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 12 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.7%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 160% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 13 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.6%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 149% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 14 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.6%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 139% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 15 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.5%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 130% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 16 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.5%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 122% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 17 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.5%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 114% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 18 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.4%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 107% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 19 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.4%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 101% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 20 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.4%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 94.7% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 21 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 89.2% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 22 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 84.1% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 23 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 79.4% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 24 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 74.9% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 25 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 70.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 26 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 66.9% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 27 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 63.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 28 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 59.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 29 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 56.6% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 30 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 53.6% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 31 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 50.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 32 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 48.1% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 33 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 45.6% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 34 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 43.2% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 35 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 40.9% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 36 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 38.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 37 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 36.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 38 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 34.9% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 39 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 33.1% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 40 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 31.4% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 41 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 29.8% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 42 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 28.3% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 43 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 26.9% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 44 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 25.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 45 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 24.2% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 46 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 23% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 47 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 21.8% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 48 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 20.7% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 49 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 19.7% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 50 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 18.7% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 51 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 17.8% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 52 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 16.9% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 53 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 16% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 54 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 15.2% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 55 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 14.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 56 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 13.8% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 57 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 13.1% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 58 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 12.4% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 59 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 11.8% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 60 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 11.2% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 61 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 10.7% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 62 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 10.1% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 63 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 9.64% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Convergence criterion met, running final INLA integration with known theta mode. #> iinla: Iteration 64 [max:100] #> Finish model fitting  #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  11.96342 #> iinla: Evaluate component inputs #> iinla: Evaluate component linearisations #> iinla: Evaluate component simplifications #> iinla: Evaluate predictor linearisation #> iinla: Construct inla stack #> iinla: Model initialisation completed #> iinla: Iteration 1 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.8%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Iteration 2 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 23.8% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 3 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 22.3% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 4 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 21.6% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 5 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 20.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 6 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 19.4% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 7 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 18.4% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 8 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 17.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 9 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 16.6% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 10 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 15.8% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 11 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 15% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 12 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 14.2% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 13 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 13.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 14 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 12.8% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 15 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 12.2% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 16 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 11.6% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 17 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 11% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 18 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 10.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 19 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 9.95% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Convergence criterion met, running final INLA integration with known theta mode. #> iinla: Iteration 20 [max:100] #> Finish model fitting"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-posteriors-with-corresponding-starting-values","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions > Analysis of M6.7 catalogue","what":"Plot posteriors with corresponding starting values","title":"Sensitivity to starting point","text":"","code":"plots <- list()  trueParas <- data.frame(value = c(mu, K, alpha, c, p), param = c(\"mu\", \"K\", \"alpha\", \"c\", \"p\"))  post.list <- get_posterior_param(input.list = list.output.quietScenario[[1]]) post.df <- post.list[[1]] post.df$id <- 1  for (i in 2:nRealisations) {   post.list <- get_posterior_param(input.list = list.output.quietScenario[[i]])   post.df.tmp <- post.list[[1]]   post.df.tmp$id <- i    post.df <- rbind(post.df, post.df.tmp) }  plots[[1]] <- ggplot(post.df, aes(x = x, y = y, group = id, color = factor(id), lty = factor(id))) +   geom_line() +   # scale_x_discrete(guide = guide_axis(check.overlap = TRUE)) +   facet_wrap(facets = vars(param), scales = \"free\", labeller = label_parsed, nrow = 1) +   geom_vline(aes(xintercept = value),     data = trueParas, color = \"black\", linetype = 2,     label = \"True value\"   ) +   labs(color = \"Initial ETAS Para. Set\", linetype = \"Initial ETAS Para. Set\") +   ggtitle(paste(\"A.  Inversion of a 1000 day catalogue with no large events, nEvents =\", length(quiet.ETAS.cat$ts))) +   xlab(\"ETAS Posteriors\") +   theme_bw() +   theme(axis.text.x = element_text(angle = 45, hjust = 1)) +   theme(legend.position = \"hidden\") +   theme(plot.title = element_text(size = 12)) #> Warning in geom_vline(aes(xintercept = value), data = trueParas, color = #> \"black\", : Ignoring unknown parameters: `label` trueParas <- data.frame(value = c(mu, K, alpha, c, p), param = c(\"mu\", \"K\", \"alpha\", \"c\", \"p\"))  post.list <- get_posterior_param(input.list = list.output.M6p7Scenario[[1]]) post.df <- post.list[[1]] post.df$id <- 2  for (i in 2:nRealisations) {   post.list <- get_posterior_param(input.list = list.output.M6p7Scenario[[i]])   post.df.tmp <- post.list[[1]]   post.df.tmp$id <- i    post.df <- rbind(post.df, post.df.tmp) }  plots[[2]] <- ggplot(post.df, aes(x = x, y = y, group = id, color = factor(id), lty = factor(id))) +   geom_line() +   # scale_x_discrete(guide = guide_axis(check.overlap = TRUE)) +   facet_wrap(facets = vars(param), scales = \"free\", labeller = label_parsed, nrow = 1) +   geom_vline(aes(xintercept = value),     data = trueParas, color = \"black\", linetype = 2,     label = \"True value\"   ) +   labs(color = \"Initial ETAS Para. Set\", linetype = \"Initial ETAS Para. Set\") +   ggtitle(paste(\"B. Inversion of a 1000 day catalogue with a M6.7 on day 500, nEvents =\", length(M6p7.ETAS.cat$ts))) +   xlab(\"ETAS Posteriors\") +   theme_bw() +   theme(axis.text.x = element_text(angle = 45, hjust = 1)) +   theme(legend.position = \"hidden\") +   theme(plot.title = element_text(size = 12)) #> Warning in geom_vline(aes(xintercept = value), data = trueParas, color = #> \"black\", : Ignoring unknown parameters: `label` plt <- grid_arrange_shared_legend(plots[[1]], plots[[2]], ncol = 1, nrow = 2, position = \"bottom\") plt #> TableGrob (2 x 1) \"arrange\": 2 grobs #>   z     cells    name              grob #> 1 1 (1-1,1-1) arrange   gtable[arrange] #> 2 2 (2-2,1-1) arrange gtable[guide-box] # ggsave(\"initialCondition_posteriors.png\", plt) # ggsave(\"initialCondition_posteriors.pdf\", plt)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"explore-etas-triggering-function-using-posterior-samples","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Explore ETAS triggering function using posterior samples","title":"Sensitivity to starting point","text":"","code":"plot_triggering <- list() plot_triggering[[1]] <- triggering_fun_plot(list.output.quietScenario[[1]], magnitude = 4, n.samp = 100) +   ggtitle(\"C. M4 triggering function\") +   theme_bw() +   ylim(0, 5.5) +   theme(plot.title = element_text(size = 8))  plot_triggering[[2]] <- triggering_fun_plot(list.output.M6p7Scenario[[1]], magnitude = 4, n.samp = 100) +   ggtitle(\"D. M4 triggering function\") +   theme_bw() +   ylim(0, 5.5) +   theme(plot.title = element_text(size = 8))  plot_triggering[[3]] <- triggering_fun_plot(list.output.quietScenario[[1]], magnitude = 6.7, n.samp = 100) +   ggtitle(\"E. M6.7 triggering function\") +   theme_bw() +   ylim(0, 1700) +   theme(plot.title = element_text(size = 8))   plot_triggering[[4]] <- triggering_fun_plot(list.output.M6p7Scenario[[1]], magnitude = 6.7, n.samp = 100) +   ggtitle(\"F. M6.7 triggering function\") +   theme_bw() +   ylim(0, 1700) +   theme(plot.title = element_text(size = 8))   plt <- grid.arrange(plot_triggering[[1]], plot_triggering[[3]], plot_triggering[[2]], plot_triggering[[4]], ncol = 2, nrow = 2, top = \"Triggering function variability\") +   theme(plot.title = element_text(size = 8)) #> Warning: Removed 30 rows containing missing values (`geom_line()`). #> Warning: Removed 2 rows containing missing values (`geom_line()`). #> Warning: Removed 66 rows containing missing values (`geom_line()`). #> Warning: Removed 3 rows containing missing values (`geom_line()`). plt #> NULL  # ggsave(\"trigFuncVariability_runin.png\", plt) # ggsave(\"trigFuncVariability_runin.pdf\", plt) plot_omori <- list() plot_omori[[1]] <- omori_plot_posterior(list.output.quietScenario[[1]], n.samp = 100) +   ggtitle(\"A. Omori decay\") +   theme_bw() +   ylim(0, 1) +   theme(plot.title = element_text(size = 8))   plot_omori[[2]] <- omori_plot_posterior(list.output.M6p7Scenario[[1]], n.samp = 100) +   ggtitle(\"B. Omori decay\") +   theme_bw() +   ylim(0, 1) +   theme(plot.title = element_text(size = 8)) plt <- grid.arrange(plot_omori[[1]], plot_triggering[[1]], plot_triggering[[3]], plot_omori[[2]], plot_triggering[[2]], plot_triggering[[4]], ncol = 3, nrow = 2, top = \"Triggering  function variability\", left = \"M6.7 baseline            Unseeded baseline\") #> Warning: Removed 30 rows containing missing values (`geom_line()`). #> Warning: Removed 2 rows containing missing values (`geom_line()`). #> Warning: Removed 66 rows containing missing values (`geom_line()`). #> Warning: Removed 3 rows containing missing values (`geom_line()`). plt #> TableGrob (3 x 4) \"arrange\": 8 grobs #>   z     cells    name                 grob #> 1 1 (2-2,2-2) arrange       gtable[layout] #> 2 2 (2-2,3-3) arrange       gtable[layout] #> 3 3 (2-2,4-4) arrange       gtable[layout] #> 4 4 (3-3,2-2) arrange       gtable[layout] #> 5 5 (3-3,3-3) arrange       gtable[layout] #> 6 6 (3-3,4-4) arrange       gtable[layout] #> 7 7 (1-1,2-4) arrange text[GRID.text.1299] #> 8 8 (1-3,1-1) arrange text[GRID.text.1300]  # ggsave(\"trigFuncVariability_runin.png\", plt) # ggsave(\"trigFuncVariability_runin.pdf\", plt)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-the-samples-from-the-joint-posteriors-as-pairs-plots","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Plot the samples from the joint posteriors as pairs plots","title":"Sensitivity to starting point","text":"","code":"post_pairs_plot(list.output.quietScenario[[1]], n.samp = 1000)$pair.plot post_pairs_plot(list.output.M6p7Scenario[[1]], n.samp = 1000)$pair_plot #> NULL"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"inlabru-convergence-diagnostics","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"inlabru convergence diagnostics","title":"Sensitivity to starting point","text":"can also assess convergence inlabru method , using bru_convergence_plot() function. can reveal starting values inlabru estimation unreasonable, better starting values nonlinear iterations might speed computations.","code":"bru_convergence_plot(list.output.quietScenario[[1]]$model.fit) bru_convergence_plot(list.output.quietScenario[[2]]$model.fit) bru_convergence_plot(list.output.M6p7Scenario[[1]]$model.fit) bru_convergence_plot(list.output.M6p7Scenario[[2]]$model.fit)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"introduction-to-etas-model","dir":"Articles","previous_headings":"","what":"Introduction to ETAS model","title":"2d Temporal Model: Tutorial on real data","text":"tutorial, show use ETAS.inlabru R-package fit temporal ETAS model real earthquakes data. tutorial shows prepare data, fit model, retrieve posterior distribution parameters posterior distribution quantities interest, generate synthetic catalogues fitted model, produce forecasts seismicity. Epidemic-Type Aftershock Sequence (ETAS) model belongs family Hawkes () point processes. temporal Hawkes process point process model conditional intensity given \\[ \\lambda(t | \\mathcal H_t) = \\mu + \\sum_{t_h \\\\mathcal H_t} g(t- t_h) \\] \\(\\mathcal H_t\\) history process time \\(t\\). Generally speaking \\(\\mathcal H_t\\) contains events occurred \\(t\\). quantity \\(\\mu > 0\\) usually called , interpreted rate events occur spontaneously. function \\(g(t-t_h)\\) called function (excitation function, simply kernel) measures influence event \\(t_h\\) time \\(t\\). look \\(g(t-t_h)\\) function \\(t\\) intensity point process representing offspring event \\(t_h\\). seismology offspring event called , two terms used synonyms. essence, Hawkes process model can seen superposition background process intensity \\(\\mu\\) aftershock processes generated observations \\(\\mathcal H_t\\) one intensity \\(g(t-t_h)\\). makes Hawkes process model particularly suitable describe phenomena event ability trigger additional events, phenomena characterized cascades events earthquakes, infectious diseases, wildfires, financial crisis, similar. ETAS model particular instance Hawkes process model proven particularly suitable model earthquake occurrence. Earthquakes usually described modelled marked time points marking variable magnitude event. history process composed time-magnitude pairs, namely \\(\\mathcal H_t = \\{(t_h,m_h), h = 1,...,N_h\\}\\). Various slightly different ETAS formulations exist, usually characterized slightly different triggering functions, one implemented ETAS.inlabru R-package conditional intensity given \\[ \\lambda(t | \\mathcal H_t) = \\mu + \\sum_{t_h \\\\mathcal H_t} K \\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] \\(M_0\\) cutoff magnitude \\(m_h \\geq M_0\\) \\(h\\). value decided priori based quality catalogue used. parameters model : \\(\\mu \\geq 0\\), background rate \\(K \\geq 0\\) general productivity parameter, plays role determining average number aftershocks induced event catalogue. \\(\\alpha \\geq 0\\) magnitude scaling parameter, determines number aftershocks changes based magnitude event generating aftershocks. non-negative reflect fact stronger earthquakes generate aftershocks. \\(c > 0\\) time offset parameter, smaller values associated catalogues fewer missing events. \\(p > 1\\) aftershock decay parameter, determines rate aftershock activity decreases time. greater 1 otherwise event may generate infinite number aftershocks infinite interval time thought unphysical.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"priors","dir":"Articles","previous_headings":"","what":"Priors","title":"2d Temporal Model: Tutorial on real data","text":"Bayesian analysis need decide priors parameters. approximation method use considers parameters two different scales: original ETAS scale, internal scale. internal scale used package perform calculations. internal scale parameters constraint standard normal distribution prior. need set priors parameters ETAS scale. done considering copula transformation \\(\\eta(X)\\) \\(X \\sim N(0,1)\\) , \\(\\eta(X)\\) desired distribution. ETAS.inlabru R-package provides four different functions corresponding three different distributions: gamma_t(X, , b) Gamma distribution shape parameter \\(\\) rate \\(b\\). distribution mean \\(/b\\) variance \\(/b^2\\). unit_t(X, , b) Uniform distribution \\(\\) \\(b\\). exp_t(X, r) Exponential distribution rate \\(r\\). loggaus_t(X, m ,s) Log-Gaussian distribution mean logarithm \\(m\\) standard deviation logarithm \\(s\\). code generate 1000 observations normal distribution, transform using functions provided package, shows empirical density estimated sample.  package also provide inverse functions retrieve value parameter internal scale value ETAS scale provided. example decided priors going use analysis, need store corresponding copula transformations list. list one element parameter model (\\(5\\)), element list must name corresponding parameter. names fixed mu, K, alpha, c_, p. parameter \\(c\\) referred c_ avoid clashing names R function c(). useful inverse functions also, list used set initial value parameters later. code assumes parameter \\(\\mu\\) Gamma distribution prior parameters \\(0.3\\) \\(0.6\\), parameters \\(K, \\alpha,\\) \\(c\\) Uniform prior \\((0,10)\\), parameter \\(p\\) Uniform prior \\((1,10)\\).","code":"# obtain sample from standard normal distribution X <- rnorm(1000) # apply copula transformations gamma.X <- gamma_t(X, 1, 2) unif.X <- unif_t(X, 0, 1) exp.X <- exp_t(X, 1) loggaus.X <- loggaus_t(X, 0.5, 0.5)  # build data.frame for plotting df.to.plot <- rbind(   data.frame(     value = X,     distribution = \"Std Normal\"   ),   data.frame(     value = gamma.X,     distribution = \"Gamma\"   ),   data.frame(     value = unif.X,     distribution = \"Uniform\"   ),   data.frame(     value = exp.X,     distribution = \"Exponential\"   ),   data.frame(     value = loggaus.X,     distribution = \"Log-Gaussian\"   ) ) # plot them ggplot(df.to.plot, aes(value)) +   geom_histogram() +   theme_bw() +   facet_wrap(facets = ~distribution, scales = \"free\") #> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. inv_gamma_t(gamma_t(1.2, 1, 2), 1, 2) #> [1] 1.2 inv_unif_t(unif_t(1.2, 1, 2), 1, 2) #> [1] 1.2 inv_exp_t(exp_t(1.2, 1), 1) #> [1] 1.2 inv_loggaus_t(loggaus_t(1.2, 1, 2), 1, 2) #> [1] 1.2 # set copula transformations list link.f <- list(   mu = \\(x) gamma_t(x, 0.3, 0.6),   K = \\(x) unif_t(x, 0, 10),   alpha = \\(x) unif_t(x, 0, 10),   c_ = \\(x) unif_t(x, 0, 10),   p = \\(x) unif_t(x, 1, 10) )  # set inverse copula transformations list inv.link.f <- list(   mu = \\(x) inv_gamma_t(x, 0.3, 0.6),   K = \\(x) inv_unif_t(x, 0, 10),   alpha = \\(x) inv_unif_t(x, 0, 10),   c_ = \\(x) inv_unif_t(x, 0, 10),   p = \\(x) inv_unif_t(x, 1, 10) )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"laquila-seismic-sequence","dir":"Articles","previous_headings":"","what":"L’Aquila seismic sequence","title":"2d Temporal Model: Tutorial on real data","text":"Earthquake data stored -called earthquake catalogues. Many different catalogues exists region easy way decide one better. , provide subset HOmogenized instRUmental Seismic (HORUS) catalogue 1960 2020. can downloaded http://horus.bo.ingv./. See data-raw/horus.R details subset created original data set. HORUS catalogue subset can accessed directly using horus ETAS.inlabru::horus: documentation data set available via ?horus. data reports earthquake time string (time_string), longitude (lon) latitude (lat) epicentre, depth kilometres (depth), moment magnitude (M). focus L’Aquila seismic sequence sufficient retain observations specific space-time-magnitude region include sequence interest. L’Aquila sequence, retain events magnitude greater equal \\(2.5\\) happened 2009 longitude \\((10.5, 16)\\) latitude \\((40.5, 45)\\). L’Aquila sequence selected way composed 1024 events. seismic sequence can selected similarly. selection convenient transform time string Date object select rows Horus catalogue verifying conditions. data can visually represented plotting time event magnitude. shows clustering observations correspondance high magnitude events. L’Aquila seismic sequence, times versus magnitudes","code":"# load HORUS catalogue head(horus) #>           time_string     lon     lat depth    M #> 1 1960-01-03T20:19:34 15.3000 39.3000   290 6.34 #> 2 1960-01-04T09:20:00 13.1667 43.1333     0 3.94 #> 3 1960-01-06T15:17:34 12.7000 46.4833     4 4.69 #> 4 1960-01-06T15:20:53 12.7000 46.4667     0 4.14 #> 5 1960-01-06T15:31:00 12.7500 46.4333     0 3.00 #> 6 1960-01-06T15:45:00 12.7500 46.4333     0 3.00 # transform time string in Date object horus$time_date <- as.POSIXct(   horus$time_string,   format = \"%Y-%m-%dT%H:%M:%OS\" )  # set up parameters for selection start.date <- as.POSIXct(\"2009-01-01T00:00:00\", format = \"%Y-%m-%dT%H:%M:%OS\") end.date <- as.POSIXct(\"2010-01-01T00:00:00\", format = \"%Y-%m-%dT%H:%M:%OS\") min.longitude <- 10.5 max.longitude <- 16 min.latitude <- 40.5 max.latitude <- 45 M0 <- 2.5  # set up conditions for selection aquila.sel <- (horus$time_date >= start.date) &   (horus$time_date < end.date) &   (horus$lon >= min.longitude) &   (horus$lon <= max.longitude) &   (horus$lat >= min.latitude) &   (horus$lat <= max.latitude) &   (horus$M >= M0)  # select aquila <- horus[aquila.sel, ] ggplot(aquila, aes(time_date, M)) +   geom_point() +   theme_bw()"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"data-preparation-to-model-fitting","dir":"Articles","previous_headings":"","what":"Data preparation to model fitting","title":"2d Temporal Model: Tutorial on real data","text":"need prepare data.frame used input data fit ETAS model. data.frame must three columns: ts time difference starting date occurrence time events (measured days example), magnitudes magnitude events, idx.p index column different value event. names fixed changed , need set initial values parameters list containing inlabru options used. initial values stored list elements th.mu, th.K, th.alpha, th.c, th.p corresponds ETAS parameters. initial values must provided internal scale therefore useful retrieve using inverse copula transformations set . way, can find values parameters internal scale given value parameters ETAS scale. example uses \\(\\mu = 0.5, K = 0.1, \\alpha = 1, c = 0.1,\\) \\(p = 1.1\\) initial values. crucial set initial values cause numerical problems, general achieved setting initial values zero. values provided worked well various examples. Lastly, need set list inlabru options. main elements list : bru_verbose: number indicating type diagnostic output. Set 0 output. bru_max_iter: maximum number iterations. set max_step inlabru algorithm stops stopping criterion met. However, setting max_step values smaller 1 forces algorithm run exactly bru_max_iter iterations. bru_method: relevant , thing may need set max_step argument. algorithm converge without fixing max_step suggest try fix value 1, experience \\(0.5\\) \\(0.2\\) works well. example line setting bru_method commented. bru_initial: list initial values created . Note: option list, one can also set number threads allowed INLA , e.g. num.threads = 8. override global option set beginning tutorial. code likely run many different systems, using global setting easier manage.","code":"# set up data.frame for model fitting aquila.bru <- data.frame(   ts = as.numeric(     difftime(aquila$time_date, start.date, units = \"days\")   ),   magnitudes = aquila$M,   idx.p = 1:nrow(aquila) ) # set up list of initial values th.init <- list(   th.mu = inv.link.f$mu(0.5),   th.K = inv.link.f$K(0.1),   th.alpha = inv.link.f$alpha(1),   th.c = inv.link.f$c_(0.1),   th.p = inv.link.f$p(1.1) ) # set up list of bru options bru.opt.list <- list(   bru_verbose = 3, # type of visual output   bru_max_iter = 70, # maximum number of iterations   # bru_method = list(max_step = 0.5),   bru_initial = th.init # parameters' initial values )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"model-fitting","dir":"Articles","previous_headings":"","what":"Model fitting","title":"2d Temporal Model: Tutorial on real data","text":"function Temporal.ETAS fit ETAS model returns bru object output. required inputs : total.data: data.frame containing observed events. format described previous Section. M0: cutoff magnitude. events total.data must magnitude greater equal number. T1: starting time time interval want fit model. T2: end time time interval want fit model. link.functions: list copula transformation functions format described previous sections. coef.t., delta.t., N.max.: parameters temporal binning. binning strategy described Appendix B paper Approximation Bayesian Hawkes process inlabru. parameters corresponds coef.t.\\(=\\delta\\), delta.t.\\(=\\Delta\\), N.max.\\(=n_{\\max}\\). bru.opt: list inlabru options described previous Section.","code":"# set starting and time of the time interval used for model fitting. In this case, we use the interval covered by the data. T1 <- 0 T2 <- max(aquila.bru$ts) + 0.2 # fit the model aquila.fit <- Temporal.ETAS(   total.data = aquila.bru,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  2.054098"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"create-input-list","dir":"Articles","previous_headings":"","what":"Create input list","title":"2d Temporal Model: Tutorial on real data","text":"model fitted package ETAS.inlabru offers various functions visually explore output. require input list. list must different elements depending function going use. retrieve posterior parameters sample posterior parameters need two elements: model.fit: output Temporal.ETAS link.functions: list copula transformations","code":"# create input list to explore model output input_list <- list(   model.fit = aquila.fit,   link.functions = link.f )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"check-marginal-posterior-distributions","dir":"Articles","previous_headings":"","what":"Check marginal posterior distributions","title":"2d Temporal Model: Tutorial on real data","text":"function get_posterior_param can use retrieve marginal posteriors parameters ETAS scale. function returns list elements: post.df: data.frame containing posterior parameters. data.frame three columns, x value parameter, y corresponding value posterior, param indicates ETAS parameter x y referring . post.plot: ggplot object containing plot marginal posteriors parameters","code":"# get marginal posterior information post.list <- get_posterior_param(input.list = input_list)  # plot marginal posteriors post.list$post.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"sample-the-joint-posterior-and-make-pair-plot","dir":"Articles","previous_headings":"","what":"Sample the joint posterior and make pair plot","title":"2d Temporal Model: Tutorial on real data","text":"function post_sampling generate samples joint posterior ETAS parameters. function takes input: input.list: list model.fit element link.functions elements described . n.samp: number posterior samples. max.batch: number posterior samples generated simultaneously. n.samp\\(>\\)max.batch, , samples generated parallel batches maximum size equal max.batch. Default \\(1000\\). ncore: number cores used parallel n.samp\\(>\\)max.batch. function returns data.frame columns corresponding ETAS parameters posterior samples can used analyse correlation parameters. function post_pairs_plot generate pair plot posterior samples taken input. function 4 arguments need specified. input : post.samp: data.frame samples joint posterior distribution parameters. NULL samples generated function . input.list: input list arguments model.fit link.functions used generate posterior samples. used post.samp = NULL. Default NULL. n.samp: number posterior samples. NULL, samples post.samp used. post.samp NULL, n.samp samples generated joint posterior. post.samp n.samp NULL n.samp samples randomly (uniformly replacement) selected post.samp. Default NULL max.batch number posterior samples generated simultaneously. used post.samp NULL. Default NULL function returns list two elements: post.samp posterior samples, pair.plot ggplot object containing pair plot.","code":"post.samp <- post_sampling(   input.list = input_list,   n.samp = 1000,   max.batch = 1000,   ncore = 1 )  head(post.samp) #>          mu         K    alpha          c        p #> 1 0.3252994 0.1732059 2.436955 0.05858051 1.177873 #> 2 0.2446502 0.1182635 2.465343 0.07514384 1.170952 #> 3 0.2308049 0.1880554 2.364085 0.06516428 1.192704 #> 4 0.3108447 0.1465592 2.403460 0.07508792 1.179871 #> 5 0.2788000 0.1561454 2.404388 0.06286938 1.181576 #> 6 0.3078044 0.1459604 2.437307 0.06594422 1.176881 pair.plot <- post_pairs_plot(   post.samp = post.samp,   input.list = NULL,   n.samp = NULL,   max.batch = 1000 ) #> Registered S3 method overwritten by 'GGally': #>   method from    #>   +.gg   ggplot2 pair.plot$pair.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"check-posterior-number-of-events","dir":"Articles","previous_headings":"","what":"Check posterior number of events","title":"2d Temporal Model: Tutorial on real data","text":"quantity interest posterior distribution number events. can accessed using function get_posterior_N requires input list. However, list needs additional elements respect one used now. Specifically, need add T12 extremes time interval want calculate number events, M0 cutoff magnitude, catalog.bru data.frame containing observed events. latter format total.data used Temporal.ETAS function. function returns list three elements: post.plot plot distribution, post.plot.shaded plot distribution shaded regions representing \\(95\\%\\) interval distribution, post.df data.frame used generate plots. vertical line plots represent number events catalog.bru element input list.","code":"# set additional elements of the list input_list$T12 <- c(T1, T2) input_list$M0 <- M0 input_list$catalog.bru <- aquila.bru N.post <- get_posterior_N(input.list = input_list) N.post$post.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"posterior-of-the-triggering-function-and-omori-law","dir":"Articles","previous_headings":"","what":"Posterior of the triggering function and Omori law","title":"2d Temporal Model: Tutorial on real data","text":"functions triggering_fun_plot triggering_fun_plot_prior plot, respectively, quantiles posterior prior distribution triggering function \\(g(t-t_h, mh)\\), namely, \\[ g(t - t_h, m_h) = K\\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] function takes input input.list: input list defined functions used previously. post.samp: data.frame samples posterior distribution parameters. NULL, n.samp samples generated posterior. n.samp: number posterior samples parameters used generated. magnitude: magnitude event (\\(m_h\\)). t.end: maximum value \\(t\\) plot. n.breaks: number breaks interval \\((0, \\texttt{t.end})\\) divided. function returns ggplot object. sample parameters triggering function \\(0\\) t.end calculated. black solid lines represents \\(95\\%\\) posterior interval function, grey lines represent triggering function calculated posterior samples, horizontal red lines represent \\(95\\%\\) posterior interval background rate \\(\\mu\\). function triggering_fun_plot_prior value parameters sampled according prior distribution rather posterior, therefore, need specify posterior samples data.frame.   functions omori_plot_posterior omori_plot_prior functions triggering_fun_plot triggering_fun_plot_prior considering \\[ \\left(\\frac{t- t_h}{c} + 1\\right)^{-p} \\] instead whole triggering function without background rate.","code":"triggering_fun_plot(   input.list = input_list,   post.samp = post.samp,   n.samp = NULL, magnitude = 4,   t.end = 5, n.breaks = 100 ) triggering_fun_plot_prior(input.list = input_list, magnitude = 4, n.samp = 1000, t.end = 10) omori_plot_posterior(input.list = input_list, post.samp = post.samp, n.samp = NULL, t.end = 5) omori_plot_prior(input.list = input_list, n.samp = 1000, t.end = 5)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"generate-synthetic-catalogues-from-model","dir":"Articles","previous_headings":"","what":"Generate synthetic catalogues from model","title":"2d Temporal Model: Tutorial on real data","text":"earthquake forecast usually composed collection synthetic catalogues model. package ETAS.inlabru provides function generate synthetic catalogues given set parameters. can used produce forecasts simply produce synthetic catalogues. function generate synthetic catalogues called generate_temporal_ETAS_synthetic takes input theta: list ETAS parameters names mu, K, alpha, c, p, corresponding ETAS parameters. beta.p: parameter magnitude distribution M0: cutoff magnitude, generated event magnitude greater M0. T1: starting time catalogue (unit measure depends unit used fit model). T2: end time catalogue (unit measure depends unit used fit model). Ht: set known events. can also T1 T2, useful want generate catalogues imposed events. Regarding magnitude distribution, exponential, specificically assume \\[ m - M_0 \\sim \\text{Exp}(\\beta) \\] parameter \\(\\beta\\) usually estimated independently ETAS parameters. use maximum likelihood estimator \\(\\beta\\) given \\[ \\hat\\beta = \\frac{1}{\\bar{m} - M_0} \\] \\(\\bar m\\) mean observed magnitudes values. function returns list data.frame, element output list corresponds different generation. data.frame three columns: occurence time (ts), magnitude (magnitudes), generation identifier (gen). generation identifier uses following convention, \\(-1\\) indicates events Ht time T1 T2, \\(0\\) indicates first generation offspring events gen equal \\(-1\\), \\(1\\) indicates background events, \\(2\\) offspring events gen equal \\(0\\) \\(1\\), \\(3\\) indicates offspring events gen equal \\(2\\), \\(4\\) indicates offspring events gen equal \\(3\\), . obtain unique data.frame containing simulated events sufficient bind rows generations. example generate 1 synthetic catalogue using parameters one posterior samples generated . catalogue covers time span L’Aquila catalogue impose greatest event sequence.  can easily generate multiple catalogues. code generates 8 catalogues using different samples posterior distribution parameters. red point indicates event imposed last panel represents observed L’Aquila sequence.","code":"# maximum likelihood estimator for beta beta.p <- 1 / (mean(aquila.bru$magnitudes) - M0) synth.cat.list <- generate_temporal_ETAS_synthetic(   theta = post.samp[1, ], # ETAS parameters   beta.p = beta.p, # magnitude distribution parameter   M0 = M0, # cutoff magnitude   T1 = T1, # starting time   T2 = T2, # end time   Ht = aquila.bru[which.max(aquila.bru$magnitudes), ] # known events ) # merge into unique data.frame synth.cat.df <- do.call(rbind, synth.cat.list) # order events by time synth.cat.df <- synth.cat.df[order(synth.cat.df$ts), ]  ggplot(synth.cat.df, aes(ts, magnitudes, color = as.factor(gen))) +   geom_point(size = 0.5) set.seed(2) n.cat <- 8 # generate catalogues as list of lists multi.synth.cat.list <- lapply(seq_len(n.cat), \\(x) generate_temporal_ETAS_synthetic(   theta = post.samp[x, ],   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = aquila.bru[which.max(aquila.bru$magnitudes), ] ))  # store catalogues as list of data.frames multi.synth.cat.list.df <- lapply(multi.synth.cat.list, \\(x) do.call(rbind, x)) # set catalogue identifier multi.synth.cat.list.df <- lapply(seq_len(n.cat), \\(x) cbind(multi.synth.cat.list.df[[x]],   cat.idx = x )) # merge catalogues in unique data.frame multi.synth.cat.df <- do.call(rbind, multi.synth.cat.list.df)  # we need to bing the synthetics with the observed catalogue for plotting cat.df.for.plotting <- rbind(   multi.synth.cat.df,   cbind(aquila.bru[, c(\"ts\", \"magnitudes\")],     gen = NA,     cat.idx = \"observed\"   ) )  # plot them ggplot(cat.df.for.plotting, aes(ts, magnitudes)) +   geom_point(size = 0.5) +   geom_point(     data = aquila.bru[which.max(aquila.bru$magnitudes), ],     mapping = aes(ts, magnitudes),     color = \"red\"   ) +   facet_wrap(facets = ~cat.idx)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"forecasting","dir":"Articles","previous_headings":"","what":"Forecasting","title":"2d Temporal Model: Tutorial on real data","text":"earthquake forecast usually collection synthetic catalogues generated model. bayesian models can reflect uncertainty parameters values generating synthetic catalogue composing forecast using different set parameters sampled join posterior distribution. can generate forecasts using function Temporal.ETAS.forecast. function takes input post.samp: data.frame samples posterior distribution parameters format described previous sections. n.cat: number synthetic catalogues composing forecast. n.cat greater nrow(post.samp), rows post.samp sampled uniformly replacement n.cat times. n.cat smaller nrow(post.samp), , rows post.samp sampled uniformly without replacement n.cat times. n.cat NULL equal nrow(post.samp), , post.samp used . ncore: number cores used generate synthetic catalogues parallel. remaining inputs (beta.p, M0, T1, T2, Ht) ones used generate_temporal_ETAS_synthetic. output function list two elements: fore.df n.cat. element fore.df data.frame synthetic catalogues binded together row, multi.synth.cat.df created . element n.cat just number catalogues generated. need n.cat zero-events catalogues appear fore.df, corresponding cat.idx value missing. Therefore need n.cat recover total number catalogues. code creates daily forecast 24 hours starting 1 minute event greatest magnitude sequence. starting date end date forecast expressed unit used catalogue fit model (days case). Day zero correspond start.date stated beginning document example \\(2009-01-01 00:00:00\\). forecast generated assuming known events catalogue occurred forecasting period. can easily retrieve predictive distribution number events forecasting period looking frequencies catalogue identifiers appears fore.df element. Indeed, number rows fore.df cat.idx value represents number events synthetic catalogue. , frequency catalogue identifier appears fore.df$cat.idx correspond number events catalogue. allows easily retrieve predictive distribution number events using code . remark case can use function table find frequencies elements fore.df$cat.idx. catalogue identifier zero-events catalogues present fore.df$cat.idx. using table lead zero probability zero events day, quantity crucial intersted probability earthquake activity (probability least one event).","code":"# express 1 minute in days min.in.days <- 1 / (24 * 60) # find time of the event with the greatest magnitude t.max.mag <- aquila.bru$ts[which.max(aquila.bru$magnitudes)] # set starting time of the forecasting period T1.fore <- t.max.mag + min.in.days # set forecast length fore.length <- 1 # set end time of the forecasting period T2.fore <- T1.fore + fore.length # set known data Ht.fore <- aquila.bru[aquila.bru$ts < T1.fore, ]  # produce forecast daily.fore <- Temporal.ETAS.forecast(   post.samp = post.samp, # ETAS parameters posterior samples   n.cat = nrow(post.samp), # number of synthetic catalogues   beta.p = beta.p, # magnitude distribution parameter   M0 = M0, # cutoff magnitude   T1 = T1.fore, # forecast starting time   T2 = T2.fore, # forecast end time   Ht = Ht.fore, # known events   ncore = 3 ) # number of cores # find number of events per catalogue N.fore <- vapply(   seq_len(daily.fore$n.cat),   \\(x) sum(daily.fore$fore.df$cat.idx == x), 0 ) # find number of observed events in the forecasting period N.obs <- sum(aquila.bru$ts >= T1.fore & aquila.bru$ts <= T2.fore) # plot the distribution ggplot() +   geom_histogram(aes(x = N.fore, y = after_stat(density)), binwidth = 1) +   geom_vline(xintercept = N.obs) +   xlim(100, 500) #> Warning: Removed 29 rows containing non-finite values (`stat_bin()`). #> Warning: Removed 2 rows containing missing values (`geom_bar()`)."},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"2c Temporal Model: Tutorial on synthetic data","text":"tutorial shows use ETAS.inlabru package generate synthetic catalogue temporal ETAS model fit ETAS model data. also show retrieve posterior distribution parameters quantity interest. brief introduction ETAS model refer tutorial real earthquake data.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"generate-a-synthetic-catalogue","dir":"Articles","previous_headings":"","what":"Generate a synthetic catalogue","title":"2c Temporal Model: Tutorial on synthetic data","text":"function generate_temporal_ETAS_synthetic() can used generate synthetic catalogues temporal ETAS model fixed parameters spanning given interval time. generate_temporal_ETAS_synthetic() takes input theta: list ETAS parameters names mu, K, alpha, c, p, corresponding ETAS parameters. beta.p: parameter magnitude distribution M0: cutoff magnitude, generated event magnitude greater M0. T1: starting time catalogue (unit measure depends unit used fit model). T2: end time catalogue (unit measure depends unit used fit model). Ht: set known events. can also T1 T2, useful want generate catalogues imposed events. NULL events imposed. function returns list data.frame, element output list corresponds different generation. data.frame three columns: occurence time (ts), magnitude (magnitudes), generation identifier (gen). generation identifier uses following convention, \\(-1\\) indicates events Ht time T1 T2, \\(0\\) indicates first generation offspring events gen equal \\(-1\\), \\(1\\) indicates background events, \\(2\\) offspring events gen equal \\(0\\) \\(1\\), \\(3\\) indicates offspring events gen equal \\(2\\), \\(4\\) indicates offspring events gen equal \\(3\\), . obtain unique data.frame containing simulated events sufficient bind rows generations. code generates synthetic catalogue events magnitude greater \\(2.5\\) according temporal ETAS model parameters equal vector true.param. value parameters equal posterior mean parameters obtained fitting model L’Aquila seismic sequence done tutorial real data. Also parameter \\(\\beta\\) magnitude distribution comes example. output function list data.frames convenient transform single data.frame binding rows data.frames list. synthetic catalogue composed total \\(288\\) events \\(112\\) background events \\(176\\) aftershocks. can easily retrieve numbers looking gen column data. code plot occurrence time events magnitude color indicating generation event time evolution cumulative number events. multiplot function provided inlabru R-package can used combine plots.","code":"set.seed(111) # set true ETAS parameters true.param <- list(mu = 0.30106014, K = 0.13611399, alpha = 2.43945301, c = 0.07098607, p = 1.17838741) # set magnitude distribution parameter beta.p <- 2.353157 # set cutoff magnitude M0 <- 2.5 # set starting time of the synthetic catalogue T1 <- 0 # set end time of the synthetic catalogue T2 <- 365 # generate the catalogue - it returns a list of data.frames synth.cat.list <- generate_temporal_ETAS_synthetic(   theta = true.param,   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = NULL,   ncore = 1 ) synth.cat.df <- do.call(rbind, synth.cat.list) head(synth.cat.df) #>           ts magnitudes gen #> 1 135.204031   2.661688   1 #> 2 187.947198   2.632073   1 #> 3 137.847074   3.073890   1 #> 4 152.693124   2.653628   1 #> 5   3.890113   2.686633   1 #> 6 194.287763   3.035756   1 c(N = nrow(synth.cat.df), N.bkg = sum(synth.cat.df$gen == 1), N.after = sum(synth.cat.df$gen > 1)) #>       N   N.bkg N.after  #>     288     112     176 pl1 <- ggplot(synth.cat.df, aes(ts, magnitudes, color = as.factor(gen))) +   geom_point() +   labs(color = \"gen\")  t.breaks <- T1:T2 N.cumsum <- vapply(t.breaks, \\(x) sum(synth.cat.df$ts < x), 0) df.to.cumsum.plot <- data.frame(ts = t.breaks, N.cum = N.cumsum) pl2 <- ggplot(df.to.cumsum.plot, aes(ts, N.cum)) +   geom_line() +   ylab(\"cumulative number of events\")  inlabru::multiplot(pl1, pl2, cols = 2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"prepare-data-for-model-fitting","dir":"Articles","previous_headings":"","what":"Prepare data for model fitting","title":"2c Temporal Model: Tutorial on synthetic data","text":"order fit model synthetic catalogue need set parameters priors set initial value parameters set inlabru options prepare data model fitting set priors need create list copula transformation (simply link) functions. method works internal representation parameters parameter Gaussian distribution. need function transform parameters original ETAS scale set prior . ETAS.inlabru package offers four different functions corresponding four different prior distributions. functions gamma_t, unif_t, exp_t, loggaus_t corresponds Gamma distribution, Uniform distribution, Exponential distribution Log-Gaussian distribution. also provide inverse functions retrieve value parameters internal scale given value ETAS scale. inv_gamma_t, inv_unif_t, exp_t, inv_loggaus_t. example going consider following priors parameters \\[\\begin{align*} \\mu & \\sim \\Gamma(0.3, 0.6) \\\\ K & \\sim \\text{Unif}(0,10) \\\\ \\alpha & \\sim \\text{Unif}(0,10) \\\\ c & \\sim \\text{Unif}(0,10) \\\\ p & \\sim \\text{Unif}(1,10) \\end{align*}\\] list link functions corresponding priors initial value parameters inlabru algorithm must specified internal scale parameters. reason, useful create list inverse link functions can specify initial value parameters ETAS scale easily retrieve corresponding value parameters internal scale. can done shown initial value parameters specified list names th.mu, th.K, th.alpha, th.c, th.p, , example, th.mu corresponds initial value parameter \\(\\mu\\) internal scale. initial value parameters important ensure algorithm able converge. Indeed, start algorithm values parameters causing numerical problems, may prevent algorithm converge. experience, setting initial values parameter (e.g. \\(< 10^{-5}\\)) (e.g. \\(> 10^2\\)) safe choice. code uses following initial values parameters \\(\\mu_{\\text{init}} = 0.5, K_{\\text{init}} = 0.1, \\alpha_{\\text{init}} = 1, c_{\\text{init}} = 0.1, p_{\\text{init}} = 1.1\\) Also inlabru options provided list, main elements list : bru_verbose: number indicating type visual output. Set 0 output. bru_max_iter: maximum number iterations. set max_step inlabru algorithm stops stopping criterion met. However, setting max_step values smaller 1 forces algorithm run exactly bru_max_iter iterations. bru_method: relevant , thing may need set max_step argument. algorithm converge without fixing max_step suggest try fix value 1, experience \\(0.5\\) \\(0.2\\) works well. example line setting bru_method commented. bru_initial: list initial values created . Lastly, need prepare data model fitting. data must provided data.frame least 3 columns names ts corresponding occurrence time events, magnitudes corresponding magnitude, idx.p event identifier. events data.frame must sorted respect occurrence time. synthetic catalogue generated beginning already columns ts magnitudes, sorted generation time. code sort rows data.frame adds event identifier","code":"# set copula transformations list link.f <- list(   mu = \\(x) gamma_t(x, 0.3, 0.6),   K = \\(x) unif_t(x, 0, 10),   alpha = \\(x) unif_t(x, 0, 10),   c_ = \\(x) unif_t(x, 0, 10),   p = \\(x) unif_t(x, 1, 10) ) # set inverse copula transformations list inv.link.f <- list(   mu = \\(x) inv_gamma_t(x, 0.3, 0.6),   K = \\(x) inv_unif_t(x, 0, 10),   alpha = \\(x) inv_unif_t(x, 0, 10),   c_ = \\(x) inv_unif_t(x, 0, 10),   p = \\(x) inv_unif_t(x, 1, 10) ) # set up list of initial values th.init <- list(   th.mu = inv.link.f$mu(0.5),   th.K = inv.link.f$K(0.1),   th.alpha = inv.link.f$alpha(1),   th.c = inv.link.f$c_(0.1),   th.p = inv.link.f$p(1.1) ) # set up list of bru options bru.opt.list <- list(   bru_verbose = 3, # type of visual output   bru_max_iter = 70, # maximum number of iterations   # bru_method = list(max_step = 0.5),   bru_initial = th.init ) # parameters initial values # sort catalogue by occurrence time synth.cat.df <- synth.cat.df[order(synth.cat.df$ts), ] # add event identifier synth.cat.df$idx.p <- seq_len(nrow(synth.cat.df))"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"model-fitting","dir":"Articles","previous_headings":"","what":"Model Fitting","title":"2c Temporal Model: Tutorial on synthetic data","text":"function Temporal.ETAS fit ETAS model returns bru object output. required inputs : total.data: data.frame containing observed events. format described previous Section. M0: cutoff magnitude. events total.data must magnitude greater equal number. T1: starting time time interval want fit model. T2: end time time interval want fit model. link.functions: list copula transformation functions format described previous sections. coef.t., delta.t., N.max.: parameters temporal binning. binning strategy described Appendix B paper Approximation Bayesian Hawkes process inlabru. parameters corresponds coef.t.\\(=\\delta\\), delta.t.\\(=\\Delta\\), N.max.\\(=n_{\\max}\\). bru.opt: list inlabru options described previous Section.","code":"synth.fit <- Temporal.ETAS(   total.data = synth.cat.df,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  0.5605464"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"check-marginal-posterior-distributions","dir":"Articles","previous_headings":"","what":"Check marginal posterior distributions","title":"2c Temporal Model: Tutorial on synthetic data","text":"order retrieve marginal posterior distributions parameter need provide list containing two elements: model.fit bru object containing fitted model, link.functions list link functions created . list created, function get_posterior_param returns marginal posterior distribution parameters ETAS scale. function returns list two elements: post.df data.frame three columns, x indicating value parameter, y indicating corresponding value marginal posterior distribution, param parameter identifier. output list also contains post.plot ggplot object containing plot marginal posterior distributions parameter. code retrieve marginal posterior distribution parameters plot along true value parameters represented vertical dashed lines.","code":"# create input list to explore model output input_list <- list(   model.fit = synth.fit,   link.functions = link.f ) # retrieve marginal posterior distributions post.list <- get_posterior_param(input.list = input_list)  # create data.frame of true value of parameters df.true.param <- data.frame(   x = unlist(true.param),   param = names(true.param) ) # add to the marginal posterior distribution of the parameters the true value of the parameters. post.list$post.plot +   geom_vline(     data = df.true.param,     mapping = aes(xintercept = x), linetype = 2   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"sampling-the-joint-posterior-distribution","dir":"Articles","previous_headings":"","what":"Sampling the joint posterior distribution","title":"2c Temporal Model: Tutorial on synthetic data","text":"function post_sampling generate samples joint posterior ETAS parameters. function takes input: input.list: list model.fit element link.functions elements described . n.samp: number posterior samples. max.batch: number posterior samples generated simultaneously. n.samp\\(>\\)max.batch, , samples generated parallel batches maximum size equal max.batch. Default \\(1000\\). ncore: number cores used parallel n.samp\\(>\\)max.batch. function returns data.frame columns corresponding ETAS parameters posterior samples can used estimate posterior distribution functions parameters.","code":"post.samp <- post_sampling(   input.list = input_list,   n.samp = 1000,   max.batch = 1000,   ncore = 1 ) head(post.samp) #>          mu          K    alpha         c        p #> 1 0.3476984 0.07149284 2.341925 0.2678390 1.362746 #> 2 0.3199397 0.04006330 2.610662 0.2537858 1.387029 #> 3 0.3624227 0.04742687 2.592690 0.3155453 1.468431 #> 4 0.3815345 0.03520194 2.600622 0.2606082 1.344165 #> 5 0.3289610 0.05001712 2.484249 0.3408652 1.428198 #> 6 0.2956709 0.03693771 2.502236 0.2932889 1.341063"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"triggering-function-and-omori-law","dir":"Articles","previous_headings":"","what":"Triggering function and Omori law","title":"2c Temporal Model: Tutorial on synthetic data","text":"Interesting functions parameters triggering function Omori law. can estimate posterior distribution functions using samples joint posterior distribution parameters obtained previous section. functions triggering_fun_plot provides plot quantiles posterior distribution triggering function \\(g(t-t_h, mh)\\), namely, \\[ g(t - t_h, m_h) = K\\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] function takes input input.list: input list defined functions used previously. post.samp: data.frame samples posterior distribution parameters. NULL, n.samp samples generated posterior. n.samp: number posterior samples parameters used generated. magnitude: magnitude event (\\(m_h\\)). t.end: maximum value \\(t\\) plot. n.breaks: number breaks interval \\((0, \\texttt{t.end})\\) divided. function returns ggplot object. sample parameters triggering function \\(0\\) t.end calculated. black solid lines represents \\(95\\%\\) posterior interval function, grey lines represent triggering function calculated posterior samples, horizontal red lines represent \\(95\\%\\) posterior interval background rate \\(\\mu\\). function triggering_plot_prior using parameters sampled priors parameters. code creates plot posterior triggering function adds triggering function calculated true parameter values blue. need add argument M0 input_list use function triggering_fun_plot.  functions omori_plot_posterior function triggering_fun_plot considering \\[ \\left(\\frac{t- t_h}{c} + 1\\right)^{-p} \\] instead whole triggering function without background rate.","code":"# add cutoff magnitude to input_list input_list$M0 <- M0  # generate triggering function plot trig.plot <- triggering_fun_plot(   input.list = input_list,   post.samp = post.samp,   n.samp = NULL, magnitude = 4,   t.end = 5, n.breaks = 100 )  # set times at which calculate the true triggering function t.breaks <- seq(1e-6, 5, length.out = 100) # calculate the function true.trig <- gt(unlist(true.param), t = t.breaks, th = 0, mh = 4, M0 = M0) # store in data.frame for plotting true.trig.df <- data.frame(ts = t.breaks, trig.fun = true.trig)  # add the true triggering function to the plot trig.plot +   geom_line(     data = true.trig.df,     mapping = aes(x = ts, y = trig.fun), color = \"blue\"   ) omori.plot <- omori_plot_posterior(input.list = input_list, post.samp = post.samp, n.samp = NULL, t.end = 5)  true.omori <- omori(theta = unlist(true.param), t = t.breaks, ti = 0) true.omori.df <- data.frame(ts = t.breaks, omori.fun = true.omori)  omori.plot +   geom_line(     data = true.omori.df,     mapping = aes(x = ts, y = omori.fun), color = \"blue\"   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"comparison-between-different-fitted-models","dir":"Articles","previous_headings":"","what":"Comparison between different fitted models","title":"2c Temporal Model: Tutorial on synthetic data","text":"interesting fit model multiple synthetic catalogues compare parameters posterior distributions obtained different catalogues. section, going generate second synthetic catalogue, fit model, compare posterior distributions ones obtained . second catalogue impose large event magnitude \\(6\\) happening midpoint time interval. first step set data.frame known events generate second synthetic catalogue Counting number background events aftershocks case slightly different . fact, count imposed event background event, aftershocks need include also event gen = 0 ones induced imposed event case 192. comparison number events two catalogues. Notice background events roughly expected given time interval . , just need set data.frame model fitting. inputs can use ones created first model fit. Now, extract marginal posterior distributions, need create input_list second model fit. Now, can retrieve marginal posterior distributions provided model fitted second catalogue compare ones obtained .  process shown can extended multiple (\\(>2\\)) input catalogues order study parameters identifiable. Also, using characteristics input catalogue catalogue identifier can study change posterior distribution characteristic input catalogue changes. interesting example number events catalogue, studying marginal posterior distributions change increase decrease number events.","code":"# set up data.frame of imposed events Ht.imposed <- data.frame(   ts = mean(c(T1, T2)),   magnitudes = 6 ) # generate second catalogue set.seed(1) synth.cat.list.2 <- generate_temporal_ETAS_synthetic(   theta = true.param,   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = Ht.imposed,   ncore = 1 ) # transform it in a data.frame synth.cat.df.2 <- do.call(rbind, synth.cat.list.2) sum(synth.cat.df.2$gen == 0) #> [1] 192 rbind(   first = c(     N = nrow(synth.cat.df),     N.bkg = sum(synth.cat.df$gen == 1),     N.after = sum(synth.cat.df$gen > 1)   ),   second = c(     N = nrow(synth.cat.df.2),     N.bkg = sum(synth.cat.df.2$gen == 1 | synth.cat.df.2$gen == -1),     N.after = sum(synth.cat.df.2$gen > 1 | synth.cat.df.2$gen == 0)   ) ) #>          N N.bkg N.after #> first  288   112     176 #> second 408   104     304 synth.cat.df.2 <- synth.cat.df.2[order(synth.cat.df.2$ts), ] synth.cat.df.2$idx.p <- seq_len(nrow(synth.cat.df.2))  synth.fit.2 <- Temporal.ETAS(   total.data = synth.cat.df.2,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  0.7841983 input_list.2 <- list(   model.fit = synth.fit.2,   link.functions = link.f ) # retrieve marginal posterior distributions post.list.2 <- get_posterior_param(input.list = input_list.2)  # set model identifier post.list$post.df$cat.used <- \"first catalogue\" post.list.2$post.df$cat.used <- \"second catalogue\"  # bind marginal posterior data.frames bind.post.df <- rbind(post.list$post.df, post.list.2$post.df)  # plot them ggplot(bind.post.df, aes(x = x, y = y, color = cat.used)) +   geom_line() +   facet_wrap(facets = ~param, scales = \"free\") +   xlab(\"param\") +   ylab(\"pdf\") +   geom_vline(     data = df.true.param,     mapping = aes(xintercept = x), linetype = 2   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Francesco Serafini. Author, maintainer. Mark Naylor. Author, thesis advisor. Finn Lindgren. Author, thesis advisor.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Mark Naylor, & Francesco Serafini (2023). edinburgh-seismicity-hub/ETAS.inlabru: Temporal Hawkes (v1.0.1).  Zenodo. https://doi.org/10.5281/zenodo.7515785 Mark Naylor, Francesco Serafini, Finn Lindgren (2023). doi:10.3389/fams.2023.1126759, https://www.frontiersin.org/articles/10.3389/fams.2023.1126759 Francesco Serafini, Finn Lindgren, Mark Naylor (2023). doi:10.1002/env.2798, https://onlinelibrary.wiley.com/doi/abs/10.1002/env.2798","code":"@Misc{,   title = {edinburgh-seismicity-hub/ETAS.inlabru: Temporal Hawkes},   author = {Mark Naylor and Francesco Serafini},   publisher = {Zenodo},   year = {2023},   number = {v1.0.1},   url = {https://doi.org/10.5281/zenodo.7515785},   doi = {10.5281/zenodo.7515785}, } @Article{,   title = {Bayesian modelling of the temporal evolution of seismicity using the ETAS.inlabru R-package},   author = {Mark Naylor and Francesco Serafini and Finn Lindgren},   journal = {Frontiers in Applied Mathematics and Statistics},   year = {2023},   doi = {10.3389/fams.2023.1126759},   url = {https://www.frontiersin.org/articles/10.3389/fams.2023.1126759}, } @Article{,   title = {Approximation of Bayesian Hawkes process with inlabru},   author = {{Serafini} and {Francesco} and {Lindgren} and {Finn} and {Naylor} and {Mark}},   journal = {Environmetrics},   year = {2023},   doi = {10.1002/env.2798},   url = {https://onlinelibrary.wiley.com/doi/abs/10.1002/env.2798}, }"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"etasinlabru","dir":"","previous_headings":"","what":"Bayesian ETAS model for modelling seismic sequences with inlabru","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"R package implements ETAS Hawkes process modelling seismicity Online documentation: https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"authors","dir":"","previous_headings":"","what":"Authors","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Dr Francesco Serafini Dr Mark Naylor , School GeoSciences, University Edinburgh Prof Finn Lindgren , School Mathematics, University Edinburgh Dr Kirsty Bayliss , Global Earthquake Model (GEM)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"funding","dir":"","previous_headings":"","what":"Funding","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"study funded yhe Real-Time Earthquake Risk Reduction Resilient Europe RISE project , received funding European Union’s Horizon 2020 Research Innovation Program grant Agreement 821115. Naylor additionally funded NSFGEO-NERC grant NE/R000794/1. Bayliss funded EPSRC Studentship.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"ETAS.inlabru work, need install R-INLA inlabru: inlabru (see https://inlabru-org.github.io/inlabru/): CRAN release, development version, R-INLA (see https://www.r-inla.org/download-install): can install development version ETAS.inlabru GitHub ","code":"install.packages(\"inlabru\") # install.packages(\"remotes\") remotes::install_github(\"inlabru-org/inlabru\") install.packages(   \"INLA\",   repos = c(getOption(\"repos\"), INLA=\"https://inla.r-inla-download.org/R/testing\"),   dep = TRUE ) # install.packages(\"remotes\") remotes::install_github(\"edinburgh-seismicity-hub/ETAS.inlabru\")"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"file-structure-in-package","dir":"","previous_headings":"Terminology and planning suggestions","what":"File structure in package","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"ETAS.triggering.function.R : Contains ETAS specific model functions HawkesProcess.R : Generic Hawkes code intended integration back inlabru generateSyntheticCatalogues.R : Contains iterative Hawkes functions generating triggered events actual triggering functions reside ETAS file introduce models temporalBinning.R : Code generate time bins make integration scheme efficient plottingFunctions.R : lets put standard plotting functions setupInlabruInputs.R : Put functions generating input.list ","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"terminology","dir":"","previous_headings":"","what":"Terminology","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Let’s specific just temporal clear function names spatial spatial-temporal later Might anything bad? tried modify just theta","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"implemented","dir":"","previous_headings":"","what":"Implemented","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Generation synthetic ETAS catalogues ETAS.inlabru demonstration notebook","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"in-development","dir":"","previous_headings":"","what":"In development","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Add inversion modelling based original code Modify implementation generic Hawkes code can go inlabru ETAS triggering function code stay package Implement time varying incompleteness model Farnaz Kamranzad","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"roadmap","dir":"","previous_headings":"","what":"Roadmap","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Implement incompleteness fix Integrate spatial modelling","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/ETAS.inlabru-package.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru — ETAS.inlabru-package","title":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru — ETAS.inlabru-package","text":"Modelling inversion ETAS model seismicity using inlabru Epidemic Type Aftershock Sequence (ETAS) model designed model earthquakes triggered previous events. statistics, referred Hawkes process. code can used generate synthetic ETAS catalogues can also include seeded events model specific sequences. also implement Bayesian inversion scheme using Integrated Nested Laplace Approximation (INLA) using inlabru. temporal model, given training catalogue times magnitudes, code returns joint posteriors ETAS parameters. future roadmap, include tools model spatial distribution spatio-temporal evolution seismic sequences.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/ETAS.inlabru-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru — ETAS.inlabru-package","text":"Maintainer: Francesco Serafini francesco.serafini@newcastle.ac.uk (ORCID) Authors: Mark Naylor mark.naylor@ed.ac.uk (ORCID) [thesis advisor] Finn Lindgren Finn.Lindgren@ed.ac.uk (ORCID) [thesis advisor]","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":null,"dir":"Reference","previous_headings":"","what":"Injection Rate function calculations — IntInjectionIntensity","title":"Injection Rate function calculations — IntInjectionIntensity","text":"Forward time integrated function exponential rate decay, inverse","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Injection Rate function calculations — IntInjectionIntensity","text":"","code":"IntInjectionIntensity(a = 50, V.i = 1, tau = 10, T.i, T2)  Inv_IntInjectionIntensity(   a = 50,   V.i = 1,   tau = 10,   T.i,   number.injected.events )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Injection Rate function calculations — IntInjectionIntensity","text":"Event rate per unit volume injected V.Injected volume tau Decay rate [days] T.Time injection event T2 End temporal model domain number.injected.events number expected injected events, used inverse.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Injection Rate function calculations — IntInjectionIntensity","text":"IntInjectionIntensity returns forward time integrated function exponential rate decay. Inv_IntInjectionIntensity returns end time corresponding given expected number injected events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":null,"dir":"Reference","previous_headings":"","what":"Integrated Omori's law — Int_ETAS_time_trig_function","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"Integrated Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"","code":"Int_ETAS_time_trig_function(theta, th, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p) th Time past event [days] start temporal domain, vector. T2 End temporal domain, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"Value integral Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"function returns integral Omori's law, namely $$\\int_{t_h}^{T_2} \\left(\\frac{t - t_h}{c} + 1\\right)^{-p} dt$$","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"Inverse integrated Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"","code":"Inv_Int_ETAS_time_trig_function(theta, omega, th)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p) omega Value integral inverted, vector th Time integral calculated scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"Value start temporal domain used calculate integral","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"Considering integral Omori's law $$\\omega = \\int_{t_h}^{T_2}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} dt$$ function applied value \\(\\omega\\) returns value \\(t_h\\).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to calculate the integral of Omori's law — It_df","title":"Function to calculate the integral of Omori's law — It_df","text":"Function calculate integral Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to calculate the integral of Omori's law — It_df","text":"","code":"It_df(param_, time.df)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to calculate the integral of Omori's law — It_df","text":"param_ ETAS parameters vector (\\(\\mu, K, \\alpha, c, p\\)), \\(c, p\\) used. time.df output function time_grid()","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to calculate the integral of Omori's law — It_df","text":"vector integral values bin provided time.df","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"Fits remporal ETAS model returns results. function decomposes input.list `Hawkes.bru2`` function.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"","code":"Temporal.ETAS.fit(input.list)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"input.list input data parameters passed inlabru via structured list. output function create_input_list_temporal_withCatalogue create_input_list_temporal_noCatalogue","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"fitted model bru object, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — Temporal.ETAS.forecast","title":"Title — Temporal.ETAS.forecast","text":"Title","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — Temporal.ETAS.forecast","text":"","code":"Temporal.ETAS.forecast(post.samp, n.cat, beta.p, M0, T1, T2, Ht, ncore = 1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — Temporal.ETAS.forecast","text":"post.samp data.frame containing samples posterior distribution ETAS parameters. row data.frame corresponds different sample parameters order \\(\\mu\\), \\(K\\), \\(\\alpha\\), \\(c\\), \\(p\\). n.cat number synthetic catalogues composing forecast. n.cat greater nrow(post.samp), , n.cat rows sampled uniformly replacement post.samp. n.cat smaller nrow(post.samp), , n.cat rows sampled uniformly without replacement post.samp. n.cat NULL equal nrow(post.samp), post.samp used nrow(post.samp) catalogues generated. beta.p parameter magnitude distribution M0 cutoff magnitude, synthetic events magnitude greater value. T1 starting time forecast T2 end time forecast Ht set known events ncore number cores used generate synthetic catalogues parallel.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — Temporal.ETAS.forecast","text":"list two elements: fore.df data.frame containing synthetic catalogues composing forecast. data.frame four columns, ts occurrence time, magnitudes magnitude, gen generation event, cat.idx catalogue identifier second element output list n.cat number synthetic catalogues generated.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to fit Hawkes process model — Temporal.ETAS","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"function fit temporal ETAS model using inlabru.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"","code":"Temporal.ETAS(   total.data,   M0,   T1,   T2,   link.functions = NULL,   coef.t.,   delta.t.,   N.max.,   bru.opt )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"total.data Observed events: data.frame columns time (ts), magnitude (magnitudes), event identifier (idx.p). Column names must changed. M0 Minimum magnitude threshold, scalar T1 Start temporal model domain, scalar [measure unit sample.s$ts]. T2 End temporal model domain, scalar [measure unit sample.s$ts]. link.functions Functions transform parameters internal INLA scale ETAS scale. must list functions names (mu, K, alpha, c_, p) coef.t. TimeBinning parameter: parameter regulating relative length successive bins, scalar. delta.t. TimeBinning parameter: parameter regulating bins' width, scalar. N.max. TimeBinning parameter: parameter regulating Number bins (= N.max + 2), scalar. bru.opt Runtime options inlabru: See https://inlabru-org.github.io/inlabru/reference/bru_call_options.html, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"fitted model 'bru' object, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":null,"dir":"Reference","previous_headings":"","what":"Find breaks point for 1D grid — breaks_exp","title":"Find breaks point for 1D grid — breaks_exp","text":"breaks_exp return breaks points one dimensional grid depending three parameters, see details","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find breaks point for 1D grid — breaks_exp","text":"","code":"breaks_exp(start.grid, end.grid, coef.t = 2, delta.t, N.exp. = 10)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find breaks point for 1D grid — breaks_exp","text":"start.grid Starting point grid, scalar. end.grid End point grid, scalar. coef.t TimeBinning parameter: \\(\\delta > 0\\) determines relative length subsequent intervals, scalar. delta.t TimeBinning parameter: \\(\\Delta > 0\\) determines length intervals, scalar. N.exp. TimeBinning parameter: \\(n_{max} >0\\) determines maximum number intervals, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find breaks point for 1D grid — breaks_exp","text":"vector containing grid points","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Find breaks point for 1D grid — breaks_exp","text":"grid calculated follows $$t, t + \\Delta, t + \\Delta(1 + \\delta), t + \\Delta(1 + \\delta)^2,...., T$$ \\(t\\) start.grid argument, \\(T\\) end.grid argument, \\(n_{max}\\) maximum value exponent","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find breaks point for 1D grid — breaks_exp","text":"","code":"breaks_exp(start.grid = 1, end.grid = 100, coef.t = 1, delta.t = 1, N.exp. = 3) #> [1]   1   2   3   5   9 100 breaks_exp(start.grid = 1, end.grid = 100, coef.t = 1, delta.t = 1, N.exp. = 10) #> [1]   1   2   3   5   9  17  33  65 100"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to compute the integral of Omori's law efficiently — compute_grid","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"Function compute integral Omori's law efficiently","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"","code":"compute_grid(param., list.input_)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"param. ETAS parameters vector (\\(\\mu, K, \\alpha, c, p\\)), \\(c, p\\) used. list.input_ list containing information calculate integrals efficiently. list created inside Temporal.ETAS function Two elements used time.sel selection rows output time_grid unique t.ref_layer value, data.frame. Imapping mapper unique names provided time.sel original rows output time_grid(), vector.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"vector length list.input_$Imapping integral Omori's law bin.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS conditional intensity - used by inlabru — cond_lambda","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"Function calculate value ETAS model conditional intensity specified time given history process.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"","code":"cond_lambda(theta, t, th, mh, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"theta ETAS parameters list names mu, K, alpha, c, p t Time conditional intensity evaluated, scalar th Time events history process, vector mh Magnitudes events history process, vector M0 Minimum magnitude threshold","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"Value ETAS conditional intensity calculated t history th, mh, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"function takes single value t returns ETAS conditional intensity calculated t history th, mh. ETAS conditional intensity given $$\\lambda(t | \\mathcal H_t) = \\mu + \\sum_{h: (t_h,m_h) \\\\mathcal H_t} K e^{\\alpha(m_h - M_0)} \\left( \\frac{t - t_h}{c} + 1\\right)^{-p}$$ use t vector.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"Function create default input list ETAS Hawkes temporal model catalogue specified input file","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"","code":"create_input_list_temporal_noCatalogue(input_path, num.threads = NULL)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"input_path Input file path string num.threads Optional argument number threads used parallel processing","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"formatted input.list elements required temporal Hawkes model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"","code":"create_input_list_temporal_noCatalogue(   system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\") ) #> $catalog #> NULL #>  #> $catalog.bru #> NULL #>  #> $time.int #> NULL #>  #> $T12 #> [1] \"T1\"  \" T2\" #>  #> $lat.int #> [1] -90  90 #>  #> $lon.int #> [1] -180  180 #>  #> $M0 #> NULL #>  #> $mu.init #> [1] 0.25 #>  #> $K.init #> [1] 0.3 #>  #> $alpha.init #> [1] 1.6 #>  #> $c.init #> [1] 0.2 #>  #> $p.init #> [1] 1.1 #>  #> $a_mu #> [1] 0.5 #>  #> $b_mu #> [1] 0.5 #>  #> $a_K #> [1] -1 #>  #> $b_K #> [1] 0.5 #>  #> $a_alpha #> [1] 0 #>  #> $b_alpha #> [1] 10 #>  #> $a_c #> [1] 0 #>  #> $b_c #> [1] 1 #>  #> $a_p #> [1] 1 #>  #> $b_p #> [1] 2 #>  #> $max_iter #> [1] 100 #>  #> $max_step #> NULL #>  #> $link.functions #> $link.functions$mu #> function (x)  #> gamma_t(x, a_mu, b_mu) #> <bytecode: 0x5618445d4cc8> #> <environment: 0x5618445d7518> #>  #> $link.functions$K #> function (x)  #> loggaus_t(x, a_K, b_K) #> <bytecode: 0x5618445d49f0> #> <environment: 0x5618445d7518> #>  #> $link.functions$alpha #> function (x)  #> unif_t(x, a_alpha, b_alpha) #> <bytecode: 0x5618445d4718> #> <environment: 0x5618445d7518> #>  #> $link.functions$c_ #> function (x)  #> unif_t(x, a_c, b_c) #> <bytecode: 0x5618445d4440> #> <environment: 0x5618445d7518> #>  #> $link.functions$p #> function (x)  #> unif_t(x, a_p, b_p) #> <bytecode: 0x5618445d4168> #> <environment: 0x5618445d7518> #>  #>  #> $bru.opt.list #> $bru.opt.list$bru_verbose #> [1] 3 #>  #> $bru.opt.list$bru_max_iter #> [1] 100 #>  #> $bru.opt.list$num.threads #> NULL #>  #> $bru.opt.list$bru_initial #> $bru.opt.list$bru_initial$th.mu #> [1] -0.2978078 #>  #> $bru.opt.list$bru_initial$th.K #> [1] -0.4079456 #>  #> $bru.opt.list$bru_initial$th.alpha #> [1] -0.9944579 #>  #> $bru.opt.list$bru_initial$th.c #> [1] -0.8416212 #>  #> $bru.opt.list$bru_initial$th.p #> [1] -1.281552 #>  #>  #>  #> $coef.t #> [1] 1 #>  #> $delta.t #> [1] 0.1 #>  #> $Nmax #> [1] 8 #>  #> $n.periods #> [1] 120 #>  #> $period.length #> [1] 1 #>  #> $start.date.fore #> NULL #>  #> $magnitude.update #> [1] 5.5 #>  #> $output.name #> [1] \"report_ETAS\" #>"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"Function create default input file ETAS Hawkes temporal model catalogue specified input file.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"","code":"create_input_list_temporal_withCatalogue(input_path, num.threads = NULL)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"input_path path txt file containing experiment's information num.threads Optional argument number threads used parallel processing","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"formatted input.list elements required temporal Hawkes model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"Copula transformation standard Normal distribution Exponential distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"","code":"exp_t(x, r)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"x values standard Normal distribution, vector. r rate exponential distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"values Exponential distribution rate r, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"Copula transformation standard Normal distribution Gamma distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"","code":"gamma_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"x values standard Normal distribution, vector. shape parameter gamma distribution scalar. b rate parameter gamma distribution scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"values Gamma distribution shape rate b, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":null,"dir":"Reference","previous_headings":"","what":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"Generates synthetic catalogue using ETAS model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"","code":"generate_temporal_ETAS_synthetic(   theta,   beta.p,   M0,   T1,   T2,   Ht = NULL,   ncore = 1 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). M0 minimum magnitude synthetic catalogue. T1 start time synthetic catalogue [days]. T2 end time synthetic catalogue [days]. Ht catalogue history impose synthetic sequence. ncore Integer number compute cores use.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"data.frame temporal catalogue columns [t_i, M_i, gen_i] , t_i times,  M_i magnitudes, gen_i includes information generation number","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"","code":"## EXAMPLE 1: Generate a 1000 day synthetic ETAS catalogue  generate_temporal_ETAS_synthetic(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000 ) #> [[1]] #>           ts magnitudes gen #> 1  543.22890   2.729438   1 #> 2  578.41146   3.066532   1 #> 3   67.34373   2.894243   1 #> 4  838.39258   4.692373   1 #> 5   59.40773   3.139859   1 #> 6  967.61100   2.953002   1 #> 7  680.95970   2.665244   1 #> 8  594.95350   2.988598   1 #> 9  150.30706   3.094851   1 #> 10 193.65151   3.076386   1 #> 11 582.63219   2.559357   1 #> 12 209.41515   2.516408   1 #> 13 587.07296   3.161914   1 #> 14 235.90511   2.776428   1 #> 15 312.43598   2.598601   1 #> 16 433.08444   2.645738   1 #> 17  49.42561   3.186732   1 #> 18 311.83455   2.553923   1 #> 19 238.61692   2.680350   1 #> 20 630.08775   2.527209   1 #> 21 662.52166   2.983663   1 #> 22 673.82330   3.390465   1 #> 23 199.22883   3.045855   1 #> 24 829.98989   2.991241   1 #> 25 495.46406   3.096071   1 #> 26 696.22326   2.519832   1 #> 27 133.66969   2.878592   1 #> 28 348.68751   2.856573   1 #> 29 864.99198   2.538365   1 #> 30 624.54391   2.537082   1 #> 31 517.61443   3.021598   1 #> 32 349.81132   2.788803   1 #> 33 114.84196   2.985688   1 #> 34 717.42935   2.721444   1 #> 35 510.94757   2.773022   1 #> 36 373.67953   2.550606   1 #> 37 725.29645   2.920587   1 #> 38 400.12456   2.552611   1 #> 39 655.34206   2.516923   1 #> 40 649.76493   2.761956   1 #> 41 484.62336   2.573420   1 #> 42 264.43910   2.510800   1 #> 43 260.64617   2.612434   1 #> 44 250.04410   3.081678   1 #> 45 515.97775   2.846497   1 #> 46 271.58046   2.508978   1 #> 47 822.26683   2.513769   1 #> 48 788.09009   2.587771   1 #> 49 428.32126   3.408485   1 #> 50 605.51451   2.535629   1 #> 51 279.86892   4.063084   1 #> 52 845.61784   2.947063   1 #> 53 988.55010   2.600276   1 #> 54 757.73788   3.025610   1 #> 55  55.33609   3.257137   1 #> 56 489.71201   2.913227   1 #> 57  27.25239   3.274099   1 #> 58  20.97382   2.655846   1 #> 59 907.65924   3.349727   1 #> 60 842.56218   2.617366   1 #> 61 774.32244   2.747372   1 #> 62 584.77002   2.909520   1 #> 63 515.11619   4.398447   1 #> 64  78.62840   2.793792   1 #> 65 510.46915   2.901321   1 #> 66 725.77102   2.573029   1 #> 67 565.89537   2.787267   1 #> 68 563.47376   3.345324   1 #> 69 883.70231   2.516380   1 #> 70 986.03781   2.953438   1 #> 71 915.26931   2.593276   1 #> 72 320.62701   2.842516   1 #> 73 386.39950   3.159105   1 #> 74 626.80856   2.508507   1 #> 75 512.97379   3.121149   1 #> 76 885.08842   2.566522   1 #> 77 453.08480   2.839270   1 #> 78 946.06041   2.590542   1 #> 79 351.46240   3.040191   1 #> 80 984.53315   2.600134   1 #>  #> [[2]] #>          ts magnitudes gen #> 1  838.4269   2.682246   2 #> 2  843.5384   2.709745   2 #> 3  839.6008   2.569796   2 #> 4  839.8356   2.982795   2 #> 5  913.3038   3.221381   2 #> 6  838.4516   2.669231   2 #> 7  839.4414   2.673659   2 #> 8  839.5577   2.530411   2 #> 9  664.0469   2.948830   2 #> 10 373.8206   2.826135   2 #> 11 305.7541   2.825660   2 #> 12 280.9097   2.817055   2 #> 13 515.5986   2.587170   2 #> 14 521.3794   2.767284   2 #> 15 542.9825   3.262938   2 #> 16 793.9507   2.645105   2 #> 17 883.7385   3.174009   2 #> 18 516.4801   2.706771   2 #> 19 356.7762   2.802759   2 #>    ## EXAMPLE 2: To generate a 1000 day catalogue including a M6.7 event on day 500  Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) generate_temporal_ETAS_synthetic(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000,   Ht = Ht ) #> [[1]] #>    ts magnitudes gen #> 1 500        6.7  -1 #>  #> [[2]] #>             ts magnitudes gen #> 1   558.900140   2.976926   0 #> 2   500.108314   2.653137   0 #> 3   508.088785   2.866201   0 #> 4   500.878350   3.574288   0 #> 5   500.757801   3.260418   0 #> 6   507.143068   3.726044   0 #> 7   500.401375   3.042250   0 #> 8   501.101532   2.816656   0 #> 9   500.105221   2.786360   0 #> 10  573.326015   2.680253   0 #> 11  500.065407   2.885906   0 #> 12  589.104464   2.903092   0 #> 13  512.191487   3.017540   0 #> 14  571.238234   2.750187   0 #> 15  702.379191   3.854633   0 #> 16  500.129088   2.618930   0 #> 17  500.008244   2.855918   0 #> 18  500.198016   3.288315   0 #> 19  500.895227   3.347413   0 #> 20  501.462385   2.657441   0 #> 21  502.100672   3.084799   0 #> 22  500.768583   2.829052   0 #> 23  500.868158   2.965880   0 #> 24  500.088323   2.886029   0 #> 25  500.271140   3.255958   0 #> 26  503.050915   2.601101   0 #> 27  500.440892   2.687951   0 #> 28  500.014111   2.951659   0 #> 29  691.628721   2.519493   0 #> 30  586.354247   2.507747   0 #> 31  500.068683   2.602136   0 #> 32  500.872068   3.839467   0 #> 33  642.302300   2.876971   0 #> 34  521.060877   2.552280   0 #> 35  500.060621   2.539715   0 #> 36  500.503252   2.787072   0 #> 37  904.809902   2.939848   0 #> 38  571.997439   2.769862   0 #> 39  500.099290   2.702606   0 #> 40  501.941406   2.949728   0 #> 41  501.831938   2.831896   0 #> 42  504.334320   3.376787   0 #> 43  500.524520   2.520857   0 #> 44  500.427050   3.047490   0 #> 45  500.448348   2.519781   0 #> 46  520.352723   2.717437   0 #> 47  500.319462   2.866191   0 #> 48  505.068746   2.963648   0 #> 49  500.335959   3.387689   0 #> 50  500.303888   2.628157   0 #> 51  590.049829   2.569653   0 #> 52  519.635477   2.533799   0 #> 53  500.224865   2.565290   0 #> 54  514.874814   2.593134   0 #> 55  503.679235   3.320414   0 #> 56  556.205084   2.577946   0 #> 57  500.091721   2.597382   0 #> 58  502.852393   2.581179   0 #> 59  500.057220   3.290897   0 #> 60  547.061641   2.884535   0 #> 61  705.393663   2.550161   0 #> 62  500.093118   2.809140   0 #> 63  500.565324   2.887787   0 #> 64  505.488845   3.150499   0 #> 65  501.034637   2.511466   0 #> 66  501.038151   2.599637   0 #> 67  506.244984   3.106033   0 #> 68  517.080977   2.869074   0 #> 69  500.283060   3.555859   0 #> 70  572.084464   2.894465   0 #> 71  500.447783   2.912841   0 #> 72  501.748747   2.642711   0 #> 73  500.848025   2.888800   0 #> 74  509.612250   2.650530   0 #> 75  501.356768   2.562026   0 #> 76  500.328844   2.896856   0 #> 77  500.044885   2.775825   0 #> 78  500.235084   2.936780   0 #> 79  500.317424   2.715052   0 #> 80  870.391926   2.772338   0 #> 81  512.243539   2.780126   0 #> 82  506.080502   3.461219   0 #> 83  506.867564   2.531999   0 #> 84  500.421804   3.016208   0 #> 85  600.519532   3.181537   0 #> 86  505.748635   2.538705   0 #> 87  500.527046   3.778485   0 #> 88  500.116842   3.257853   0 #> 89  500.256727   2.532519   0 #> 90  501.352857   3.578679   0 #> 91  562.129725   2.943675   0 #> 92  500.010676   4.468195   0 #> 93  516.861892   3.126615   0 #> 94  524.336987   2.535799   0 #> 95  538.519964   3.004420   0 #> 96  771.991454   4.108434   0 #> 97  679.375272   2.533332   0 #> 98  505.621974   2.817117   0 #> 99  534.436092   2.738485   0 #> 100 958.959453   3.014239   0 #> 101 500.465847   2.764831   0 #> 102 524.338465   2.945986   0 #> 103 509.016225   2.527766   0 #> 104 502.150221   3.568240   0 #> 105 538.338218   2.713948   0 #> 106 502.648375   2.907482   0 #> 107 500.104655   2.844165   0 #> 108 500.005810   2.647145   0 #> 109 500.528411   2.502946   0 #> 110 500.589872   3.414613   0 #> 111 513.177829   2.599304   0 #> 112 560.886035   2.590449   0 #> 113 500.111976   2.946196   0 #> 114 500.557209   2.807123   0 #> 115 533.580570   3.133640   0 #> 116 712.744290   3.080015   0 #> 117 589.206843   2.848597   0 #> 118 500.113285   2.644719   0 #> 119 500.017771   2.957336   0 #> 120 500.772089   3.411006   0 #> 121 504.797962   3.721583   0 #> 122 503.784755   3.476232   0 #> 123 918.439233   3.243534   0 #> 124 500.887988   3.975647   0 #> 125 536.011735   3.082746   0 #> 126 500.051392   2.822477   0 #> 127 500.160380   2.971898   0 #> 128 501.987862   2.656590   0 #> 129 748.543740   2.874104   0 #> 130 500.061165   2.883962   0 #> 131 500.980674   3.022592   0 #> 132 500.241438   2.676708   0 #> 133 518.795285   2.889136   0 #> 134 524.914900   3.062548   0 #> 135 500.184268   2.646895   0 #> 136 555.059504   3.714132   0 #> 137 629.448035   3.126377   0 #> 138 590.178257   2.636109   0 #> 139 834.355143   3.078843   0 #> 140 702.259114   2.621925   0 #> 141 693.879627   2.786665   0 #> 142 500.356854   2.833785   0 #> 143 940.524836   2.658777   0 #> 144 533.841024   2.593422   0 #> 145 500.244779   3.056383   0 #> 146 500.532682   2.937018   0 #> 147 521.194985   2.807538   0 #> 148 500.097044   2.718333   0 #> 149 501.378207   4.085062   0 #> 150 549.613422   3.056824   0 #> 151 526.578772   3.023371   0 #> 152 551.992038   3.517282   0 #> 153 903.988685   3.116714   0 #> 154 500.035025   2.741860   0 #> 155 501.156060   3.071578   0 #> 156 500.052008   2.733944   0 #> 157 663.359344   2.885669   0 #> 158 524.584037   3.034918   0 #> 159 719.832731   2.523523   0 #> 160 504.681373   2.549861   0 #> 161 505.315756   5.166080   0 #> 162 543.551425   2.503662   0 #> 163 818.690657   2.612957   0 #> 164 500.136644   2.598776   0 #> 165 522.517482   2.904789   0 #> 166 500.114906   3.924526   0 #> 167 500.003731   2.589182   0 #> 168 502.187553   3.029102   0 #> 169 514.821067   2.653749   0 #> 170 701.505397   3.055161   0 #> 171 702.267311   2.733082   0 #> 172 653.149182   2.502132   0 #> 173 500.126294   2.724035   0 #> 174 582.140179   2.752795   0 #> 175 501.150505   2.958059   0 #> 176 500.013489   3.349098   0 #> 177 500.012421   3.143674   0 #> 178 577.734737   2.878671   0 #> 179 502.042052   3.136786   0 #> 180 500.415898   3.109090   0 #> 181 500.287716   2.577352   0 #> 182 773.136866   2.933625   0 #> 183 500.791500   2.511278   0 #> 184 616.321874   2.822172   0 #> 185 745.115356   3.075643   0 #> 186 517.903721   2.554640   0 #> 187 500.417561   2.855968   0 #> 188 510.087806   2.513210   0 #> 189 500.053740   2.568921   0 #> 190 574.940308   2.560548   0 #> 191 500.051588   3.579133   0 #> 192 500.340170   3.374357   0 #> 193 504.746257   2.566071   0 #> 194 531.179072   3.079512   0 #> 195 500.101504   2.674799   0 #> 196 644.683812   2.663311   0 #> 197 511.858253   4.456741   0 #> 198 504.048791   3.255183   0 #> 199 523.768008   2.587785   0 #> 200 501.789621   2.691030   0 #> 201 509.769318   2.764776   0 #> 202 504.228408   2.801937   0 #> 203 545.120972   2.512228   0 #> 204 500.053296   3.508150   0 #> 205 500.378673   2.908632   0 #> 206 563.638346   3.675180   0 #> 207 515.100651   3.172761   0 #> 208 643.741402   2.589076   0 #> 209 500.721876   2.874981   0 #> 210 500.102072   3.488548   0 #> 211 500.600409   3.694306   0 #> 212 521.092776   4.385129   0 #> 213 500.305534   2.505338   0 #> 214 658.233878   2.830214   0 #> 215 702.753286   3.307515   0 #> 216 500.031675   3.118739   0 #> 217 502.554583   2.729186   0 #> 218 500.020934   2.519563   0 #> 219 500.518769   3.163590   0 #> 220 543.861989   2.626522   0 #> 221 584.342224   2.645177   0 #> 222 503.433777   2.686175   0 #> 223 505.590021   2.630946   0 #> 224 500.390559   3.433599   0 #> 225 500.001654   3.005759   0 #> 226 516.392445   2.651679   0 #> 227 500.651843   2.740106   0 #> 228 500.013550   2.573808   0 #> 229 542.757065   3.210649   0 #> 230 523.245442   2.531990   0 #> 231 500.319882   2.527610   0 #> 232 599.887013   3.159731   0 #> 233 500.706882   2.645289   0 #> 234 500.174924   2.907712   0 #> 235 500.015598   3.184050   0 #> 236 501.330306   3.002995   0 #> 237 500.095539   2.530996   0 #> 238 500.085768   2.697766   0 #> 239 502.380923   2.679894   0 #> 240 500.005643   3.519720   0 #> 241 511.265951   2.557765   0 #> 242 690.014418   2.697573   0 #> 243 500.127285   3.486628   0 #> 244 509.371865   2.657417   0 #> 245 601.927746   2.769290   0 #> 246 519.407723   2.545407   0 #> 247 516.172227   2.588566   0 #> 248 571.884273   2.533027   0 #> 249 546.645990   2.724086   0 #> 250 570.317164   3.088057   0 #> 251 500.737780   2.809606   0 #> 252 685.030012   4.314363   0 #> 253 540.145909   5.165741   0 #> 254 504.423840   2.575398   0 #> 255 500.329696   2.728523   0 #> 256 500.111736   2.664806   0 #> 257 688.402105   3.635487   0 #> 258 575.114734   2.827561   0 #> 259 500.226328   2.678940   0 #> 260 500.813229   2.718332   0 #> 261 581.041458   2.637091   0 #> 262 506.563957   3.298217   0 #> 263 500.065749   2.879592   0 #> 264 500.303545   3.387964   0 #> 265 501.842775   2.958378   0 #> 266 511.313689   2.626767   0 #> 267 501.089199   2.589835   0 #> 268 583.540604   2.626742   0 #> 269 833.543664   2.832878   0 #> 270 546.920102   2.569878   0 #> 271 500.820305   3.027736   0 #> 272 775.612512   3.496339   0 #> 273 518.553480   2.543828   0 #> 274 507.211602   3.811572   0 #> 275 500.170804   3.121314   0 #> 276 502.119713   3.457531   0 #> 277 942.128299   2.720297   0 #> 278 963.721906   2.554515   0 #> 279 684.617603   2.815615   0 #> 280 529.902188   2.746728   0 #> 281 519.592876   2.545375   0 #> 282 500.023348   2.673270   0 #> 283 732.201131   2.649622   0 #> 284 500.506142   2.713424   0 #> 285 503.092824   4.056539   0 #> 286 500.605067   2.681914   0 #> 287 502.985983   2.553398   0 #> 288 502.673678   2.649426   0 #> 289 500.658931   3.923332   0 #> 290 527.828953   2.899361   0 #> 291 502.173989   3.141812   0 #> 292 505.819001   2.789447   0 #> 293 500.234771   2.663322   0 #> 294 635.560991   2.516324   0 #> 295 501.860324   2.979929   0 #> 296 740.206292   2.621903   0 #> 297 500.355999   2.972303   0 #> 298 502.606070   3.217020   0 #> 299 503.622606   2.683828   0 #> 300 500.059814   3.175957   0 #> 301 803.096137   2.723663   0 #> 302 514.534759   2.826499   0 #> 303 541.299629   2.829880   0 #> 304 508.311827   2.814371   0 #> 305 505.006696   3.165402   0 #> 306 500.502312   2.687126   0 #> 307 528.316860   2.798050   0 #> 308 521.627774   3.124427   0 #> 309 500.303049   3.355438   0 #> 310 500.917354   2.525549   0 #> 311 507.378174   2.842068   0 #> 312 502.440507   2.679646   0 #> 313 500.114616   2.831160   0 #> 314 501.657528   2.879434   0 #> 315 622.862901   3.005131   0 #> 316 502.998052   2.926529   0 #> 317 504.142499   2.769163   0 #> 318 640.047032   3.145428   0 #> 319 500.248493   3.418330   0 #> 320 535.534442   2.775731   0 #> 321 500.270278   3.531162   0 #> 322 506.830110   3.211116   0 #> 323 522.649420   2.942308   0 #> 324 525.008852   2.675058   0 #> 325 500.980880   2.835539   0 #> 326 500.275905   3.763417   0 #> 327 500.022837   2.808566   0 #> 328 500.158473   2.872523   0 #> 329 511.078725   2.716984   0 #> 330 500.388601   2.515957   0 #> 331 502.755515   2.678635   0 #> 332 500.675895   2.658623   0 #> 333 637.278194   4.073033   0 #> 334 504.619498   2.700956   0 #> 335 744.047153   2.812069   0 #> 336 546.560455   2.665617   0 #> 337 501.060816   2.575796   0 #> 338 536.218579   3.131721   0 #> 339 502.956865   2.554499   0 #> 340 508.279892   3.155528   0 #> 341 505.241547   3.201861   0 #> 342 500.789625   2.886799   0 #> 343 500.123920   3.576650   0 #> 344 600.990851   2.905778   0 #> 345 661.697372   2.511039   0 #> 346 687.600545   2.953687   0 #> 347 500.002123   2.764915   0 #> 348 500.056389   2.615160   0 #> 349 547.785729   3.058196   0 #> 350 503.957912   2.792924   0 #> 351 500.585406   3.279879   0 #> 352 526.579441   2.640581   0 #> 353 856.490729   2.982084   0 #> 354 500.182644   2.505659   0 #> 355 501.555672   2.824281   0 #> 356 609.176921   2.528922   0 #> 357 500.462307   3.519389   0 #> 358 557.013612   2.658538   0 #> 359 531.207807   2.767015   0 #> 360 575.020625   3.326363   0 #> 361 891.549925   2.749480   0 #> 362 547.810384   3.606297   0 #> 363 512.277472   2.785368   0 #> 364 500.187284   3.166370   0 #> 365 500.417163   2.913321   0 #> 366 606.329789   2.547496   0 #> 367 504.574675   2.681807   0 #> 368 501.744783   2.731922   0 #> 369 500.055475   2.847364   0 #> 370 500.244732   3.257222   0 #> 371 552.708827   2.621083   0 #> 372 500.033309   4.221634   0 #> 373 936.268279   2.506243   0 #> 374 693.889030   4.322656   0 #> 375 500.137605   2.544696   0 #> 376 536.524655   2.525573   0 #> 377 501.370586   2.646373   0 #> 378 894.658910   2.555076   0 #> 379 696.854864   3.099938   0 #> 380 504.225927   2.612174   0 #> 381 504.095522   3.429853   0 #> 382 518.916192   2.801578   0 #> 383 502.538001   3.217088   0 #> 384 500.103743   3.527195   0 #> 385 500.011884   2.710711   0 #> 386 609.849515   2.574039   0 #> 387 580.768641   2.696558   0 #> 388 530.632448   3.212735   0 #> 389 610.182129   2.633146   0 #> 390 500.821236   2.689505   0 #> 391 500.672625   3.146821   0 #> 392 507.017825   2.637893   0 #> 393 508.933921   2.988161   0 #> 394 505.397967   3.171838   0 #> 395 501.161927   2.692932   0 #> 396 500.232251   2.588589   0 #> 397 514.583440   3.121312   0 #> 398 501.332409   4.099871   0 #> 399 502.003065   2.622232   0 #> 400 506.038821   3.727151   0 #> 401 515.290800   2.960708   0 #> 402 502.483199   2.609597   0 #> 403 500.186598   2.526971   0 #> 404 505.849921   2.795817   0 #> 405 500.040982   3.042436   0 #> 406 509.460123   2.808790   0 #> 407 551.271476   2.536499   0 #> 408 504.269444   2.833862   0 #> 409 501.018757   5.818981   0 #> 410 500.241957   2.877492   0 #> 411 500.303235   3.042855   0 #> 412 500.977250   2.782767   0 #> 413 535.364476   2.846959   0 #> 414 500.068488   2.656913   0 #> 415 548.721769   2.658558   0 #> 416 500.018782   3.306565   0 #> 417 521.362374   2.807621   0 #> 418 500.027394   2.836314   0 #> 419 640.423873   2.528087   0 #> 420 776.877916   3.640762   0 #> 421 500.008961   3.093348   0 #> 422 500.014938   3.179062   0 #> 423 500.317216   2.779914   0 #> 424 513.153096   2.920939   0 #> 425 500.239581   2.722743   0 #> 426 521.715875   2.599469   0 #> 427 634.288786   2.965457   0 #> 428 502.129856   2.730933   0 #> 429 500.769608   2.509765   0 #> 430 501.263655   3.005593   0 #> 431 501.843929   2.521779   0 #> 432 503.539421   2.985744   0 #> 433 503.205307   2.504975   0 #> 434 500.119385   3.053820   0 #> 435 503.993385   2.529663   0 #> 436 500.357271   2.702081   0 #> 437 500.642290   2.776582   0 #> 438 524.168659   3.233813   0 #> 439 500.266936   3.329492   0 #> 440 501.128035   3.008167   0 #> 441 506.306385   3.311488   0 #> 442 515.804763   3.261832   0 #> 443 500.128638   3.612083   0 #> 444 715.525329   2.622741   0 #> 445 500.014541   2.767554   0 #> 446 502.431193   3.788750   0 #> 447 504.709737   2.614030   0 #> 448 500.136093   3.295834   0 #> 449 500.263623   2.608084   0 #> 450 500.743068   2.571964   0 #> 451 501.930189   3.061711   0 #> 452 502.677398   2.916225   0 #> 453 509.467500   2.823867   0 #> 454 507.656084   2.825593   0 #> 455 500.503879   4.429320   0 #> 456 500.193005   2.511142   0 #> 457 521.576529   3.062782   0 #> 458 500.032549   2.865076   0 #> 459 681.337033   2.639156   0 #> 460 662.596213   2.870959   0 #> 461 514.236796   3.233196   0 #> 462 528.235736   2.514844   0 #> 463 523.905951   2.805055   0 #> 464 500.957594   2.833699   0 #> 465 500.071428   2.755412   0 #> 466 530.279344   3.546563   0 #> 467 502.497420   2.805231   0 #> 468 539.462535   2.999599   0 #> 469 502.174176   3.344857   0 #> 470 500.656402   3.658442   0 #> 471 501.795156   2.652586   0 #> 472 504.549342   2.776882   0 #> 473 500.223327   2.883431   0 #> 474 501.166332   3.707651   0 #> 475 512.833852   3.202671   0 #> 476 524.950394   3.213461   0 #> 477 517.471717   2.512932   0 #> 478 737.523576   2.638288   0 #> 479 512.469730   2.824270   0 #> 480 503.918359   2.611427   0 #> 481 500.268541   2.509218   0 #> 482 557.557469   3.142534   0 #> 483 514.154800   2.526408   0 #> 484 613.483748   4.067397   0 #> 485 500.747052   2.740892   0 #> 486 500.160897   2.530994   0 #> 487 500.033966   3.183748   0 #> 488 501.121528   3.728018   0 #> 489 500.461741   2.655165   0 #> 490 501.332222   5.546605   0 #> 491 500.314214   2.872442   0 #> 492 891.651528   2.505886   0 #> 493 503.969182   2.693799   0 #> 494 500.354486   2.578979   0 #> 495 500.011220   4.044115   0 #> 496 501.850703   2.897437   0 #> 497 857.988876   3.104226   0 #> 498 583.393340   2.757607   0 #> 499 661.715267   2.819128   0 #> 500 500.895713   2.861950   0 #> 501 501.097493   3.454626   0 #> 502 500.113121   3.777191   0 #> 503 525.530320   3.636477   0 #> 504 509.968678   3.388334   0 #> 505 502.323788   2.763994   0 #> 506 718.236115   2.729343   0 #> 507 831.396839   4.063425   0 #> 508 500.203012   2.556626   0 #> 509 529.777994   2.519317   0 #> 510 502.099440   2.656041   0 #> 511 500.326023   2.911754   0 #> 512 503.569165   3.014186   0 #> 513 500.122384   2.678093   0 #> 514 566.229930   3.740056   0 #> 515 500.759932   3.316549   0 #> 516 500.200263   2.540759   0 #> 517 515.184898   2.982483   0 #> 518 526.339444   2.653465   0 #> 519 501.119580   3.094818   0 #> 520 503.715995   2.507723   0 #> 521 500.289461   2.591852   0 #> 522 524.644200   2.780635   0 #> 523 807.274234   2.574752   0 #> 524 506.152237   2.528778   0 #> 525 536.644668   3.196118   0 #> 526 500.536824   2.720133   0 #> 527 500.795779   2.822385   0 #> 528 500.010071   2.791471   0 #> 529 884.545408   2.628901   0 #> 530 500.415596   2.605698   0 #> 531 505.288690   2.723032   0 #> 532 507.277860   2.557354   0 #> 533 641.146504   2.721142   0 #> 534 918.345644   2.817773   0 #> 535 572.311757   2.706353   0 #> 536 599.168944   2.620854   0 #> 537 505.633564   2.765589   0 #> 538 508.612224   2.666620   0 #> 539 515.463244   2.529845   0 #> 540 500.164663   2.519966   0 #> 541 500.050043   3.642590   0 #> 542 502.988217   2.511526   0 #> 543 525.825696   2.690670   0 #> 544 526.947323   2.862058   0 #> 545 501.464463   2.596171   0 #> 546 775.844914   3.295012   0 #> 547 503.097013   2.527692   0 #> 548 500.147818   2.707262   0 #> 549 500.672549   2.732950   0 #> 550 557.984570   2.694798   0 #> 551 523.714146   3.574481   0 #> 552 514.053157   2.920321   0 #> 553 500.460043   2.649382   0 #> 554 518.824820   2.592486   0 #> 555 539.990785   2.525088   0 #> 556 503.374475   2.811456   0 #> 557 500.015378   2.508414   0 #> 558 500.459349   2.518934   0 #> 559 746.750373   2.526138   0 #> 560 500.036741   2.971591   0 #> 561 592.867572   2.613844   0 #> 562 500.283906   2.525592   0 #> 563 501.051509   2.555616   0 #> 564 500.095496   2.718128   0 #> 565 732.888748   2.771248   0 #> 566 513.294167   2.589813   0 #> 567 500.394098   2.832942   0 #> 568 501.739565   2.631048   0 #> 569 503.410403   3.015125   0 #> 570 713.383907   2.673960   0 #> 571 506.879098   2.558976   0 #> 572 612.249699   2.741808   0 #> 573 525.844427   2.519087   0 #> 574 603.698324   4.227678   0 #> 575 783.925046   3.178417   0 #> 576 501.101441   2.575380   0 #> 577 535.214126   2.508120   0 #> 578 500.272041   2.927388   0 #> 579 500.710950   3.382650   0 #> 580 500.499234   3.160929   0 #> 581 501.993949   2.730491   0 #> 582 564.182160   2.696272   0 #> 583 503.978224   2.757103   0 #> 584 500.013854   2.508814   0 #> 585 500.301232   3.207193   0 #> 586 500.904509   2.617876   0 #> 587 531.952015   2.770325   0 #> 588 503.342187   3.161047   0 #> 589 507.126350   2.861632   0 #> 590 517.170752   3.543036   0 #> 591 500.440648   2.661931   0 #> 592 500.510181   2.664974   0 #> 593 500.903914   2.700411   0 #> 594 551.615272   2.658093   0 #> 595 524.401571   3.387796   0 #> 596 924.464267   2.777062   0 #> 597 500.178731   2.758954   0 #> 598 500.727614   2.976548   0 #> 599 501.254329   2.787044   0 #> 600 500.760428   2.540172   0 #> 601 513.669646   2.951464   0 #> 602 502.842652   2.726582   0 #> 603 505.092248   2.857447   0 #> 604 501.850141   2.734192   0 #> 605 510.010275   2.811000   0 #> 606 581.583564   2.974454   0 #> 607 504.604711   3.714289   0 #> 608 500.184877   2.592774   0 #> 609 719.647727   2.958685   0 #> 610 522.471384   4.053437   0 #> 611 523.888077   2.719755   0 #> 612 591.294906   2.738968   0 #> 613 500.872927   2.767222   0 #> 614 597.122023   2.777249   0 #> 615 546.033556   2.967569   0 #> 616 500.059854   2.595809   0 #> 617 501.352472   2.933081   0 #> 618 500.699532   3.479669   0 #> 619 500.023891   2.590804   0 #> 620 501.296557   2.694246   0 #> 621 561.515780   3.013537   0 #> 622 507.692028   2.704974   0 #> 623 500.041703   3.177966   0 #> 624 510.347814   2.554131   0 #> 625 540.188462   3.599941   0 #> 626 501.545936   2.727118   0 #> 627 500.772016   3.412696   0 #> 628 567.679689   2.658047   0 #> 629 896.573688   3.470626   0 #> 630 500.515956   2.611977   0 #> 631 500.105594   2.576908   0 #> 632 543.305654   3.563344   0 #> 633 629.142649   2.629268   0 #> 634 501.067708   2.967365   0 #> 635 501.349003   3.392490   0 #> 636 509.703231   2.529705   0 #> 637 543.508098   2.509625   0 #> 638 555.246833   2.584022   0 #> 639 500.308653   3.278081   0 #> 640 504.833783   3.079212   0 #> 641 500.812975   3.098128   0 #> 642 504.941320   2.507636   0 #> 643 554.906169   2.644960   0 #> 644 645.814695   2.512536   0 #> 645 500.152874   3.143323   0 #> 646 501.620384   2.968656   0 #> 647 500.136906   2.917171   0 #> 648 507.890999   2.580991   0 #> 649 501.235329   5.487145   0 #> 650 500.358786   2.999950   0 #> 651 579.538406   2.531386   0 #> 652 570.484549   2.849879   0 #> 653 500.827568   2.833573   0 #> 654 502.644517   2.942570   0 #> 655 550.746049   2.690491   0 #> 656 501.393763   3.759085   0 #> 657 512.263379   4.412943   0 #> 658 500.628949   2.519285   0 #> 659 500.465464   2.515448   0 #> 660 514.884318   4.502852   0 #> 661 504.080862   2.568524   0 #> 662 504.395966   2.884672   0 #> 663 650.528097   2.658719   0 #> 664 504.191443   2.973474   0 #> 665 500.757139   3.447078   0 #> 666 771.758456   2.900425   0 #> 667 500.044653   2.723658   0 #> 668 500.295759   3.080990   0 #> 669 771.636742   2.983224   0 #> 670 576.385897   3.081257   0 #> 671 676.191163   2.553921   0 #> 672 500.666677   2.885819   0 #> 673 500.157475   2.617277   0 #> 674 500.210025   3.546805   0 #> 675 510.144241   2.912082   0 #> 676 595.880111   3.909461   0 #> 677 500.048675   2.674927   0 #> 678 500.445855   2.844845   0 #> 679 509.417488   2.661739   0 #> 680 507.156086   2.925531   0 #> 681 751.383544   2.849168   0 #> 682 501.730916   3.759213   0 #> 683 500.347217   2.600762   0 #> 684 504.365402   2.680244   0 #> 685 689.265888   2.640599   0 #> 686 502.815920   2.566474   0 #> 687 643.687841   3.365801   0 #> 688 502.917669   2.599375   0 #> 689 500.068450   2.824508   0 #> 690 503.181805   3.166316   0 #> 691 509.830690   2.514016   0 #> 692 504.587400   3.628020   0 #> 693 532.917132   3.033671   0 #> 694 500.178510   2.571648   0 #> 695 500.000021   3.455434   0 #> 696 622.281566   3.315122   0 #> 697 505.219441   3.150598   0 #> 698 910.196447   3.219081   0 #> 699 526.985744   2.612251   0 #> 700 624.111982   2.847529   0 #> 701 515.131106   2.750044   0 #> 702 509.364303   3.147303   0 #> 703 727.582588   2.924038   0 #> 704 500.033158   3.051121   0 #> 705 531.063473   3.099543   0 #> 706 508.182341   3.089596   0 #> 707 510.830735   2.753031   0 #> 708 500.338938   2.885742   0 #> 709 526.697298   3.595158   0 #> 710 500.460690   2.906974   0 #> 711 501.333325   3.070390   0 #> 712 500.061043   2.688541   0 #> 713 511.603531   2.834220   0 #> 714 500.152203   3.298972   0 #> 715 500.514083   2.807008   0 #> 716 502.440595   2.999840   0 #> 717 503.999083   2.745949   0 #> 718 500.298099   3.078521   0 #> 719 974.316937   3.145147   0 #> 720 679.025600   2.728926   0 #> 721 504.292993   3.711403   0 #> 722 816.594250   3.615488   0 #> 723 500.202787   2.749675   0 #> 724 500.019273   2.680766   0 #> 725 500.070307   2.703729   0 #> 726 500.151011   3.076486   0 #> 727 500.885404   2.905635   0 #> 728 615.995392   3.530886   0 #> 729 514.783212   3.003189   0 #> 730 500.159988   2.605204   0 #> 731 501.038290   3.210712   0 #> 732 500.067691   3.574138   0 #> 733 502.278147   3.207443   0 #> 734 585.806141   3.361238   0 #> 735 503.645388   3.146796   0 #> 736 500.539933   2.598309   0 #> 737 500.022520   3.301945   0 #> 738 538.171040   2.635339   0 #> 739 501.447610   3.564465   0 #> 740 510.220596   3.394948   0 #> 741 528.081108   2.771810   0 #> 742 500.002406   2.987893   0 #> 743 509.210872   3.971385   0 #> 744 500.941398   3.181257   0 #> 745 501.302105   3.289650   0 #> 746 547.122544   2.951795   0 #> 747 507.214170   3.761572   0 #> 748 500.094505   2.655975   0 #> 749 500.151989   3.246832   0 #> 750 509.637728   2.776379   0 #> 751 502.994815   2.760913   0 #> 752 500.076744   2.806448   0 #> 753 500.912619   2.787406   0 #> 754 773.607835   2.531357   0 #> 755 519.582433   2.846027   0 #> 756 554.985073   2.666019   0 #> 757 505.451236   2.553725   0 #> 758 500.721003   3.187018   0 #> 759 501.491209   3.347877   0 #> 760 509.583691   3.108907   0 #> 761 503.906524   2.613356   0 #> 762 509.378279   3.495393   0 #> 763 511.750188   2.669197   0 #> 764 500.031096   2.758097   0 #> 765 885.752949   3.448201   0 #> 766 500.102550   2.519559   0 #> 767 506.854304   2.952687   0 #> 768 500.334709   2.633836   0 #> 769 507.812729   2.566249   0 #> 770 500.046161   2.617698   0 #> 771 500.056583   3.312290   0 #> 772 501.203833   2.620172   0 #> 773 553.912087   2.552200   0 #> 774 504.301268   2.918481   0 #> 775 501.273480   3.348393   0 #> 776 518.726587   2.577338   0 #> 777 500.080175   2.761970   0 #> 778 501.756958   3.139859   0 #> 779 500.364603   3.100158   0 #> 780 502.021098   2.944205   0 #> 781 626.030278   2.517856   0 #> 782 503.594644   2.924532   0 #> 783 500.144469   2.507750   0 #> 784 504.511762   2.585103   0 #> 785 913.077159   3.429811   0 #> 786 518.143918   2.644226   0 #> 787 500.145266   3.483410   0 #> 788 588.114955   2.651626   0 #> 789 500.363138   3.120798   0 #> 790 918.127293   2.762603   0 #> 791 551.084706   2.509252   0 #> 792 515.349604   4.713147   0 #> 793 500.541043   2.589817   0 #> 794 500.771860   2.549253   0 #> 795 632.375367   2.663563   0 #> 796 505.355161   2.816121   0 #> 797 502.695280   2.848209   0 #> 798 699.543816   2.524880   0 #> 799 500.105965   2.810652   0 #> 800 554.882971   2.556760   0 #> 801 500.458439   2.589682   0 #> 802 502.057420   4.141385   0 #> 803 501.159856   2.840643   0 #> 804 509.539373   2.678257   0 #> 805 505.993347   2.697883   0 #> 806 621.901565   2.648400   0 #> 807 500.326239   2.612713   0 #> 808 673.320497   3.248365   0 #> 809 554.079712   3.007174   0 #> 810 520.712243   2.842521   0 #> 811 762.897645   2.558886   0 #> 812 500.462907   2.523715   0 #> 813 501.765711   3.333295   0 #> 814 646.748634   2.797371   0 #> 815 504.491727   2.505285   0 #> 816 502.117247   3.069576   0 #> 817 503.279080   2.821058   0 #> 818 557.540207   3.126972   0 #> 819 501.940442   2.889814   0 #> 820 952.174700   2.845568   0 #> 821 500.041149   3.253411   0 #> 822 500.355920   3.133972   0 #> 823 518.099844   2.809098   0 #> 824 504.475022   2.995755   0 #> 825 500.157589   2.757935   0 #> 826 501.193018   3.496287   0 #> 827 685.343402   2.547255   0 #> 828 501.327501   2.552081   0 #> 829 500.034356   2.566801   0 #> 830 567.345697   2.762652   0 #> 831 506.861772   2.730308   0 #> 832 528.087446   3.447006   0 #> 833 672.632856   2.898212   0 #> 834 515.074749   3.243410   0 #> 835 503.505730   2.632439   0 #> 836 500.016486   2.938459   0 #> 837 552.373193   3.042542   0 #> 838 500.396685   2.997076   0 #> 839 501.106528   2.643988   0 #> 840 507.431531   2.613698   0 #> 841 508.619260   4.202521   0 #> 842 708.106476   3.257832   0 #> 843 509.966478   2.884878   0 #> 844 500.391787   3.467713   0 #> 845 501.028957   2.640488   0 #> 846 500.820803   2.541111   0 #> 847 757.031473   3.182308   0 #> 848 500.822670   2.746346   0 #> 849 298.044636   3.025041   1 #> 850 138.712270   2.707951   1 #> 851   1.773763   2.747894   1 #> 852 910.078020   2.515069   1 #> 853 276.618580   2.854391   1 #> 854 950.448123   3.019734   1 #> 855 741.546960   2.565540   1 #> 856 125.402734   2.607567   1 #> 857 142.905971   2.631245   1 #> 858 473.929857   3.370050   1 #> 859 465.657226   2.763479   1 #> 860 960.277658   2.946834   1 #> 861 808.757355   3.183791   1 #> 862 134.288852   2.895089   1 #> 863 944.948816   2.535259   1 #> 864 791.890151   2.798664   1 #> 865 434.522564   3.499517   1 #> 866 409.824787   2.664903   1 #> 867 350.170679   2.849353   1 #> 868 312.544215   2.606841   1 #> 869 468.877576   3.105924   1 #> 870 832.480637   3.319398   1 #> 871  44.215136   2.870375   1 #> 872 211.439274   3.119545   1 #> 873 571.556875   2.593691   1 #> 874 927.346193   2.960918   1 #> 875 751.739337   2.947792   1 #> 876 946.132212   2.549160   1 #> 877 522.910639   2.723990   1 #> 878 328.822751   2.680286   1 #> 879 205.740233   2.727710   1 #> 880 732.808783   2.500134   1 #> 881 356.119287   2.858028   1 #> 882 569.894508   3.111948   1 #> 883 509.424200   2.545561   1 #> 884 561.873858   2.926923   1 #> 885 733.276953   3.552974   1 #> 886 580.277913   2.650562   1 #> 887 195.877629   2.720162   1 #> 888 157.805297   2.926541   1 #> 889 907.798565   2.691534   1 #> 890 942.364781   2.994283   1 #> 891 131.144455   2.781502   1 #> 892 563.054555   2.926018   1 #> 893 441.528662   2.618544   1 #> 894 112.901324   3.819770   1 #> 895 283.106187   2.969060   1 #> 896 414.980244   2.910459   1 #> 897 396.759651   2.615886   1 #> 898 118.114753   3.169860   1 #> 899 159.925214   2.810689   1 #> 900 187.999458   2.982975   1 #> 901  44.199969   2.679727   1 #> 902  46.896287   2.940500   1 #> 903 937.581455   3.464446   1 #> 904 927.573522   2.526956   1 #> 905 450.044074   2.630778   1 #> 906 481.053880   2.967462   1 #> 907 873.844608   3.464116   1 #> 908 766.729674   3.239411   1 #> 909 372.678136   3.368844   1 #> 910 692.940057   2.918269   1 #> 911 728.337138   2.525861   1 #> 912 639.014034   3.005351   1 #> 913 467.725893   2.646495   1 #> 914 372.277916   2.622194   1 #> 915 190.461295   2.650151   1 #> 916 225.886639   2.894144   1 #> 917 624.229825   2.504235   1 #> 918 255.544510   2.652132   1 #> 919 615.876463   2.935948   1 #> 920 140.590723   3.164823   1 #> 921 123.019772   3.012106   1 #> 922 760.706366   2.566530   1 #> 923 825.353265   3.261390   1 #> 924 914.989314   2.738376   1 #> 925 421.946958   2.638112   1 #> 926 508.588256   2.813099   1 #> 927 267.210439   3.800412   1 #> 928 344.422979   2.510074   1 #> 929 924.013644   3.061454   1 #> 930  39.693878   2.967711   1 #> 931 290.166485   2.657076   1 #> 932 795.957367   2.515659   1 #> 933 898.464882   3.550371   1 #> 934 951.574383   2.563348   1 #> 935 433.792134   3.929705   1 #> 936 663.334877   3.529025   1 #> 937 206.686903   2.678281   1 #> 938 151.892612   2.941714   1 #> 939 943.244129   2.948545   1 #> 940 155.079799   2.781828   1 #> 941 727.291021   2.951546   1 #> 942 929.044092   2.924298   1 #> 943 269.518286   2.608099   1 #> 944  56.505864   2.830170   1 #> 945  90.290348   3.435860   1 #> 946 480.664501   3.012577   1 #>  #> [[3]] #>            ts magnitudes gen #> 1   540.39067   2.562392   2 #> 2   501.47027   2.818523   2 #> 3   597.30539   2.921520   2 #> 4   500.59625   3.976125   2 #> 5   703.81004   3.109327   2 #> 6   729.94013   2.829452   2 #> 7   708.38972   4.067102   2 #> 8   504.98359   2.983176   2 #> 9   544.21415   3.730317   2 #> 10  503.07920   3.056460   2 #> 11  605.98722   4.102051   2 #> 12  504.56475   2.865784   2 #> 13  501.02484   2.549948   2 #> 14  517.01087   2.578853   2 #> 15  501.56021   2.595941   2 #> 16  821.04286   4.047179   2 #> 17  505.30260   2.739351   2 #> 18  501.34242   2.587822   2 #> 19  517.03989   2.966798   2 #> 20  500.45196   2.544276   2 #> 21  500.43602   2.982502   2 #> 22  705.60682   3.165483   2 #> 23  505.07763   3.185669   2 #> 24  501.24698   3.212515   2 #> 25  600.62706   4.047176   2 #> 26  500.63121   2.527139   2 #> 27  501.83610   2.563928   2 #> 28  584.85854   3.306132   2 #> 29  503.85927   2.646481   2 #> 30  500.69383   2.855809   2 #> 31  968.64228   2.513670   2 #> 32  543.13275   2.789320   2 #> 33  778.78323   3.462289   2 #> 34  527.11533   2.717974   2 #> 35  500.11391   2.663722   2 #> 36  713.37182   2.742421   2 #> 37  503.88931   3.041738   2 #> 38  901.13661   4.834021   2 #> 39  565.51029   2.605327   2 #> 40  501.80247   2.547933   2 #> 41  630.33306   2.676305   2 #> 42  629.55157   3.163511   2 #> 43  501.71987   2.715765   2 #> 44  503.96256   4.095091   2 #> 45  723.20555   4.180218   2 #> 46  553.66745   2.771532   2 #> 47  798.81419   2.655248   2 #> 48  505.66260   2.849644   2 #> 49  505.45183   3.332603   2 #> 50  534.00974   3.586808   2 #> 51  505.55167   3.477336   2 #> 52  505.50565   2.731412   2 #> 53  505.32775   3.002111   2 #> 54  507.15516   3.872887   2 #> 55  513.25067   2.538031   2 #> 56  505.78639   3.014579   2 #> 57  561.23065   3.228486   2 #> 58  505.87186   2.896134   2 #> 59  505.58995   3.470357   2 #> 60  505.90515   3.095740   2 #> 61  507.18162   2.913153   2 #> 62  505.65096   2.533976   2 #> 63  704.95656   2.584018   2 #> 64  506.17844   2.528983   2 #> 65  505.82093   2.642044   2 #> 66  505.42535   3.098924   2 #> 67  505.95325   3.229141   2 #> 68  637.08624   3.293522   2 #> 69  506.66840   2.645190   2 #> 70  557.30693   2.646034   2 #> 71  505.89870   3.355557   2 #> 72  505.51373   2.662977   2 #> 73  530.70025   2.517686   2 #> 74  506.59474   3.241548   2 #> 75  511.52725   2.625708   2 #> 76  503.18014   3.194947   2 #> 77  574.17260   3.107338   2 #> 78  542.72238   2.974456   2 #> 79  616.85166   2.551144   2 #> 80  514.16742   3.380293   2 #> 81  513.46928   2.642377   2 #> 82  512.07491   2.894604   2 #> 83  512.07128   2.556204   2 #> 84  532.94277   4.145658   2 #> 85  504.47921   2.570886   2 #> 86  504.82027   2.901228   2 #> 87  565.44941   2.561965   2 #> 88  500.12291   2.538358   2 #> 89  502.36439   2.530444   2 #> 90  668.80279   3.827877   2 #> 91  500.83377   3.352451   2 #> 92  501.17678   2.622570   2 #> 93  523.22430   2.601679   2 #> 94  521.86499   2.671310   2 #> 95  526.62318   2.893922   2 #> 96  547.46794   2.663571   2 #> 97  602.47087   3.227623   2 #> 98  546.08383   2.650958   2 #> 99  502.73401   2.768968   2 #> 100 501.88831   2.980794   2 #> 101 501.36113   3.021204   2 #> 102 691.00626   2.761529   2 #> 103 507.31809   2.657409   2 #> 104 628.02169   2.828696   2 #> 105 691.54469   2.837686   2 #> 106 686.10427   2.664791   2 #> 107 572.80271   4.291683   2 #> 108 564.01956   2.607044   2 #> 109 552.77945   2.725689   2 #> 110 540.24427   2.581171   2 #> 111 546.53853   3.388785   2 #> 112 542.55715   3.936942   2 #> 113 540.39054   2.870458   2 #> 114 540.26839   4.309281   2 #> 115 602.48184   2.694187   2 #> 116 541.03762   3.316859   2 #> 117 540.21956   2.607455   2 #> 118 556.50806   2.861093   2 #> 119 540.58420   2.652431   2 #> 120 652.78310   3.043452   2 #> 121 545.93370   3.927642   2 #> 122 540.18148   2.941211   2 #> 123 566.22871   2.553333   2 #> 124 644.70459   2.616912   2 #> 125 549.82924   2.546070   2 #> 126 558.32401   3.119073   2 #> 127 540.24158   3.061704   2 #> 128 691.61222   3.786102   2 #> 129 555.90939   3.300430   2 #> 130 540.49860   3.818252   2 #> 131 540.47960   2.557211   2 #> 132 563.19809   3.350249   2 #> 133 694.22923   3.255409   2 #> 134 689.92993   2.545760   2 #> 135 511.39238   2.579138   2 #> 136 781.90254   2.608139   2 #> 137 508.48707   2.576410   2 #> 138 572.20779   2.582264   2 #> 139 642.88462   2.625651   2 #> 140 602.03667   2.638352   2 #> 141 504.25258   2.796272   2 #> 142 500.44404   2.945818   2 #> 143 793.21300   2.832205   2 #> 144 529.06070   3.608683   2 #> 145 525.54721   2.516953   2 #> 146 640.09235   2.567416   2 #> 147 523.32474   3.380619   2 #> 148 503.66839   2.512111   2 #> 149 500.96440   3.150591   2 #> 150 524.73743   3.554127   2 #> 151 637.83444   2.979600   2 #> 152 884.79428   2.921826   2 #> 153 536.35935   2.599836   2 #> 154 510.21403   4.076383   2 #> 155 500.38513   2.558715   2 #> 156 667.86731   3.468214   2 #> 157 500.66487   2.631440   2 #> 158 510.49136   3.630688   2 #> 159 500.48144   4.028932   2 #> 160 577.17978   3.371263   2 #> 161 898.92491   2.601495   2 #> 162 548.24765   3.249245   2 #> 163 887.14372   2.940972   2 #> 164 563.63481   2.548270   2 #> 165 532.22273   3.517131   2 #> 166 500.35944   2.522607   2 #> 167 724.86416   2.597224   2 #> 168 693.96959   2.517591   2 #> 169 698.66827   3.902323   2 #> 170 505.73883   2.633344   2 #> 171 501.92027   2.837851   2 #> 172 549.97326   2.818098   2 #> 173 767.46390   2.701147   2 #> 174 502.05266   2.756412   2 #> 175 502.48692   3.189470   2 #> 176 679.44334   2.978176   2 #> 177 503.49658   2.817208   2 #> 178 502.34930   2.523223   2 #> 179 622.31049   2.519859   2 #> 180 502.76159   2.697594   2 #> 181 521.00108   2.644667   2 #> 182 508.99064   3.661279   2 #> 183 502.20799   3.159939   2 #> 184 503.02189   2.605008   2 #> 185 521.82298   2.730921   2 #> 186 501.02846   2.677443   2 #> 187 501.10714   2.522351   2 #> 188 577.63371   3.662587   2 #> 189 501.12977   2.584290   2 #> 190 553.51443   2.526146   2 #> 191 507.05631   3.057751   2 #> 192 723.49103   2.514576   2 #> 193 523.80724   2.563146   2 #> 194 502.05927   3.029210   2 #> 195 502.07809   3.031488   2 #> 196 502.07689   3.106963   2 #> 197 503.02451   2.620342   2 #> 198 501.08403   3.776116   2 #> 199 502.21217   3.262595   2 #> 200 514.63467   2.612901   2 #> 201 502.17299   2.634096   2 #> 202 529.48875   3.868804   2 #> 203 502.24746   3.133514   2 #> 204 501.13971   2.656610   2 #> 205 501.05758   2.657251   2 #> 206 743.06309   3.846951   2 #> 207 525.79708   2.596918   2 #> 208 503.88519   3.899171   2 #> 209 525.10675   2.743401   2 #> 210 554.22268   3.373062   2 #> 211 501.04869   3.915219   2 #> 212 501.53737   3.095587   2 #> 213 511.49031   3.492593   2 #> 214 502.45471   2.779056   2 #> 215 556.55388   3.833546   2 #> 216 726.74115   2.634728   2 #> 217 501.24701   2.705171   2 #> 218 644.18099   2.616672   2 #> 219 513.30337   2.767718   2 #> 220 741.22556   2.672749   2 #> 221 593.85453   2.590283   2 #> 222 519.55307   2.582981   2 #> 223 521.32395   2.534981   2 #> 224 501.70005   2.627440   2 #> 225 501.42709   2.566191   2 #> 226 503.82511   2.965892   2 #> 227 501.65518   3.103224   2 #> 228 508.59781   2.511096   2 #> 229 540.79215   3.104285   2 #> 230 501.24319   2.711725   2 #> 231 504.69023   3.431345   2 #> 232 543.93639   2.586427   2 #> 233 553.64531   3.102534   2 #> 234 501.39742   2.501236   2 #> 235 529.63683   2.884283   2 #> 236 605.75825   3.239172   2 #> 237 517.56250   2.516602   2 #> 238 543.32165   2.798923   2 #> 239 505.67838   2.931767   2 #> 240 541.40831   2.720705   2 #> 241 506.77192   3.301782   2 #> 242 501.12465   2.529112   2 #> 243 511.72389   2.516197   2 #> 244 502.48837   2.672466   2 #> 245 925.18194   3.526179   2 #> 246 501.96885   3.775791   2 #> 247 503.57396   2.959847   2 #> 248 625.85334   3.498143   2 #> 249 617.08548   2.627338   2 #> 250 505.40813   2.789905   2 #> 251 784.58016   2.534772   2 #> 252 527.82193   2.781030   2 #> 253 623.07972   2.947835   2 #> 254 501.26836   2.746738   2 #> 255 501.11359   2.514784   2 #> 256 641.00649   3.781315   2 #> 257 501.35391   3.026476   2 #> 258 509.75167   3.055286   2 #> 259 501.77565   3.515502   2 #> 260 501.10430   2.942864   2 #> 261 501.28341   2.903494   2 #> 262 501.67192   4.232389   2 #> 263 503.57628   2.907585   2 #> 264 509.54882   2.975430   2 #> 265 501.08730   2.506039   2 #> 266 501.05066   3.259128   2 #> 267 538.30795   3.036346   2 #> 268 505.40528   2.920985   2 #> 269 508.62764   2.835067   2 #> 270 501.27990   4.314057   2 #> 271 501.03455   2.671696   2 #> 272 736.63236   2.500412   2 #> 273 514.81108   2.939781   2 #> 274 501.40451   2.826002   2 #> 275 505.21995   2.544103   2 #> 276 513.74817   3.101642   2 #> 277 504.60771   2.951098   2 #> 278 508.61681   3.140908   2 #> 279 504.84447   2.501174   2 #> 280 513.18718   2.535743   2 #> 281 506.07274   2.714535   2 #> 282 569.41395   3.222350   2 #> 283 501.05802   2.608180   2 #> 284 507.58042   3.668388   2 #> 285 520.75440   3.542598   2 #> 286 544.95241   2.576534   2 #> 287 501.99159   2.719630   2 #> 288 500.32122   2.723135   2 #> 289 648.02758   3.043142   2 #> 290 501.06239   3.173493   2 #> 291 506.73841   2.756644   2 #> 292 507.42357   3.604734   2 #> 293 500.47069   3.830492   2 #> 294 606.69109   2.549394   2 #> 295 551.09776   2.758611   2 #> 296 514.62110   2.986462   2 #> 297 530.46620   2.768211   2 #> 298 525.74245   2.646768   2 #> 299 539.53044   2.576591   2 #> 300 502.58428   2.647800   2 #> 301 502.86085   2.806583   2 #> 302 823.92307   2.597796   2 #> 303 627.75813   2.511601   2 #> 304 624.67568   2.525522   2 #> 305 628.63222   2.563954   2 #> 306 614.86794   2.706122   2 #> 307 923.16921   2.594691   2 #> 308 503.50053   3.076001   2 #> 309 523.55507   2.878617   2 #> 310 502.42143   2.616924   2 #> 311 504.03058   3.259945   2 #> 312 537.07007   2.525842   2 #> 313 519.91334   3.175463   2 #> 314 501.49182   2.752243   2 #> 315 501.35404   2.805683   2 #> 316 506.07422   2.712480   2 #> 317 645.24525   2.742374   2 #> 318 920.36095   3.048910   2 #> 319 503.16268   2.550674   2 #> 320 501.34232   2.578269   2 #> 321 501.75123   2.627109   2 #> 322 501.53990   2.567786   2 #> 323 501.40850   2.719929   2 #> 324 502.13934   2.525824   2 #> 325 501.33491   2.592072   2 #> 326 501.33691   3.074016   2 #> 327 501.73913   2.742457   2 #> 328 527.14839   2.564404   2 #> 329 504.43510   2.973501   2 #> 330 502.01287   3.343631   2 #> 331 511.71474   2.600463   2 #> 332 589.95912   2.781157   2 #> 333 514.41209   3.086266   2 #> 334 515.16071   3.490450   2 #> 335 501.63306   2.539327   2 #> 336 601.02006   2.684723   2 #> 337 605.20950   2.512970   2 #> 338 506.93057   2.602287   2 #> 339 733.48067   2.774746   2 #> 340 911.76964   3.163539   2 #> 341 501.90557   2.729797   2 #> 342 501.71919   2.541616   2 #> 343 507.38997   2.950199   2 #> 344 512.37560   3.086805   2 #> 345 501.97469   2.672429   2 #> 346 785.68778   2.528089   2 #> 347 807.09512   3.887628   2 #> 348 501.89611   2.575734   2 #> 349 501.39643   3.496432   2 #> 350 510.59282   3.287104   2 #> 351 576.17603   2.721973   2 #> 352 501.86003   2.808655   2 #> 353 564.11505   3.104233   2 #> 354 501.33792   3.076848   2 #> 355 509.30470   3.213915   2 #> 356 501.63964   2.631406   2 #> 357 795.55177   2.589144   2 #> 358 519.62987   2.835786   2 #> 359 502.82110   2.805528   2 #> 360 501.40945   2.539060   2 #> 361 687.59796   3.185768   2 #> 362 502.71224   2.502540   2 #> 363 554.53831   4.147207   2 #> 364 980.53422   2.617461   2 #> 365 561.15038   2.877781   2 #> 366 502.07236   3.162671   2 #> 367 502.91318   2.609871   2 #> 368 502.49296   3.647713   2 #> 369 501.45680   2.564313   2 #> 370 546.21847   2.602336   2 #> 371 504.98728   2.520992   2 #> 372 503.75522   2.839595   2 #> 373 501.55616   2.873241   2 #> 374 504.77414   2.999406   2 #> 375 839.87749   2.638109   2 #> 376 506.20836   2.673763   2 #> 377 533.17941   2.826511   2 #> 378 528.82468   3.056420   2 #> 379 504.27378   2.584849   2 #> 380 504.58211   3.121786   2 #> 381 556.91756   2.670519   2 #> 382 502.56223   2.869108   2 #> 383 502.06482   2.530670   2 #> 384 848.84974   3.600221   2 #> 385 502.59911   2.523545   2 #> 386 585.33601   2.640834   2 #> 387 500.03745   2.756811   2 #> 388 561.18081   2.543221   2 #> 389 502.33527   2.804662   2 #> 390 669.00729   2.834966   2 #> 391 525.60730   3.035695   2 #> 392 836.00871   2.881841   2 #> 393 544.45969   2.647052   2 #> 394 505.92427   2.548665   2 #> 395 578.47534   2.608971   2 #> 396 553.75009   2.855088   2 #> 397 505.90923   3.084143   2 #> 398 770.53043   3.073946   2 #> 399 813.88611   2.835032   2 #> 400 500.30826   2.642033   2 #> 401 502.72008   2.691824   2 #> 402 500.77527   2.624104   2 #> 403 523.31352   3.870932   2 #> 404 502.67642   3.198359   2 #> 405 598.71724   3.319172   2 #> 406 541.84519   3.734641   2 #> 407 821.49179   3.332459   2 #> 408 501.31486   2.522151   2 #> 409 556.05637   3.195990   2 #> 410 643.02360   2.614722   2 #> 411 502.29081   2.602983   2 #> 412 505.32314   2.917231   2 #> 413 504.35631   3.198601   2 #> 414 501.96558   2.547651   2 #> 415 501.38745   2.560899   2 #> 416 501.36928   2.536951   2 #> 417 502.18975   2.828465   2 #> 418 501.31358   2.769868   2 #> 419 501.90366   2.788193   2 #> 420 502.01833   2.861585   2 #> 421 507.25474   3.521842   2 #> 422 941.53147   2.579417   2 #> 423 501.99623   2.736556   2 #> 424 501.37696   2.661013   2 #> 425 532.43444   3.680110   2 #> 426 501.99844   2.981797   2 #> 427 625.25838   2.696426   2 #> 428 606.32435   2.826940   2 #> 429 523.37364   2.520737   2 #> 430 558.97793   2.538618   2 #> 431 545.03868   3.144116   2 #> 432 530.28480   2.759581   2 #> 433 524.67463   2.662668   2 #> 434 940.69953   2.952187   2 #> 435 505.21629   2.777278   2 #> 436 699.71115   2.554962   2 #> 437 739.15035   3.335507   2 #> 438 512.29790   2.631066   2 #> 439 502.19104   2.755609   2 #> 440 502.41107   2.677360   2 #> 441 501.39694   2.580670   2 #> 442 501.40505   3.154878   2 #> 443 613.23242   2.543163   2 #> 444 507.53300   2.972627   2 #> 445 523.33236   2.572590   2 #> 446 505.87927   2.695844   2 #> 447 544.68558   2.918864   2 #> 448 503.06021   2.530002   2 #> 449 526.53115   2.693717   2 #> 450 503.36775   2.937852   2 #> 451 501.81947   3.200804   2 #> 452 612.99816   2.690965   2 #> 453 506.10057   3.534833   2 #> 454 509.01655   3.186558   2 #> 455 501.48985   2.705752   2 #> 456 501.51797   2.534552   2 #> 457 504.84741   2.830164   2 #> 458 501.23747   2.913045   2 #> 459 501.39170   2.516790   2 #> 460 558.17657   4.803869   2 #> 461 750.50874   2.710459   2 #> 462 509.99540   3.447927   2 #> 463 520.13105   2.819396   2 #> 464 501.49618   3.271198   2 #> 465 502.12238   2.705194   2 #> 466 578.14895   4.731248   2 #> 467 538.30382   2.531776   2 #> 468 514.92952   3.676594   2 #> 469 514.95033   2.525184   2 #> 470 515.32497   3.111841   2 #> 471 515.05393   2.564196   2 #> 472 572.71629   3.528913   2 #> 473 547.15035   2.817430   2 #> 474 547.60377   2.567596   2 #> 475 523.41614   2.711960   2 #> 476 517.75312   2.733168   2 #> 477 526.06819   2.528841   2 #> 478 515.15748   2.516220   2 #> 479 738.61247   2.586131   2 #> 480 501.22894   2.643107   2 #> 481 595.99021   2.728954   2 #> 482 512.86676   2.555632   2 #> 483 501.73485   2.616690   2 #> 484 503.27392   2.534076   2 #> 485 505.28849   2.612081   2 #> 486 504.90241   2.773351   2 #> 487 555.73166   2.740527   2 #> 488 652.62290   2.634660   2 #> 489 505.42737   2.639648   2 #> 490 505.37635   2.853464   2 #> 491 515.14377   2.596157   2 #> 492 537.69189   2.981504   2 #> 493 896.00231   2.927301   2 #> 494 508.27010   3.161498   2 #> 495 526.69836   2.680476   2 #> 496 536.89633   2.816418   2 #> 497 563.27551   2.993508   2 #> 498 664.18870   3.101702   2 #> 499 528.26624   2.582006   2 #> 500 501.76438   2.681958   2 #> 501 616.58786   3.218514   2 #> 502 519.35811   2.566618   2 #> 503 628.56677   4.504786   2 #> 504 561.47834   2.710847   2 #> 505 538.62589   2.715883   2 #> 506 501.65437   2.657567   2 #> 507 510.27178   3.053573   2 #> 508 756.96269   2.549871   2 #> 509 502.83832   6.131702   2 #> 510 500.18919   2.579980   2 #> 511 534.38952   2.761991   2 #> 512 518.73630   3.317288   2 #> 513 635.29522   3.574291   2 #> 514 934.81767   3.906441   2 #> 515 504.88427   2.929821   2 #> 516 515.86526   3.161134   2 #> 517 524.89622   3.202072   2 #> 518 555.02008   2.509522   2 #> 519 582.76812   3.242877   2 #> 520 515.56229   2.622763   2 #> 521 515.49836   2.617496   2 #> 522 558.01862   2.906433   2 #> 523 601.03569   2.515337   2 #> 524 908.06466   2.956305   2 #> 525 503.17843   2.832935   2 #> 526 503.06962   2.701630   2 #> 527 800.68171   2.746915   2 #> 528 503.77496   3.186485   2 #> 529 623.08838   2.531776   2 #> 530 516.74224   3.001241   2 #> 531 580.33343   2.905167   2 #> 532 501.81050   3.294692   2 #> 533 557.98628   3.113990   2 #> 534 563.88161   2.793012   2 #> 535 504.47876   2.581461   2 #> 536 530.29769   2.598188   2 #> 537 504.53377   2.625467   2 #> 538 530.34431   2.652184   2 #> 539 572.62529   3.062451   2 #> 540 510.91274   4.298532   2 #> 541 522.16784   2.600392   2 #> 542 708.41030   3.295502   2 #> 543 480.40527   2.672381   2 #> 544 322.68868   2.506834   2 #> 545 947.50153   3.672713   2 #> 546 131.29507   2.557450   2 #> 547 120.90511   2.951038   2 #> 548 113.16065   2.602882   2 #> 549 115.35509   2.974826   2 #> 550 115.45796   2.644909   2 #> 551  44.45462   2.810537   2 #> 552 937.76507   3.656973   2 #> 553 642.32524   2.964334   2 #> 554 668.31576   2.630667   2 #> 555 624.04580   2.781787   2 #> 556 358.00986   2.550939   2 #> 557 860.17645   3.327478   2 #> 558 531.05726   2.908004   2 #> 559 269.76100   2.853772   2 #> 560  54.69794   2.771301   2 #> 561 898.47383   2.617961   2 #> 562 665.28129   2.884001   2 #>  #> [[4]] #>           ts magnitudes gen #> 1   500.7041   2.513001   3 #> 2   500.6676   3.379703   3 #> 3   511.5709   3.500939   3 #> 4   709.5540   3.191168   3 #> 5   548.5185   3.758865   3 #> 6   544.4392   2.533741   3 #> 7   507.9099   2.758931   3 #> 8   822.5465   2.787205   3 #> 9   821.0526   2.811795   3 #> 10  821.6013   3.063997   3 #> 11  822.5669   2.531789   3 #> 12  604.9354   3.204184   3 #> 13  968.8079   3.052711   3 #> 14  790.5928   3.792461   3 #> 15  901.3065   2.566191   3 #> 16  963.2276   2.640295   3 #> 17  901.2819   2.714604   3 #> 18  925.3323   3.469132   3 #> 19  901.1519   3.544580   3 #> 20  903.5984   2.878506   3 #> 21  903.9323   2.745402   3 #> 22  912.2078   2.998967   3 #> 23  901.7892   2.675010   3 #> 24  901.8945   3.038821   3 #> 25  901.3522   2.802535   3 #> 26  901.1455   2.631223   3 #> 27  902.5696   3.071644   3 #> 28  504.9645   3.169226   3 #> 29  596.5835   4.308729   3 #> 30  563.8611   2.965675   3 #> 31  624.0718   2.648640   3 #> 32  504.1176   2.540645   3 #> 33  724.9177   2.531974   3 #> 34  746.2171   2.874977   3 #> 35  742.2306   2.574261   3 #> 36  554.2816   3.099512   3 #> 37  514.1359   3.718004   3 #> 38  507.3993   3.196894   3 #> 39  534.5290   5.065585   3 #> 40  521.1737   2.589523   3 #> 41  507.0135   2.579658   3 #> 42  507.6035   3.166497   3 #> 43  510.2351   2.948947   3 #> 44  561.3853   2.611949   3 #> 45  515.6710   3.085656   3 #> 46  560.8678   2.843680   3 #> 47  533.6728   3.059488   3 #> 48  532.9682   3.014419   3 #> 49  543.9636   4.861431   3 #> 50  916.4337   2.932233   3 #> 51  671.6219   2.670392   3 #> 52  669.5200   2.557048   3 #> 53  672.3122   2.950471   3 #> 54  670.3562   2.784612   3 #> 55  500.8870   2.514080   3 #> 56  525.1419   2.945121   3 #> 57  554.5237   3.827239   3 #> 58  607.1606   2.579171   3 #> 59  573.0011   2.647183   3 #> 60  573.4743   3.674793   3 #> 61  613.4852   2.968673   3 #> 62  572.9343   2.966926   3 #> 63  548.0235   2.986039   3 #> 64  544.2993   2.769887   3 #> 65  655.4671   2.896963   3 #> 66  541.8642   2.744034   3 #> 67  647.4965   2.601990   3 #> 68  540.7963   2.514832   3 #> 69  545.7523   2.852839   3 #> 70  548.0682   2.578309   3 #> 71  549.7730   4.924029   3 #> 72  557.5666   3.058053   3 #> 73  691.6513   2.604867   3 #> 74  558.2393   2.513047   3 #> 75  560.9706   2.826433   3 #> 76  540.5783   2.560955   3 #> 77  524.9970   2.772176   3 #> 78  637.9078   3.286298   3 #> 79  670.1792   2.662038   3 #> 80  809.2285   2.520054   3 #> 81  623.4973   3.990431   3 #> 82  500.6297   2.885199   3 #> 83  500.7871   2.621487   3 #> 84  564.8808   2.518201   3 #> 85  717.0594   3.223590   3 #> 86  711.7026   2.874016   3 #> 87  803.0374   2.529952   3 #> 88  503.4695   2.694451   3 #> 89  723.5471   2.729840   3 #> 90  502.1898   2.809478   3 #> 91  501.9505   3.773168   3 #> 92  529.5209   2.591255   3 #> 93  763.2003   2.621131   3 #> 94  743.7810   3.414510   3 #> 95  743.5693   3.196256   3 #> 96  504.0292   3.733121   3 #> 97  519.7454   2.802109   3 #> 98  507.8135   2.907075   3 #> 99  555.8098   2.935827   3 #> 100 557.7302   2.829758   3 #> 101 511.5225   3.038485   3 #> 102 511.6222   2.516086   3 #> 103 556.7835   2.680985   3 #> 104 534.4580   3.953083   3 #> 105 516.6935   2.754248   3 #> 106 517.5784   3.095704   3 #> 107 515.6293   2.675342   3 #> 108 756.2651   2.764512   3 #> 109 509.8581   2.730527   3 #> 110 502.2784   2.987330   3 #> 111 502.2285   3.015513   3 #> 112 519.2300   2.632366   3 #> 113 503.7058   2.760974   3 #> 114 501.2971   3.284576   3 #> 115 522.9528   2.743766   3 #> 116 509.0310   3.010310   3 #> 117 515.5193   3.225481   3 #> 118 515.6913   3.932550   3 #> 119 510.6097   3.174669   3 #> 120 619.9642   3.602296   3 #> 121 723.8744   2.591445   3 #> 122 507.8215   3.604528   3 #> 123 648.1096   2.914727   3 #> 124 501.2050   3.161540   3 #> 125 625.0114   4.000363   3 #> 126 508.9419   2.702472   3 #> 127 504.2835   2.715625   3 #> 128 567.1127   2.672473   3 #> 129 734.6626   2.530878   3 #> 130 807.9365   2.858817   3 #> 131 522.3307   3.370351   3 #> 132 512.4940   2.573894   3 #> 133 559.8630   2.983358   3 #> 134 561.3422   2.758835   3 #> 135 826.3658   2.711854   3 #> 136 533.8229   3.183264   3 #> 137 777.4634   2.687302   3 #> 138 500.5050   2.702105   3 #> 139 523.7407   3.416644   3 #> 140 523.4531   2.804108   3 #> 141 826.2215   2.678019   3 #> 142 504.2107   3.259057   3 #> 143 513.7358   2.516190   3 #> 144 502.2600   3.026225   3 #> 145 558.3228   2.896863   3 #> 146 601.7316   2.789282   3 #> 147 573.6698   2.775757   3 #> 148 566.0728   2.774585   3 #> 149 639.3873   2.596580   3 #> 150 561.1398   2.717847   3 #> 151 569.7941   2.793830   3 #> 152 558.9061   2.526070   3 #> 153 869.0661   2.511303   3 #> 154 558.5819   2.637014   3 #> 155 559.2620   3.335415   3 #> 156 674.6280   2.802616   3 #> 157 561.8634   2.553951   3 #> 158 578.2458   2.570101   3 #> 159 610.1185   2.584849   3 #> 160 578.2226   2.684270   3 #> 161 579.2829   2.660911   3 #> 162 631.0442   4.290579   3 #> 163 600.5335   2.737837   3 #> 164 616.6884   3.362134   3 #> 165 940.7594   2.989361   3 #> 166 523.2026   3.969425   3 #> 167 530.2778   3.046200   3 #> 168 602.1979   2.807772   3 #> 169 518.8967   2.678446   3 #> 170 550.6873   3.420444   3 #> 171 564.7878   2.763592   3 #> 172 528.2884   2.802027   3 #> 173 790.2893   2.989183   3 #> 174 648.1629   2.579683   3 #> 175 629.1291   2.814207   3 #> 176 631.3676   2.999034   3 #> 177 630.4530   2.576413   3 #> 178 628.5765   3.242824   3 #> 179 629.7142   2.533340   3 #> 180 628.6607   2.799439   3 #> 181 513.3676   2.596354   3 #> 182 509.9178   2.690155   3 #> 183 504.5511   2.552497   3 #> 184 551.7758   3.798801   3 #> 185 502.8442   3.476884   3 #> 186 541.9403   2.904415   3 #> 187 503.0942   2.672377   3 #> 188 512.2066   2.736587   3 #> 189 503.6641   2.770426   3 #> 190 503.6094   2.627407   3 #> 191 519.4668   4.005376   3 #> 192 740.7863   3.203524   3 #> 193 690.3181   3.437534   3 #> 194 526.4469   2.671269   3 #> 195 503.7349   3.522196   3 #> 196 536.9232   5.470818   3 #> 197 503.7140   2.588269   3 #> 198 507.0120   2.617303   3 #> 199 568.4624   2.598861   3 #> 200 502.8461   2.879269   3 #> 201 623.1872   3.514880   3 #> 202 504.7482   2.577111   3 #> 203 504.0411   2.746189   3 #> 204 503.0323   2.522493   3 #> 205 502.8884   2.630453   3 #> 206 513.1502   2.611313   3 #> 207 510.4870   2.814584   3 #> 208 503.5931   3.105092   3 #> 209 503.5166   2.735050   3 #> 210 508.2652   3.066888   3 #> 211 503.0431   2.846422   3 #> 212 543.1235   2.946247   3 #> 213 678.8934   2.653594   3 #> 214 549.3447   2.781319   3 #> 215 661.1029   3.336067   3 #> 216 543.8860   2.780340   3 #> 217 502.9421   4.026289   3 #> 218 505.0446   2.581793   3 #> 219 503.7677   3.429559   3 #> 220 503.3923   2.820046   3 #> 221 865.3832   2.626364   3 #> 222 503.1754   2.867422   3 #> 223 615.7432   2.900898   3 #> 224 502.9444   2.758824   3 #> 225 502.9970   2.628770   3 #> 226 635.8864   2.896806   3 #> 227 680.7925   2.715043   3 #> 228 504.0425   2.675498   3 #> 229 505.4246   2.577628   3 #> 230 502.9694   3.157617   3 #> 231 747.3719   3.028602   3 #> 232 751.6953   3.292540   3 #> 233 502.8992   2.625053   3 #> 234 505.7025   2.537219   3 #> 235 503.2616   2.846699   3 #> 236 726.6967   2.694558   3 #> 237 502.8598   2.583967   3 #> 238 553.3289   3.823024   3 #> 239 503.1254   3.100425   3 #> 240 504.2940   2.549179   3 #> 241 539.1706   3.655003   3 #> 242 504.2320   2.638385   3 #> 243 513.2173   2.843202   3 #> 244 502.8639   2.668079   3 #> 245 503.4863   2.780286   3 #> 246 502.9432   2.567265   3 #> 247 522.0357   2.557654   3 #> 248 503.3800   3.767894   3 #> 249 504.7109   3.539350   3 #> 250 504.0581   2.721132   3 #> 251 503.2722   3.225264   3 #> 252 502.9033   2.829955   3 #> 253 502.9015   2.599022   3 #> 254 895.4220   3.814479   3 #> 255 503.3083   3.527762   3 #> 256 519.4270   4.229810   3 #> 257 502.9697   3.134274   3 #> 258 515.4200   4.591115   3 #> 259 502.8898   2.511753   3 #> 260 660.8999   2.830343   3 #> 261 503.0133   3.046161   3 #> 262 537.6216   2.940024   3 #> 263 503.2763   2.535734   3 #> 264 792.2489   2.810943   3 #> 265 508.1346   3.443200   3 #> 266 613.5207   2.685160   3 #> 267 505.5761   2.571184   3 #> 268 502.8924   2.686953   3 #> 269 502.8454   3.482552   3 #> 270 522.0698   3.468051   3 #> 271 503.4406   2.811180   3 #> 272 502.9859   2.586296   3 #> 273 527.5959   3.067061   3 #> 274 502.8449   2.894930   3 #> 275 518.0733   3.450634   3 #> 276 637.2222   2.501067   3 #> 277 508.3640   2.558139   3 #> 278 504.0818   2.647845   3 #> 279 502.8868   2.557375   3 #> 280 504.1000   2.650125   3 #> 281 925.6597   3.435332   3 #> 282 503.2000   2.503893   3 #> 283 504.0606   3.394279   3 #> 284 513.8954   2.577187   3 #> 285 503.5339   2.717173   3 #> 286 503.6817   2.676423   3 #> 287 507.0705   2.745167   3 #> 288 503.0710   2.694618   3 #> 289 520.9786   3.621384   3 #> 290 503.1770   3.151021   3 #> 291 882.6471   3.566024   3 #> 292 502.9993   2.870351   3 #> 293 502.9068   2.500862   3 #> 294 876.0678   2.714718   3 #> 295 503.0763   3.070522   3 #> 296 939.4837   2.716066   3 #> 297 514.7732   3.330105   3 #> 298 503.3188   2.747228   3 #> 299 504.6923   2.737285   3 #> 300 533.3845   2.716136   3 #> 301 503.0481   2.600427   3 #> 302 507.1119   2.853928   3 #> 303 537.5706   3.186234   3 #> 304 503.1713   2.609256   3 #> 305 504.0843   2.836653   3 #> 306 571.0723   2.557592   3 #> 307 503.5435   2.783866   3 #> 308 503.2672   2.659985   3 #> 309 503.0031   3.123204   3 #> 310 934.4541   3.079733   3 #> 311 502.9916   3.002160   3 #> 312 504.1274   3.051846   3 #> 313 503.4330   3.179828   3 #> 314 503.6626   2.817837   3 #> 315 502.9810   2.770851   3 #> 316 742.5481   3.659922   3 #> 317 519.1442   3.002000   3 #> 318 552.6610   3.537020   3 #> 319 506.0770   2.630370   3 #> 320 571.8507   2.572774   3 #> 321 605.9247   2.561008   3 #> 322 502.9017   2.648540   3 #> 323 509.4461   3.786849   3 #> 324 503.5144   3.283131   3 #> 325 518.4345   2.570227   3 #> 326 585.3664   2.651731   3 #> 327 504.0168   2.587582   3 #> 328 928.8188   2.826749   3 #> 329 503.4643   2.860043   3 #> 330 521.9723   2.502728   3 #> 331 514.5461   2.702197   3 #> 332 503.0379   2.863409   3 #> 333 508.0460   2.769654   3 #> 334 502.8505   2.896933   3 #> 335 584.3599   2.790408   3 #> 336 926.1116   2.513476   3 #> 337 503.0331   3.039730   3 #> 338 526.6982   2.782061   3 #> 339 519.6594   2.623868   3 #> 340 654.1556   4.085322   3 #> 341 502.8699   2.910843   3 #> 342 503.1402   2.979508   3 #> 343 502.8721   2.685579   3 #> 344 503.1373   2.856937   3 #> 345 502.8852   2.540523   3 #> 346 517.7452   2.601251   3 #> 347 692.4481   2.577110   3 #> 348 503.3447   2.756521   3 #> 349 505.2086   4.280055   3 #> 350 506.5427   3.550295   3 #> 351 502.8530   2.821822   3 #> 352 506.9452   3.018315   3 #> 353 515.3261   2.624771   3 #> 354 502.8679   5.084944   3 #> 355 517.8190   2.505619   3 #> 356 558.4644   2.646995   3 #> 357 510.2679   2.995579   3 #> 358 504.9711   3.457223   3 #> 359 516.7301   3.030974   3 #> 360 502.8569   2.735543   3 #> 361 502.8671   3.378644   3 #> 362 502.9355   3.883320   3 #> 363 503.3172   2.850577   3 #> 364 523.7655   2.701232   3 #> 365 508.4315   2.561773   3 #> 366 504.4055   2.593345   3 #> 367 868.1614   2.681837   3 #> 368 507.7037   3.287908   3 #> 369 522.1086   2.911870   3 #> 370 503.1102   2.596165   3 #> 371 511.2997   3.579482   3 #> 372 502.8742   2.677896   3 #> 373 502.8953   3.012739   3 #> 374 504.3381   2.710807   3 #> 375 503.7562   3.413745   3 #> 376 854.5115   2.544715   3 #> 377 502.9785   3.102751   3 #> 378 507.1500   2.625767   3 #> 379 639.1275   2.807376   3 #> 380 502.9841   2.637658   3 #> 381 535.3381   2.971678   3 #> 382 503.0197   2.619105   3 #> 383 504.3298   2.621343   3 #> 384 506.4958   2.675986   3 #> 385 551.0896   2.700010   3 #> 386 505.8713   2.622607   3 #> 387 502.9555   2.568080   3 #> 388 514.5661   2.960047   3 #> 389 503.0029   2.748345   3 #> 390 504.4384   3.663527   3 #> 391 506.8063   4.539889   3 #> 392 624.0200   2.820435   3 #> 393 506.2030   2.584756   3 #> 394 504.5081   2.516887   3 #> 395 944.3626   2.801431   3 #> 396 503.2078   2.787406   3 #> 397 503.0833   3.379764   3 #> 398 593.0862   2.765765   3 #> 399 502.8990   2.593183   3 #> 400 504.0702   2.991767   3 #> 401 526.3257   3.275530   3 #> 402 504.4726   2.613120   3 #> 403 505.3838   2.688162   3 #> 404 502.9147   2.551514   3 #> 405 512.7576   2.768270   3 #> 406 515.9053   2.734327   3 #> 407 507.7687   3.212225   3 #> 408 503.0669   2.566792   3 #> 409 502.8604   2.683008   3 #> 410 516.0034   2.828905   3 #> 411 505.5605   4.718252   3 #> 412 572.7536   2.985176   3 #> 413 821.0617   3.287240   3 #> 414 659.2774   2.753690   3 #> 415 503.3236   3.279702   3 #> 416 505.1480   3.103346   3 #> 417 545.8564   2.787020   3 #> 418 516.8509   2.585023   3 #> 419 698.5787   2.548878   3 #> 420 568.5288   2.604833   3 #> 421 531.9957   4.081646   3 #> 422 505.3956   3.067907   3 #> 423 652.0219   3.170377   3 #> 424 506.0070   2.534028   3 #> 425 511.6362   2.968137   3 #> 426 508.9126   2.868231   3 #> 427 656.6336   2.535804   3 #> 428 503.7001   2.780271   3 #> 429 503.2987   2.965036   3 #> 430 526.5614   2.638384   3 #> 431 567.7134   3.316261   3 #> 432 734.9659   2.970665   3 #> 433 635.4011   2.639405   3 #> 434 642.6563   2.501882   3 #> 435 935.3605   3.585420   3 #> 436 608.8986   2.704756   3 #> 437 656.0514   3.183286   3 #> 438 800.6995   2.614026   3 #> 439 517.2633   2.574329   3 #> 440 511.1326   2.694610   3 #> 441 938.2333   3.812530   3 #> 442 940.4729   2.978716   3 #> 443 531.1336   2.587964   3 #> 444 270.4640   2.652858   3 #> 445 666.0118   2.520245   3 #> 446 698.4901   2.873693   3 #> 447 665.3979   3.138947   3 #>  #> [[5]] #>           ts magnitudes gen #> 1   511.5902   2.925265   4 #> 2   632.6396   3.246517   4 #> 3   626.5098   2.880256   4 #> 4   791.7124   2.678494   4 #> 5   927.7107   2.742555   4 #> 6   986.4067   2.671346   4 #> 7   983.9448   3.468581   4 #> 8   904.4559   3.893348   4 #> 9   902.5442   3.843494   4 #> 10  604.0302   2.869571   4 #> 11  596.9327   2.642020   4 #> 12  608.2780   2.676559   4 #> 13  585.9506   3.253792   4 #> 14  605.9639   3.073981   4 #> 15  514.2761   2.964772   4 #> 16  535.5446   2.746036   4 #> 17  541.4952   2.638866   4 #> 18  539.0113   2.781264   4 #> 19  534.6432   2.851058   4 #> 20  542.5890   2.687786   4 #> 21  536.7651   2.625788   4 #> 22  562.0043   3.127124   4 #> 23  537.3548   2.768427   4 #> 24  534.8804   4.008487   4 #> 25  535.5625   2.524461   4 #> 26  540.5937   2.607582   4 #> 27  534.5655   2.525129   4 #> 28  536.1844   2.844197   4 #> 29  599.4385   4.465542   4 #> 30  536.8426   2.917150   4 #> 31  905.5297   3.141059   4 #> 32  534.5594   2.756096   4 #> 33  534.5743   2.824630   4 #> 34  582.3507   3.164128   4 #> 35  549.3412   2.523426   4 #> 36  556.2234   3.300799   4 #> 37  936.9065   2.742330   4 #> 38  536.4394   2.567417   4 #> 39  512.5061   2.753225   4 #> 40  512.3075   2.749282   4 #> 41  579.8422   2.571652   4 #> 42  582.3414   3.139153   4 #> 43  544.9752   2.624028   4 #> 44  609.6901   2.854345   4 #> 45  544.9977   3.057922   4 #> 46  685.9731   3.225883   4 #> 47  543.9779   3.952174   4 #> 48  548.1940   3.509444   4 #> 49  548.9398   2.640511   4 #> 50  546.7651   2.598113   4 #> 51  544.2759   2.783400   4 #> 52  545.0262   2.592788   4 #> 53  545.3017   2.568605   4 #> 54  672.6617   3.731874   4 #> 55  563.1348   2.613841   4 #> 56  554.7161   3.004617   4 #> 57  559.3419   2.547078   4 #> 58  605.7256   2.532658   4 #> 59  552.9677   2.615091   4 #> 60  828.4378   2.574227   4 #> 61  552.1623   3.003486   4 #> 62  556.3441   2.517802   4 #> 63  637.3593   2.517637   4 #> 64  551.3397   3.310863   4 #> 65  554.3608   2.618714   4 #> 66  688.8218   2.777809   4 #> 67  580.4544   2.883469   4 #> 68  550.1398   3.614480   4 #> 69  665.0409   3.521774   4 #> 70  538.5035   3.105822   4 #> 71  623.6278   2.763637   4 #> 72  502.4411   3.471738   4 #> 73  743.9793   2.902133   4 #> 74  536.3185   2.704728   4 #> 75  505.5551   2.855808   4 #> 76  622.4123   2.557019   4 #> 77  510.3642   2.559810   4 #> 78  555.9073   2.598546   4 #> 79  534.7266   2.686942   4 #> 80  623.8207   2.772043   4 #> 81  535.5188   2.654636   4 #> 82  512.9218   3.067442   4 #> 83  518.5240   3.996256   4 #> 84  528.5774   2.724594   4 #> 85  518.3739   2.627415   4 #> 86  620.0862   2.754759   4 #> 87  620.0178   2.704117   4 #> 88  626.3838   2.589516   4 #> 89  813.0979   2.946252   4 #> 90  551.1185   2.943082   4 #> 91  512.3378   2.959723   4 #> 92  826.5085   2.502219   4 #> 93  519.4654   2.526802   4 #> 94  613.0863   2.998099   4 #> 95  872.4566   2.570270   4 #> 96  559.3611   2.655999   4 #> 97  674.9723   3.113814   4 #> 98  631.0760   2.768937   4 #> 99  557.6817   3.293578   4 #> 100 529.0489   2.524394   4 #> 101 517.0720   3.008262   4 #> 102 523.5753   2.630786   4 #> 103 524.1152   3.868434   4 #> 104 691.1227   2.617157   4 #> 105 526.6416   2.514027   4 #> 106 900.5355   2.732629   4 #> 107 507.7278   2.671025   4 #> 108 507.5682   3.130482   4 #> 109 652.8904   2.654241   4 #> 110 537.4807   2.611685   4 #> 111 537.6874   2.517797   4 #> 112 537.0109   2.818440   4 #> 113 537.9403   2.873902   4 #> 114 536.9590   3.272888   4 #> 115 537.0716   3.128950   4 #> 116 544.1125   4.306422   4 #> 117 872.0144   2.506100   4 #> 118 537.6992   3.080952   4 #> 119 550.3584   2.552216   4 #> 120 540.4194   3.203912   4 #> 121 537.3964   2.682365   4 #> 122 552.7110   3.188445   4 #> 123 700.5725   3.441092   4 #> 124 622.4445   2.961118   4 #> 125 536.9847   2.600303   4 #> 126 537.1680   3.665131   4 #> 127 541.0366   3.907766   4 #> 128 662.6925   3.534894   4 #> 129 537.9943   2.834414   4 #> 130 538.2432   2.907490   4 #> 131 544.5777   3.143429   4 #> 132 541.1385   2.555387   4 #> 133 540.4815   3.266906   4 #> 134 896.2434   3.136090   4 #> 135 783.3994   3.526887   4 #> 136 537.4421   5.108580   4 #> 137 580.6020   2.516712   4 #> 138 537.7095   2.920646   4 #> 139 929.4752   2.767830   4 #> 140 576.6340   2.909959   4 #> 141 537.0717   2.586498   4 #> 142 542.6323   4.026821   4 #> 143 598.2339   2.791708   4 #> 144 536.9314   2.525445   4 #> 145 594.6898   2.802858   4 #> 146 538.9286   2.809304   4 #> 147 542.2998   2.521334   4 #> 148 538.0937   5.958687   4 #> 149 538.0710   3.636879   4 #> 150 538.1430   3.502030   4 #> 151 547.0895   3.148615   4 #> 152 538.2465   2.705309   4 #> 153 536.9676   2.973955   4 #> 154 537.2250   2.518097   4 #> 155 537.0538   3.017690   4 #> 156 540.6820   2.684169   4 #> 157 559.3916   2.645887   4 #> 158 538.8714   3.086968   4 #> 159 558.5103   3.241007   4 #> 160 594.9964   2.568549   4 #> 161 536.9817   4.312443   4 #> 162 536.9314   2.615332   4 #> 163 599.6526   2.586615   4 #> 164 558.6400   3.090351   4 #> 165 575.9233   3.545131   4 #> 166 506.9768   3.677952   4 #> 167 502.9684   2.650533   4 #> 168 531.3055   2.952145   4 #> 169 510.7223   2.677625   4 #> 170 511.1678   2.566808   4 #> 171 505.8761   2.501492   4 #> 172 553.3974   3.040627   4 #> 173 582.7167   2.906652   4 #> 174 539.9763   2.656941   4 #> 175 896.7015   2.651778   4 #> 176 794.7923   2.751365   4 #> 177 503.3820   3.581358   4 #> 178 528.3688   2.579835   4 #> 179 850.2862   2.742107   4 #> 180 519.6530   2.942295   4 #> 181 515.7173   2.645599   4 #> 182 516.4474   2.848103   4 #> 183 515.6875   2.801196   4 #> 184 515.4592   2.675889   4 #> 185 517.5553   2.572145   4 #> 186 516.0172   2.626273   4 #> 187 515.8923   2.688936   4 #> 188 678.8350   2.617045   4 #> 189 540.1293   2.736163   4 #> 190 702.8641   2.777975   4 #> 191 504.6822   2.512568   4 #> 192 503.1110   3.265046   4 #> 193 837.3178   2.547331   4 #> 194 505.3629   3.097856   4 #> 195 747.6423   3.629301   4 #> 196 504.2741   3.910197   4 #> 197 504.0598   2.689223   4 #> 198 655.9436   2.602487   4 #> 199 502.8811   3.380929   4 #> 200 859.9147   3.326626   4 #> 201 507.0153   2.654632   4 #> 202 505.2117   3.261091   4 #> 203 506.5394   3.023404   4 #> 204 533.5321   4.495759   4 #> 205 527.9070   3.048650   4 #> 206 618.8183   2.529592   4 #> 207 817.6043   2.937453   4 #> 208 503.8570   2.804565   4 #> 209 502.9869   2.618247   4 #> 210 718.5810   4.009682   4 #> 211 503.8343   2.858072   4 #> 212 507.4119   2.551340   4 #> 213 502.8784   2.722931   4 #> 214 503.3103   2.530593   4 #> 215 506.7064   3.592967   4 #> 216 504.0089   3.310092   4 #> 217 502.8759   3.070179   4 #> 218 506.7255   2.522537   4 #> 219 512.5320   2.560291   4 #> 220 510.4104   2.809382   4 #> 221 606.6489   2.823120   4 #> 222 503.0930   2.572965   4 #> 223 508.0170   2.713961   4 #> 224 504.9858   2.717777   4 #> 225 521.9650   2.621580   4 #> 226 503.8168   2.658298   4 #> 227 504.4871   2.829160   4 #> 228 506.9120   3.544463   4 #> 229 796.9800   2.549757   4 #> 230 507.6521   2.533500   4 #> 231 518.4953   2.616696   4 #> 232 760.9700   2.585851   4 #> 233 507.3895   2.574352   4 #> 234 944.4594   2.578273   4 #> 235 593.3531   2.829876   4 #> 236 520.6848   3.077003   4 #> 237 505.6366   2.715768   4 #> 238 557.6929   4.202877   4 #> 239 505.6622   2.683783   4 #> 240 733.2107   2.592038   4 #> 241 640.5617   3.127468   4 #> 242 534.0902   2.771411   4 #> 243 505.8821   2.859266   4 #> 244 559.0597   2.547334   4 #> 245 659.6200   3.150873   4 #> 246 505.3442   2.663347   4 #> 247 513.2934   3.092231   4 #> 248 530.9838   2.510202   4 #> 249 636.7474   2.521799   4 #> 250 936.0817   2.719992   4 #> 251 955.8009   2.930159   4 #>  #> [[6]] #>           ts magnitudes gen #> 1   511.6542   2.805211   5 #> 2   632.8246   2.599155   5 #> 3   626.6349   3.846868   5 #> 4   912.4163   3.642032   5 #> 5   905.4910   2.846976   5 #> 6   937.1828   3.163970   5 #> 7   904.2463   2.863807   5 #> 8   597.4132   2.502881   5 #> 9   608.3665   2.664244   5 #> 10  655.1369   3.462584   5 #> 11  562.6557   2.564121   5 #> 12  563.9198   2.686371   5 #> 13  547.0089   2.506644   5 #> 14  543.9972   3.352418   5 #> 15  599.8565   2.659502   5 #> 16  599.6564   2.586611   5 #> 17  599.7445   2.755890   5 #> 18  600.9480   2.515950   5 #> 19  601.1584   2.904864   5 #> 20  599.5731   2.869372   5 #> 21  546.8607   2.639157   5 #> 22  944.0012   2.547052   5 #> 23  674.6775   3.643139   5 #> 24  555.9487   2.512923   5 #> 25  549.9161   3.354911   5 #> 26  674.6996   4.060177   5 #> 27  563.1591   2.867642   5 #> 28  558.7283   2.905471   5 #> 29  653.5337   2.968901   5 #> 30  665.3212   2.706220   5 #> 31  513.3212   2.548739   5 #> 32  534.8254   2.746452   5 #> 33  520.0035   3.314370   5 #> 34  820.4294   2.590179   5 #> 35  513.0401   2.937969   5 #> 36  574.0093   3.485802   5 #> 37  574.7944   2.607338   5 #> 38  554.6154   3.159756   5 #> 39  846.6573   2.672020   5 #> 40  551.0318   3.390219   5 #> 41  553.5925   2.853397   5 #> 42  560.0897   4.173871   5 #> 43  541.2344   2.575983   5 #> 44  554.5595   3.288688   5 #> 45  663.5666   2.860360   5 #> 46  898.2168   3.049669   5 #> 47  797.3320   2.587242   5 #> 48  555.8247   2.635820   5 #> 49  564.2709   2.607352   5 #> 50  558.5825   2.937037   5 #> 51  544.9220   2.865935   5 #> 52  537.6088   3.415958   5 #> 53  538.7840   2.979586   5 #> 54  544.9458   2.878244   5 #> 55  537.8624   2.713396   5 #> 56  610.1590   2.527561   5 #> 57  537.4930   2.556798   5 #> 58  546.6850   2.612818   5 #> 59  537.5664   2.726406   5 #> 60  537.9670   2.870978   5 #> 61  538.5937   2.640234   5 #> 62  537.7797   2.645274   5 #> 63  561.5207   2.528762   5 #> 64  555.6812   2.977562   5 #> 65  540.3688   2.759709   5 #> 66  538.1282   2.713267   5 #> 67  545.0433   2.873256   5 #> 68  544.1238   2.617518   5 #> 69  542.7542   2.826666   5 #> 70  548.5203   2.662385   5 #> 71  538.1339   2.742147   5 #> 72  542.6154   2.704389   5 #> 73  538.4226   2.545657   5 #> 74  539.0197   2.614271   5 #> 75  538.1093   2.875881   5 #> 76  548.9259   2.744846   5 #> 77  538.2158   2.727208   5 #> 78  542.3597   2.866443   5 #> 79  538.3516   2.516528   5 #> 80  538.2143   2.743353   5 #> 81  538.9847   2.938212   5 #> 82  538.3061   3.030128   5 #> 83  538.1030   2.685227   5 #> 84  541.2669   2.571816   5 #> 85  540.7589   2.787435   5 #> 86  839.3360   2.807157   5 #> 87  538.1271   2.762868   5 #> 88  538.3039   2.959055   5 #> 89  541.6891   2.692930   5 #> 90  822.8252   2.646965   5 #> 91  538.4026   3.285334   5 #> 92  538.1201   2.992649   5 #> 93  539.7537   2.807806   5 #> 94  539.4633   3.310239   5 #> 95  538.4052   2.652747   5 #> 96  547.6724   2.697940   5 #> 97  573.1177   3.083051   5 #> 98  550.9311   2.659361   5 #> 99  539.6696   2.847511   5 #> 100 538.3502   2.956567   5 #> 101 538.5739   4.024340   5 #> 102 552.6444   2.715777   5 #> 103 616.4054   2.670141   5 #> 104 548.1570   3.032464   5 #> 105 546.0994   2.689647   5 #> 106 539.2458   3.127082   5 #> 107 540.2215   2.591749   5 #> 108 538.1627   3.261138   5 #> 109 538.9627   2.875314   5 #> 110 538.6969   2.518916   5 #> 111 889.3523   2.681762   5 #> 112 543.3401   2.599314   5 #> 113 553.5585   2.614104   5 #> 114 582.1520   2.524387   5 #> 115 538.1876   3.571081   5 #> 116 548.3179   3.286792   5 #> 117 538.3253   2.613984   5 #> 118 637.7311   3.249504   5 #> 119 551.4084   3.051076   5 #> 120 541.9939   2.527427   5 #> 121 538.5214   3.220100   5 #> 122 580.8929   2.846258   5 #> 123 538.0988   2.924627   5 #> 124 540.5721   2.792436   5 #> 125 539.3340   2.644978   5 #> 126 685.8390   3.153602   5 #> 127 703.4798   2.999110   5 #> 128 538.5368   4.698894   5 #> 129 543.5960   3.312578   5 #> 130 538.3139   2.792996   5 #> 131 545.7939   3.252002   5 #> 132 549.1535   2.865352   5 #> 133 683.7590   2.579937   5 #> 134 538.1430   2.537874   5 #> 135 538.4603   2.720591   5 #> 136 619.4630   2.509286   5 #> 137 538.2663   2.863379   5 #> 138 624.7950   3.435426   5 #> 139 538.4438   3.112525   5 #> 140 540.2168   2.988278   5 #> 141 555.8487   2.520676   5 #> 142 950.0763   2.525025   5 #> 143 541.1013   3.627478   5 #> 144 661.6525   2.577900   5 #> 145 538.3285   2.709785   5 #> 146 545.4257   2.825005   5 #> 147 540.4386   2.698734   5 #> 148 538.1962   2.643924   5 #> 149 538.1477   2.698720   5 #> 150 538.7572   2.528716   5 #> 151 538.6036   3.128202   5 #> 152 538.1279   2.553524   5 #> 153 538.3373   3.065071   5 #> 154 594.6282   2.504397   5 #> 155 538.1515   2.567405   5 #> 156 800.8362   2.985606   5 #> 157 538.1022   2.693597   5 #> 158 538.1375   2.626784   5 #> 159 543.1208   2.507083   5 #> 160 539.8061   2.935941   5 #> 161 562.9507   3.259032   5 #> 162 538.1011   2.580378   5 #> 163 538.2506   2.907588   5 #> 164 594.2405   2.588626   5 #> 165 538.1882   2.909606   5 #> 166 538.2042   2.535424   5 #> 167 540.1119   3.065361   5 #> 168 539.5639   2.711698   5 #> 169 538.3382   2.981370   5 #> 170 538.2085   2.552852   5 #> 171 543.0466   2.866400   5 #> 172 679.3041   2.680073   5 #> 173 613.7639   2.545079   5 #> 174 538.1223   2.784110   5 #> 175 543.6941   3.559668   5 #> 176 538.5691   2.747946   5 #> 177 539.8109   2.564571   5 #> 178 538.1853   3.047152   5 #> 179 542.9242   2.607936   5 #> 180 538.0972   3.216132   5 #> 181 540.1672   2.949942   5 #> 182 538.7389   2.772423   5 #> 183 865.8821   2.838499   5 #> 184 547.7080   2.711719   5 #> 185 704.5614   2.616989   5 #> 186 549.1054   2.848972   5 #> 187 549.1170   3.394359   5 #> 188 538.5094   2.973927   5 #> 189 540.9776   2.895555   5 #> 190 539.7428   2.788811   5 #> 191 567.6119   2.618061   5 #> 192 617.9941   2.740223   5 #> 193 546.3266   3.323846   5 #> 194 659.6751   4.789789   5 #> 195 541.2854   2.897573   5 #> 196 715.5246   2.516989   5 #> 197 538.1631   2.688000   5 #> 198 538.4732   2.535616   5 #> 199 850.5608   2.841252   5 #> 200 553.7093   2.565395   5 #> 201 538.2732   3.734587   5 #> 202 576.9963   3.359233   5 #> 203 614.0276   2.930809   5 #> 204 555.0231   2.532789   5 #> 205 767.4123   2.625918   5 #> 206 539.1979   2.694429   5 #> 207 538.2996   2.718714   5 #> 208 554.0454   3.121054   5 #> 209 605.1979   2.924425   5 #> 210 538.3424   2.915425   5 #> 211 540.4846   2.508976   5 #> 212 538.2990   2.671319   5 #> 213 541.4537   2.652587   5 #> 214 538.2452   2.628956   5 #> 215 539.8000   2.847478   5 #> 216 654.1131   2.858453   5 #> 217 572.1915   3.244876   5 #> 218 581.5759   3.515857   5 #> 219 543.8211   2.853812   5 #> 220 790.0931   3.028057   5 #> 221 538.1094   2.653477   5 #> 222 541.4172   3.251306   5 #> 223 771.7877   2.684169   5 #> 224 538.3637   2.516349   5 #> 225 553.3631   2.702645   5 #> 226 537.3472   3.358280   5 #> 227 540.3910   2.683068   5 #> 228 503.5334   2.530166   5 #> 229 880.5536   2.521855   5 #> 230 503.6505   3.060905   5 #> 231 506.9754   2.901679   5 #> 232 505.7955   3.091584   5 #> 233 505.0501   2.675351   5 #> 234 509.6044   3.120749   5 #> 235 627.2192   4.338348   5 #> 236 570.4835   2.792774   5 #> 237 536.1889   2.563676   5 #> 238 557.3274   3.087525   5 #> 239 534.8875   3.227134   5 #> 240 533.7320   2.942242   5 #> 241 619.0799   2.689656   5 #> 242 723.1488   2.893382   5 #> 243 721.1931   2.974204   5 #> 244 718.8133   3.612289   5 #> 245 505.6240   2.699085   5 #> 246 508.1003   2.607427   5 #> 247 524.9822   5.249883   5 #> 248 523.6083   4.016639   5 #> 249 507.7152   3.082678   5 #> 250 507.1349   2.588571   5 #> 251 511.8465   2.859989   5 #> 252 603.9660   3.397921   5 #> 253 557.9621   2.557530   5 #> 254 594.3780   2.635177   5 #> 255 578.4516   2.534957   5 #> 256 505.9386   2.883233   5 #>  #> [[7]] #>           ts magnitudes gen #> 1   648.9691   3.180473   6 #> 2   633.6685   2.631060   6 #> 3   931.4348   2.673246   6 #> 4   912.9204   2.777067   6 #> 5   630.0779   3.663053   6 #> 6   675.4781   2.510880   6 #> 7   674.7644   3.349255   6 #> 8   934.3538   2.940240   6 #> 9   520.0280   2.995488   6 #> 10  513.2377   2.736377   6 #> 11  706.0842   2.717529   6 #> 12  560.8739   2.777028   6 #> 13  560.1411   2.606628   6 #> 14  558.9948   2.783912   6 #> 15  559.4843   2.589357   6 #> 16  537.5884   3.045733   6 #> 17  548.9578   2.549005   6 #> 18  540.1760   2.806622   6 #> 19  538.3251   3.106869   6 #> 20  823.2629   2.510986   6 #> 21  538.4888   3.446035   6 #> 22  538.7557   2.587339   6 #> 23  610.4772   4.147762   6 #> 24  541.9656   2.972338   6 #> 25  546.1694   2.986908   6 #> 26  564.8355   2.818171   6 #> 27  538.5677   2.549509   6 #> 28  538.6358   2.548027   6 #> 29  538.8552   2.962878   6 #> 30  538.7301   4.136676   6 #> 31  768.0682   2.500978   6 #> 32  630.7307   2.706790   6 #> 33  539.9997   2.933578   6 #> 34  540.2587   3.116220   6 #> 35  658.6398   2.534929   6 #> 36  539.6931   2.813020   6 #> 37  582.9959   2.629221   6 #> 38  539.3327   2.747336   6 #> 39  543.5074   2.869234   6 #> 40  543.7992   4.406963   6 #> 41  865.9094   3.161513   6 #> 42  866.3244   2.791011   6 #> 43  549.2655   2.779054   6 #> 44  565.4040   2.638828   6 #> 45  588.2793   2.618058   6 #> 46  551.0739   2.884965   6 #> 47  659.8249   2.572492   6 #> 48  703.8607   2.972701   6 #> 49  659.8124   2.636177   6 #> 50  659.7318   2.535851   6 #> 51  920.3548   2.774081   6 #> 52  677.2682   2.893513   6 #> 53  704.8306   2.504385   6 #> 54  659.8496   2.792483   6 #> 55  697.5674   3.607448   6 #> 56  792.9616   2.680459   6 #> 57  849.2061   2.725556   6 #> 58  660.5440   3.078234   6 #> 59  660.0904   2.887388   6 #> 60  768.7309   3.135506   6 #> 61  695.4844   2.739263   6 #> 62  736.8100   3.177463   6 #> 63  637.8012   2.848696   6 #> 64  638.3554   3.486604   6 #> 65  627.9773   3.258887   6 #> 66  632.5588   3.000697   6 #> 67  627.3611   2.829455   6 #> 68  632.1387   2.579983   6 #> 69  543.9692   2.895910   6 #> 70  725.4795   3.105953   6 #> 71  746.0143   2.577794   6 #> 72  545.1503   2.536888   6 #> 73  525.0672   3.809381   6 #> 74  560.2992   4.337255   6 #> 75  536.5692   3.039945   6 #> 76  525.0536   2.543587   6 #> 77  525.1478   2.601977   6 #> 78  525.4710   2.944906   6 #> 79  539.0842   2.990035   6 #> 80  581.0111   2.569517   6 #> 81  936.0856   2.522030   6 #> 82  549.7092   2.729369   6 #> 83  525.0086   2.681368   6 #> 84  526.1673   2.549262   6 #> 85  525.0103   2.545692   6 #> 86  885.3366   2.584617   6 #> 87  525.0412   2.562712   6 #> 88  526.5532   3.604247   6 #> 89  525.1171   3.399668   6 #> 90  536.5894   3.211969   6 #> 91  537.4409   2.596777   6 #> 92  525.3485   3.203759   6 #> 93  527.9900   2.570320   6 #> 94  539.8642   2.719230   6 #> 95  532.2306   2.915542   6 #> 96  619.9487   2.528474   6 #> 97  760.4934   2.572400   6 #> 98  528.4968   2.626860   6 #> 99  530.9980   3.521642   6 #> 100 525.2249   3.198671   6 #> 101 871.1365   2.577049   6 #> 102 525.3391   2.550169   6 #> 103 563.6968   3.010581   6 #> 104 550.5778   2.966203   6 #> 105 524.1140   2.965963   6 #>  #> [[8]] #>          ts magnitudes gen #> 1  706.2583   2.617214   7 #> 2  561.9587   5.152725   7 #> 3  537.9687   3.963626   7 #> 4  541.8793   2.751748   7 #> 5  552.9956   2.621019   7 #> 6  611.3805   2.880727   7 #> 7  843.2594   3.509593   7 #> 8  575.6528   2.863502   7 #> 9  544.7534   2.506451   7 #> 10 658.8651   2.937739   7 #> 11 543.9495   3.177625   7 #> 12 538.8473   2.914820   7 #> 13 543.9153   2.861745   7 #> 14 551.4079   2.929443   7 #> 15 657.7090   3.101461   7 #> 16 870.8355   2.954598   7 #> 17 867.0058   2.529177   7 #> 18 677.5046   2.509242   7 #> 19 701.8619   3.516677   7 #> 20 770.2319   2.989992   7 #> 21 772.6786   3.122653   7 #> 22 628.2207   2.511510   7 #> 23 621.8268   2.510760   7 #> 24 902.0921   2.616028   7 #>  #> [[9]] #>          ts magnitudes gen #> 1  562.2950   3.281056   8 #> 2  712.6172   2.900003   8 #> 3  562.2650   3.980944   8 #> 4  561.9897   3.181131   8 #> 5  686.7588   2.725978   8 #> 6  572.0113   2.644405   8 #> 7  654.7779   2.548686   8 #> 8  725.0494   2.883734   8 #> 9  572.8400   2.505539   8 #> 10 565.4858   3.136621   8 #> 11 754.4979   3.454403   8 #> 12 579.7338   2.951419   8 #> 13 565.7110   2.620857   8 #> 14 599.9924   2.793177   8 #> 15 565.0019   2.608179   8 #> 16 693.7341   2.712503   8 #> 17 564.3853   2.528503   8 #> 18 578.0579   3.087114   8 #> 19 562.0753   3.180747   8 #> 20 562.8265   2.567126   8 #> 21 562.1902   2.947880   8 #> 22 562.9842   2.697552   8 #> 23 569.9506   3.286850   8 #> 24 574.0475   2.506953   8 #> 25 561.9629   2.582344   8 #> 26 580.2001   3.963275   8 #> 27 539.6467   3.141304   8 #>  #> [[10]] #>         ts magnitudes gen #> 1 576.1982   2.617038   9 #> 2 562.3407   2.846236   9 #> 3 567.6591   2.652253   9 #> 4 571.5332   3.633152   9 #> 5 609.6848   4.262933   9 #> 6 591.0281   2.657210   9 #>  #> [[11]] #>         ts magnitudes gen #> 1 570.3526   3.425596  10 #> 2 572.5791   2.634358  10 #> 3 613.8224   2.503236  10 #> 4 611.3038   2.578084  10 #> 5 682.3371   2.757082  10 #>"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the posterior distribution of the expected number of events — get_posterior_N","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"Plot posterior distribution expected number events","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"","code":"get_posterior_N(input.list, domain.extension = 0.1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"input.list combined input file (link functions) bru output (marginals) domain.extension Percentage posterior quantiles extend domain specified scalar. Default set 0.10.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"list three objects: post.df: data.frame containing posterior informations posterior distribution number events post.plot : ggplot object showing posterior distribution expected number events post.plot.shaded : ggplot object showing posterior distribution expected number events, shaded region corresponds 0.025 0.975 quantiles distribution distribution number events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"Retrieve posterior distribution ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"","code":"get_posterior_param(input.list)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"input.list input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"list two elements: post.df : data.frame posterior distributions parameters columns x (value parameter), y (value posterior), param (parameter name) post.plot : ggplot object showing posterior distribution parameter","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS triggering function - used by inlabru — gt","title":"ETAS triggering function - used by inlabru — gt","text":"function returns value ETAS triggering function specified time t points history th, mh","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ETAS triggering function - used by inlabru — gt","text":"","code":"gt(theta, t, th, mh, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ETAS triggering function - used by inlabru — gt","text":"theta ETAS parameters list names K, alpha, c, p t Time function calculated, scalar vector th Time events history [days, months,...], scalar vector mh Magnitude events history, scalar vector M0 Minimum magnitude threshold, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ETAS triggering function - used by inlabru — gt","text":"value ETAS triggering function evaluated t history th, mh.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ETAS triggering function - used by inlabru — gt","text":"ETAS triggering function evaluated $$g(t - t_h | m_h) = K e^{\\alpha(m_h - M_0)} \\left( \\frac{t - t_h}{c} + 1\\right)^{-p}$$ \\(K, \\alpha, c > 0\\), \\(p \\geq 1\\) ETAS parameters, \\(t\\) (t) time function evaluated, considering past observation \\(t_h, m_h\\) (th, mh). function returns 0 \\(t_h > t\\). \\(t\\) scalar \\(t_h, m_h\\) vectors function returns vector, \\(t\\) vector \\(t_h, m_h\\) scalars, \\(t, t_h, m_h\\) vectors length. use \\(t\\) \\(t_h, m_h\\) vectors different lengths.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":null,"dir":"Reference","previous_headings":"","what":"HORUS Ita Catalogue — horus","title":"HORUS Ita Catalogue — horus","text":"HOmogenized instRUmental Seismic catalog (HORUS) Italy 1960 present, limited limited 1960-2019.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"HORUS Ita Catalogue — horus","text":"","code":"horus"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"HORUS Ita Catalogue — horus","text":"Original file format: Year: Origin Time (OT) year Mo: OT month Da: OT day Ho: OT hour Mi OT minute Se OT seconds fractions Lat epicenter N latitude (degrees) Lon epicenter E longitude (degrees) Depth hypocenter depth (km) Mw true proxy moment magnitude sigMw moment magnitude uncertainty Geo.Ita \"*\" indicates epicenter within Italian mainland territory, otherwise \" \" Geo.CPTI15 \"*\" indicates epicenter within spatial window CPTI15 catalog (Rovida et al., 2020, Bull Earth Eng, doi: 10.1007/s10518-020-00818-y) Ev..type \"x\" indicates event earthquake (e.g. explosion, eruption, landslide, ...) (since May 1st 2012) Iside.n. ISIDe id number (since April 16th 2005) ETAS.inlabru format: time_string: Data-time event, ISO 8601 format; format = \"%Y-%m-%dT%H:%M:%OS\" use .POSIXct() lon: Original Lon lat: Original Lat depth Original Depth M: Original Mw","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"HORUS Ita Catalogue — horus","text":"http://horus.bo.ingv./","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"HORUS Ita Catalogue — horus","text":"original entire HORUS catalog provided single tab separated ascii file: HORUS_Ita_Catalog.txt random second decimal digit added ML Md INGV bulletin (ISIDe) computing Mw proxies (Lolli et al., Seism. Res. Lett., 91, 3208-3222, doi: 10.1785/0220200148), HORUS_Ita_Catalog_o.txt original ML Md used compute Mw proxies. ETAS.inlabru includes reformatted version data HORUS_Ita_Catalog.txt data.frame, limited 1960-2019. data provided , express implied warranty given.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"HORUS Ita Catalogue — horus","text":"Barbara Lolli(1), Daniele Randazzo(1), Gianfranco Vannucci(1) Paolo Gasperini (2),(1) (2020). Homogenized Instrumental Seismic Catalog (HORUS) Italy 1960 Present, Seismol. Res. Lett, doi: 10.1785/0220200148. (1) Istituto Nazionale di Geofisica e Vulcanologia, Sezione di Bologna (2) Dipartimento di Fisica e Astronomia, Università di Bologna","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"Copula transformation Exponential standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"","code":"inv_exp_t(x, rate)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"x values Exponential distribution, vector. rate rate Exponential distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"Copula transformation Gamma standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"","code":"inv_gamma_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"x values Gamma distribution, vector. shape parameter Gamma distribution, scalar. b rate parameter Gamma distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"Copula transformation Log-Normal standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"","code":"inv_loggaus_t(x, m, s)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"x values Log-Normal distribution, vector. m mean logarithm Log-Normal distribution, scalar. s standard deviation logarithm Log-Normal distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"Copula transformation Uniform standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"","code":"inv_unif_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"x values Uniform distribution, vector. minimum Uniform distribution, scalar. b maximum Uniform distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the integral of the ETAS conditional intensity — lambda_N","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"Calculate number events time interval T1 T2 given imposed events ETAS","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"","code":"lambda_N(th.mu, th.K, th.alpha, th.c, th.p, T1, T2, M0, Ht, link.functions)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"th.mu Background rate, mu, internal parameter scale th.K ETAS triggering parameter K internal parameter scale th.alpha ETAS triggering parameter alpha internal parameter scale th.c ETAS triggering parameter c internal parameter scale th.p ETAS triggering parameter p internal parameter scale T1 Start temporal model domain. T2 End temporal model domain. M0 Minimum magnitude threshold Ht History process, set known events interval. must data.frame columns ts (time) magnitudes (magnitudes). link.functions list functions transform parameters internal scale ETAS scale","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"Integral ETAS conditional intensity T1 T2 minimum magnitude M0, .e. expected number events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":null,"dir":"Reference","previous_headings":"","what":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"Logarithm integral ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"","code":"log_Lambda_h(theta, th, mh, M0, T1, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"theta ETAS parameters data.frame(mu=mu, K=K, alpha=alpha, c=c, p=p). th Time parent event. mh Magnitude parent event M0 Minimum magnitude threshold T1 Start temporal model domain. T2 End temporal model domain.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"Logarithm integral ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"Copula transformation standard Normal distribution Log-Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"","code":"loggaus_t(x, m, s)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"x values standard Normal distribution, vector. m mean logarithm Log-Normal distribution, scalar. s standard deviation logarithm Log-Normal distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"Values Log-Normal distribution logarithmic mean m standard deviation s, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to calculate Omori's law — omori","title":"Function to calculate Omori's law — omori","text":"Function calculate Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to calculate Omori's law — omori","text":"","code":"omori(theta, t, ti)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to calculate Omori's law — omori","text":"theta ETAS parameters (list(mu = mu, K = K, alpha = alpha, c = c, p = p), parameters c p used t Time Omori's law evaluated ti Time event history","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to calculate Omori's law — omori","text":"Value Omori's law point t event happened ti","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"Function plot Omori's law corresponding different posterior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"","code":"omori_plot_posterior(   input.list,   post.samp = NULL,   n.samp = 10,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale post.samp data.frame containing posterior samples parameters. NULL, n.samp samples generated. n.samp different nrow(post.samp) n.samp rows uniformly sampled post.samp. Default NULL. n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"ggplot object","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"Function plot Omori's law corresponding different prior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"","code":"omori_plot_prior(input.list, n.samp = 10, t.end = 1, n.breaks = 100)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"input.list structured input list least one element: link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"ggplot object","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"Plot posterior densities ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"","code":"post_pairs_plot(   input.list = NULL,   n.samp = NULL,   post.samp = NULL,   max.batch = 1000 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp number samples draw posteriors plot post.samp data.frame columns mu, K, alpha, c, p rows corresponding different posterior samples. NULL function samples joint posterior distribution n.samp times. default NULL. max.batch parameter post_sampling function used case post.samp = NULL","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"list: elements post.samp.df:data.frame posterior samples nrow = n.samp columns mu, K, alpha, c, p corresponding ETAS parameters. post.samp NULL returns post.samp pair.plot: ggplot object reporting pair plot parameters samples. obtained using ggpairs function Ggally library","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from the posterior of the ETAS parameters — post_sampling","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"Sample posterior ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"","code":"post_sampling(input.list, n.samp, max.batch = 1000, ncore = 1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp number samples draw posteriors max.batch Maximum number posterior samples generated simultaneously. Default 1000. ncore Number cores used n.samp exceeds max.batch. Default 1","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"data.frame posterior samples nrow = n.samp columns mu, K, alpha, c, p corresponding ETAS parameters.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":null,"dir":"Reference","previous_headings":"","what":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"Return sample magnitudes drawn GR distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"","code":"sample_GR_magnitudes(n, beta.p, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"n Number events sample. beta.p Related b-value via b ln(10). M0 Minimum magnitude sample.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"list magnitudes length n drawn GR distribution.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"","code":"sample_GR_magnitudes(n = 100, beta.p = log(10), M0 = 2.5) #>   [1] 2.565276 2.655549 2.569139 2.501348 2.621134 2.863835 3.951483 2.662309 #>   [9] 3.151434 2.852220 3.695151 3.367160 2.530887 2.875541 2.861103 5.086882 #>  [17] 2.526571 2.684223 2.879123 4.286285 2.627990 2.916647 2.628079 2.546219 #>  [25] 2.714801 2.701172 2.602952 3.073764 2.942081 3.022327 2.570992 3.044000 #>  [33] 3.293238 2.648600 2.890063 2.591994 2.674703 2.680624 2.586984 3.192044 #>  [41] 2.803385 2.727180 2.878512 3.014003 3.449880 2.755975 2.628730 3.061200 #>  [49] 2.517700 3.192936 2.666113 3.253941 3.668454 2.774410 2.656357 3.720594 #>  [57] 2.529600 2.612591 2.614557 2.904233 3.037120 2.781924 2.615917 3.278323 #>  [65] 3.460555 2.589337 2.799001 2.552430 2.591576 2.894900 3.288935 2.979786 #>  [73] 2.514374 2.507744 3.301460 3.292746 3.135457 2.538304 2.772561 2.598416 #>  [81] 2.568976 2.634589 2.658002 2.836325 3.198680 3.270320 3.104304 2.568132 #>  [89] 2.942378 2.732049 2.987930 2.561954 2.546024 3.150199 2.505936 2.822833 #>  [97] 2.630371 3.094246 2.802842 2.573921"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"Generate sample new events data.frame(t_i, M_i) length n.ev one parent event occuring time t_h using ETAS model.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"","code":"sample_temporal_ETAS_daughters(theta, beta.p, th, n.ev, M0, T1, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). th Time parent event [days]. n.ev number events placed. M0 Minimum magnitude synthetic catalogue. T1 Start time synthetic catalogue [days]. T2 End time synthetic catalogue [days].","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"Generate sample new events data.frame(t_i, M_i) one parent","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":null,"dir":"Reference","previous_headings":"","what":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"Take previous parent events Ht=data.frame[ts, magnitudes] generates daughters events using ETAS model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"","code":"sample_temporal_ETAS_generation(theta, beta.p, Ht, M0, T1, T2, ncore = 1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). Ht set parent events form data.frame[ts, magnitudes] M0 minimum earthquake magnitude synthetic catalogue. T1 start time synthetic catalogue [days]. T2 end time synthetic catalogue [days]. ncore number compute cores use","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"Return one generation daughters parents Ht form data.frame(t_i, M_i).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"","code":"# The parents are specified in Ht Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) sample_temporal_ETAS_generation(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000,   Ht = Ht ) #>           ts magnitudes #> 1   500.0717   3.453707 #> 2   506.0749   2.529286 #> 3   516.3410   3.426739 #> 4   502.1214   3.174202 #> 5   502.3496   3.230961 #> 6   512.5852   2.750375 #> 7   501.1835   2.965594 #> 8   512.8956   3.878631 #> 9   500.1337   2.880985 #> 10  500.2200   2.591981 #> 11  500.7164   3.245264 #> 12  561.8029   2.675096 #> 13  508.1163   2.675352 #> 14  500.0602   3.999008 #> 15  568.1226   3.575782 #> 16  501.2717   2.542212 #> 17  505.1563   2.503378 #> 18  549.7401   3.866972 #> 19  503.2262   3.512208 #> 20  501.8759   3.003222 #> 21  500.1004   2.576449 #> 22  505.5560   2.822620 #> 23  500.0215   2.660315 #> 24  529.5737   2.791504 #> 25  560.4576   6.276101 #> 26  501.5590   3.126955 #> 27  507.8161   2.922698 #> 28  500.0929   2.645258 #> 29  604.0835   3.362029 #> 30  547.2289   4.273454 #> 31  622.9816   2.757150 #> 32  518.2629   2.925576 #> 33  506.3781   2.636429 #> 34  500.1045   3.840160 #> 35  505.1267   3.922096 #> 36  501.8180   2.924844 #> 37  500.3884   2.584050 #> 38  500.0287   2.805132 #> 39  501.1986   2.749444 #> 40  506.4577   3.296246 #> 41  500.2678   3.982940 #> 42  500.1125   3.014698 #> 43  500.6836   3.060919 #> 44  500.1441   3.113571 #> 45  587.4116   2.649692 #> 46  502.8802   2.852479 #> 47  698.6924   2.867545 #> 48  500.1344   2.681538 #> 49  500.0254   2.748629 #> 50  516.8511   3.014539 #> 51  501.6246   2.928749 #> 52  500.5201   2.612579 #> 53  624.8629   2.875905 #> 54  845.5875   2.767620 #> 55  552.3102   3.678264 #> 56  510.0117   2.877688 #> 57  596.9706   2.530618 #> 58  650.8277   4.225801 #> 59  664.2730   2.516287 #> 60  500.7296   2.546108 #> 61  500.2559   2.552475 #> 62  526.8880   2.980740 #> 63  536.6431   3.322838 #> 64  739.2400   2.892341 #> 65  524.3895   2.514960 #> 66  500.1525   2.627163 #> 67  643.6469   3.022966 #> 68  500.0497   2.771565 #> 69  502.3029   3.057833 #> 70  509.7369   2.777163 #> 71  500.4821   2.543549 #> 72  500.2002   2.871168 #> 73  505.2733   3.737428 #> 74  500.0650   2.843195 #> 75  500.0314   2.694367 #> 76  500.0675   2.698897 #> 77  500.3830   2.700967 #> 78  504.9436   2.936576 #> 79  500.0601   2.504675 #> 80  687.4828   4.013515 #> 81  509.9752   2.529638 #> 82  500.1253   2.795661 #> 83  500.0056   3.824551 #> 84  660.2210   3.293338 #> 85  504.3134   2.713807 #> 86  503.2392   2.812662 #> 87  500.1015   2.586029 #> 88  501.1067   2.626274 #> 89  500.8063   2.590968 #> 90  500.6235   2.839161 #> 91  500.0316   4.919135 #> 92  500.9585   3.238806 #> 93  735.6464   3.200827 #> 94  534.7870   2.621557 #> 95  500.7507   4.584412 #> 96  500.4322   2.667790 #> 97  500.0662   2.706199 #> 98  502.7013   2.566986 #> 99  500.2593   2.577214 #> 100 504.6771   3.078698 #> 101 500.0868   2.562237 #> 102 522.7759   2.757345 #> 103 518.9310   2.624212 #> 104 500.9289   2.825999 #> 105 500.1442   2.972981 #> 106 500.0646   2.527181 #> 107 605.1972   3.565323 #> 108 501.9452   2.568555 #> 109 510.1841   2.602218 #> 110 500.0035   2.520814 #> 111 500.1260   2.820689 #> 112 500.2142   3.338204 #> 113 500.1429   3.203350 #> 114 500.4042   2.811102 #> 115 503.9594   2.787906 #> 116 501.7121   2.504941 #> 117 500.0075   2.732289 #> 118 500.3199   2.759778 #> 119 581.3335   2.555747 #> 120 505.7954   3.276966 #> 121 500.4134   2.898418 #> 122 500.2395   3.332119 #> 123 500.2586   2.676535 #> 124 952.8005   3.876072 #> 125 507.7374   2.852140 #> 126 500.0759   3.494795 #> 127 501.5792   2.522097 #> 128 500.1031   2.525891 #> 129 549.6548   2.617949 #> 130 500.4104   3.480905 #> 131 505.6270   2.980113 #> 132 849.3889   4.078952 #> 133 557.0826   2.971443 #> 134 503.8468   3.219703 #> 135 513.3607   2.535134 #> 136 504.2148   3.101790 #> 137 939.4436   3.258852 #> 138 500.1580   2.654896 #> 139 500.0079   2.858392 #> 140 515.6164   3.015800 #> 141 500.4393   3.177124 #> 142 657.2280   3.235162 #> 143 500.0130   2.867578 #> 144 899.2475   2.597263 #> 145 501.0858   2.788444 #> 146 500.1109   2.537485 #> 147 697.3846   3.647115 #> 148 507.5607   2.986524 #> 149 780.0773   3.261970 #> 150 527.2769   3.123584 #> 151 501.2794   2.603042 #> 152 500.2294   2.772446 #> 153 508.1802   2.957318 #> 154 602.5042   3.710434 #> 155 530.6086   2.545729 #> 156 528.8240   2.771289 #> 157 999.3802   3.749975 #> 158 520.5470   2.568214 #> 159 511.2973   2.695098 #> 160 502.0136   3.112070 #> 161 533.5898   3.010525 #> 162 537.8894   2.902829 #> 163 500.2855   3.462181 #> 164 716.5296   2.601028 #> 165 502.7853   2.524135 #> 166 584.4195   4.828081 #> 167 500.6677   4.126749 #> 168 511.3998   2.677130 #> 169 539.3545   2.511768 #> 170 500.1595   3.118983 #> 171 500.6125   2.605345 #> 172 743.9896   2.806542 #> 173 502.8122   3.239850 #> 174 511.6211   2.754167 #> 175 500.0210   2.650452 #> 176 504.2870   3.481934 #> 177 749.3790   3.413402 #> 178 502.3012   2.561737 #> 179 500.2200   2.774719 #> 180 500.8433   3.084428 #> 181 509.1451   3.404427 #> 182 570.2851   3.250004 #> 183 909.8775   3.119626 #> 184 501.3461   3.359405 #> 185 506.7520   2.940531 #> 186 957.4850   4.034864 #> 187 582.7395   2.516748 #> 188 502.4455   2.595839 #> 189 581.0442   4.220864 #> 190 500.0069   2.533714 #> 191 690.7149   2.898934 #> 192 502.3406   3.628957 #> 193 654.3754   4.127757 #> 194 500.3752   2.592071 #> 195 691.2102   3.255963 #> 196 535.0081   2.525262 #> 197 505.3451   2.536402 #> 198 502.8826   4.280910 #> 199 746.9444   2.833670 #> 200 607.7496   2.743920 #> 201 500.2311   3.066688 #> 202 512.4035   2.509388 #> 203 500.1731   3.092312 #> 204 506.7850   2.861804 #> 205 502.0690   3.213544 #> 206 500.6755   3.256082 #> 207 812.9303   2.857160 #> 208 500.3234   2.739586 #> 209 542.6052   3.079441 #> 210 503.6086   2.602474 #> 211 500.3426   2.990737 #> 212 524.7825   2.828104 #> 213 500.2685   2.524985 #> 214 504.3884   2.584638 #> 215 500.5970   2.677392 #> 216 504.3492   2.662315 #> 217 500.4797   3.289944 #> 218 524.7800   2.798315 #> 219 500.8802   2.501258 #> 220 501.8621   2.689807 #> 221 500.6754   2.506029 #> 222 593.9593   2.985496 #> 223 598.4565   2.632531 #> 224 500.0209   2.690942 #> 225 503.6857   2.801385 #> 226 501.3840   2.717143 #> 227 500.0765   3.104896 #> 228 510.4952   2.997495 #> 229 500.7852   2.581962 #> 230 697.3344   2.739533 #> 231 501.0571   3.139646 #> 232 538.1203   2.988208 #> 233 673.7881   2.784061 #> 234 526.7652   2.544372 #> 235 500.0474   2.975046 #> 236 591.9784   2.695030 #> 237 608.1392   2.521250 #> 238 503.8255   2.819657 #> 239 517.2993   3.771731 #> 240 500.0396   3.354404 #> 241 500.0620   3.181469 #> 242 500.8694   2.575961 #> 243 564.8961   2.937534 #> 244 502.0319   2.745673 #> 245 504.2723   3.010350 #> 246 530.6165   3.744146 #> 247 500.5113   2.600277 #> 248 500.4337   3.447394 #> 249 537.0884   3.009539 #> 250 500.1300   4.366351 #> 251 500.6442   2.619873 #> 252 838.5042   3.296875 #> 253 502.2900   2.865756 #> 254 502.6407   3.327178 #> 255 511.3193   3.029974 #> 256 500.3676   3.134517 #> 257 501.9215   4.395136 #> 258 500.0957   2.574446 #> 259 500.4351   2.580949 #> 260 502.4115   2.578077 #> 261 502.9002   3.566210 #> 262 651.9349   3.012166 #> 263 503.4724   2.706484 #> 264 500.6696   2.819966 #> 265 500.6843   3.489902 #> 266 500.2333   2.678603 #> 267 500.0578   4.424906 #> 268 500.7005   3.221507 #> 269 500.9025   2.558645 #> 270 509.9863   2.550340 #> 271 785.3392   2.669033 #> 272 507.9010   3.000490 #> 273 500.0500   3.771966 #> 274 935.8343   2.706808 #> 275 529.5627   3.322572 #> 276 964.2172   2.634403 #> 277 560.8036   3.087899 #> 278 613.7336   2.530096 #> 279 500.7987   3.141701 #> 280 500.7463   2.561893 #> 281 500.5408   3.612086 #> 282 507.0553   2.839386 #> 283 500.1188   2.589585 #> 284 671.7984   3.029164 #> 285 504.0983   2.651355 #> 286 500.2218   2.873037 #> 287 584.9894   2.600956 #> 288 578.4510   4.401286 #> 289 500.3605   2.536749 #> 290 503.8051   2.592987 #> 291 736.2800   2.625949 #> 292 715.6761   2.620462 #> 293 509.8882   2.696933 #> 294 500.6773   3.372236 #> 295 501.2511   3.032029 #> 296 500.1285   2.685849 #> 297 500.0946   2.718117 #> 298 569.3822   3.330695 #> 299 519.7821   2.909514 #> 300 522.1809   2.848821 #> 301 519.0032   2.589482 #> 302 500.4026   2.995296 #> 303 500.3379   2.599294 #> 304 529.6715   2.742419 #> 305 500.1728   3.441325 #> 306 500.0952   2.521750 #> 307 500.2107   3.499099 #> 308 537.5172   2.519626 #> 309 617.7911   2.514584 #> 310 500.2390   3.035725 #> 311 597.9621   2.647188 #> 312 812.3976   2.822488 #> 313 503.7035   2.607946 #> 314 522.5498   2.702323 #> 315 500.0242   2.790227 #> 316 501.6468   2.739210 #> 317 820.0041   2.619937 #> 318 506.8198   3.971992 #> 319 504.4688   2.721397 #> 320 500.9794   3.232102 #> 321 638.8177   3.459139 #> 322 952.3991   2.901361 #> 323 503.8397   3.281490 #> 324 500.5540   3.031240 #> 325 510.4341   2.914478 #> 326 500.2409   2.559534 #> 327 500.0708   2.621474 #> 328 500.1781   2.672474 #> 329 503.9213   2.859091 #> 330 500.0395   2.796704 #> 331 503.3500   2.835858 #> 332 500.5857   2.732817 #> 333 500.3170   4.148115 #> 334 517.1171   2.561682 #> 335 635.7574   2.604901 #> 336 507.4556   2.601981 #> 337 519.7470   2.845813 #> 338 740.1841   3.340809 #> 339 500.0725   2.792592 #> 340 503.3541   2.744470 #> 341 631.6661   2.571209 #> 342 504.1528   2.500621 #> 343 502.8619   2.662177 #> 344 500.0214   2.937944 #> 345 501.3220   3.082927 #> 346 513.1323   2.804631 #> 347 500.1719   3.201421 #> 348 500.9110   2.544485 #> 349 500.0167   3.432632 #> 350 513.6375   3.645755 #> 351 762.9941   2.929590 #> 352 501.6672   2.869965 #> 353 519.7294   3.459364 #> 354 517.8919   2.626446 #> 355 513.4228   2.604451 #> 356 500.1553   2.609077 #> 357 502.0958   3.061470 #> 358 565.3216   2.828962 #> 359 591.7238   2.710911 #> 360 517.7610   2.804905 #> 361 501.0458   2.875400 #> 362 500.3934   2.557672 #> 363 500.7865   3.011663 #> 364 500.1256   2.928465 #> 365 502.5870   3.371744 #> 366 504.1514   2.721888 #> 367 501.7055   2.508914 #> 368 505.1841   2.697247 #> 369 500.5957   2.983005 #> 370 516.8893   3.365529 #> 371 502.9785   3.254286 #> 372 501.0465   2.720839 #> 373 500.2652   2.604519 #> 374 512.6087   2.946172 #> 375 747.7676   2.784033 #> 376 502.9212   2.829413 #> 377 510.2947   3.166143 #> 378 517.7753   3.096165 #> 379 507.1268   2.908039 #> 380 501.7242   2.727349 #> 381 500.1332   2.630867 #> 382 500.0755   2.680610 #> 383 500.8264   6.105941 #> 384 500.3735   2.944838 #> 385 764.8490   2.668506 #> 386 501.3693   2.647305 #> 387 500.0196   2.556291 #> 388 500.8614   2.886664 #> 389 530.3864   2.559336 #> 390 525.9736   4.168153 #> 391 696.9971   2.811017 #> 392 501.0771   2.814390 #> 393 500.0091   3.231032 #> 394 500.0136   2.539618 #> 395 515.0360   3.450079 #> 396 747.2252   2.502153 #> 397 510.5733   2.764726 #> 398 610.7412   2.880409 #> 399 500.2232   3.184637 #> 400 500.0274   3.424069 #> 401 555.6243   2.656881 #> 402 507.3192   2.585540 #> 403 915.9260   3.142708 #> 404 547.0321   3.720351 #> 405 541.6295   3.014297 #> 406 500.6276   2.747268 #> 407 993.2813   2.607915 #> 408 500.1665   2.744274 #> 409 582.1392   3.190746 #> 410 500.0112   2.509671 #> 411 500.0126   3.010292 #> 412 500.2049   2.814569 #> 413 521.3971   3.731056 #> 414 504.6374   2.561887 #> 415 657.7165   2.539676 #> 416 553.2551   2.567428 #> 417 942.6823   2.582530 #> 418 552.6477   2.875706 #> 419 503.3626   2.546187 #> 420 571.6431   2.569597 #> 421 583.5381   3.719871 #> 422 501.1510   2.530868 #> 423 500.8382   2.941573 #> 424 502.2185   4.231973 #> 425 500.0025   2.915349 #> 426 544.7895   2.580764 #> 427 551.0074   2.787058 #> 428 965.5944   3.059514 #> 429 546.2589   3.105389 #> 430 506.4902   2.653913 #> 431 500.3570   2.745562 #> 432 511.3728   2.762814 #> 433 501.2083   2.595544 #> 434 500.4913   4.397412 #> 435 679.5535   2.510461 #> 436 683.0947   3.225581 #> 437 500.5198   2.630009 #> 438 500.0965   3.678189 #> 439 502.0442   2.936710 #> 440 500.3324   3.049316 #> 441 506.0229   2.575060 #> 442 512.6805   2.549186 #> 443 500.6214   3.508419 #> 444 500.0560   2.544235 #> 445 529.0074   2.660304 #> 446 688.5242   2.516122 #> 447 501.5657   3.044979 #> 448 500.1900   2.711620 #> 449 507.9947   2.908489 #> 450 500.0707   2.620181 #> 451 536.6590   2.888422 #> 452 514.7259   3.057380 #> 453 511.2936   2.600885 #> 454 500.2869   2.520475 #> 455 511.8090   2.715919 #> 456 536.7047   3.008004 #> 457 500.0480   2.980669 #> 458 622.4769   2.639082 #> 459 500.0559   3.079627 #> 460 500.0560   2.561305 #> 461 540.1189   3.042211 #> 462 502.6783   3.243754 #> 463 500.0740   2.845753 #> 464 869.6736   2.574489 #> 465 676.8067   2.501293 #> 466 500.1144   3.069313 #> 467 500.0182   2.859768 #> 468 511.7678   2.873943 #> 469 501.1140   2.510570 #> 470 501.9854   2.771747 #> 471 501.0033   2.635835 #> 472 506.7687   3.050306 #> 473 506.7578   3.600629 #> 474 539.8697   3.127426 #> 475 515.4804   2.556169 #> 476 567.1111   2.597622 #> 477 500.8136   4.081328 #> 478 897.8623   2.593751 #> 479 502.9617   2.622018 #> 480 770.5566   2.541044 #> 481 573.3299   2.703000 #> 482 501.2274   2.842335 #> 483 500.3259   2.547604 #> 484 502.9003   3.404123 #> 485 500.2517   4.805275 #> 486 507.2176   3.720035 #> 487 757.4920   2.790087 #> 488 500.1295   2.887646 #> 489 571.5333   2.625211 #> 490 601.5823   2.997998 #> 491 545.3659   2.674529 #> 492 500.2673   2.668516 #> 493 501.0005   2.814781 #> 494 500.0647   2.561945 #> 495 502.1544   2.615332 #> 496 660.1273   2.624816 #> 497 500.0344   2.784005 #> 498 501.8510   3.811851 #> 499 516.9570   2.617718 #> 500 508.2324   2.665957 #> 501 954.0769   2.507258 #> 502 513.9400   2.740342 #> 503 529.1898   2.716385 #> 504 504.1967   2.501456 #> 505 503.3231   2.677035 #> 506 500.7206   3.075138 #> 507 511.8188   2.898027 #> 508 500.0284   2.525671 #> 509 503.5587   2.777250 #> 510 502.0927   2.982671 #> 511 561.0042   2.593883 #> 512 501.9426   2.947500 #> 513 500.4233   2.663855 #> 514 536.2922   3.090624 #> 515 500.0652   2.524999 #> 516 513.2498   2.579275 #> 517 589.2059   2.742504 #> 518 500.2142   3.707108 #> 519 500.5537   2.956937 #> 520 543.6508   4.041690 #> 521 500.0734   2.860012 #> 522 720.0034   2.762549 #> 523 524.6512   2.978998 #> 524 500.1300   3.014113 #> 525 503.7365   3.058424 #> 526 500.0049   2.544180 #> 527 500.3420   2.530377 #> 528 524.6887   3.106659 #> 529 504.5635   2.529333 #> 530 523.3616   2.579977 #> 531 500.4888   2.502998 #> 532 500.0943   4.280882 #> 533 503.4324   2.502671 #> 534 500.0015   2.683904 #> 535 503.0455   3.848446 #> 536 500.2797   2.606296 #> 537 500.0738   2.933434 #> 538 500.5714   2.519041 #> 539 500.0344   2.942002 #> 540 500.2181   3.660511 #> 541 559.0907   3.685203 #> 542 501.0611   2.621483 #> 543 503.7590   3.563917 #> 544 506.7534   2.599769 #> 545 500.0302   2.586741 #> 546 502.0168   2.548679 #> 547 500.1746   2.681149 #> 548 538.2979   2.663542 #> 549 501.3471   4.012534 #> 550 502.7609   2.752077 #> 551 501.1757   3.059744 #> 552 501.3783   2.629219 #> 553 566.2829   3.475180 #> 554 500.0687   3.286313 #> 555 500.0848   3.100491 #> 556 540.7575   2.513239 #> 557 501.7644   2.930260 #> 558 528.9146   3.759917 #> 559 500.1871   2.783167 #> 560 665.6989   3.676397 #> 561 500.7615   2.553795 #> 562 501.4023   3.145077 #> 563 505.5156   3.073462 #> 564 507.2500   2.963874 #> 565 776.9231   2.726919 #> 566 501.3781   3.677090 #> 567 642.3671   3.440731 #> 568 500.2491   2.682176 #> 569 518.9457   3.782098 #> 570 500.1350   3.129065 #> 571 650.2866   3.045144 #> 572 500.5180   3.485397 #> 573 906.1386   2.760381 #> 574 501.3841   3.400607 #> 575 500.7773   2.920135 #> 576 501.6060   2.504360 #> 577 512.0912   2.544316 #> 578 503.3101   2.745467 #> 579 500.0938   3.057334 #> 580 500.0412   2.534340 #> 581 510.4309   3.339657 #> 582 500.5547   3.811197 #> 583 500.0964   3.708994 #> 584 500.1928   2.807200 #> 585 504.7545   2.609763 #> 586 500.1039   2.974238 #> 587 556.7624   3.154712 #> 588 501.0184   2.760818 #> 589 507.2936   2.550319 #> 590 883.5328   3.013458 #> 591 802.0053   3.142708 #> 592 500.2212   2.557466 #> 593 503.2342   2.879537 #> 594 500.2809   3.049874 #> 595 502.0200   2.556798 #> 596 506.4429   2.509604 #> 597 500.2470   2.931914 #> 598 500.3395   4.012424 #> 599 597.3235   2.547287 #> 600 512.3549   2.792215 #> 601 500.9189   3.119101 #> 602 500.0365   2.560755 #> 603 500.7202   4.571852 #> 604 550.4353   3.382226 #> 605 613.7590   2.601595 #> 606 500.4669   3.698840 #> 607 501.4535   2.838393 #> 608 612.0715   3.376918 #> 609 655.3036   2.748688 #> 610 500.4664   2.779788 #> 611 500.0165   2.785110 #> 612 500.0125   2.943453 #> 613 509.1615   2.555709 #> 614 501.1767   3.860483 #> 615 500.2136   2.798458 #> 616 823.3242   2.966284 #> 617 502.9640   2.638465 #> 618 500.0152   3.479158 #> 619 500.0688   2.688062 #> 620 610.7388   2.868644 #> 621 501.7318   2.648853 #> 622 500.0124   2.897859 #> 623 539.3736   3.195622 #> 624 500.0918   2.724907 #> 625 500.0512   2.927225 #> 626 508.1905   2.694677 #> 627 500.0872   3.027947 #> 628 500.1018   3.716529 #> 629 583.8582   2.520257 #> 630 504.5051   2.565250 #> 631 500.5108   2.733877 #> 632 532.5557   2.714936 #> 633 501.8359   2.747939 #> 634 931.4182   2.700237 #> 635 501.6075   3.096748 #> 636 579.9381   2.754347 #> 637 500.6911   2.788636 #> 638 528.6816   2.821029 #> 639 500.0399   2.613585 #> 640 501.2827   2.602591 #> 641 503.2717   3.506729 #> 642 596.1308   2.749590 #> 643 531.3118   2.973482 #> 644 515.7566   2.539658 #> 645 500.1676   3.401226 #> 646 500.1373   2.558884 #> 647 500.0019   3.092394 #> 648 529.8376   3.287831 #> 649 500.1245   2.678568 #> 650 500.2171   2.959003 #> 651 500.2316   2.587883 #> 652 500.2829   2.551997 #> 653 572.7987   3.259273 #> 654 500.2338   2.569926 #> 655 515.8346   2.536424 #> 656 602.8563   2.585897 #> 657 500.0604   2.903670 #> 658 506.0232   3.074128 #> 659 500.0140   2.655820 #> 660 500.4106   2.591458 #> 661 500.1296   3.365149 #> 662 500.2472   3.312883 #> 663 567.3727   2.742127 #> 664 503.6998   3.333127 #> 665 500.0482   2.980054 #> 666 530.9380   2.616799 #> 667 501.0876   2.718865 #> 668 530.2364   3.155751 #> 669 500.3778   2.723314 #> 670 503.8917   2.840968 #> 671 520.2524   2.506291 #> 672 501.6387   3.140282 #> 673 736.0325   2.873692 #> 674 506.5673   2.983976 #> 675 503.1729   2.634152 #> 676 500.0221   2.589039 #> 677 504.6011   2.610869 #> 678 500.0389   2.543183 #> 679 500.1156   2.688541 #> 680 503.8659   2.534351 #> 681 500.0192   3.127004 #> 682 562.9950   2.774551 #> 683 500.2888   3.104758 #> 684 533.7616   2.879585 #> 685 502.1357   2.917518 #> 686 529.9418   2.665866 #> 687 583.9725   3.547036 #> 688 611.8608   2.779262 #> 689 644.7689   2.854240 #> 690 508.6773   2.675383 #> 691 501.0753   2.993197 #> 692 500.5699   3.848593 #> 693 500.2481   2.678592 #> 694 500.0869   2.812222 #> 695 723.9309   3.189055 #> 696 503.7772   3.623157 #> 697 500.2436   3.274780 #> 698 502.9553   2.926759 #> 699 500.4418   2.563086 #> 700 506.2924   2.605155 #> 701 501.0407   2.799053 #> 702 500.2322   3.234876 #> 703 503.5155   2.502666 #> 704 500.9245   3.142456 #> 705 533.7754   2.617737 #> 706 507.7769   2.509777 #> 707 513.7162   2.973536 #> 708 508.2645   2.902927 #> 709 500.1084   2.587188 #> 710 677.2767   2.706905 #> 711 509.6885   2.612232 #> 712 774.1737   3.043685 #> 713 500.9180   2.697102 #> 714 500.0006   3.356873 #> 715 506.0727   2.811473 #> 716 501.3380   2.708866 #> 717 508.6573   2.585006 #> 718 500.1590   3.103977 #> 719 529.1279   2.686771 #> 720 500.1440   2.521418 #> 721 500.0132   2.561385 #> 722 500.0033   3.155222 #> 723 520.8238   2.517078 #> 724 518.6678   2.924216 #> 725 500.0005   2.723714 #> 726 899.9996   3.283917 #> 727 501.8544   2.685869 #> 728 500.7231   2.802546 #> 729 527.8105   2.593590 #> 730 683.1216   3.835831 #> 731 634.0061   2.564039 #> 732 552.8904   2.596883 #> 733 501.1528   3.359592 #> 734 500.0692   3.173365 #> 735 500.1573   3.695331 #> 736 517.3997   3.167914 #> 737 505.4388   2.603285 #> 738 500.0821   2.565384 #> 739 502.5748   3.139286 #> 740 500.4843   2.958031 #> 741 500.2422   2.570667 #> 742 526.0185   2.724569 #> 743 562.3205   2.633884 #> 744 537.0152   2.653863 #> 745 505.1705   3.069749 #> 746 500.2738   2.893216 #> 747 511.4717   3.444438 #> 748 500.3561   2.631724 #> 749 501.4090   2.581941 #> 750 500.0247   3.034164 #> 751 606.5525   2.751947 #> 752 750.0074   3.710610 #> 753 502.3032   2.551911 #> 754 501.4489   2.551249 #> 755 501.1921   2.789268 #> 756 500.0480   3.567637 #> 757 580.8782   2.735397 #> 758 503.0604   2.936493 #> 759 527.9928   3.095277 #> 760 522.1866   2.880557 #> 761 510.7037   2.711044 #> 762 502.5470   2.899384 #> 763 519.3954   3.154207 #> 764 500.4069   2.707337 #> 765 513.9206   2.667278 #> 766 500.0151   2.668443 #> 767 555.8430   3.173660 #> 768 509.9646   3.446033 #> 769 500.3104   2.600194 #> 770 500.1726   2.505101 #> 771 539.7504   2.819618 #> 772 500.0249   2.861929 #> 773 500.0990   3.880381 #> 774 509.0718   2.902040 #> 775 500.6074   2.668026 #> 776 500.0064   2.721211 #> 777 711.0241   2.774896 #> 778 513.7860   4.226827 #> 779 526.3135   4.782584 #> 780 513.6965   2.590145 #> 781 500.5506   2.527592 #> 782 500.4356   2.610328 #> 783 508.2793   3.336443 #> 784 500.3369   2.920256 #> 785 505.5538   2.804495 #> 786 501.4598   3.267751 #> 787 502.8225   3.051214 #> 788 504.1958   2.796318 #> 789 520.4978   3.289438 #> 790 505.3604   2.983716 #> 791 571.8665   3.008115 #> 792 502.1707   2.529509 #> 793 504.7307   2.539463 #> 794 580.3164   2.541388 #> 795 500.1020   3.138889 #> 796 510.1676   3.531525 #> 797 504.7302   2.561862 #> 798 504.9687   3.383316 #> 799 512.2004   2.968434 #> 800 517.2237   2.663686 #> 801 501.6535   4.986151 #> 802 568.3209   2.955461 #> 803 509.5339   2.754980 #> 804 501.3509   2.607603 #> 805 730.3498   3.205933 #> 806 506.3059   2.969172 #> 807 500.6028   2.534880 #> 808 512.5698   3.031277 #> 809 500.0817   2.695582 #> 810 549.4227   2.568756 #> 811 500.0308   2.511031 #> 812 588.9783   3.288928 #> 813 552.9446   3.135243 #> 814 650.6820   4.537243 #> 815 501.1637   2.537460 #> 816 500.4967   2.873500 #> 817 500.8100   2.655872 #> 818 572.1226   3.097525 #> 819 500.4707   2.794882 #> 820 500.7296   3.037802 #> 821 573.9647   4.120137 #> 822 500.0020   2.690350 #> 823 501.8083   2.771189 #> 824 627.0301   3.019266 #> 825 500.5264   3.574944 #> 826 536.1121   2.539839 #> 827 500.2320   3.382797 #> 828 504.4685   2.899507 #> 829 500.2971   2.631316 #> 830 531.0579   2.624980 #> 831 500.3778   3.219746 #> 832 501.3052   3.693502 #> 833 500.1086   2.609276 #> 834 602.2894   3.063102 #> 835 980.4866   3.450848 #> 836 502.1971   2.635313 #> 837 500.1218   3.056664 #> 838 509.3655   3.094109 #> 839 500.0728   2.567077 #> 840 500.1320   2.541121 #> 841 524.6731   2.752522 #> 842 599.5166   3.028552 #> 843 558.0934   2.750220 #> 844 623.9578   2.808681 #> 845 500.0500   3.519305 #> 846 508.4367   2.712108 #> 847 500.0084   4.989126 #> 848 500.5116   2.521905 #> 849 501.1624   3.036200 #> 850 500.0100   2.660185 #> 851 508.4807   3.508302 #> 852 502.6030   2.711405 #> 853 777.0160   2.903972 #> 854 502.5080   3.408150 #> 855 500.5941   2.529898 #> 856 694.4080   3.654366 #> 857 500.1032   2.572516 #> 858 521.3080   2.777297 #> 859 500.0258   2.686750 #> 860 502.2609   3.267591 #> 861 511.6940   2.595862 #> 862 500.7239   2.528410 #> 863 632.6069   3.807510 #> 864 504.1548   2.976873 #> 865 663.7112   2.552453 #> 866 508.9192   2.736892 #> 867 500.0730   3.279986 #> 868 501.0473   2.679459 #> 869 504.0591   2.626460 #> 870 510.6884   3.527181 #> 871 500.1620   2.529851 #> 872 582.5208   2.865481 #> 873 500.1698   2.662057 #> 874 500.5948   3.123325 #> 875 502.0405   3.151910 #> 876 500.1882   2.800239 #> 877 503.2367   3.089753 #> 878 501.8408   3.032616 #> 879 500.0335   2.596116 #> 880 501.0093   2.735498 #> 881 508.9585   2.886702 #> 882 500.7314   2.801083 #> 883 504.4081   2.779041 #> 884 500.5288   2.823209 #> 885 500.0162   2.634351 #> 886 500.2003   2.676653 #> 887 989.4304   2.842688 #> 888 747.5208   2.623019 #> 889 500.2161   2.577480 #> 890 501.9546   2.628454 #> 891 560.5758   2.723309 #> 892 500.9177   2.662173 #> 893 500.0630   2.793867 #> 894 670.1112   2.545689 #> 895 501.9035   4.381606 #> 896 501.3676   3.776732 #> 897 501.0206   3.382211 #> 898 500.0007   2.744994 #> 899 500.8685   4.158614 #> 900 513.4735   2.645749"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":null,"dir":"Reference","previous_headings":"","what":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"Sampling times events triggered parent th according ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"","code":"sample_temporal_ETAS_times(theta, n.ev, th, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). n.ev Number events return sample time domain (th, T2]. th Time parent event producing n.ev daughters. T2 End time model domain.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"t.sample list times interval [0, T2] distributed according ETAS triggering function.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — sample_temporal_injection_events","title":"Title — sample_temporal_injection_events","text":"Title","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — sample_temporal_injection_events","text":"","code":"sample_temporal_injection_events(   a = 50,   V.i = 1,   tau = 10,   beta.p,   M0,   T.i,   T2 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — sample_temporal_injection_events","text":"Induced event rate per unit volume. V.Injected volume tau Decay rate [days]. beta.p Related b-value via b ln(10). M0 Minimum magnitude threshold. T.Time injection [days]. T2 End temporal model domain [days].","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — sample_temporal_injection_events","text":"Catalogue parent events induced injection; data.frame(times, magnitudes)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a set of time bins for a specific event. — time_grid","title":"Generate a set of time bins for a specific event. — time_grid","text":"Generate set time bins specific event.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a set of time bins for a specific event. — time_grid","text":"","code":"time_grid(data.point, coef.t, delta.t, N.exp., T1., T2.)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a set of time bins for a specific event. — time_grid","text":"data.point Point binning calculated, list elements time (ts, scalar), event index (idx.p, scalar). Names mandatory changed coef.t TimeBinning parameter: look breaks_exp() delta.t TimeBinning parameter: look breaks_exp() N.exp. TimeBinning parameter: look breaks_exp() T1. Start temporal domain, scalar T2. End temporal domain scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a set of time bins for a specific event. — time_grid","text":"data.frame many rows number bins fixed number columns. columns t.start : starting point bin (minimum = T1.). t.end : end point bin. (maximum = T2.). t.bin.name : unique bin identifier. t.ref_layer : bin identifier calculations ts : time provided data.point idx.p : identifier provided data.point bins T1. T2. containing T1.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a set of time bins for a specific event. — time_grid","text":"","code":"## EXAMPLE 1 event <- list(ts = 0, idx.p = 1) time_grid(data.point = event, coef.t = 1, delta.t = 0.1, N.exp. = 8, T1. = 1, T2. = 20) #>   t.start t.end t.bin.name t.ref_layer ts idx.p #> 1     1.0   1.6    0.8-1.6   between-1  0     1 #> 2     1.6   3.2    1.6-3.2           6  0     1 #> 3     3.2   6.4    3.2-6.4           7  0     1 #> 4     6.4  12.8   6.4-12.8           8  0     1 #> 5    12.8  20.0    12.8-20      last-1  0     1"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"Function plot ETAS triggering function corresponding different posterior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"","code":"triggering_fun_plot(   input.list,   post.samp = NULL,   n.samp = 10,   magnitude = 4,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale post.samp data.frame containing posterior samples parameters. NULL, n.samp samples generated. n.samp different nrow(post.samp) n.samp rows uniformly sampled post.samp. Default NULL n.samp Number posterior samples, integer (default = 10). magnitude Magnitude event triggering function calculated, scalar (default = 4). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"ggplot object grey lines representing triggering function posterior sample. Black lines representing 0.025 0.975 quantiles function values calculated posterior sample. Horizontal red lines represents 0.025 0.975 quantiles sampled background rates.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"Function plot ETAS triggering function corresponding different prior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"","code":"triggering_fun_plot_prior(   input.list,   magnitude = 4,   n.samp = 10,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"input.list structured input list least one element: link.functions: list functions convert ETAS parameters INLA scale ETAS scale magnitude Magnitude event triggering function calculated, scalar (default = 4). n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"ggplot object grey lines representing triggering function posterior sample. Black lines representing 0.025 0.975 quantiles function values calculated posterior sample. Horizontal red lines represents 0.025 0.975 quantiles sampled background rates.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"Copula transformation standard Normal distribution Uniform distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"","code":"unif_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"x values standard Normal distribution, vector. minimum value Uniform distribution, scalar. b maximum value Uniform distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"values Uniform distribution b, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/news/index.html","id":"etasinlabru-development-version","dir":"Changelog","previous_headings":"","what":"ETAS.inlabru (development version)","title":"ETAS.inlabru (development version)","text":"Cleaned R package structure Added vignettes package website Renamed functions avoid “.” non-S3-method function names. Temporal.ETAS.* functions retain “.”, now.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/news/index.html","id":"etasinlabru-101","dir":"Changelog","previous_headings":"","what":"ETAS.inlabru 1.0.1","title":"ETAS.inlabru 1.0.1","text":"Initial package version.","code":""}]
