[{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"load-packages","dir":"Articles","previous_headings":"Setup","what":"Load Packages","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"library(ETAS.inlabru) library(ggplot2)  library(rnaturalearth) library(terra) library(sf) library(ggspatial) library(rnaturalearthdata) library(dplyr) library(lubridate)  ## This is just the EPSG equivalent of WGS84 crs_wgs84 <- st_crs('EPSG:4326')"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"load-an-earthquake-catalogue","dir":"Articles","previous_headings":"","what":"Load an earthquake catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"Earthquake data stored -called earthquake catalogues. Many different catalogues exists region easy way decide one better. , provide HOmogenized instRUmental Seismic (HORUS) catalogue 1960 2020. can downloaded http://horus.bo.ingv./. subset (see data-raw/horus.R subset created) information Horus catalogue can loaded using data reports earthquake time string (time_string), longitude (lon) latitude (lat) epicentre, depth kilometres (depth), moment magnitude (M).","code":"# load HORUS catalogue data(horus, package = \"ETAS.inlabru\")  # transform time string in Date object horus$time_date <- as.POSIXct(   horus$time_string,   format = \"%Y-%m-%dT%H:%M:%OS\" )  head(horus) #>           time_string     lon     lat depth    M           time_date #> 1 1960-01-03T20:19:34 15.3000 39.3000   290 6.34 1960-01-03 20:19:34 #> 2 1960-01-04T09:20:00 13.1667 43.1333     0 3.94 1960-01-04 09:20:00 #> 3 1960-01-06T15:17:34 12.7000 46.4833     4 4.69 1960-01-06 15:17:34 #> 4 1960-01-06T15:20:53 12.7000 46.4667     0 4.14 1960-01-06 15:20:53 #> 5 1960-01-06T15:31:00 12.7500 46.4333     0 3.00 1960-01-06 15:31:00 #> 6 1960-01-06T15:45:00 12.7500 46.4333     0 3.00 1960-01-06 15:45:00  # Set df_cat to be the catalogue we want to analyse and then use this below df_cat <- horus  # Add an integer id to each event df_cat$event_num <- seq.int(nrow(df_cat))  # Generate an sf version of the catalogue where the longitude and latitude are converted to a point object df_cat.sf<- st_as_sf(df_cat,                      coords = c(\"lon\", \"lat\"),                      crs = crs_wgs84)  head(df_cat.sf) #> Simple feature collection with 6 features and 5 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 12.7 ymin: 39.3 xmax: 15.3 ymax: 46.4833 #> Geodetic CRS:  WGS 84 #>           time_string depth    M           time_date event_num #> 1 1960-01-03T20:19:34   290 6.34 1960-01-03 20:19:34         1 #> 2 1960-01-04T09:20:00     0 3.94 1960-01-04 09:20:00         2 #> 3 1960-01-06T15:17:34     4 4.69 1960-01-06 15:17:34         3 #> 4 1960-01-06T15:20:53     0 4.14 1960-01-06 15:20:53         4 #> 5 1960-01-06T15:31:00     0 3.00 1960-01-06 15:31:00         5 #> 6 1960-01-06T15:45:00     0 3.00 1960-01-06 15:45:00         6 #>                  geometry #> 1       POINT (15.3 39.3) #> 2 POINT (13.1667 43.1333) #> 3    POINT (12.7 46.4833) #> 4    POINT (12.7 46.4667) #> 5   POINT (12.75 46.4333) #> 6   POINT (12.75 46.4333)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"get-map-and-extract-crs-for-the-map","dir":"Articles","previous_headings":"Load an earthquake catalogue","what":"Get map and extract crs for the map","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"download polygon file national boundary Italy use later notebook.","code":"italy.map <- ne_countries(country = 'Italy', returnclass = \"sf\", scale = 'medium') italy.crs <- crs(italy.map) print(italy.crs) #> [1] \"BOUNDCRS[\\n    SOURCECRS[\\n        GEOGCRS[\\\"unknown\\\",\\n            DATUM[\\\"World Geodetic System 1984\\\",\\n                ELLIPSOID[\\\"WGS 84\\\",6378137,298.257223563,\\n                    LENGTHUNIT[\\\"metre\\\",1]],\\n                ID[\\\"EPSG\\\",6326]],\\n            PRIMEM[\\\"Greenwich\\\",0,\\n                ANGLEUNIT[\\\"degree\\\",0.0174532925199433],\\n                ID[\\\"EPSG\\\",8901]],\\n            CS[ellipsoidal,2],\\n                AXIS[\\\"longitude\\\",east,\\n                    ORDER[1],\\n                    ANGLEUNIT[\\\"degree\\\",0.0174532925199433,\\n                        ID[\\\"EPSG\\\",9122]]],\\n                AXIS[\\\"latitude\\\",north,\\n                    ORDER[2],\\n                    ANGLEUNIT[\\\"degree\\\",0.0174532925199433,\\n                        ID[\\\"EPSG\\\",9122]]]]],\\n    TARGETCRS[\\n        GEOGCRS[\\\"WGS 84\\\",\\n            DATUM[\\\"World Geodetic System 1984\\\",\\n                ELLIPSOID[\\\"WGS 84\\\",6378137,298.257223563,\\n                    LENGTHUNIT[\\\"metre\\\",1]]],\\n            PRIMEM[\\\"Greenwich\\\",0,\\n                ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n            CS[ellipsoidal,2],\\n                AXIS[\\\"geodetic latitude (Lat)\\\",north,\\n                    ORDER[1],\\n                    ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n                AXIS[\\\"geodetic longitude (Lon)\\\",east,\\n                    ORDER[2],\\n                    ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n            ID[\\\"EPSG\\\",4326]]],\\n    ABRIDGEDTRANSFORMATION[\\\"Transformation from unknown to WGS84\\\",\\n        METHOD[\\\"Geocentric translations (geog2D domain)\\\",\\n            ID[\\\"EPSG\\\",9603]],\\n        PARAMETER[\\\"X-axis translation\\\",0,\\n            ID[\\\"EPSG\\\",8605]],\\n        PARAMETER[\\\"Y-axis translation\\\",0,\\n            ID[\\\"EPSG\\\",8606]],\\n        PARAMETER[\\\"Z-axis translation\\\",0,\\n            ID[\\\"EPSG\\\",8607]]]]\"  ggplot() +    geom_sf(data = italy.map) +    theme_bw() +   ggtitle(\"Map of the Italian territorial boundary and coastline\")"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"histogram-of-event-depths","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Histogram of event depths","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"histogram depth data 1km bins initially looks reasonable except artefact cluster events zero depth.  However, reduce bin width 100m see artefacts data. spikes 0, 5, 10 11km artefacts depth estimation, one cause algorithms may got stuck starting values. magnitude time series shows completeness intermediate deep events improved time.","code":"hist(df_cat$depth, breaks=seq(650,-5,-1), xlim=c(-5,40), main=\"Histogram of depths, 1km bins\", xlab=\"Depth [km]\") hist(df_cat$depth, breaks=seq(650,-5,-0.1), xlim=c(-5,40), main=\"Histogram of depths (100m bins)\", xlab=\"Depth [km]\") ggplot(df_cat, aes(x=time_date, y=depth))  +    geom_point(size = 0.1) +   ylim(620,0) +   ggtitle('Depth timeseries using natural time') #> Warning: Removed 3 rows containing missing values (`geom_point()`)."},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"plot-of-event-magnitudes-using-natural-time","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Plot of event magnitudes using natural time","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"Natural time refers plot event evenly spaced along x-axis. advantage data occurs periods high activity spread , means can see structure data rates high. plot magnitude events y-axis natural time horizontal. observations : 40,000 events magnitude data cluster events \\(M=0\\) likely artefact catalogue generated period time data rounded 1 decimal place producing horizontal banding times, data rounded sensitivity lowest magnitudes varies time can seen changes lowest magnitudes","code":"ggplot(df_cat, aes(x=event_num, y=M))  +    geom_point(size = 0.1) +   ggtitle('Magnitude timeseries using natural time')"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"plot-of-event-magnitudes-using-date-time","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Plot of event magnitudes using date-time","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"present data previous plot, plotted data-time. Clustered events now sit top . get better representaion data density increases towards modern day magnitude incompleteness varyies time.  number events occuring year difficult assess plot, group data year count number events occuring year. plot shows number events recorded year gradually increasing. artefact due gradual increase sensitivity network, seismicity systematically increasing.","code":"ggplot(df_cat, aes(x=time_date, y=M)) +    geom_point(size = 0.1) +   ggtitle(\"Horus catalogue magnitude time series\") #> Warning: Removed 1 rows containing missing values (`geom_point()`). df_cat$Time <- as.Date(df_cat$time_date)   print(\"Extract year\") #> [1] \"Extract year\" # extract the year and convert to numeric format df_cat$Year <- as.numeric(format(df_cat$Time, \"%Y\"))  countEventsInYear <- df_cat %>%   group_by(Year) %>%   summarize(counts = n())  plot(countEventsInYear, type=\"l\", main=\"Annual number of events for whole catalogue\") # Filtered for M>4 ggplot(df_cat[df_cat$M>4,], aes(x=time_date, y=M)) +    geom_point(size = 0.1) +   ggtitle(\"Whole catalogue magnitude timeseries for M>4\") #> Warning: Removed 1 rows containing missing values (`geom_point()`). countEventsInYear <- df_cat[df_cat$M>=4,] %>%   group_by(Year) %>%   summarize(counts = n())  plot(countEventsInYear, type=\"l\", main=\"Annual number of events with M>=4\") abline(h=mean(countEventsInYear), col=2) #> Warning in mean.default(countEventsInYear): argument is not numeric or logical: #> returning NA"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"frequency-magnitude-analysis-for-horus-catalogue","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Frequency-magnitude analysis for Horus catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"traditional GR plot shows cumulative data (red) also show incremental data (black). personally prefer looking incremental data correlated therefore easier understand Poisson counting errors account uncertainty data. three domains standard GR plot. - low magnitudes always incompleteness due limitations monitoring network - requirement GR good model log-linear portion data slope stable, slope refered b-value - high magnitudes always fluctuations magnitudes due effect counting errors bins low rates","code":"minMag <- 1.5 maxMag <- max(df_cat$M)  mags <- df_cat[df_cat$M>minMag,]$M  tmp <- hist(mags, breaks=seq(minMag-0.05,maxMag+0.1,0.1), plot=FALSE)  N.counts <- length( tmp$counts) tmp$cumulativeCounts <- cumsum(tmp$counts[N.counts:1])[N.counts:1]  m.min <- 4 bin_m.min <- which(tmp$mids==m.min) freq_m.min <- tmp$counts[bin_m.min] b <- 1 x <- tmp$mids y <- freq_m.min * 10^(-b*(x-m.min)) y.cum <- tmp$cumulativeCounts[bin_m.min] * 10^(-b*(x-m.min))  ggplot() +   geom_point( aes(x=tmp$mids, y=tmp$counts) ) +   geom_point( aes(x=tmp$mids, y=tmp$cumulativeCounts) , color='red', pch=\"+\", size=2) +   scale_y_log10() +   ggtitle(paste(\"Frequency-magnitude plot with arbitary GR dist: b =\", b)) +   xlab(\"Magnitude\") +   ylab(\"log10(Frequency)\") +   geom_line(aes(x=x, y=y)) +   geom_line(aes(x=x, y=y.cum), color='red') +   geom_vline( xintercept=m.min, lty=2 ) #> Warning: Transformation introduced infinite values in continuous y-axis"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"b-value-stability-plot-for-the-events-in-the-horus-catalogue","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"b-value stability plot for the events in the Horus catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"minMag <- 2 maxMag <- max(df_cat$M, na.rm=TRUE) mags <- df_cat[df_cat$M>=minMag,]$M  x <- seq(minMag,maxMag,0.1)  b.stability.list <- c() b.error.list <- c() m.mean <- c()  b_utsu <- c() b_guttorp <- c() b_elst <- c() delta_b_utsu <- c() b_elst_lower <- c() b_elst_upper <- c()  max.index.x <- length(x)-5  for( i in 1:max.index.x ){   mag.threshold <- x[i]   mags.subset <- mags[mags > mag.threshold]      N <- length(mags.subset)   b_utsu[i] <- 1/( log(10)*(mean(mags.subset)-mag.threshold+0.05))   delta_b_utsu[i] <- log(10)*b_utsu[i]**2 * sqrt( sum((mags.subset - mean(mags.subset))**2)/(N*(N-1)))        b_guttorp[i] = 1/( 2*0.05*log(10))*log((mean(mags.subset)-mag.threshold+2*0.05)/(mean(mags.subset)-mag.threshold))        deltaMags <- diff(mags.subset)   deltaMags_p <- deltaMags[deltaMags>0.1]   N <- length(deltaMags_p)   b_elst[i] <- 1/(2*0.05* log(10)) * log((mean(deltaMags_p))/(mean(deltaMags_p)-0.1))   c = 10**(0.1*b_elst[i])   b_elst_lower[i] <- 1/(0.1 * log(10)) * log((c+sqrt(c/N))/(1+sqrt(c/N)))   b_elst_upper[i] <- 1/(0.1 * log(10)) * log((c-sqrt(c/N))/(1-sqrt(c/N))) }  ggplot() +   geom_line( aes(x=x[1:max.index.x], y=b_utsu) ) +   geom_line( aes(x=x[1:max.index.x], y=b_utsu+delta_b_utsu), color=2, lty=2 ) +   geom_line( aes(x=x[1:max.index.x], y=b_utsu-delta_b_utsu), color=2, lty=2 ) +   geom_line( aes(x=x[1:max.index.x], y=b_guttorp), color=3, lty=1 ) +   xlab(\"Magnitude threshold\") +   ylab(\"b-value estimate\") +   geom_hline(yintercept = 1, lty=3) +   geom_hline(yintercept = 0.85, lty=3) +   ggtitle(\"b-value stability plot for Horus catalogue\")"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"heatmap-of-the-events-in-the-horus-catalogue","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Heatmap of the events in the Horus catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"ggplot() +   geom_hex(data = df_cat[df_cat$M>3,], aes(x = lon, y = lat), bins = 50) +   scale_fill_continuous(type = \"viridis\") +   geom_sf(data = italy.map, fill=alpha(\"lightgrey\", 0), color = 'orange', size=0.2) +    ggtitle(\"Density plot for M>3 events\") +   theme_bw()"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"map-of-the-events-in-the-italian-horus-catalogue","dir":"Articles","previous_headings":"Exploratory Data Analysis on the whole of Italy using the Horus catalogue","what":"Map of the events in the Italian Horus catalogue","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"plot location seismicity map. outline Italy territory shown green.","code":"ggplot() +   geom_sf(data = df_cat.sf[df_cat$M>3,], size = 0.05) +   geom_sf(data = italy.map, fill=alpha(\"lightgrey\", 0), color = 'green', linewidth=0.7) +   geom_sf(data = df_cat.sf[df_cat$M>5,], size = 0.5, color='orange') +   geom_sf(data = df_cat.sf[df_cat$M>6,], size = 0.5, color='red') +   ggtitle(\"Map of event locations\") eventDate <- ymd_hms( '2009-04-06 00:00:00' ) endDate <- eventDate + days(400) startDate <- eventDate - days(50) deltaLat <- 2.4 latLims <- c( 42.2,42.5) longLims <- c( 13, 13.75)  ggplot() +    geom_point(data=df_cat[df_cat$M>3,], aes(time_date, lat), size=0.1) +   geom_point(data=df_cat[df_cat$M>5,], aes(time_date, lat), size=1.2, color='orange') +   geom_point(data=df_cat[df_cat$M>6,], aes(time_date, lat), size=1.5, color='red') +   ggtitle(\"Italian latitude-time plot\")  +   geom_rect(aes(xmin = as.POSIXct(startDate), xmax = as.POSIXct(endDate), ymin = latLims[1], ymax = latLims[2]), alpha = 0.4, fill='blue', color='blue') #> Warning: Removed 1 rows containing missing values (`geom_point()`)."},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"analysis-if-the-laquila-sequence","dir":"Articles","previous_headings":"","what":"Analysis if the L’Aquila Sequence","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"focus L Aquila seismic sequence sufficient retain observations specific space-time-magnitude region include sequence interest. L’Aquila sequence, retain events magnitude greater equal \\(2.5\\) happened 2009 longitude \\((10.5, 16)\\) latitude \\((40.5, 45)\\). L’Aquila sequence selected way composed 1024 events. seismic sequence can selected similarly. selection convenient transform time string Date object select rows Horus catalogue verifying conditions. start.date = “2009-04-06 00:00:00 BST” end.date = “2010-01-01 00:00:00 BST” magnitude.completeness = 2.49 min.longitude = 13.00 max.longitude = 13.75 min.latitude = 42.2 max.latitude = 42.5","code":"eventDate <- ymd_hms( '2009-04-06 00:00:00' ) endDate <- eventDate + days(400) startDate <- eventDate - days(50) deltaLat <- 2.4 latLims <- c( 42.2,42.5) longLims <- c( 13, 13.75)  minMAG <- 0  # Subset the main catalogue df_cat.subset <- df_cat[df_cat$M >= minMAG, ] df_cat.subset <- df_cat.subset[ (df_cat.subset$lat>latLims[1]), ] df_cat.subset <- df_cat.subset[ (df_cat.subset$lat<latLims[2]), ] df_cat.subset <- df_cat.subset[ (df_cat.subset$lon>longLims[1]), ] df_cat.subset <- df_cat.subset[ (df_cat.subset$lon<longLims[2]), ]  head(df_cat.subset) #>             time_string     lon     lat depth    M           time_date #> 243 1961-03-25T10:40:00 13.3167 42.4333     0 3.64 1961-03-25 10:40:00 #> 295 1961-10-05T19:59:35 13.0167 42.3500     3 0.00 1961-10-05 19:59:35 #> 302 1961-10-31T00:00:00 13.0167 42.3500    10 3.94 1961-10-31 00:00:00 #> 303 1961-10-31T00:00:00 13.0167 42.3500    10 3.94 1961-10-31 00:00:00 #> 304 1961-10-31T13:37:18 13.0833 42.4167     4 4.64 1961-10-31 13:37:18 #> 305 1961-10-31T13:41:59 13.0833 42.4167     0 4.14 1961-10-31 13:41:59 #>     event_num       Time Year #> 243       243 1961-03-25 1961 #> 295       295 1961-10-05 1961 #> 302       302 1961-10-31 1961 #> 303       303 1961-10-31 1961 #> 304       304 1961-10-31 1961 #> 305       305 1961-10-31 1961"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"plot-of-the-event-magnitude-time-series-laquila","dir":"Articles","previous_headings":"Analysis if the L’Aquila Sequence","what":"Plot of the event magnitude time series: l’Aquila","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"ggplot() +    geom_point(data=df_cat.subset[df_cat.subset$M>3,], aes(time_date, lat), size=0.1) +   geom_point(data=df_cat.subset[df_cat.subset$M>5,], aes(time_date, lat), size=1.2, color='orange') +   geom_point(data=df_cat.subset[df_cat.subset$M>6,], aes(time_date, lat), size=1.5, color='red') +   ggtitle(\"L'Aquila latitude-time plot\") +   geom_rect(aes(xmin = as.POSIXct(startDate), xmax = as.POSIXct(endDate), ymin = latLims[1], ymax = latLims[2]), alpha = 0.4, fill='blue', color='blue') minMag <- 0 maxMag <- max(df_cat.subset$M, na.rm=TRUE)  mags <- df_cat.subset[df_cat.subset$M>=minMag,]$M  tmp <- hist(mags, breaks=seq(minMag-0.05,maxMag+0.4,0.1), plot=FALSE)  N.counts <- length( tmp$counts) tmp$cumulativeCounts <- cumsum(tmp$counts[N.counts:1])[N.counts:1]  m.min <- 4 bin_m.min <- which(tmp$mids==m.min) freq_m.min <- tmp$counts[bin_m.min] b <- 1. x <- tmp$mids y <- freq_m.min * 10^(-b*(x-m.min)) y.cum <- tmp$cumulativeCounts[bin_m.min] * 10^(-b*(x-m.min))  ggplot() +   geom_point( aes(x=tmp$mids, y=tmp$counts) ) +   geom_point( aes(x=tmp$mids, y=tmp$cumulativeCounts) , color='red', pch=\"+\") +   scale_y_log10() +   ggtitle(paste(\"Frequency-magnitude plot with arbitary GR dist: b =\", b)) +   xlab(\"Magnitude\") +   ylab(\"log10(Frequency)\") +   geom_line(aes(x=x, y=y)) +   geom_line(aes(x=x, y=y.cum), color='red') +   geom_vline( xintercept=m.min, lty=2 ) #> Warning: Transformation introduced infinite values in continuous y-axis #> Transformation introduced infinite values in continuous y-axis"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/EDA_Italy_Horus.html","id":"b-value-stability-plot-laquila","dir":"Articles","previous_headings":"Analysis if the L’Aquila Sequence","what":"b-value stability plot: l’Aquila","title":"1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus","text":"","code":"minMag <- 0 maxMag <- max(df_cat.subset$M, na.rm=TRUE) mags <- df_cat.subset[df_cat.subset$M>=minMag,]$M  x <- seq(minMag,maxMag,0.1)  b.stability.list <- c() b.error.list <- c() m.mean <- c()  b_utsu <- c() b_guttorp <- c() b_elst <- c() delta_b_utsu <- c() b_elst_lower <- c() b_elst_upper <- c()  max.index.x <- length(x)-5  for( i in 1:max.index.x ){   mag.threshold <- x[i]   mags.subset <- mags[mags > mag.threshold]      N <- length(mags.subset)   b_utsu[i] <- 1/( log(10)*(mean(mags.subset)-mag.threshold+0.05))   delta_b_utsu[i] <- log(10)*b_utsu[i]**2 * sqrt( sum((mags.subset - mean(mags.subset))**2)/(N*(N-1)))        b_guttorp[i] = 1/( 2*0.05*log(10))*log((mean(mags.subset)-mag.threshold+2*0.05)/(mean(mags.subset)-mag.threshold))        deltaMags <- diff(mags.subset)   deltaMags_p <- deltaMags[deltaMags>0.1]   N <- length(deltaMags_p)   b_elst[i] <- 1/(2*0.05* log(10)) * log((mean(deltaMags_p))/(mean(deltaMags_p)-0.1))   c = 10**(0.1*b_elst[i])   b_elst_lower[i] <- 1/(0.1 * log(10)) * log((c+sqrt(c/N))/(1+sqrt(c/N)))   b_elst_upper[i] <- 1/(0.1 * log(10)) * log((c-sqrt(c/N))/(1-sqrt(c/N))) }  ggplot() +   geom_line( aes(x=x[1:max.index.x], y=b_utsu) ) +   geom_line( aes(x=x[1:max.index.x], y=b_utsu+delta_b_utsu), color=2, lty=2 ) +   geom_line( aes(x=x[1:max.index.x], y=b_utsu-delta_b_utsu), color=2, lty=2 ) +   geom_line( aes(x=x[1:max.index.x], y=b_guttorp), color=3, lty=1 ) +   xlab(\"Magnitude threshold\") +   ylab(\"b-value estimate\") +   geom_hline(yintercept = 1, lty=3) +   geom_hline(yintercept = 0.85, lty=3) +   ggtitle(\"b-value stability plot for the l'Aquila catalogue\") #> Warning: Removed 2 rows containing missing values (`geom_line()`). #> Removed 2 rows containing missing values (`geom_line()`)."},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/generateSyntheticCatalogues.html","id":"create-catalogue","dir":"Articles","previous_headings":"","what":"Create catalogue","title":"2a Temporal Model: Generating synthetic temporal ETAS catalogues","text":"define ETAS parameters define model domain specify history generate ETAS sample plot results","code":"mu <- 1070. / 365 K <- 0.089 alpha <- 2.29 c <- 0.011 p <- 1.08  modelledDuration <- 10 # [days]  M0 <- 2  theta_etas <- data.frame(mu = mu, K = K, alpha = alpha, c = c, p = p)  Ht <- data.frame(ts = c(0., 1.5), magnitudes = c(6.7, 7.))  combined.M7.ETAS.cat <-   generate_temporal_ETAS_synthetic(     theta = theta_etas,     beta.p = log(10),     M0 = M0,     T1 = 0,     T2 = modelledDuration,     Ht = Ht,     format = \"df\"   ) combined.M7.ETAS.cat$ID <- seq_len(nrow(combined.M7.ETAS.cat))  ggplot(combined.M7.ETAS.cat) +   geom_point(aes(x = ts, y = magnitudes, color = factor(gen))) +   xlim(0, modelledDuration) +   ggtitle(\"M7 plus background and ETAS\") ggplot(combined.M7.ETAS.cat %>%          mutate(generation = if_else(gen == -1, \"Initial\", \"Child\"))) +   geom_point(aes(x = ts, y = magnitudes, color = generation)) +   xlim(0, modelledDuration) +   ggtitle(\"M7 plus background and ETAS\") ggplot() +   geom_point(data = combined.M7.ETAS.cat, aes(x = ID, y = magnitudes), color = \"red\") #+ #  geom_ma(data = combined.M7.ETAS.cat, aes(x=ID, y=magnitudes), ma_fun = SMA, n = 10)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sampleFromETASpriors.html","id":"sampling-etas-priors","dir":"Articles","previous_headings":"","what":"Sampling ETAS Priors","title":"2b Temporal Model: Presenting samples drawn from the ETAS priors","text":"important check priors broad enough expect model parameterisation lie within . notebook shows draw samples priors present resulting triggering functions.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"multiple-analyses-of-two-catalogues-using-different-initial-values","dir":"Articles","previous_headings":"","what":"Multiple analyses of two catalogues using different initial values","title":"Sensitivity to starting point","text":"inlabru algorithm takes initial guess mode parameters inverting iteratively updates initial guess. potential may bad initial conditions find different solutions runtime differ depending upon solution converges. notebook, explore robustness posteriors two synthetic catalogues true parameters known. catalogues contain 2000 days data. One catalogue contain large event second contains M6.7 event day 1000.","code":"library(ETAS.inlabru)  library(tidyquant) library(gridExtra) library(grid) library(lemon) library(ggplot2) library(ggpubr) library(GGally)  library(inlabru) library(INLA) library(ETAS.inlabru)  # inla.setOption(pardiso.license=\"~/sys/licences/pardiso.lic\")  library(dplyr)  # Increase/decrease num.cores if you have more/fewer cores on your computer. # future::multisession works on both Windows, MacOS, and Linux num.cores <- 2 future::plan(future::multisession, workers = num.cores) INLA::inla.setOption(num.threads = num.cores) # To deactivate parallelism, run #   future::plan(future::sequential) #   INLA::inla.setOption(num.threads = 1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"define-the-parameters-for-the-synthetic-catalogues-and-starting-values-for-inversion","dir":"Articles","previous_headings":"Multiple analyses of two catalogues using different initial values","what":"Define the parameters for the synthetic catalogues and starting values for inversion","title":"Sensitivity to starting point","text":"","code":"# Parameters we use to generate synthetics, which we will refer to as the 'true' parameters mu <- 0.1 K <- 0.089 alpha <- 2.29 c <- 0.11 p <- 1.08  # Format the true ETAS parameters for code to generate the synthetics theta_etas <- data.frame(mu = mu, K = K, alpha = alpha, c = c, p = p)  # A dataframe containing different starting values for the algorithm startingValues <- data.frame(   mu = c(5., mu),   K = c(1., K),   alpha = c(5., alpha),   c = c(0.3, c),   p = c(1.5, p) ) nRealisations <- length(startingValues$mu)   # Temporal duration of the synthetic catalogue in days modelledDuration <- 1000 # [days]  # The minimum magnitude that will be modelled M0 <- 2.5"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"generate-new-catalogues-and-save-them","dir":"Articles","previous_headings":"Multiple analyses of two catalogues using different initial values","what":"Generate new catalogues and save them","title":"Sensitivity to starting point","text":"vignette use Rmd caching, can save catalogues files explicitly:","code":"############ #### Generate the first catalogue with no large events  samp.etas.list <- generate_temporal_ETAS_synthetic(   theta = theta_etas,   beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = NULL )  quiet.ETAS.cat <- bind_rows(samp.etas.list) quiet.ETAS.cat <- quiet.ETAS.cat[order(quiet.ETAS.cat$ts), ] # quiet.ETAS.cat <- na.omit(quiet.ETAS.cat) ############ #### Generate the second catalogue with a M6.7 event on day 1000  Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) # Impose a M6.7 event on day 1000  samp.etas.list <- generate_temporal_ETAS_synthetic(theta = theta_etas, beta.p = log(10), M0 = M0, T1 = 0, T2 = modelledDuration, Ht = Ht)  M6p7.ETAS.cat <- bind_rows(samp.etas.list) M6p7.ETAS.cat <- M6p7.ETAS.cat[order(M6p7.ETAS.cat$ts), ] # save(M6p7.ETAS.cat,file=\"M6p7_ETAS_cat.Rda\") # save(quiet.ETAS.cat,file=\"quiet.ETAS.cat.Rda\")"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"load-the-catalogues","dir":"Articles","previous_headings":"Present the catalogues","what":"Load the catalogues","title":"Sensitivity to starting point","text":"read saved object files:","code":"# load(\"M6p7_ETAS_cat.Rda\") # load(\"quiet.ETAS.cat.Rda\")"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-properties-of-the-catalogues","dir":"Articles","previous_headings":"Present the catalogues","what":"Plot properties of the catalogues","title":"Sensitivity to starting point","text":"","code":"plots <- list()  plots[[1]] <- ggplot() +   geom_point(data = quiet.ETAS.cat, aes(x = ts, y = magnitudes), size = 0.1, alpha = 0.5) +   xlim(0, modelledDuration) +   ggtitle(paste(\"A.  Unseeded catalog, nEvents =\", length(quiet.ETAS.cat$ts))) +   ylim(2, 7) +   xlab(\"Time [days]\") +   ylab(\"Magnitude\") +   theme_bw()  plots[[2]] <- ggplot() +   geom_point(data = M6p7.ETAS.cat, aes(x = ts, y = magnitudes), size = 0.1, alpha = 0.5) +   xlim(0, modelledDuration) +   ggtitle(paste(\"B.  Catalog seeded with M6.7 event on day 500, nEvents =\", length(M6p7.ETAS.cat$ts))) +   ylim(2, 7) +   xlab(\"Time [days]\") +   ylab(\"Magnitude\") +   theme_bw()   plt <- grid.arrange(plots[[1]], plots[[2]], ncol = 1, nrow = 2) # ggsave(\"initialConditionCats.png\", plt) # ggsave(\"initialConditionCats.pdf\", plt)"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"analysis-of-quiet-catalogue","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Analysis of quiet catalogue","title":"Sensitivity to starting point","text":"","code":"list.output.quietScenario <- list()  for (i in seq_len(nRealisations)) {   if (exists(\"list.input\")) remove(\"list.input\")    # Load a set of parameters that we will need to tweak for this application   fpath <- system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\")   list.input <- create_input_list_temporal_noCatalogue(fpath)    ####################   # Tweak the variables loaded from the input file   list.input$M0 <- M0   list.input$time.int <- c(0, modelledDuration)   list.input$T12 <- c(0, modelledDuration)    # Change the starting location, measured on the ETAS scale   list.input$mu.init <- startingValues$mu[i]   list.input$alpha.init <- startingValues$alpha[i]   list.input$K.init <- startingValues$K[i]   list.input$c.init <- startingValues$c[i]   list.input$p.init <- startingValues$p[i]    link.f <- list(     mu = \\(x) gamma_t(x, a_mu, b_mu),     K = \\(x) loggaus_t(x, a_K, b_K),     alpha = \\(x) unif_t(x, a_alpha, b_alpha),     c_ = \\(x) unif_t(x, a_c, b_c),     p = \\(x) unif_t(x, a_p, b_p)   )    # initial value - convert from ETAS scale to internal scale   list.input$th.init <- list(     th.mu = inv_gamma_t(list.input$mu.init, list.input$a_mu, list.input$b_mu),     th.K = inv_loggaus_t(list.input$K.init, list.input$a_K, list.input$b_K),     th.alpha = inv_unif_t(list.input$alpha.init, list.input$a_alpha, list.input$b_alpha),     th.c = inv_unif_t(list.input$c.init, list.input$a_c, list.input$b_c),     th.p = inv_unif_t(list.input$p.init, list.input$a_p, list.input$b_p)   )    # Define options for inlabru   if (is.null(list.input$max_step)) {     list.input$bru.opt.list <- list(       bru_verbose = 0, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       # bru_method = list(max_step = 0.5),       bru_initial = list.input$th.init     ) # parameters initial values   } else {     list.input$bru.opt.list <- list(       bru_verbose = 0, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       bru_method = list(max_step = list.input$max_step),       bru_initial = list.input$th.init     ) # parameters initial values   }    ## Add out catalogue to the input list   list.input$catalog <- data.frame(     time_diff = quiet.ETAS.cat$ts,     magnitudes = quiet.ETAS.cat$magnitudes   )    ## Add the catalogue formatted for bru   list.input$catalog.bru <- data.frame(     ts = quiet.ETAS.cat$ts,     magnitudes = quiet.ETAS.cat$magnitudes,     idx.p = seq_len(nrow(quiet.ETAS.cat))   )    ## Input list is now formatted   ####################    ## Run the model according to the input list   ETAS.model.fit <- Temporal.ETAS.fit(list.input)    ## Small bit of post processing   list.output.quietScenario[[i]] <- append(list.input, list(model.fit = ETAS.model.fit))   list.output.quietScenario[[i]]$runtime <- sum(list.output.quietScenario[[i]]$model.fit$bru_timings$Time)   list.output.quietScenario[[i]]$nEvents <- length(list.output.quietScenario[[i]]$catalog[, 1]) } #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  0.5432522  #> Finish model fitting  #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  0.5450776  #> Finish model fitting"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"analysis-of-m6-7-catalogue","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Analysis of M6.7 catalogue","title":"Sensitivity to starting point","text":"","code":"list.output.M6p7Scenario <- list()  for (i in seq_len(nRealisations)) {   if (exists(\"list.input\")) {     remove(list.input)   }    # Load a set of parameters that we will need to tweak for this application   fpath <- system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\")   list.input <- create_input_list_temporal_noCatalogue(fpath)    ####################   # Tweak the variables laoded from the input file   list.input$M0 <- M0   list.input$time.int <- c(0, modelledDuration)   list.input$T12 <- c(0, modelledDuration)    # Change the starting location, measured on the ETAS scale   list.input$mu.init <- startingValues$mu[i]   list.input$alpha.init <- startingValues$alpha[i]   list.input$K.init <- startingValues$K[i]   list.input$c.init <- startingValues$c[i]   list.input$p.init <- startingValues$p[i]    link.f <- list(     mu = \\(x) gamma_t(x, a_mu, b_mu),     K = \\(x) loggaus_t(x, a_K, b_K),     alpha = \\(x) unif_t(x, a_alpha, b_alpha),     c_ = \\(x) unif_t(x, a_c, b_c),     p = \\(x) unif_t(x, a_p, b_p)   )    # initial value - convert from ETAS scale to internal scale   list.input$th.init <- list(     th.mu = inv_gamma_t(list.input$mu.init, list.input$a_mu, list.input$b_mu),     th.K = inv_loggaus_t(list.input$K.init, list.input$a_K, list.input$b_K),     th.alpha = inv_unif_t(list.input$alpha.init, list.input$a_alpha, list.input$b_alpha),     th.c = inv_unif_t(list.input$c.init, list.input$a_c, list.input$b_c),     th.p = inv_unif_t(list.input$p.init, list.input$a_p, list.input$b_p)   )    # Define options for inlabru   if (is.null(list.input$max_step)) {     list.input$bru.opt.list <- list(       bru_verbose = 4, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       # bru_method = list(max_step = 0.5),       bru_initial = list.input$th.init     ) # parameters initial values   } else {     list.input$bru.opt.list <- list(       bru_verbose = 4, # type of visual output       bru_max_iter = list.input$max_iter, # maximum number of iterations       bru_method = list(max_step = list.input$max_step),       bru_initial = list.input$th.init     ) # parameters initial values   }    ## Add out catalogue to the input list   list.input$catalog <- data.frame(     time_diff = M6p7.ETAS.cat$ts,     magnitudes = M6p7.ETAS.cat$magnitudes   )    ## Add the catalogue formatted for bru   list.input$catalog.bru <- data.frame(     ts = M6p7.ETAS.cat$ts,     magnitudes = M6p7.ETAS.cat$magnitudes,     idx.p = seq_len(nrow(M6p7.ETAS.cat))   )    ## Input list is now formatted   ####################    ## Run the model according to the input list   ETAS.model.fit <- Temporal.ETAS.fit(list.input)    ## Small bit of post processing   list.output.M6p7Scenario[[i]] <- append(list.input, list(model.fit = ETAS.model.fit))   list.output.M6p7Scenario[[i]]$runtime <- sum(list.output.M6p7Scenario[[i]]$model.fit$bru_timings$Time)   list.output.M6p7Scenario[[i]]$nEvents <- length(list.output.M6p7Scenario[[i]]$catalog[, 1]) } #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  5.823672 #> iinla: Evaluate component inputs #> iinla: Evaluate component linearisations #> iinla: Evaluate component simplifications #> iinla: Evaluate predictor linearisation #> iinla: Construct inla stack #> iinla: Model initialisation completed #> iinla: Iteration 1 [max:100] #> iinla: Step rescaling: 93.26%, Optimisation #> iinla: |lin1-lin0| = 9366 #>        <eta-lin1,delta>/|delta| = -55.58 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 336.4 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Iteration 2 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 125%, Optimisation #> iinla: |lin1-lin0| = 2286 #>        <eta-lin1,delta>/|delta| = -59.4 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 279.8 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 1520% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 3 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 61.08%, Optimisation #> iinla: |lin1-lin0| = 2089 #>        <eta-lin1,delta>/|delta| = -1130 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 141.5 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 2270% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 4 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 117%, Optimisation #> iinla: |lin1-lin0| = 1524 #>        <eta-lin1,delta>/|delta| = -7.557 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 106.7 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 1110% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 5 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 110.5%, Optimisation #> iinla: |lin1-lin0| = 590.2 #>        <eta-lin1,delta>/|delta| = -4.381 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 28.52 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 678% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 6 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 101.2%, Optimisation #> iinla: |lin1-lin0| = 352.3 #>        <eta-lin1,delta>/|delta| = -0.02589 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 2.191 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 261% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 7 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 103.8%, Optimisation #> iinla: |lin1-lin0| = 255.5 #>        <eta-lin1,delta>/|delta| = -0.5008 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 7.588 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 181% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 8 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.5%, Optimisation #> iinla: |lin1-lin0| = 236.2 #>        <eta-lin1,delta>/|delta| = -0.007301 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.9119 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 169% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 9 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 101%, Optimisation #> iinla: |lin1-lin0| = 201.6 #>        <eta-lin1,delta>/|delta| = -0.02185 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 1.455 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 144% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 10 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.7%, Optimisation #> iinla: |lin1-lin0| = 183.5 #>        <eta-lin1,delta>/|delta| = -0.01136 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 1.005 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 131% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 11 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.6%, Optimisation #> iinla: |lin1-lin0| = 166.1 #>        <eta-lin1,delta>/|delta| = -0.007638 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.7861 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 119% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 12 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.5%, Optimisation #> iinla: |lin1-lin0| = 151 #>        <eta-lin1,delta>/|delta| = -0.005318 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.6266 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 109% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 13 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.5%, Optimisation #> iinla: |lin1-lin0| = 137.6 #>        <eta-lin1,delta>/|delta| = -0.003836 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.5088 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 99.5% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 14 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.4%, Optimisation #> iinla: |lin1-lin0| = 125.7 #>        <eta-lin1,delta>/|delta| = -0.002836 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.4186 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 91.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 15 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.4%, Optimisation #> iinla: |lin1-lin0| = 115.1 #>        <eta-lin1,delta>/|delta| = -0.002134 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.3477 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 83.9% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 16 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: |lin1-lin0| = 105.5 #>        <eta-lin1,delta>/|delta| = -0.001626 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.2908 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 77.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 17 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: |lin1-lin0| = 96.84 #>        <eta-lin1,delta>/|delta| = -0.002 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.2445 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 71.2% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 18 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: |lin1-lin0| = 89.03 #>        <eta-lin1,delta>/|delta| = -0.00228 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.2063 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 65.7% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 19 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.3%, Optimisation #> iinla: |lin1-lin0| = 81.95 #>        <eta-lin1,delta>/|delta| = 0.0008539 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.1746 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 60.7% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 20 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: |lin1-lin0| = 75.5 #>        <eta-lin1,delta>/|delta| = 0.0004826 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.1482 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 56.1% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 21 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: |lin1-lin0| = 69.63 #>        <eta-lin1,delta>/|delta| = 0.00019 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.126 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 51.9% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 22 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: |lin1-lin0| = 64.26 #>        <eta-lin1,delta>/|delta| = -3.935e-05 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.1074 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 48% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 23 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: |lin1-lin0| = 59.36 #>        <eta-lin1,delta>/|delta| = -0.0002177 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.09164 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 44.5% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 24 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: |lin1-lin0| = 54.86 #>        <eta-lin1,delta>/|delta| = -0.0003547 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.0783 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 41.2% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 25 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.2%, Optimisation #> iinla: |lin1-lin0| = 50.74 #>        <eta-lin1,delta>/|delta| = -0.0004583 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.06699 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 38.2% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 26 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 46.95 #>        <eta-lin1,delta>/|delta| = -0.0005348 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.05738 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 35.4% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 27 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 43.47 #>        <eta-lin1,delta>/|delta| = -0.0005895 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.0492 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 32.9% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 28 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 40.26 #>        <eta-lin1,delta>/|delta| = -0.0006264 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.04222 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 30.5% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 29 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 37.31 #>        <eta-lin1,delta>/|delta| = -0.0006492 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.03626 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 28.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 30 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 34.59 #>        <eta-lin1,delta>/|delta| = -0.0006605 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.03117 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 26.3% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 31 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 32.07 #>        <eta-lin1,delta>/|delta| = -0.0006628 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.02681 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 24.4% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 32 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 29.75 #>        <eta-lin1,delta>/|delta| = 0.0005509 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.02308 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 22.7% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 33 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 27.61 #>        <eta-lin1,delta>/|delta| = 0.0004744 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.01987 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 21.1% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 34 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 25.63 #>        <eta-lin1,delta>/|delta| = 0.0004087 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.01712 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 19.6% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 35 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 23.79 #>        <eta-lin1,delta>/|delta| = 0.0003523 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.01476 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 18.2% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 36 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 22.09 #>        <eta-lin1,delta>/|delta| = 0.0003038 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.01273 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 16.9% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 37 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 20.52 #>        <eta-lin1,delta>/|delta| = 0.0002621 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.01098 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 15.7% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 38 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 19.07 #>        <eta-lin1,delta>/|delta| = 0.0002262 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.009477 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 14.6% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 39 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 17.72 #>        <eta-lin1,delta>/|delta| = 0.0001952 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.008182 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 13.6% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 40 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 16.46 #>        <eta-lin1,delta>/|delta| = 0.0001686 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.007066 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 12.7% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 41 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: |lin1-lin0| = 15.3 #>        <eta-lin1,delta>/|delta| = 0.0001456 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.006104 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 11.8% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 42 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: |lin1-lin0| = 14.23 #>        <eta-lin1,delta>/|delta| = 0.0001258 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.005275 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 11% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 43 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: |lin1-lin0| = 13.23 #>        <eta-lin1,delta>/|delta| = 0.0001087 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.004559 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 10.2% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 44 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100%, Optimisation #> iinla: |lin1-lin0| = 12.3 #>        <eta-lin1,delta>/|delta| = 9.398e-05 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.003941 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 9.49% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Convergence criterion met, running final INLA integration with known theta mode. #> iinla: Iteration 45 [max:100] #> Finish model fitting  #> Start model fitting  #> Start creating grid...  #> Finished creating grid, time  5.954548 #> iinla: Evaluate component inputs #> iinla: Evaluate component linearisations #> iinla: Evaluate component simplifications #> iinla: Evaluate predictor linearisation #> iinla: Construct inla stack #> iinla: Model initialisation completed #> iinla: Iteration 1 [max:100] #> iinla: Step rescaling: 92.06%, Optimisation #> iinla: |lin1-lin0| = 174.3 #>        <eta-lin1,delta>/|delta| = -3.799 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 18.5 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Iteration 2 [max:100] #> iinla: Step rescaling: 99.32%, Optimisation #> iinla: |lin1-lin0| = 41.11 #>        <eta-lin1,delta>/|delta| = -0.1645 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 1.838 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 42.5% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 3 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 99.99%, Optimisation #> iinla: |lin1-lin0| = 10.12 #>        <eta-lin1,delta>/|delta| = -0.001882 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.09727 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 16.1% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Iteration 4 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 5.642 #>        <eta-lin1,delta>/|delta| = -0.0001879 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.01588 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 10.5% of SD, and line search is active [stop if: <10% and line search inactive] #> iinla: Iteration 5 [max:100] #> iinla: Step rescaling: 162%, Expand #> iinla: Step rescaling: 100%, Overstep #> iinla: Step rescaling: 100.1%, Optimisation #> iinla: |lin1-lin0| = 5.666 #>        <eta-lin1,delta>/|delta| = -0.0001337 #>        |eta-lin0 - delta <delta,eta-lin0>/<delta,delta>| = 0.007986 #> iinla: Evaluate component linearisations #> iinla: Evaluate predictor linearisation #> iinla: Max deviation from previous: 6.5% of SD, and line search is inactive [stop if: <10% and line search inactive] #> iinla: Convergence criterion met, running final INLA integration with known theta mode. #> iinla: Iteration 6 [max:100] #> Finish model fitting"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-posteriors-with-corresponding-starting-values","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions > Analysis of M6.7 catalogue","what":"Plot posteriors with corresponding starting values","title":"Sensitivity to starting point","text":"","code":"plots <- list()  trueParas <- data.frame(value = c(mu, K, alpha, c, p), param = c(\"mu\", \"K\", \"alpha\", \"c\", \"p\"))  post.list <- get_posterior_param(input.list = list.output.quietScenario[[1]]) post.df <- post.list[[1]] post.df$id <- 1  for (i in 2:nRealisations) {   post.list <- get_posterior_param(input.list = list.output.quietScenario[[i]])   post.df.tmp <- post.list[[1]]   post.df.tmp$id <- i    post.df <- rbind(post.df, post.df.tmp) }  plots[[1]] <- ggplot(post.df, aes(x = x, y = y, group = id, color = factor(id), lty = factor(id))) +   geom_line() +   # scale_x_discrete(guide = guide_axis(check.overlap = TRUE)) +   facet_wrap(facets = vars(param), scales = \"free\", labeller = label_parsed, nrow = 1) +   geom_vline(aes(xintercept = value),     data = trueParas, color = \"black\", linetype = 2,     label = \"True value\"   ) +   labs(color = \"Initial ETAS Para. Set\", linetype = \"Initial ETAS Para. Set\") +   ggtitle(paste(\"A.  Inversion of a 1000 day catalogue with no large events, nEvents =\", length(quiet.ETAS.cat$ts))) +   xlab(\"ETAS Posteriors\") +   theme_bw() +   theme(axis.text.x = element_text(angle = 45, hjust = 1)) +   theme(legend.position = \"hidden\") +   theme(plot.title = element_text(size = 12)) #> Warning in geom_vline(aes(xintercept = value), data = trueParas, color = #> \"black\", : Ignoring unknown parameters: `label` trueParas <- data.frame(value = c(mu, K, alpha, c, p), param = c(\"mu\", \"K\", \"alpha\", \"c\", \"p\"))  post.list <- get_posterior_param(input.list = list.output.M6p7Scenario[[1]]) post.df <- post.list[[1]] post.df$id <- 2  for (i in 2:nRealisations) {   post.list <- get_posterior_param(input.list = list.output.M6p7Scenario[[i]])   post.df.tmp <- post.list[[1]]   post.df.tmp$id <- i    post.df <- rbind(post.df, post.df.tmp) }  plots[[2]] <- ggplot(post.df, aes(x = x, y = y, group = id, color = factor(id), lty = factor(id))) +   geom_line() +   # scale_x_discrete(guide = guide_axis(check.overlap = TRUE)) +   facet_wrap(facets = vars(param), scales = \"free\", labeller = label_parsed, nrow = 1) +   geom_vline(aes(xintercept = value),     data = trueParas, color = \"black\", linetype = 2,     label = \"True value\"   ) +   labs(color = \"Initial ETAS Para. Set\", linetype = \"Initial ETAS Para. Set\") +   ggtitle(paste(\"B. Inversion of a 1000 day catalogue with a M6.7 on day 500, nEvents =\", length(M6p7.ETAS.cat$ts))) +   xlab(\"ETAS Posteriors\") +   theme_bw() +   theme(axis.text.x = element_text(angle = 45, hjust = 1)) +   theme(legend.position = \"hidden\") +   theme(plot.title = element_text(size = 12)) #> Warning in geom_vline(aes(xintercept = value), data = trueParas, color = #> \"black\", : Ignoring unknown parameters: `label` plt <- grid_arrange_shared_legend(plots[[1]], plots[[2]], ncol = 1, nrow = 2, position = \"bottom\") plt #> TableGrob (2 x 1) \"arrange\": 2 grobs #>   z     cells    name              grob #> 1 1 (1-1,1-1) arrange   gtable[arrange] #> 2 2 (2-2,1-1) arrange gtable[guide-box] # ggsave(\"initialCondition_posteriors.png\", plt) # ggsave(\"initialCondition_posteriors.pdf\", plt)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"explore-etas-triggering-function-using-posterior-samples","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Explore ETAS triggering function using posterior samples","title":"Sensitivity to starting point","text":"","code":"plot_triggering <- list() plot_triggering[[1]] <- triggering_fun_plot(list.output.quietScenario[[1]], magnitude = 4, n.samp = 100) +   ggtitle(\"C. M4 triggering function\") +   theme_bw() +   ylim(0, 5.5) +   theme(plot.title = element_text(size = 8))  plot_triggering[[2]] <- triggering_fun_plot(list.output.M6p7Scenario[[1]], magnitude = 4, n.samp = 100) +   ggtitle(\"D. M4 triggering function\") +   theme_bw() +   ylim(0, 5.5) +   theme(plot.title = element_text(size = 8))  plot_triggering[[3]] <- triggering_fun_plot(list.output.quietScenario[[1]], magnitude = 6.7, n.samp = 100) +   ggtitle(\"E. M6.7 triggering function\") +   theme_bw() +   ylim(0, 1700) +   theme(plot.title = element_text(size = 8))   plot_triggering[[4]] <- triggering_fun_plot(list.output.M6p7Scenario[[1]], magnitude = 6.7, n.samp = 100) +   ggtitle(\"F. M6.7 triggering function\") +   theme_bw() +   ylim(0, 1700) +   theme(plot.title = element_text(size = 8))   plt <- grid.arrange(plot_triggering[[1]], plot_triggering[[3]], plot_triggering[[2]], plot_triggering[[4]], ncol = 2, nrow = 2, top = \"Triggering function variability\") +   theme(plot.title = element_text(size = 8)) #> Warning: Removed 3 rows containing missing values (`geom_line()`). #> Warning: Removed 29 rows containing missing values (`geom_line()`). #> Warning: Removed 2 rows containing missing values (`geom_line()`). #> Warning: Removed 74 rows containing missing values (`geom_line()`). #> Warning: Removed 2 rows containing missing values (`geom_line()`). plt #> NULL  # ggsave(\"trigFuncVariability_runin.png\", plt) # ggsave(\"trigFuncVariability_runin.pdf\", plt) plot_omori <- list() plot_omori[[1]] <- omori_plot_posterior(list.output.quietScenario[[1]], n.samp = 100) +   ggtitle(\"A. Omori decay\") +   theme_bw() +   ylim(0, 1) +   theme(plot.title = element_text(size = 8))   plot_omori[[2]] <- omori_plot_posterior(list.output.M6p7Scenario[[1]], n.samp = 100) +   ggtitle(\"B. Omori decay\") +   theme_bw() +   ylim(0, 1) +   theme(plot.title = element_text(size = 8)) plt <- grid.arrange(plot_omori[[1]], plot_triggering[[1]], plot_triggering[[3]], plot_omori[[2]], plot_triggering[[2]], plot_triggering[[4]], ncol = 3, nrow = 2, top = \"Triggering  function variability\", left = \"M6.7 baseline            Unseeded baseline\") #> Warning: Removed 3 rows containing missing values (`geom_line()`). #> Warning: Removed 29 rows containing missing values (`geom_line()`). #> Warning: Removed 2 rows containing missing values (`geom_line()`). #> Warning: Removed 74 rows containing missing values (`geom_line()`). #> Warning: Removed 2 rows containing missing values (`geom_line()`). plt #> TableGrob (3 x 4) \"arrange\": 8 grobs #>   z     cells    name                 grob #> 1 1 (2-2,2-2) arrange       gtable[layout] #> 2 2 (2-2,3-3) arrange       gtable[layout] #> 3 3 (2-2,4-4) arrange       gtable[layout] #> 4 4 (3-3,2-2) arrange       gtable[layout] #> 5 5 (3-3,3-3) arrange       gtable[layout] #> 6 6 (3-3,4-4) arrange       gtable[layout] #> 7 7 (1-1,2-4) arrange text[GRID.text.1299] #> 8 8 (1-3,1-1) arrange text[GRID.text.1300]  # ggsave(\"trigFuncVariability_runin.png\", plt) # ggsave(\"trigFuncVariability_runin.pdf\", plt)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"plot-the-samples-from-the-joint-posteriors-as-pairs-plots","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"Plot the samples from the joint posteriors as pairs plots","title":"Sensitivity to starting point","text":"","code":"post_pairs_plot(list.output.quietScenario[[1]], n.samp = 1000)$pair.plot post_pairs_plot(list.output.M6p7Scenario[[1]], n.samp = 1000)$pair_plot #> NULL"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/sensitivityToStartingPoint.html","id":"inlabru-convergence-diagnostics","dir":"Articles","previous_headings":"Analyse the sensitivity to starting conditions","what":"inlabru convergence diagnostics","title":"Sensitivity to starting point","text":"can also assess convergence inlabru method , using bru_convergence_plot() function. can reveal starting values inlabru estimation unreasonable, better starting values nonlinear iterations might speed computations.","code":"bru_convergence_plot(list.output.quietScenario[[1]]$model.fit) bru_convergence_plot(list.output.quietScenario[[2]]$model.fit) bru_convergence_plot(list.output.M6p7Scenario[[1]]$model.fit) bru_convergence_plot(list.output.M6p7Scenario[[2]]$model.fit)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"introduction-to-etas-model","dir":"Articles","previous_headings":"","what":"Introduction to ETAS model","title":"2d Temporal Model: Tutorial on real data","text":"tutorial, show use ETAS.inlabru R-package fit temporal ETAS model real earthquakes data. tutorial shows prepare data, fit model, retrieve posterior distribution parameters posterior distribution quantities interest, generate synthetic catalogues fitted model, produce forecasts seismicity. Epidemic-Type Aftershock Sequence (ETAS) model belongs family Hawkes () point processes. temporal Hawkes process point process model conditional intensity given \\[ \\lambda(t | \\mathcal H_t) = \\mu + \\sum_{t_h \\\\mathcal H_t} g(t- t_h) \\] \\(\\mathcal H_t\\) history process time \\(t\\). Generally speaking \\(\\mathcal H_t\\) contains events occurred \\(t\\). quantity \\(\\mu > 0\\) usually called , interpreted rate events occur spontaneously. function \\(g(t-t_h)\\) called function (excitation function, simply kernel) measures influence event \\(t_h\\) time \\(t\\). look \\(g(t-t_h)\\) function \\(t\\) intensity point process representing offspring event \\(t_h\\). seismology offspring event called , two terms used synonyms. essence, Hawkes process model can seen superposition background process intensity \\(\\mu\\) aftershock processes generated observations \\(\\mathcal H_t\\) one intensity \\(g(t-t_h)\\). makes Hawkes process model particularly suitable describe phenomena event ability trigger additional events, phenomena characterized cascades events earthquakes, infectious diseases, wildfires, financial crisis, similar. ETAS model particular instance Hawkes process model proven particularly suitable model earthquake occurrence. Earthquakes usually described modelled marked time points marking variable magnitude event. history process composed time-magnitude pairs, namely \\(\\mathcal H_t = \\{(t_h,m_h), h = 1,...,N_h\\}\\). Various slightly different ETAS formulations exist, usually characterized slightly different triggering functions, one implemented ETAS.inlabru R-package conditional intensity given \\[ \\lambda(t | \\mathcal H_t) = \\mu + \\sum_{t_h \\\\mathcal H_t} K \\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] \\(M_0\\) cutoff magnitude \\(m_h \\geq M_0\\) \\(h\\). value decided priori based quality catalogue used. parameters model : \\(\\mu \\geq 0\\), background rate \\(K \\geq 0\\) general productivity parameter, plays role determining average number aftershocks induced event catalogue. \\(\\alpha \\geq 0\\) magnitude scaling parameter, determines number aftershocks changes based magnitude event generating aftershocks. non-negative reflect fact stronger earthquakes generate aftershocks. \\(c > 0\\) time offset parameter, smaller values associated catalogues fewer missing events. \\(p > 1\\) aftershock decay parameter, determines rate aftershock activity decreases time. greater 1 otherwise event may generate infinite number aftershocks infinite interval time thought unphysical.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"priors","dir":"Articles","previous_headings":"","what":"Priors","title":"2d Temporal Model: Tutorial on real data","text":"Bayesian analysis need decide priors parameters. approximation method use considers parameters two different scales: original ETAS scale, internal scale. internal scale used package perform calculations. internal scale parameters constraint standard normal distribution prior. need set priors parameters ETAS scale. done considering copula transformation \\(\\eta(X)\\) \\(X \\sim N(0,1)\\) , \\(\\eta(X)\\) desired distribution. ETAS.inlabru R-package provides four different functions corresponding three different distributions: gamma_t(X, , b) Gamma distribution shape parameter \\(\\) rate \\(b\\). distribution mean \\(/b\\) variance \\(/b^2\\). unit_t(X, , b) Uniform distribution \\(\\) \\(b\\). exp_t(X, r) Exponential distribution rate \\(r\\). loggaus_t(X, m ,s) Log-Gaussian distribution mean logarithm \\(m\\) standard deviation logarithm \\(s\\). code generate 1000 observations normal distribution, transform using functions provided package, shows empirical density estimated sample.  package also provide inverse functions retrieve value parameter internal scale value ETAS scale provided. example decided priors going use analysis, need store corresponding copula transformations list. list one element parameter model (\\(5\\)), element list must name corresponding parameter. names fixed mu, K, alpha, c_, p. parameter \\(c\\) referred c_ avoid clashing names R function c(). useful inverse functions also, list used set initial value parameters later. code assumes parameter \\(\\mu\\) Gamma distribution prior parameters \\(0.3\\) \\(0.6\\), parameters \\(K, \\alpha,\\) \\(c\\) Uniform prior \\((0,10)\\), parameter \\(p\\) Uniform prior \\((1,10)\\).","code":"# obtain sample from standard normal distribution X <- rnorm(1000) # apply copula transformations gamma.X <- gamma_t(X, 1, 2) unif.X <- unif_t(X, 0, 1) exp.X <- exp_t(X, 1) loggaus.X <- loggaus_t(X, 0.5, 0.5)  # build data.frame for plotting df.to.plot <- rbind(   data.frame(     value = X,     distribution = \"Std Normal\"   ),   data.frame(     value = gamma.X,     distribution = \"Gamma\"   ),   data.frame(     value = unif.X,     distribution = \"Uniform\"   ),   data.frame(     value = exp.X,     distribution = \"Exponential\"   ),   data.frame(     value = loggaus.X,     distribution = \"Log-Gaussian\"   ) ) # plot them ggplot(df.to.plot, aes(value)) +   geom_histogram() +   theme_bw() +   facet_wrap(facets = ~distribution, scales = \"free\") #> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. inv_gamma_t(gamma_t(1.2, 1, 2), 1, 2) #> [1] 1.2 inv_unif_t(unif_t(1.2, 1, 2), 1, 2) #> [1] 1.2 inv_exp_t(exp_t(1.2, 1), 1) #> [1] 1.2 inv_loggaus_t(loggaus_t(1.2, 1, 2), 1, 2) #> [1] 1.2 # set copula transformations list link.f <- list(   mu = \\(x) gamma_t(x, 0.3, 0.6),   K = \\(x) unif_t(x, 0, 10),   alpha = \\(x) unif_t(x, 0, 10),   c_ = \\(x) unif_t(x, 0, 10),   p = \\(x) unif_t(x, 1, 10) )  # set inverse copula transformations list inv.link.f <- list(   mu = \\(x) inv_gamma_t(x, 0.3, 0.6),   K = \\(x) inv_unif_t(x, 0, 10),   alpha = \\(x) inv_unif_t(x, 0, 10),   c_ = \\(x) inv_unif_t(x, 0, 10),   p = \\(x) inv_unif_t(x, 1, 10) )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"laquila-seismic-sequence","dir":"Articles","previous_headings":"","what":"L’Aquila seismic sequence","title":"2d Temporal Model: Tutorial on real data","text":"Earthquake data stored -called earthquake catalogues. Many different catalogues exists region easy way decide one better. , provide subset HOmogenized instRUmental Seismic (HORUS) catalogue 1960 2020. can downloaded http://horus.bo.ingv./. See data-raw/horus.R details subset created original data set. HORUS catalogue subset can accessed directly using horus ETAS.inlabru::horus: documentation data set available via ?horus. data reports earthquake time string (time_string), longitude (lon) latitude (lat) epicentre, depth kilometres (depth), moment magnitude (M). focus L’Aquila seismic sequence sufficient retain observations specific space-time-magnitude region include sequence interest. L’Aquila sequence, retain events magnitude greater equal \\(2.5\\) happened 2009 longitude \\((10.5, 16)\\) latitude \\((40.5, 45)\\). L’Aquila sequence selected way composed 1024 events. seismic sequence can selected similarly. selection convenient transform time string Date object select rows Horus catalogue verifying conditions. data can visually represented plotting time event magnitude. shows clustering observations correspondance high magnitude events. L’Aquila seismic sequence, times versus magnitudes","code":"# load HORUS catalogue head(horus) #>           time_string     lon     lat depth    M #> 1 1960-01-03T20:19:34 15.3000 39.3000   290 6.34 #> 2 1960-01-04T09:20:00 13.1667 43.1333     0 3.94 #> 3 1960-01-06T15:17:34 12.7000 46.4833     4 4.69 #> 4 1960-01-06T15:20:53 12.7000 46.4667     0 4.14 #> 5 1960-01-06T15:31:00 12.7500 46.4333     0 3.00 #> 6 1960-01-06T15:45:00 12.7500 46.4333     0 3.00 # transform time string in Date object horus$time_date <- as.POSIXct(   horus$time_string,   format = \"%Y-%m-%dT%H:%M:%OS\" ) # There may be some incorrectly registered data-times in the original data set, # that as.POSIXct() can't convert, depending on the system. # These should ideally be corrected, but for now, we just remove the rows that # couldn't be converted. horus <- na.omit(horus)  # set up parameters for selection start.date <- as.POSIXct(\"2009-01-01T00:00:00\", format = \"%Y-%m-%dT%H:%M:%OS\") end.date <- as.POSIXct(\"2010-01-01T00:00:00\", format = \"%Y-%m-%dT%H:%M:%OS\") min.longitude <- 10.5 max.longitude <- 16 min.latitude <- 40.5 max.latitude <- 45 M0 <- 2.5  # set up conditions for selection aquila.sel <- (horus$time_date >= start.date) &   (horus$time_date < end.date) &   (horus$lon >= min.longitude) &   (horus$lon <= max.longitude) &   (horus$lat >= min.latitude) &   (horus$lat <= max.latitude) &   (horus$M >= M0)  # select aquila <- horus[aquila.sel, ] ggplot(aquila, aes(time_date, M)) +   geom_point() +   theme_bw()"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"data-preparation-to-model-fitting","dir":"Articles","previous_headings":"","what":"Data preparation to model fitting","title":"2d Temporal Model: Tutorial on real data","text":"need prepare data.frame used input data fit ETAS model. data.frame must three columns: ts time difference starting date occurrence time events (measured days example), magnitudes magnitude events, idx.p index column different value event. names fixed changed , need set initial values parameters list containing inlabru options used. initial values stored list elements th.mu, th.K, th.alpha, th.c, th.p corresponds ETAS parameters. initial values must provided internal scale therefore useful retrieve using inverse copula transformations set . way, can find values parameters internal scale given value parameters ETAS scale. example uses \\(\\mu = 0.5, K = 0.1, \\alpha = 1, c = 0.1,\\) \\(p = 1.1\\) initial values. crucial set initial values cause numerical problems, general achieved setting initial values zero. values provided worked well various examples. Lastly, need set list inlabru options. main elements list : bru_verbose: number indicating type diagnostic output. Set 0 output. bru_max_iter: maximum number iterations. set max_step inlabru algorithm stops stopping criterion met. However, setting max_step values smaller 1 forces algorithm run exactly bru_max_iter iterations. bru_method: relevant , thing may need set max_step argument. algorithm converge without fixing max_step suggest try fix value 1, experience \\(0.5\\) \\(0.2\\) works well. example line setting bru_method commented. bru_initial: list initial values created . Note: option list, one can also set number threads allowed INLA , e.g. num.threads = 8. override global option set beginning tutorial. code likely run many different systems, using global setting easier manage.","code":"# set up data.frame for model fitting aquila.bru <- data.frame(   ts = as.numeric(     difftime(aquila$time_date, start.date, units = \"days\")   ),   magnitudes = aquila$M,   idx.p = 1:nrow(aquila) ) # set up list of initial values th.init <- list(   th.mu = inv.link.f$mu(0.5),   th.K = inv.link.f$K(0.1),   th.alpha = inv.link.f$alpha(1),   th.c = inv.link.f$c_(0.1),   th.p = inv.link.f$p(1.1) ) # set up list of bru options bru.opt.list <- list(   bru_verbose = 3, # type of visual output   bru_max_iter = 70, # maximum number of iterations   # bru_method = list(max_step = 0.5),   bru_initial = th.init # parameters' initial values )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"model-fitting","dir":"Articles","previous_headings":"","what":"Model fitting","title":"2d Temporal Model: Tutorial on real data","text":"function Temporal.ETAS fit ETAS model returns bru object output. required inputs : total.data: data.frame containing observed events. format described previous Section. M0: cutoff magnitude. events total.data must magnitude greater equal number. T1: starting time time interval want fit model. T2: end time time interval want fit model. link.functions: list copula transformation functions format described previous sections. coef.t., delta.t., N.max.: parameters temporal binning. binning strategy described Appendix B paper Approximation Bayesian Hawkes process inlabru. parameters corresponds coef.t.\\(=\\delta\\), delta.t.\\(=\\Delta\\), N.max.\\(=n_{\\max}\\). bru.opt: list inlabru options described previous Section.","code":"# set starting and time of the time interval used for model fitting. In this case, we use the interval covered by the data. T1 <- 0 T2 <- max(aquila.bru$ts) + 0.2 # Use max(..., na.rm = TRUE) if there may still be NAs here # fit the model aquila.fit <- Temporal.ETAS(   total.data = aquila.bru,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  2.299931"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"create-input-list","dir":"Articles","previous_headings":"","what":"Create input list","title":"2d Temporal Model: Tutorial on real data","text":"model fitted package ETAS.inlabru offers various functions visually explore output. require input list. list must different elements depending function going use. retrieve posterior parameters sample posterior parameters need two elements: model.fit: output Temporal.ETAS link.functions: list copula transformations","code":"# create input list to explore model output input_list <- list(   model.fit = aquila.fit,   link.functions = link.f )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"check-marginal-posterior-distributions","dir":"Articles","previous_headings":"","what":"Check marginal posterior distributions","title":"2d Temporal Model: Tutorial on real data","text":"function get_posterior_param can use retrieve marginal posteriors parameters ETAS scale. function returns list elements: post.df: data.frame containing posterior parameters. data.frame three columns, x value parameter, y corresponding value posterior, param indicates ETAS parameter x y referring . post.plot: ggplot object containing plot marginal posteriors parameters","code":"# get marginal posterior information post.list <- get_posterior_param(input.list = input_list)  # plot marginal posteriors post.list$post.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"sample-the-joint-posterior-and-make-pair-plot","dir":"Articles","previous_headings":"","what":"Sample the joint posterior and make pair plot","title":"2d Temporal Model: Tutorial on real data","text":"function post_sampling generate samples joint posterior ETAS parameters. function takes input: input.list: list model.fit element link.functions elements described . n.samp: number posterior samples. max.batch: number posterior samples generated simultaneously. n.samp\\(>\\)max.batch, , samples generated parallel batches maximum size equal max.batch. Default \\(1000\\). ncore: number cores used parallel n.samp\\(>\\)max.batch. function returns data.frame columns corresponding ETAS parameters posterior samples can used analyse correlation parameters. function post_pairs_plot generate pair plot posterior samples taken input. function 4 arguments need specified. input : post.samp: data.frame samples joint posterior distribution parameters. NULL samples generated function . input.list: input list arguments model.fit link.functions used generate posterior samples. used post.samp = NULL. Default NULL. n.samp: number posterior samples. NULL, samples post.samp used. post.samp NULL, n.samp samples generated joint posterior. post.samp n.samp NULL n.samp samples randomly (uniformly replacement) selected post.samp. Default NULL max.batch number posterior samples generated simultaneously. used post.samp NULL. Default NULL function returns list two elements: post.samp posterior samples, pair.plot ggplot object containing pair plot.","code":"post.samp <- post_sampling(   input.list = input_list,   n.samp = 1000,   max.batch = 1000,   ncore = num.cores ) #> Warning: The `ncore` argument of `post_sampling()` is deprecated as of ETAS.inlabru #> 1.1.1.9001. #> ℹ Please use future::plan(future::multisession, workers = ncore) in your code #>   instead. #> This warning is displayed once every 8 hours. #> Call `lifecycle::last_lifecycle_warnings()` to see where this warning was #> generated.  head(post.samp) #>          mu         K    alpha          c        p #> 1 0.3021242 0.1302891 2.519261 0.05201877 1.147929 #> 2 0.2914638 0.1038356 2.448769 0.10150325 1.219382 #> 3 0.2843393 0.1691639 2.479588 0.03744396 1.127995 #> 4 0.3055755 0.1440415 2.404510 0.06691007 1.159365 #> 5 0.2762775 0.1109113 2.454912 0.07800483 1.167500 #> 6 0.2770023 0.1501069 2.384977 0.07666930 1.192113 pair.plot <- post_pairs_plot(   post.samp = post.samp,   input.list = NULL,   n.samp = NULL,   max.batch = 1000 ) #> Registered S3 method overwritten by 'GGally': #>   method from    #>   +.gg   ggplot2 pair.plot$pair.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"check-posterior-number-of-events","dir":"Articles","previous_headings":"","what":"Check posterior number of events","title":"2d Temporal Model: Tutorial on real data","text":"quantity interest posterior distribution number events. can accessed using function get_posterior_N requires input list. However, list needs additional elements respect one used now. Specifically, need add T12 extremes time interval want calculate number events, M0 cutoff magnitude, catalog.bru data.frame containing observed events. latter format total.data used Temporal.ETAS function. function returns list three elements: post.plot plot distribution, post.plot.shaded plot distribution shaded regions representing \\(95\\%\\) interval distribution, post.df data.frame used generate plots. vertical line plots represent number events catalog.bru element input list.","code":"# set additional elements of the list input_list$T12 <- c(T1, T2) input_list$M0 <- M0 input_list$catalog.bru <- aquila.bru N.post <- get_posterior_N(input.list = input_list) N.post$post.plot"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"posterior-of-the-triggering-function-and-omori-law","dir":"Articles","previous_headings":"","what":"Posterior of the triggering function and Omori law","title":"2d Temporal Model: Tutorial on real data","text":"functions triggering_fun_plot triggering_fun_plot_prior plot, respectively, quantiles posterior prior distribution triggering function \\(g(t-t_h, mh)\\), namely, \\[ g(t - t_h, m_h) = K\\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] function takes input input.list: input list defined functions used previously. post.samp: data.frame samples posterior distribution parameters. NULL, n.samp samples generated posterior. n.samp: number posterior samples parameters used generated. magnitude: magnitude event (\\(m_h\\)). t.end: maximum value \\(t\\) plot. n.breaks: number breaks interval \\((0, \\texttt{t.end})\\) divided. function returns ggplot object. sample parameters triggering function \\(0\\) t.end calculated. black solid lines represents \\(95\\%\\) posterior interval function, grey lines represent triggering function calculated posterior samples, horizontal red lines represent \\(95\\%\\) posterior interval background rate \\(\\mu\\). function triggering_fun_plot_prior value parameters sampled according prior distribution rather posterior, therefore, need specify posterior samples data.frame.   functions omori_plot_posterior omori_plot_prior functions triggering_fun_plot triggering_fun_plot_prior considering \\[ \\left(\\frac{t- t_h}{c} + 1\\right)^{-p} \\] instead whole triggering function without background rate.","code":"triggering_fun_plot(   input.list = input_list,   post.samp = post.samp,   n.samp = NULL, magnitude = 4,   t.end = 5, n.breaks = 100 ) triggering_fun_plot_prior(input.list = input_list, magnitude = 4, n.samp = 1000, t.end = 10) omori_plot_posterior(input.list = input_list, post.samp = post.samp, n.samp = NULL, t.end = 5) omori_plot_prior(input.list = input_list, n.samp = 1000, t.end = 5)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"generate-synthetic-catalogues-from-model","dir":"Articles","previous_headings":"","what":"Generate synthetic catalogues from model","title":"2d Temporal Model: Tutorial on real data","text":"earthquake forecast usually composed collection synthetic catalogues model. package ETAS.inlabru provides function generate synthetic catalogues given set parameters. can used produce forecasts simply produce synthetic catalogues. function generate synthetic catalogues called generate_temporal_ETAS_synthetic takes input theta: list ETAS parameters names mu, K, alpha, c, p, corresponding ETAS parameters. beta.p: parameter magnitude distribution M0: cutoff magnitude, generated event magnitude greater M0. T1: starting time catalogue (unit measure depends unit used fit model). T2: end time catalogue (unit measure depends unit used fit model). Ht: set known events. can also T1 T2, useful want generate catalogues imposed events. Regarding magnitude distribution, exponential, specificically assume \\[ m - M_0 \\sim \\text{Exp}(\\beta) \\] parameter \\(\\beta\\) usually estimated independently ETAS parameters. use maximum likelihood estimator \\(\\beta\\) given \\[ \\hat\\beta = \\frac{1}{\\bar{m} - M_0} \\] \\(\\bar m\\) mean observed magnitudes values. function returns list data.frame, element output list corresponds different generation. data.frame three columns: occurence time (ts), magnitude (magnitudes), generation identifier (gen). generation identifier uses following convention, \\(-1\\) indicates events Ht time T1 T2, \\(0\\) indicates first generation offspring events gen equal \\(-1\\), \\(1\\) indicates background events, \\(2\\) offspring events gen equal \\(0\\) \\(1\\), \\(3\\) indicates offspring events gen equal \\(2\\), \\(4\\) indicates offspring events gen equal \\(3\\), . obtain unique data.frame containing simulated events sufficient bind rows generations. example generate 1 synthetic catalogue using parameters one posterior samples generated . catalogue covers time span L’Aquila catalogue impose greatest event sequence.  can easily generate multiple catalogues. code generates 8 catalogues using different samples posterior distribution parameters. red point indicates event imposed last panel represents observed L’Aquila sequence.","code":"# maximum likelihood estimator for beta beta.p <- 1 / (mean(aquila.bru$magnitudes) - M0) synth.cat.list <- generate_temporal_ETAS_synthetic(   theta = post.samp[1, ], # ETAS parameters   beta.p = beta.p, # magnitude distribution parameter   M0 = M0, # cutoff magnitude   T1 = T1, # starting time   T2 = T2, # end time   Ht = aquila.bru[which.max(aquila.bru$magnitudes), ] # known events ) # merge into unique data.frame synth.cat.df <- do.call(rbind, synth.cat.list) # order events by time synth.cat.df <- synth.cat.df[order(synth.cat.df$ts), ]  ggplot(synth.cat.df, aes(ts, magnitudes, color = as.factor(gen))) +   geom_point(size = 0.5) set.seed(2) n.cat <- 8 # generate catalogues as list of lists multi.synth.cat.list <- lapply(seq_len(n.cat), \\(x) generate_temporal_ETAS_synthetic(   theta = post.samp[x, ],   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = aquila.bru[which.max(aquila.bru$magnitudes), ] ))  # store catalogues as list of data.frames multi.synth.cat.list.df <- lapply(multi.synth.cat.list, \\(x) do.call(rbind, x)) # set catalogue identifier multi.synth.cat.list.df <- lapply(seq_len(n.cat), \\(x) cbind(multi.synth.cat.list.df[[x]],   cat.idx = x )) # merge catalogues in unique data.frame multi.synth.cat.df <- do.call(rbind, multi.synth.cat.list.df)  # we need to bing the synthetics with the observed catalogue for plotting cat.df.for.plotting <- rbind(   multi.synth.cat.df,   cbind(aquila.bru[, c(\"ts\", \"magnitudes\")],     gen = NA,     cat.idx = \"observed\"   ) )  # plot them ggplot(cat.df.for.plotting, aes(ts, magnitudes)) +   geom_point(size = 0.5) +   geom_point(     data = aquila.bru[which.max(aquila.bru$magnitudes), ],     mapping = aes(ts, magnitudes),     color = \"red\"   ) +   facet_wrap(facets = ~cat.idx)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_real.html","id":"forecasting","dir":"Articles","previous_headings":"","what":"Forecasting","title":"2d Temporal Model: Tutorial on real data","text":"earthquake forecast usually collection synthetic catalogues generated model. bayesian models can reflect uncertainty parameters values generating synthetic catalogue composing forecast using different set parameters sampled join posterior distribution. can generate forecasts using function Temporal.ETAS.forecast. function takes input post.samp: data.frame samples posterior distribution parameters format described previous sections. n.cat: number synthetic catalogues composing forecast. n.cat greater nrow(post.samp), rows post.samp sampled uniformly replacement n.cat times. n.cat smaller nrow(post.samp), , rows post.samp sampled uniformly without replacement n.cat times. n.cat NULL equal nrow(post.samp), , post.samp used . ncore: number cores used generate synthetic catalogues parallel. remaining inputs (beta.p, M0, T1, T2, Ht) ones used generate_temporal_ETAS_synthetic. output function list two elements: fore.df n.cat. element fore.df data.frame synthetic catalogues binded together row, multi.synth.cat.df created . element n.cat just number catalogues generated. need n.cat zero-events catalogues appear fore.df, corresponding cat.idx value missing. Therefore need n.cat recover total number catalogues. code creates daily forecast 24 hours starting 1 minute event greatest magnitude sequence. starting date end date forecast expressed unit used catalogue fit model (days case). Day zero correspond start.date stated beginning document example \\(2009-01-01 00:00:00\\). forecast generated assuming known events catalogue occurred forecasting period. can easily retrieve predictive distribution number events forecasting period looking frequencies catalogue identifiers appears fore.df element. Indeed, number rows fore.df cat.idx value represents number events synthetic catalogue. , frequency catalogue identifier appears fore.df$cat.idx correspond number events catalogue. allows easily retrieve predictive distribution number events using code . remark case can use function table find frequencies elements fore.df$cat.idx. catalogue identifier zero-events catalogues present fore.df$cat.idx. using table lead zero probability zero events day, quantity crucial intersted probability earthquake activity (probability least one event).","code":"# express 1 minute in days min.in.days <- 1 / (24 * 60) # find time of the event with the greatest magnitude t.max.mag <- aquila.bru$ts[which.max(aquila.bru$magnitudes)] # set starting time of the forecasting period T1.fore <- t.max.mag + min.in.days # set forecast length fore.length <- 1 # set end time of the forecasting period T2.fore <- T1.fore + fore.length # set known data Ht.fore <- aquila.bru[aquila.bru$ts < T1.fore, ]  # produce forecast daily.fore <- Temporal.ETAS.forecast(   post.samp = post.samp, # ETAS parameters posterior samples   n.cat = nrow(post.samp), # number of synthetic catalogues   beta.p = beta.p, # magnitude distribution parameter   M0 = M0, # cutoff magnitude   T1 = T1.fore, # forecast starting time   T2 = T2.fore, # forecast end time   Ht = Ht.fore, # known events   ncore = num.cores ) # number of cores # find number of events per catalogue N.fore <- vapply(   seq_len(daily.fore$n.cat),   \\(x) sum(daily.fore$fore.df$cat.idx == x), 0 ) # find number of observed events in the forecasting period N.obs <- sum(aquila.bru$ts >= T1.fore & aquila.bru$ts <= T2.fore) # plot the distribution ggplot() +   geom_histogram(aes(x = N.fore, y = after_stat(density)), binwidth = 1) +   geom_vline(xintercept = N.obs) +   xlim(100, 500) #> Warning: Removed 25 rows containing non-finite values (`stat_bin()`). #> Warning: Removed 2 rows containing missing values (`geom_bar()`)."},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"2c Temporal Model: Tutorial on synthetic data","text":"tutorial shows use ETAS.inlabru package generate synthetic catalogue temporal ETAS model fit ETAS model data. also show retrieve posterior distribution parameters quantity interest. brief introduction ETAS model refer tutorial real earthquake data.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"generate-a-synthetic-catalogue","dir":"Articles","previous_headings":"","what":"Generate a synthetic catalogue","title":"2c Temporal Model: Tutorial on synthetic data","text":"function generate_temporal_ETAS_synthetic() can used generate synthetic catalogues temporal ETAS model fixed parameters spanning given interval time. generate_temporal_ETAS_synthetic() takes input theta: list ETAS parameters names mu, K, alpha, c, p, corresponding ETAS parameters. beta.p: parameter magnitude distribution M0: cutoff magnitude, generated event magnitude greater M0. T1: starting time catalogue (unit measure depends unit used fit model). T2: end time catalogue (unit measure depends unit used fit model). Ht: set known events. can also T1 T2, useful want generate catalogues imposed events. NULL events imposed. function returns list data.frame, element output list corresponds different generation. data.frame three columns: occurence time (ts), magnitude (magnitudes), generation identifier (gen). generation identifier uses following convention, \\(-1\\) indicates events Ht time T1 T2, \\(0\\) indicates first generation offspring events gen equal \\(-1\\), \\(1\\) indicates background events, \\(2\\) offspring events gen equal \\(0\\) \\(1\\), \\(3\\) indicates offspring events gen equal \\(2\\), \\(4\\) indicates offspring events gen equal \\(3\\), . obtain unique data.frame containing simulated events sufficient bind rows generations. code generates synthetic catalogue events magnitude greater \\(2.5\\) according temporal ETAS model parameters equal vector true.param. value parameters equal posterior mean parameters obtained fitting model L’Aquila seismic sequence done tutorial real data. Also parameter \\(\\beta\\) magnitude distribution comes example. output function list data.frames convenient transform single data.frame binding rows data.frames list. synthetic catalogue composed total \\(288\\) events \\(112\\) background events \\(176\\) aftershocks. can easily retrieve numbers looking gen column data. code plot occurrence time events magnitude color indicating generation event time evolution cumulative number events. multiplot function provided inlabru R-package can used combine plots.","code":"set.seed(111) # set true ETAS parameters true.param <- list(mu = 0.30106014, K = 0.13611399, alpha = 2.43945301, c = 0.07098607, p = 1.17838741) # set magnitude distribution parameter beta.p <- 2.353157 # set cutoff magnitude M0 <- 2.5 # set starting time of the synthetic catalogue T1 <- 0 # set end time of the synthetic catalogue T2 <- 365 # generate the catalogue - it returns a list of data.frames synth.cat.list <- generate_temporal_ETAS_synthetic(   theta = true.param,   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = NULL ) synth.cat.df <- do.call(rbind, synth.cat.list) head(synth.cat.df) #>           ts magnitudes gen #> 1 135.204031   2.661688   1 #> 2 187.947198   2.632073   1 #> 3 137.847074   3.073890   1 #> 4 152.693124   2.653628   1 #> 5   3.890113   2.686633   1 #> 6 194.287763   3.035756   1 c(N = nrow(synth.cat.df), N.bkg = sum(synth.cat.df$gen == 1), N.after = sum(synth.cat.df$gen > 1)) #>       N   N.bkg N.after  #>     283     112     171 pl1 <- ggplot(synth.cat.df, aes(ts, magnitudes, color = as.factor(gen))) +   geom_point() +   labs(color = \"gen\")  t.breaks <- T1:T2 N.cumsum <- vapply(t.breaks, \\(x) sum(synth.cat.df$ts < x), 0) df.to.cumsum.plot <- data.frame(ts = t.breaks, N.cum = N.cumsum) pl2 <- ggplot(df.to.cumsum.plot, aes(ts, N.cum)) +   geom_line() +   ylab(\"cumulative number of events\")  inlabru::multiplot(pl1, pl2, cols = 2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"prepare-data-for-model-fitting","dir":"Articles","previous_headings":"","what":"Prepare data for model fitting","title":"2c Temporal Model: Tutorial on synthetic data","text":"order fit model synthetic catalogue need set parameters priors set initial value parameters set inlabru options prepare data model fitting set priors need create list copula transformation (simply link) functions. method works internal representation parameters parameter Gaussian distribution. need function transform parameters original ETAS scale set prior . ETAS.inlabru package offers four different functions corresponding four different prior distributions. functions gamma_t, unif_t, exp_t, loggaus_t corresponds Gamma distribution, Uniform distribution, Exponential distribution Log-Gaussian distribution. also provide inverse functions retrieve value parameters internal scale given value ETAS scale. inv_gamma_t, inv_unif_t, exp_t, inv_loggaus_t. example going consider following priors parameters \\[\\begin{align*} \\mu & \\sim \\Gamma(0.3, 0.6) \\\\ K & \\sim \\text{Unif}(0,10) \\\\ \\alpha & \\sim \\text{Unif}(0,10) \\\\ c & \\sim \\text{Unif}(0,10) \\\\ p & \\sim \\text{Unif}(1,10) \\end{align*}\\] list link functions corresponding priors initial value parameters inlabru algorithm must specified internal scale parameters. reason, useful create list inverse link functions can specify initial value parameters ETAS scale easily retrieve corresponding value parameters internal scale. can done shown initial value parameters specified list names th.mu, th.K, th.alpha, th.c, th.p, , example, th.mu corresponds initial value parameter \\(\\mu\\) internal scale. initial value parameters important ensure algorithm able converge. Indeed, start algorithm values parameters causing numerical problems, may prevent algorithm converge. experience, setting initial values parameter (e.g. \\(< 10^{-5}\\)) (e.g. \\(> 10^2\\)) safe choice. code uses following initial values parameters \\(\\mu_{\\text{init}} = 0.5, K_{\\text{init}} = 0.1, \\alpha_{\\text{init}} = 1, c_{\\text{init}} = 0.1, p_{\\text{init}} = 1.1\\) Also inlabru options provided list, main elements list : bru_verbose: number indicating type visual output. Set 0 output. bru_max_iter: maximum number iterations. set max_step inlabru algorithm stops stopping criterion met. However, setting max_step values smaller 1 forces algorithm run exactly bru_max_iter iterations. bru_method: relevant , thing may need set max_step argument. algorithm converge without fixing max_step suggest try fix value 1, experience \\(0.5\\) \\(0.2\\) works well. example line setting bru_method commented. bru_initial: list initial values created . Lastly, need prepare data model fitting. data must provided data.frame least 3 columns names ts corresponding occurrence time events, magnitudes corresponding magnitude, idx.p event identifier. events data.frame must sorted respect occurrence time. synthetic catalogue generated beginning already columns ts magnitudes, sorted generation time. code sort rows data.frame adds event identifier","code":"# set copula transformations list link.f <- list(   mu = \\(x) gamma_t(x, 0.3, 0.6),   K = \\(x) unif_t(x, 0, 10),   alpha = \\(x) unif_t(x, 0, 10),   c_ = \\(x) unif_t(x, 0, 10),   p = \\(x) unif_t(x, 1, 10) ) # set inverse copula transformations list inv.link.f <- list(   mu = \\(x) inv_gamma_t(x, 0.3, 0.6),   K = \\(x) inv_unif_t(x, 0, 10),   alpha = \\(x) inv_unif_t(x, 0, 10),   c_ = \\(x) inv_unif_t(x, 0, 10),   p = \\(x) inv_unif_t(x, 1, 10) ) # set up list of initial values th.init <- list(   th.mu = inv.link.f$mu(0.5),   th.K = inv.link.f$K(0.1),   th.alpha = inv.link.f$alpha(1),   th.c = inv.link.f$c_(0.1),   th.p = inv.link.f$p(1.1) ) # set up list of bru options bru.opt.list <- list(   bru_verbose = 3, # type of visual output   bru_max_iter = 70, # maximum number of iterations   # bru_method = list(max_step = 0.5),   bru_initial = th.init ) # parameters initial values # sort catalogue by occurrence time synth.cat.df <- synth.cat.df[order(synth.cat.df$ts), ] # add event identifier synth.cat.df$idx.p <- seq_len(nrow(synth.cat.df))"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"model-fitting","dir":"Articles","previous_headings":"","what":"Model Fitting","title":"2c Temporal Model: Tutorial on synthetic data","text":"function Temporal.ETAS fit ETAS model returns bru object output. required inputs : total.data: data.frame containing observed events. format described previous Section. M0: cutoff magnitude. events total.data must magnitude greater equal number. T1: starting time time interval want fit model. T2: end time time interval want fit model. link.functions: list copula transformation functions format described previous sections. coef.t., delta.t., N.max.: parameters temporal binning. binning strategy described Appendix B paper Approximation Bayesian Hawkes process inlabru. parameters corresponds coef.t.\\(=\\delta\\), delta.t.\\(=\\Delta\\), N.max.\\(=n_{\\max}\\). bru.opt: list inlabru options described previous Section.","code":"synth.fit <- Temporal.ETAS(   total.data = synth.cat.df,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  0.5988903"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"check-marginal-posterior-distributions","dir":"Articles","previous_headings":"","what":"Check marginal posterior distributions","title":"2c Temporal Model: Tutorial on synthetic data","text":"order retrieve marginal posterior distributions parameter need provide list containing two elements: model.fit bru object containing fitted model, link.functions list link functions created . list created, function get_posterior_param returns marginal posterior distribution parameters ETAS scale. function returns list two elements: post.df data.frame three columns, x indicating value parameter, y indicating corresponding value marginal posterior distribution, param parameter identifier. output list also contains post.plot ggplot object containing plot marginal posterior distributions parameter. code retrieve marginal posterior distribution parameters plot along true value parameters represented vertical dashed lines.","code":"# create input list to explore model output input_list <- list(   model.fit = synth.fit,   link.functions = link.f ) # retrieve marginal posterior distributions post.list <- get_posterior_param(input.list = input_list)  # create data.frame of true value of parameters df.true.param <- data.frame(   x = unlist(true.param),   param = names(true.param) ) # add to the marginal posterior distribution of the parameters the true value of the parameters. post.list$post.plot +   geom_vline(     data = df.true.param,     mapping = aes(xintercept = x), linetype = 2   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"sampling-the-joint-posterior-distribution","dir":"Articles","previous_headings":"","what":"Sampling the joint posterior distribution","title":"2c Temporal Model: Tutorial on synthetic data","text":"function post_sampling generate samples joint posterior ETAS parameters. function takes input: input.list: list model.fit element link.functions elements described . n.samp: number posterior samples. max.batch: number posterior samples generated simultaneously. n.samp\\(>\\)max.batch, , samples generated parallel batches maximum size equal max.batch. Default \\(1000\\). ncore: number cores used parallel n.samp\\(>\\)max.batch. function returns data.frame columns corresponding ETAS parameters posterior samples can used estimate posterior distribution functions parameters.","code":"post.samp <- post_sampling(   input.list = input_list,   n.samp = 1000,   max.batch = 1000,   ncore = 1 ) #> Warning: The `ncore` argument of `post_sampling()` is deprecated as of ETAS.inlabru #> 1.1.1.9001. #> ℹ Please use future::plan(future::multisession, workers = ncore) in your code #>   instead. #> This warning is displayed once every 8 hours. #> Call `lifecycle::last_lifecycle_warnings()` to see where this warning was #> generated. head(post.samp) #>          mu          K    alpha          c        p #> 1 0.2703242 0.07772063 2.817706 0.04405354 1.158531 #> 2 0.2962545 0.11946073 2.530242 0.07333611 1.209367 #> 3 0.2937161 0.06262619 2.522844 0.19481556 1.336901 #> 4 0.3273610 0.09268547 2.473937 0.22724007 1.503260 #> 5 0.3138248 0.12545886 2.545132 0.09331670 1.322615 #> 6 0.2925499 0.10534268 2.521352 0.11295471 1.326896"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"triggering-function-and-omori-law","dir":"Articles","previous_headings":"","what":"Triggering function and Omori law","title":"2c Temporal Model: Tutorial on synthetic data","text":"Interesting functions parameters triggering function Omori law. can estimate posterior distribution functions using samples joint posterior distribution parameters obtained previous section. functions triggering_fun_plot provides plot quantiles posterior distribution triggering function \\(g(t-t_h, mh)\\), namely, \\[ g(t - t_h, m_h) = K\\exp\\{\\alpha(m_h - M_0)\\}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} \\] function takes input input.list: input list defined functions used previously. post.samp: data.frame samples posterior distribution parameters. NULL, n.samp samples generated posterior. n.samp: number posterior samples parameters used generated. magnitude: magnitude event (\\(m_h\\)). t.end: maximum value \\(t\\) plot. n.breaks: number breaks interval \\((0, \\texttt{t.end})\\) divided. function returns ggplot object. sample parameters triggering function \\(0\\) t.end calculated. black solid lines represents \\(95\\%\\) posterior interval function, grey lines represent triggering function calculated posterior samples, horizontal red lines represent \\(95\\%\\) posterior interval background rate \\(\\mu\\). function triggering_plot_prior using parameters sampled priors parameters. code creates plot posterior triggering function adds triggering function calculated true parameter values blue. need add argument M0 input_list use function triggering_fun_plot.  functions omori_plot_posterior function triggering_fun_plot considering \\[ \\left(\\frac{t- t_h}{c} + 1\\right)^{-p} \\] instead whole triggering function without background rate.","code":"# add cutoff magnitude to input_list input_list$M0 <- M0  # generate triggering function plot trig.plot <- triggering_fun_plot(   input.list = input_list,   post.samp = post.samp,   n.samp = NULL, magnitude = 4,   t.end = 5, n.breaks = 100 )  # set times at which calculate the true triggering function t.breaks <- seq(1e-6, 5, length.out = 100) # calculate the function true.trig <- gt(unlist(true.param), t = t.breaks, th = 0, mh = 4, M0 = M0) # store in data.frame for plotting true.trig.df <- data.frame(ts = t.breaks, trig.fun = true.trig)  # add the true triggering function to the plot trig.plot +   geom_line(     data = true.trig.df,     mapping = aes(x = ts, y = trig.fun), color = \"blue\"   ) omori.plot <- omori_plot_posterior(input.list = input_list, post.samp = post.samp, n.samp = NULL, t.end = 5)  true.omori <- omori(theta = unlist(true.param), t = t.breaks, ti = 0) true.omori.df <- data.frame(ts = t.breaks, omori.fun = true.omori)  omori.plot +   geom_line(     data = true.omori.df,     mapping = aes(x = ts, y = omori.fun), color = \"blue\"   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/articles/tutorial_synth.html","id":"comparison-between-different-fitted-models","dir":"Articles","previous_headings":"","what":"Comparison between different fitted models","title":"2c Temporal Model: Tutorial on synthetic data","text":"interesting fit model multiple synthetic catalogues compare parameters posterior distributions obtained different catalogues. section, going generate second synthetic catalogue, fit model, compare posterior distributions ones obtained . second catalogue impose large event magnitude \\(6\\) happening midpoint time interval. first step set data.frame known events generate second synthetic catalogue Counting number background events aftershocks case slightly different . fact, count imposed event background event, aftershocks need include also event gen = 0 ones induced imposed event case 192. comparison number events two catalogues. Notice background events roughly expected given time interval . , just need set data.frame model fitting. inputs can use ones created first model fit. Now, extract marginal posterior distributions, need create input_list second model fit. Now, can retrieve marginal posterior distributions provided model fitted second catalogue compare ones obtained .  process shown can extended multiple (\\(>2\\)) input catalogues order study parameters identifiable. Also, using characteristics input catalogue catalogue identifier can study change posterior distribution characteristic input catalogue changes. interesting example number events catalogue, studying marginal posterior distributions change increase decrease number events.","code":"# set up data.frame of imposed events Ht.imposed <- data.frame(   ts = mean(c(T1, T2)),   magnitudes = 6 ) # generate second catalogue set.seed(1) synth.cat.list.2 <- generate_temporal_ETAS_synthetic(   theta = true.param,   beta.p = beta.p,   M0 = M0,   T1 = T1,   T2 = T2,   Ht = Ht.imposed,   ncore = 1 ) # transform it in a data.frame synth.cat.df.2 <- do.call(rbind, synth.cat.list.2) sum(synth.cat.df.2$gen == 0) #> [1] 192 rbind(   first = c(     N = nrow(synth.cat.df),     N.bkg = sum(synth.cat.df$gen == 1),     N.after = sum(synth.cat.df$gen > 1)   ),   second = c(     N = nrow(synth.cat.df.2),     N.bkg = sum(synth.cat.df.2$gen == 1 | synth.cat.df.2$gen == -1),     N.after = sum(synth.cat.df.2$gen > 1 | synth.cat.df.2$gen == 0)   ) ) #>           N N.bkg N.after #> first   283   112     171 #> second 1082   104     978 synth.cat.df.2 <- synth.cat.df.2[order(synth.cat.df.2$ts), ] synth.cat.df.2$idx.p <- seq_len(nrow(synth.cat.df.2))  synth.fit.2 <- Temporal.ETAS(   total.data = synth.cat.df.2,   M0 = M0,   T1 = T1,   T2 = T2,   link.functions = link.f,   coef.t. = 1,   delta.t. = 0.1,   N.max. = 5,   bru.opt = bru.opt.list ) #> Start creating grid...  #> Finished creating grid, time  2.257848 input_list.2 <- list(   model.fit = synth.fit.2,   link.functions = link.f ) # retrieve marginal posterior distributions post.list.2 <- get_posterior_param(input.list = input_list.2)  # set model identifier post.list$post.df$cat.used <- \"first catalogue\" post.list.2$post.df$cat.used <- \"second catalogue\"  # bind marginal posterior data.frames bind.post.df <- rbind(post.list$post.df, post.list.2$post.df)  # plot them ggplot(bind.post.df, aes(x = x, y = y, color = cat.used)) +   geom_line() +   facet_wrap(facets = ~param, scales = \"free\") +   xlab(\"param\") +   ylab(\"pdf\") +   geom_vline(     data = df.true.param,     mapping = aes(xintercept = x), linetype = 2   )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Francesco Serafini. Author, maintainer. Mark Naylor. Author, thesis advisor. Finn Lindgren. Author, thesis advisor.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Mark Naylor, & Francesco Serafini (2023). edinburgh-seismicity-hub/ETAS.inlabru: Temporal Hawkes (v1.0.1).  Zenodo. https://doi.org/10.5281/zenodo.7515785 Mark Naylor, Francesco Serafini, Finn Lindgren (2023). doi:10.3389/fams.2023.1126759, https://www.frontiersin.org/articles/10.3389/fams.2023.1126759 Francesco Serafini, Finn Lindgren, Mark Naylor (2023). doi:10.1002/env.2798, https://onlinelibrary.wiley.com/doi/abs/10.1002/env.2798","code":"@Misc{,   title = {edinburgh-seismicity-hub/ETAS.inlabru: Temporal Hawkes},   author = {Mark Naylor and Francesco Serafini},   publisher = {Zenodo},   year = {2023},   number = {v1.0.1},   url = {https://doi.org/10.5281/zenodo.7515785},   doi = {10.5281/zenodo.7515785}, } @Article{,   title = {Bayesian modelling of the temporal evolution of seismicity using the ETAS.inlabru R-package},   author = {Mark Naylor and Francesco Serafini and Finn Lindgren},   journal = {Frontiers in Applied Mathematics and Statistics},   year = {2023},   doi = {10.3389/fams.2023.1126759},   url = {https://www.frontiersin.org/articles/10.3389/fams.2023.1126759}, } @Article{,   title = {Approximation of Bayesian Hawkes process with inlabru},   author = {{Serafini} and {Francesco} and {Lindgren} and {Finn} and {Naylor} and {Mark}},   journal = {Environmetrics},   year = {2023},   doi = {10.1002/env.2798},   url = {https://onlinelibrary.wiley.com/doi/abs/10.1002/env.2798}, }"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"etasinlabru","dir":"","previous_headings":"","what":"Bayesian ETAS model for modelling seismic sequences with inlabru","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"R package implements ETAS Hawkes process modelling seismicity Online documentation: https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"authors","dir":"","previous_headings":"","what":"Authors","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Dr Francesco Serafini Dr Mark Naylor , School GeoSciences, University Edinburgh Prof Finn Lindgren , School Mathematics, University Edinburgh Dr Kirsty Bayliss , Global Earthquake Model (GEM)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"funding","dir":"","previous_headings":"","what":"Funding","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"study funded yhe Real-Time Earthquake Risk Reduction Resilient Europe RISE project , received funding European Union’s Horizon 2020 Research Innovation Program grant Agreement 821115. Naylor additionally funded NSFGEO-NERC grant NE/R000794/1. Bayliss funded EPSRC Studentship.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"ETAS.inlabru work, need install R-INLA inlabru: inlabru (see https://inlabru-org.github.io/inlabru/): CRAN release, development version, R-INLA (see https://www.r-inla.org/download-install): can install development version ETAS.inlabru GitHub ","code":"install.packages(\"inlabru\") # install.packages(\"remotes\") remotes::install_github(\"inlabru-org/inlabru\") install.packages(   \"INLA\",   repos = c(getOption(\"repos\"), INLA=\"https://inla.r-inla-download.org/R/testing\"),   dep = TRUE ) # install.packages(\"remotes\") remotes::install_github(\"edinburgh-seismicity-hub/ETAS.inlabru\")"},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"file-structure-in-package","dir":"","previous_headings":"Terminology and planning suggestions","what":"File structure in package","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"ETAS.triggering.function.R : Contains ETAS specific model functions HawkesProcess.R : Generic Hawkes code intended integration back inlabru generateSyntheticCatalogues.R : Contains iterative Hawkes functions generating triggered events actual triggering functions reside ETAS file introduce models temporalBinning.R : Code generate time bins make integration scheme efficient plottingFunctions.R : lets put standard plotting functions setupInlabruInputs.R : Put functions generating input.list ","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"terminology","dir":"","previous_headings":"","what":"Terminology","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Let’s specific just temporal clear function names spatial spatial-temporal later Might anything bad? tried modify just theta","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"implemented","dir":"","previous_headings":"","what":"Implemented","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Generation synthetic ETAS catalogues ETAS.inlabru demonstration notebook","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"in-development","dir":"","previous_headings":"","what":"In development","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Add inversion modelling based original code Modify implementation generic Hawkes code can go inlabru ETAS triggering function code stay package Implement time varying incompleteness model Farnaz Kamranzad","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/index.html","id":"roadmap","dir":"","previous_headings":"","what":"Roadmap","title":"Bayesian ETAS model for modelling seismic sequences with inlabru","text":"Implement incompleteness fix Integrate spatial modelling","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/ETAS.inlabru-package.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru — ETAS.inlabru-package","title":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru — ETAS.inlabru-package","text":"Modelling inversion ETAS model seismicity using inlabru Epidemic Type Aftershock Sequence (ETAS) model designed model earthquakes triggered previous events. statistics, referred Hawkes process. code can used generate synthetic ETAS catalogues can also include seeded events model specific sequences. also implement Bayesian inversion scheme using Integrated Nested Laplace Approximation (INLA) using inlabru. temporal model, given training catalogue times magnitudes, code returns joint posteriors ETAS parameters. future roadmap, include tools model spatial distribution spatio-temporal evolution seismic sequences.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/ETAS.inlabru-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ETAS.inlabru: Bayesian ETAS model for modelling seismic sequences with inlabru — ETAS.inlabru-package","text":"Maintainer: Francesco Serafini francesco.serafini@newcastle.ac.uk (ORCID) Authors: Mark Naylor mark.naylor@ed.ac.uk (ORCID) [thesis advisor] Finn Lindgren Finn.Lindgren@ed.ac.uk (ORCID) [thesis advisor]","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":null,"dir":"Reference","previous_headings":"","what":"Injection Rate function calculations — IntInjectionIntensity","title":"Injection Rate function calculations — IntInjectionIntensity","text":"Forward time integrated function exponential rate decay, inverse","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Injection Rate function calculations — IntInjectionIntensity","text":"","code":"IntInjectionIntensity(a = 50, V.i = 1, tau = 10, T.i, T2)  Inv_IntInjectionIntensity(   a = 50,   V.i = 1,   tau = 10,   T.i,   number.injected.events )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Injection Rate function calculations — IntInjectionIntensity","text":"Event rate per unit volume injected V.Injected volume tau Decay rate [days] T.Time injection event T2 End temporal model domain number.injected.events number expected injected events, used inverse.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/IntInjectionIntensity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Injection Rate function calculations — IntInjectionIntensity","text":"IntInjectionIntensity returns forward time integrated function exponential rate decay. Inv_IntInjectionIntensity returns end time corresponding given expected number injected events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":null,"dir":"Reference","previous_headings":"","what":"Integrated Omori's law — Int_ETAS_time_trig_function","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"Integrated Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"","code":"Int_ETAS_time_trig_function(theta, th, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p) th Time past event [days] start temporal domain, vector. T2 End temporal domain, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"Value integral Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Int_ETAS_time_trig_function.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Integrated Omori's law — Int_ETAS_time_trig_function","text":"function returns integral Omori's law, namely $$\\int_{t_h}^{T_2} \\left(\\frac{t - t_h}{c} + 1\\right)^{-p} dt$$","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"Inverse integrated Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"","code":"Inv_Int_ETAS_time_trig_function(theta, omega, th)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p) omega Value integral inverted, vector th Time integral calculated scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"Value start temporal domain used calculate integral","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Inv_Int_ETAS_time_trig_function.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Inverse of integrated Omori's law — Inv_Int_ETAS_time_trig_function","text":"Considering integral Omori's law $$\\omega = \\int_{t_h}^{T_2}\\left(\\frac{t - t_h}{c} + 1\\right)^{-p} dt$$ function applied value \\(\\omega\\) returns value \\(t_h\\).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to calculate the integral of Omori's law — It_df","title":"Function to calculate the integral of Omori's law — It_df","text":"Function calculate integral Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to calculate the integral of Omori's law — It_df","text":"","code":"It_df(param_, time.df)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to calculate the integral of Omori's law — It_df","text":"param_ ETAS parameters vector (\\(\\mu, K, \\alpha, c, p\\)), \\(c, p\\) used. time.df output function time_grid()","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/It_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to calculate the integral of Omori's law — It_df","text":"vector integral values bin provided time.df","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"Fits remporal ETAS model returns results. function decomposes input.list `Hawkes.bru2`` function.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"","code":"Temporal.ETAS.fit(input.list)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"input.list input data parameters passed inlabru via structured list. output function create_input_list_temporal_withCatalogue create_input_list_temporal_noCatalogue","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fits the remporal ETAS model and returns the results. This function decomposes the input.list for the `Hawkes.bru2`` function. — Temporal.ETAS.fit","text":"fitted model bru object, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — Temporal.ETAS.forecast","title":"Title — Temporal.ETAS.forecast","text":"Title","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — Temporal.ETAS.forecast","text":"","code":"Temporal.ETAS.forecast(post.samp, n.cat, beta.p, M0, T1, T2, Ht, ncore = NULL)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — Temporal.ETAS.forecast","text":"post.samp data.frame containing samples posterior distribution ETAS parameters. row data.frame corresponds different sample parameters order \\(\\mu\\), \\(K\\), \\(\\alpha\\), \\(c\\), \\(p\\). n.cat number synthetic catalogues composing forecast. n.cat greater nrow(post.samp), , n.cat rows sampled uniformly replacement post.samp. n.cat smaller nrow(post.samp), , n.cat rows sampled uniformly without replacement post.samp. n.cat NULL equal nrow(post.samp), post.samp used nrow(post.samp) catalogues generated. beta.p parameter magnitude distribution M0 cutoff magnitude, synthetic events magnitude greater value. T1 starting time forecast T2 end time forecast Ht set known events ncore Deprecated argument controlling parallelism. Use future::plan(future::multisession, workers = ncore) (similar) configure parallelism code instead.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.forecast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — Temporal.ETAS.forecast","text":"list two elements: fore.df data.frame containing synthetic catalogues composing forecast. data.frame four columns, ts occurrence time, magnitudes magnitude, gen generation event, cat.idx catalogue identifier second element output list n.cat number synthetic catalogues generated.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to fit Hawkes process model — Temporal.ETAS","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"function fit temporal ETAS model using inlabru.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"","code":"Temporal.ETAS(   total.data,   M0,   T1,   T2,   link.functions = NULL,   coef.t.,   delta.t.,   N.max.,   bru.opt )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"total.data Observed events: data.frame columns time (ts), magnitude (magnitudes), event identifier (idx.p). Column names must changed. M0 Minimum magnitude threshold, scalar T1 Start temporal model domain, scalar [measure unit sample.s$ts]. T2 End temporal model domain, scalar [measure unit sample.s$ts]. link.functions Functions transform parameters internal INLA scale ETAS scale. must list functions names (mu, K, alpha, c_, p) coef.t. TimeBinning parameter: parameter regulating relative length successive bins, scalar. delta.t. TimeBinning parameter: parameter regulating bins' width, scalar. N.max. TimeBinning parameter: parameter regulating Number bins (= N.max + 2), scalar. bru.opt Runtime options inlabru: See https://inlabru-org.github.io/inlabru/reference/bru_call_options.html, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/Temporal.ETAS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to fit Hawkes process model — Temporal.ETAS","text":"fitted model 'bru' object, list","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":null,"dir":"Reference","previous_headings":"","what":"Find breaks point for 1D grid — breaks_exp","title":"Find breaks point for 1D grid — breaks_exp","text":"breaks_exp return breaks points one dimensional grid depending three parameters, see details","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find breaks point for 1D grid — breaks_exp","text":"","code":"breaks_exp(start.grid, end.grid, coef.t = 2, delta.t, N.exp. = 10)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find breaks point for 1D grid — breaks_exp","text":"start.grid Starting point grid, scalar. end.grid End point grid, scalar. coef.t TimeBinning parameter: \\(\\delta > 0\\) determines relative length subsequent intervals, scalar. delta.t TimeBinning parameter: \\(\\Delta > 0\\) determines length intervals, scalar. N.exp. TimeBinning parameter: \\(n_{max} >0\\) determines maximum number intervals, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find breaks point for 1D grid — breaks_exp","text":"vector containing grid points","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Find breaks point for 1D grid — breaks_exp","text":"grid calculated follows $$t, t + \\Delta, t + \\Delta(1 + \\delta), t + \\Delta(1 + \\delta)^2,...., T$$ \\(t\\) start.grid argument, \\(T\\) end.grid argument, \\(n_{max}\\) maximum value exponent","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/breaks_exp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find breaks point for 1D grid — breaks_exp","text":"","code":"breaks_exp(start.grid = 1, end.grid = 100, coef.t = 1, delta.t = 1, N.exp. = 3) #> [1]   1   2   3   5   9 100 breaks_exp(start.grid = 1, end.grid = 100, coef.t = 1, delta.t = 1, N.exp. = 10) #> [1]   1   2   3   5   9  17  33  65 100"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to compute the integral of Omori's law efficiently — compute_grid","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"Function compute integral Omori's law efficiently","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"","code":"compute_grid(param., list.input_)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"param. ETAS parameters vector (\\(\\mu, K, \\alpha, c, p\\)), \\(c, p\\) used. list.input_ list containing information calculate integrals efficiently. list created inside Temporal.ETAS function Two elements used time.sel selection rows output time_grid unique t.ref_layer value, data.frame. Imapping mapper unique names provided time.sel original rows output time_grid(), vector.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/compute_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to compute the integral of Omori's law efficiently — compute_grid","text":"vector length list.input_$Imapping integral Omori's law bin.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS conditional intensity - used by inlabru — cond_lambda","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"Function calculate value ETAS model conditional intensity specified time given history process.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"","code":"cond_lambda(theta, t, th, mh, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"theta ETAS parameters list names mu, K, alpha, c, p t Time conditional intensity evaluated, scalar th Time events history process, vector mh Magnitudes events history process, vector M0 Minimum magnitude threshold","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"Value ETAS conditional intensity calculated t history th, mh, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/cond_lambda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ETAS conditional intensity - used by inlabru — cond_lambda","text":"function takes single value t returns ETAS conditional intensity calculated t history th, mh. ETAS conditional intensity given $$\\lambda(t | \\mathcal H_t) = \\mu + \\sum_{h: (t_h,m_h) \\\\mathcal H_t} K e^{\\alpha(m_h - M_0)} \\left( \\frac{t - t_h}{c} + 1\\right)^{-p}$$ use t vector.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"Function create default input list ETAS Hawkes temporal model catalogue specified input file","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"","code":"create_input_list_temporal_noCatalogue(input_path, num.threads = NULL)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"input_path Input file path string num.threads Optional argument number threads used parallel processing inlabru/INLA","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"formatted input.list elements required temporal Hawkes model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_noCatalogue.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to create a default input list for the ETAS Hawkes temporal model where no catalogue is specified in the input file — create_input_list_temporal_noCatalogue","text":"","code":"create_input_list_temporal_noCatalogue(   system.file(\"extdata\", \"user_input_synthetic_noCatalogue.txt\", package = \"ETAS.inlabru\") ) #> $catalog #> NULL #>  #> $catalog.bru #> NULL #>  #> $time.int #> NULL #>  #> $T12 #> [1] \"T1\"  \" T2\" #>  #> $lat.int #> [1] -90  90 #>  #> $lon.int #> [1] -180  180 #>  #> $M0 #> NULL #>  #> $mu.init #> [1] 0.25 #>  #> $K.init #> [1] 0.3 #>  #> $alpha.init #> [1] 1.6 #>  #> $c.init #> [1] 0.2 #>  #> $p.init #> [1] 1.1 #>  #> $a_mu #> [1] 0.5 #>  #> $b_mu #> [1] 0.5 #>  #> $a_K #> [1] -1 #>  #> $b_K #> [1] 0.5 #>  #> $a_alpha #> [1] 0 #>  #> $b_alpha #> [1] 10 #>  #> $a_c #> [1] 0 #>  #> $b_c #> [1] 1 #>  #> $a_p #> [1] 1 #>  #> $b_p #> [1] 2 #>  #> $max_iter #> [1] 100 #>  #> $max_step #> NULL #>  #> $link.functions #> $link.functions$mu #> function (x)  #> gamma_t(x, a_mu, b_mu) #> <bytecode: 0x560f630470e8> #> <environment: 0x560f63049938> #>  #> $link.functions$K #> function (x)  #> loggaus_t(x, a_K, b_K) #> <bytecode: 0x560f63046e10> #> <environment: 0x560f63049938> #>  #> $link.functions$alpha #> function (x)  #> unif_t(x, a_alpha, b_alpha) #> <bytecode: 0x560f63046b38> #> <environment: 0x560f63049938> #>  #> $link.functions$c_ #> function (x)  #> unif_t(x, a_c, b_c) #> <bytecode: 0x560f63046860> #> <environment: 0x560f63049938> #>  #> $link.functions$p #> function (x)  #> unif_t(x, a_p, b_p) #> <bytecode: 0x560f63046588> #> <environment: 0x560f63049938> #>  #>  #> $bru.opt.list #> $bru.opt.list$bru_verbose #> [1] 3 #>  #> $bru.opt.list$bru_max_iter #> [1] 100 #>  #> $bru.opt.list$num.threads #> NULL #>  #> $bru.opt.list$bru_initial #> $bru.opt.list$bru_initial$th.mu #> [1] -0.2978078 #>  #> $bru.opt.list$bru_initial$th.K #> [1] -0.4079456 #>  #> $bru.opt.list$bru_initial$th.alpha #> [1] -0.9944579 #>  #> $bru.opt.list$bru_initial$th.c #> [1] -0.8416212 #>  #> $bru.opt.list$bru_initial$th.p #> [1] -1.281552 #>  #>  #>  #> $coef.t #> [1] 1 #>  #> $delta.t #> [1] 0.1 #>  #> $Nmax #> [1] 8 #>  #> $n.periods #> [1] 120 #>  #> $period.length #> [1] 1 #>  #> $start.date.fore #> NULL #>  #> $magnitude.update #> [1] 5.5 #>  #> $output.name #> [1] \"report_ETAS\" #>"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"Function create default input file ETAS Hawkes temporal model catalogue specified input file.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"","code":"create_input_list_temporal_withCatalogue(input_path, num.threads = NULL)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"input_path path txt file containing experiment's information num.threads Optional argument number threads used parallel processing inlabru/INLA","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/create_input_list_temporal_withCatalogue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to create a default input file for the ETAS Hawkes temporal model where a catalogue is specified in the input file. — create_input_list_temporal_withCatalogue","text":"formatted input.list elements required temporal Hawkes model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"Copula transformation standard Normal distribution Exponential distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"","code":"exp_t(x, r)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"x values standard Normal distribution, vector. r rate exponential distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/exp_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to an Exponential distribution — exp_t","text":"values Exponential distribution rate r, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"Copula transformation standard Normal distribution Gamma distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"","code":"gamma_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"x values standard Normal distribution, vector. shape parameter gamma distribution scalar. b rate parameter gamma distribution scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gamma_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Gamma distribution — gamma_t","text":"values Gamma distribution shape rate b, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":null,"dir":"Reference","previous_headings":"","what":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"Generates synthetic catalogue using ETAS model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"","code":"generate_temporal_ETAS_synthetic(   theta,   beta.p,   M0,   T1,   T2,   Ht = NULL,   format = \"list\",   ncore = NULL )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). M0 minimum magnitude synthetic catalogue. T1 start time synthetic catalogue [days]. T2 end time synthetic catalogue [days]. Ht catalogue history impose synthetic sequence. format \"list\", return list data.frame objects, one generation. \"df\", return data.frame list element joined single data.frame, ordered ts ncore Deprecated argument controlling parallelism. Use future::plan(future::multisession, workers = ncore) (similar) configure parallelism code instead.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"list data.frame objects temporal catalogue columns [ts, magnitudes, gen] , ts times t_i, magnitudes magnitudes M_i, gen includes information generation number, gen_i. join time-ordered data.frame,   ","code":"cata <- generate_temporal_ETAS_synthetic(...) cata <- dplyr::bind_rows(cata) cata <- dplyr::arrange(cata, ts) cata <- generate_temporal_ETAS_synthetic(..., format = \"df\")"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/generate_temporal_ETAS_synthetic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generates a synthetic catalogue using the ETAS model — generate_temporal_ETAS_synthetic","text":"","code":"## EXAMPLE 1: Generate a 1000 day synthetic ETAS catalogue  generate_temporal_ETAS_synthetic(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000 ) #> [[1]] #>            ts magnitudes gen #> 1   161.40323   4.173997   1 #> 2   885.18796   2.511513   1 #> 3   579.84719   2.773467   1 #> 4   751.85679   3.470467   1 #> 5    65.84072   2.670304   1 #> 6   789.39868   3.180021   1 #> 7   737.88964   2.740810   1 #> 8   762.48082   3.389439   1 #> 9   582.19386   2.760092   1 #> 10  187.30343   3.331835   1 #> 11   80.94332   2.747326   1 #> 12  773.69938   2.945097   1 #> 13  384.24778   2.555065   1 #> 14  996.09160   2.683806   1 #> 15   80.23471   2.726704   1 #> 16  788.32256   2.960250   1 #> 17  331.37881   2.786764   1 #> 18  623.20041   4.008912   1 #> 19  655.75102   3.505938   1 #> 20  555.52930   3.286380   1 #> 21  977.95473   2.539626   1 #> 22  613.73235   2.712092   1 #> 23  937.05152   2.746266   1 #> 24  181.93726   3.824325   1 #> 25  546.92863   2.819419   1 #> 26  871.98813   2.674629   1 #> 27  447.23551   2.565233   1 #> 28  895.46554   2.933543   1 #> 29  463.64911   3.053335   1 #> 30   32.71503   3.058574   1 #> 31  600.99490   2.569605   1 #> 32  183.09103   2.552989   1 #> 33  756.13818   2.696338   1 #> 34  147.38883   2.547184   1 #> 35  296.62603   2.586405   1 #> 36   85.73593   3.106408   1 #> 37  183.37927   2.874437   1 #> 38   80.20763   2.666443   1 #> 39  446.96339   2.927574   1 #> 40  268.75997   2.626067   1 #> 41  851.34215   2.891868   1 #> 42  343.37895   2.558184   1 #> 43  628.87281   3.047445   1 #> 44   68.65515   3.024877   1 #> 45  363.89520   3.611999   1 #> 46  349.82542   2.814525   1 #> 47  301.25739   2.718757   1 #> 48  458.94222   2.505514   1 #> 49  591.03987   2.810087   1 #> 50  498.15918   2.758793   1 #> 51  854.40170   3.193579   1 #> 52  991.00431   2.774647   1 #> 53  434.16975   2.593657   1 #> 54  911.83669   3.451381   1 #> 55  475.61428   2.741012   1 #> 56  111.40157   2.560122   1 #> 57  493.88715   4.273946   1 #> 58   91.24073   2.937668   1 #> 59  186.04651   3.053159   1 #> 60  986.41757   2.844659   1 #> 61   53.37124   2.541402   1 #> 62  362.88234   2.510552   1 #> 63  738.57244   2.628007   1 #> 64  367.21607   2.963329   1 #> 65  189.89982   3.600315   1 #> 66  137.39877   2.884479   1 #> 67  491.22500   2.519458   1 #> 68  280.10952   3.487283   1 #> 69  207.18555   2.584097   1 #> 70  564.12909   3.218725   1 #> 71   51.01428   3.134353   1 #> 72  768.28545   2.652197   1 #> 73  509.28962   2.679184   1 #> 74  276.38169   2.668409   1 #> 75  656.10590   2.673049   1 #> 76  653.55796   3.504573   1 #> 77  281.00591   2.701426   1 #> 78  243.62304   2.756456   1 #> 79  573.42292   2.580695   1 #> 80  312.77287   4.663251   1 #> 81  596.16708   2.661705   1 #> 82  706.59546   4.644273   1 #> 83  774.72900   3.192940   1 #> 84  859.65681   3.917628   1 #> 85  180.72805   2.504772   1 #> 86  912.04634   2.820645   1 #> 87  887.35944   2.931596   1 #> 88  574.88381   3.217169   1 #> 89  904.24573   2.808062   1 #> 90   25.69567   2.591399   1 #> 91  954.77785   3.856480   1 #> 92  750.45180   2.858656   1 #> 93  176.55662   3.290669   1 #> 94  599.03188   2.915785   1 #> 95  198.21284   3.110509   1 #> 96  643.90004   3.579917   1 #> 97   87.20753   3.252813   1 #> 98  725.25953   3.740414   1 #> 99  579.29278   3.273966   1 #> 100 699.30225   3.449672   1 #> 101 167.76482   3.731088   1 #> 102 754.54189   2.736057   1 #> 103 916.04528   3.038453   1 #> 104  16.92899   2.802728   1 #> 105 222.15913   2.505045   1 #> 106 255.65033   4.505171   1 #> 107 864.87130   3.383184   1 #> 108 949.31636   2.545618   1 #> 109 204.12807   3.032724   1 #> 110 910.64694   2.695461   1 #>  #> [[2]] #>           ts magnitudes gen #> 1  161.97864   2.526995   2 #> 2  161.75345   3.169416   2 #> 3  632.10853   2.899031   2 #> 4  680.26395   3.381800   2 #> 5  634.73080   2.982017   2 #> 6  631.44418   2.669070   2 #> 7  448.30977   2.703353   2 #> 8  364.33026   3.411092   2 #> 9  369.14620   2.729781   2 #> 10 364.20058   3.407326   2 #> 11 854.45545   2.503520   2 #> 12 961.67472   2.583866   2 #> 13 911.85635   2.985643   2 #> 14 524.35630   2.748140   2 #> 15 571.99665   2.780943   2 #> 16 493.92389   3.249574   2 #> 17 978.33161   3.564461   2 #> 18 186.46664   2.613753   2 #> 19 994.79499   2.510946   2 #> 20 568.55230   2.779200   2 #> 21 654.79185   2.643389   2 #> 22 314.31913   2.629465   2 #> 23 468.47906   2.584764   2 #> 24 313.21562   2.568018   2 #> 25 316.95205   2.601855   2 #> 26 312.77956   2.849714   2 #> 27 321.64020   2.781278   2 #> 28 473.69730   2.619851   2 #> 29 312.93882   2.543052   2 #> 30 322.02394   2.822413   2 #> 31 313.05923   2.693529   2 #> 32 706.64817   2.792437   2 #> 33 707.05545   2.765724   2 #> 34 707.51714   2.987845   2 #> 35 707.49611   3.008736   2 #> 36 760.68404   3.042340   2 #> 37 706.72138   2.994384   2 #> 38 738.12867   2.785012   2 #> 39 708.78231   2.704448   2 #> 40 706.59647   2.607656   2 #> 41 706.69090   2.525134   2 #> 42 774.83348   3.060255   2 #> 43 859.66556   2.831061   2 #> 44 955.36322   2.667271   2 #> 45 955.61897   2.968271   2 #> 46 581.99042   2.925778   2 #> 47 579.69540   2.790810   2 #> 48 169.03404   3.008058   2 #> 49 168.77163   3.201277   2 #> 50 930.49468   2.527094   2 #> 51 916.31325   2.633724   2 #> 52  20.36613   3.661457   2 #> 53 256.33797   2.901593   2 #> 54 356.58680   3.148071   2 #> 55 726.04673   2.569457   2 #> 56 257.37507   2.599518   2 #> 57 255.83007   4.385784   2 #> 58 259.82723   2.675622   2 #> 59 258.23140   3.737942   2 #> 60 273.81558   2.513765   2 #> 61 624.95470   2.959693   2 #> 62 865.06814   2.759285   2 #>  #> [[3]] #>          ts magnitudes gen #> 1  632.8274   3.868617   3 #> 2  364.3681   3.296072   3 #> 3  364.3636   3.021443   3 #> 4  501.4916   2.908281   3 #> 5  494.6327   2.794485   3 #> 6  981.4189   2.739635   3 #> 7  187.3926   2.758898   3 #> 8  831.3841   3.076534   3 #> 9  711.1199   2.678017   3 #> 10 787.4091   2.992491   3 #> 11 579.7603   2.528152   3 #> 12 468.8713   2.923780   3 #> 13 274.1804   3.534619   3 #> 14 256.6169   2.522305   3 #> 15 357.3630   3.523218   3 #> 16 260.8925   2.783911   3 #> 17 449.8196   3.092973   3 #> 18 268.5667   2.503270   3 #> 19 328.5918   2.655531   3 #> 20 865.6255   2.690278   3 #>  #> [[4]] #>         ts magnitudes gen #> 1 678.8639   2.528656   4 #>    ## EXAMPLE 2: To generate a 1000 day catalogue including a M6.7 event on day 500  Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) generate_temporal_ETAS_synthetic(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000,   Ht = Ht ) #> [[1]] #>    ts magnitudes gen #> 1 500        6.7  -1 #>  #> [[2]] #>              ts magnitudes gen #> 1   500.4590293   3.903857   0 #> 2   500.1170547   2.659693   0 #> 3   505.9112910   3.245700   0 #> 4   537.2386776   4.101023   0 #> 5   599.2997581   2.929571   0 #> 6   500.1609439   2.857672   0 #> 7   551.1416241   3.121890   0 #> 8   500.7614857   2.597085   0 #> 9   576.2699907   2.805339   0 #> 10  593.1866524   2.931297   0 #> 11  500.2695385   2.773736   0 #> 12  673.3270044   3.040179   0 #> 13  506.1997101   2.613475   0 #> 14  537.2836515   2.772569   0 #> 15  500.3829128   3.115803   0 #> 16  500.3904772   3.037090   0 #> 17  508.7909852   4.072860   0 #> 18  500.0369986   2.709080   0 #> 19  501.2475187   2.646890   0 #> 20  500.0340275   3.033046   0 #> 21  506.7802666   2.866824   0 #> 22  644.0786638   2.698443   0 #> 23  503.3925387   2.765797   0 #> 24  524.8752611   2.502541   0 #> 25  500.6905028   3.268618   0 #> 26  501.7546890   2.938612   0 #> 27  505.5016625   3.776529   0 #> 28  500.0014297   2.513510   0 #> 29  501.8203185   2.581032   0 #> 30  500.0259989   3.252758   0 #> 31  500.0403871   3.200709   0 #> 32  542.6559663   2.763334   0 #> 33  506.0724017   2.753574   0 #> 34  500.0633875   3.637051   0 #> 35  502.6069119   2.738058   0 #> 36  500.6828578   2.510103   0 #> 37  517.4334218   2.659044   0 #> 38  509.1823237   2.789068   0 #> 39  500.1236176   3.235115   0 #> 40  505.4803666   2.994239   0 #> 41  500.0060732   3.584594   0 #> 42  589.8510211   2.672799   0 #> 43  512.7753751   2.615520   0 #> 44  527.8685854   2.701444   0 #> 45  768.4958354   2.758017   0 #> 46  500.4018741   3.062147   0 #> 47  500.0072530   3.363428   0 #> 48  633.8808332   2.540789   0 #> 49  501.8658071   2.533620   0 #> 50  686.2121165   2.722751   0 #> 51  503.8998481   2.837840   0 #> 52  502.2095197   2.775112   0 #> 53  501.6648980   2.692713   0 #> 54  569.0324492   3.497314   0 #> 55  500.4571431   3.560863   0 #> 56  500.0903354   2.748366   0 #> 57  503.4492282   2.542673   0 #> 58  531.5729658   2.575811   0 #> 59  501.3963491   2.563192   0 #> 60  537.7716268   2.516507   0 #> 61  500.4478903   2.962933   0 #> 62  594.9493916   2.583246   0 #> 63  509.5865122   3.443520   0 #> 64  500.4322287   2.878762   0 #> 65  529.1040501   3.066412   0 #> 66  501.6750813   3.834964   0 #> 67  500.6519894   2.648272   0 #> 68  879.4740078   3.142720   0 #> 69  500.2657342   2.824248   0 #> 70  569.4363235   2.910448   0 #> 71  500.0448131   2.770768   0 #> 72  500.3472946   3.429715   0 #> 73  500.7211624   3.696104   0 #> 74  515.9038840   2.774648   0 #> 75  608.6041616   2.906158   0 #> 76  500.1740066   3.669075   0 #> 77  502.4201406   2.992518   0 #> 78  500.3899349   2.601628   0 #> 79  558.2504617   2.667181   0 #> 80  501.5678422   2.557530   0 #> 81  582.6004868   3.227285   0 #> 82  500.2987867   2.557908   0 #> 83  816.4025914   2.620168   0 #> 84  580.2484435   2.796941   0 #> 85  504.4629011   2.719287   0 #> 86  500.0496503   2.601576   0 #> 87  966.9925502   2.623859   0 #> 88  500.7049329   2.667201   0 #> 89  501.0780998   2.819347   0 #> 90  506.6681580   3.428026   0 #> 91  506.3179128   3.044396   0 #> 92  502.5107150   2.715926   0 #> 93  500.0131318   2.634412   0 #> 94  893.0064330   3.251226   0 #> 95  500.1393010   2.596124   0 #> 96  500.2719618   3.025415   0 #> 97  500.3074206   3.132035   0 #> 98  747.0832844   2.827302   0 #> 99  505.7643705   2.834759   0 #> 100 507.2255566   2.593000   0 #> 101 522.0829614   3.154689   0 #> 102 560.2333481   2.526496   0 #> 103 970.8518816   2.966861   0 #> 104 500.3292287   2.660603   0 #> 105 506.1211963   3.422018   0 #> 106 517.0197097   2.709214   0 #> 107 514.1157209   3.115037   0 #> 108 501.6225792   2.814852   0 #> 109 501.2958214   2.634550   0 #> 110 508.0514472   2.827515   0 #> 111 563.5240715   2.712157   0 #> 112 500.0524931   3.174641   0 #> 113 503.7348349   3.033545   0 #> 114 630.8553460   2.514711   0 #> 115 603.6453937   3.167910   0 #> 116 503.1349863   2.575406   0 #> 117 500.0439337   2.520903   0 #> 118 500.0188180   3.716068   0 #> 119 500.9956762   2.511602   0 #> 120 500.3414373   2.678001   0 #> 121 514.9820277   2.774648   0 #> 122 584.5186215   4.157310   0 #> 123 500.2461795   2.833665   0 #> 124 500.1566749   2.562628   0 #> 125 990.4791073   2.944606   0 #> 126 623.5779596   2.614902   0 #> 127 500.1282287   2.592241   0 #> 128 516.9373691   2.515701   0 #> 129 500.6338502   2.652606   0 #> 130 581.9033546   3.475320   0 #> 131 556.0522731   2.602552   0 #> 132 587.9148862   2.614070   0 #> 133 501.9538885   3.669756   0 #> 134 540.8749009   3.065495   0 #> 135 507.0549177   2.628186   0 #> 136 536.2440358   2.656442   0 #> 137 745.6370628   2.654105   0 #> 138 500.4949234   4.657208   0 #> 139 520.3873549   3.223901   0 #> 140 501.7848268   3.133244   0 #> 141 500.9386036   2.811776   0 #> 142 506.2066988   3.014577   0 #> 143 511.0262834   2.537635   0 #> 144 512.0683533   2.604510   0 #> 145 506.9131806   3.126800   0 #> 146 500.0573220   3.178683   0 #> 147 507.5649271   2.597509   0 #> 148 500.6778621   2.605466   0 #> 149 500.8302487   2.511177   0 #> 150 501.1726729   2.944508   0 #> 151 500.0143640   2.980643   0 #> 152 500.0010930   3.106698   0 #> 153 501.9102842   2.717134   0 #> 154 501.1601405   2.548904   0 #> 155 512.2129903   2.583751   0 #> 156 500.0475872   3.171665   0 #> 157 503.2956138   2.832218   0 #> 158 547.4500637   3.147111   0 #> 159 502.2109531   3.080811   0 #> 160 556.1689202   3.009357   0 #> 161 510.9405197   2.518641   0 #> 162 597.3966182   2.656651   0 #> 163 504.5057908   2.687447   0 #> 164 501.0641656   3.418319   0 #> 165 648.4108719   2.959885   0 #> 166 500.1297584   2.656656   0 #> 167 500.1991276   4.442037   0 #> 168 510.1246259   2.722833   0 #> 169 510.5175007   3.647650   0 #> 170 500.2672349   2.681309   0 #> 171 506.3126814   2.696727   0 #> 172 504.9145519   2.565318   0 #> 173 508.3711164   3.741628   0 #> 174 531.7044093   2.650154   0 #> 175 500.1407835   2.665445   0 #> 176 500.1930914   2.581179   0 #> 177 514.9889530   2.524767   0 #> 178 501.6301895   4.028187   0 #> 179 503.5808510   2.798446   0 #> 180 500.1725718   3.171542   0 #> 181 775.3064175   3.174162   0 #> 182 648.3898121   2.612969   0 #> 183 500.9323555   3.159268   0 #> 184 500.3433607   2.780440   0 #> 185 694.0835678   3.148221   0 #> 186 594.4968844   2.768279   0 #> 187 529.2314437   2.717371   0 #> 188 501.4416854   3.013236   0 #> 189 536.7161169   2.550009   0 #> 190 533.4673281   2.643448   0 #> 191 500.2804628   2.542387   0 #> 192 555.3427865   3.485581   0 #> 193 508.3577350   2.510912   0 #> 194 500.1701227   2.500079   0 #> 195 608.2199732   2.945022   0 #> 196 503.4755088   3.272358   0 #> 197 500.6004040   2.501095   0 #> 198 500.1309802   2.842788   0 #> 199 505.5364476   2.832328   0 #> 200 500.2912200   2.606242   0 #> 201 543.1759258   2.566378   0 #> 202 506.7755720   2.794988   0 #> 203 506.9130856   2.692531   0 #> 204 588.0334289   3.614743   0 #> 205 508.1720732   2.673987   0 #> 206 753.7491974   2.707491   0 #> 207 959.7851060   2.568099   0 #> 208 502.0885564   2.564389   0 #> 209 536.7370497   4.256860   0 #> 210 506.4145932   3.267382   0 #> 211 547.7768441   2.589305   0 #> 212 501.2420480   3.629881   0 #> 213 502.4678415   2.589538   0 #> 214 506.7796172   2.600506   0 #> 215 634.7107250   2.537711   0 #> 216 931.7092410   2.645344   0 #> 217 500.0132765   3.119095   0 #> 218 502.1322354   2.555219   0 #> 219 502.0452756   2.550227   0 #> 220 601.3656948   3.057346   0 #> 221 501.3866968   2.687776   0 #> 222 500.0082760   2.691808   0 #> 223 501.1194061   2.876758   0 #> 224 799.1279740   2.511232   0 #> 225 500.3471147   2.539419   0 #> 226 503.4620628   2.530355   0 #> 227 503.8138453   2.551587   0 #> 228 500.2063216   2.575683   0 #> 229 500.0132027   2.540677   0 #> 230 502.9466030   2.698928   0 #> 231 535.0921439   3.101423   0 #> 232 507.6003593   2.981261   0 #> 233 552.0750689   2.768207   0 #> 234 504.6644815   2.990769   0 #> 235 500.2765944   2.739606   0 #> 236 536.6573082   2.621066   0 #> 237 501.2283524   2.502364   0 #> 238 503.4427944   2.914453   0 #> 239 556.7757762   3.850960   0 #> 240 500.1640718   3.179250   0 #> 241 530.6334225   3.370980   0 #> 242 500.0400358   3.121440   0 #> 243 500.1076232   3.768440   0 #> 244 500.7360896   2.544737   0 #> 245 513.4968504   2.510746   0 #> 246 500.5758108   4.566335   0 #> 247 500.4368349   3.876808   0 #> 248 528.2122943   3.015366   0 #> 249 500.3793042   2.824008   0 #> 250 500.0624851   2.562457   0 #> 251 519.7354825   2.800864   0 #> 252 572.5723804   2.661758   0 #> 253 500.3915762   2.740246   0 #> 254 913.6544147   2.684238   0 #> 255 599.4974453   4.550392   0 #> 256 510.5969850   3.078696   0 #> 257 501.4525108   3.123187   0 #> 258 511.8702032   3.289643   0 #> 259 500.4887360   2.536245   0 #> 260 532.9791658   2.996965   0 #> 261 648.2477248   3.313218   0 #> 262 620.6428229   3.267569   0 #> 263 501.2433658   2.555509   0 #> 264 505.5648064   2.615833   0 #> 265 577.8148896   2.547189   0 #> 266 517.6134233   2.612362   0 #> 267 501.2795922   2.529646   0 #> 268 501.0883449   2.566546   0 #> 269 500.0442957   3.803048   0 #> 270 500.1150638   3.458290   0 #> 271 502.6973663   2.535472   0 #> 272 500.0648032   4.262542   0 #> 273 502.7240883   2.699604   0 #> 274 500.2431900   2.543087   0 #> 275 501.6078620   3.103474   0 #> 276 500.1452577   2.926330   0 #> 277 500.2061980   2.796274   0 #> 278 517.0337468   2.827854   0 #> 279 593.7018304   2.510383   0 #> 280 708.7081948   2.851603   0 #> 281 803.7569321   2.550576   0 #> 282 605.4908982   2.791673   0 #> 283 556.7326955   3.547396   0 #> 284 501.9534829   2.654379   0 #> 285 501.6144343   3.390669   0 #> 286 500.1014400   2.668762   0 #> 287 680.9663246   2.570833   0 #> 288 531.0237374   2.536519   0 #> 289 501.8354860   3.109882   0 #> 290 512.0122718   2.783410   0 #> 291 553.2717878   3.031562   0 #> 292 503.6592664   2.710380   0 #> 293 509.9345440   3.099165   0 #> 294 503.7586258   2.619499   0 #> 295 531.1162895   2.761905   0 #> 296 500.0627974   2.682542   0 #> 297 663.0847504   2.750923   0 #> 298 511.3863371   2.810092   0 #> 299 507.1395141   3.364613   0 #> 300 533.3255369   2.720789   0 #> 301 500.5083297   2.815953   0 #> 302 509.1093169   3.031962   0 #> 303 500.3270252   2.576218   0 #> 304 500.5406435   2.624071   0 #> 305 695.8869837   3.259421   0 #> 306 500.1322294   2.767835   0 #> 307 795.0076732   3.558083   0 #> 308 501.0955792   2.728640   0 #> 309 505.6265228   2.778656   0 #> 310 500.0415360   2.651083   0 #> 311 512.7660645   2.999515   0 #> 312 501.0675195   2.551626   0 #> 313 517.8019799   3.174813   0 #> 314 519.5281200   2.516948   0 #> 315 507.3560290   3.295727   0 #> 316 619.1928213   3.296892   0 #> 317 508.1116594   2.592690   0 #> 318 765.1677860   2.583757   0 #> 319 840.2185722   2.674304   0 #> 320 537.2693249   2.982355   0 #> 321 606.3503230   2.835273   0 #> 322 504.7947101   2.600815   0 #> 323 500.2458654   4.276772   0 #> 324 737.0838169   2.518672   0 #> 325 500.0725528   2.889961   0 #> 326 500.6633177   2.538456   0 #> 327 500.0922600   3.634082   0 #> 328 530.5867438   3.606452   0 #> 329 500.0536294   2.530210   0 #> 330 524.3108162   4.142284   0 #> 331 502.9357453   3.112609   0 #> 332 510.5328989   2.579966   0 #> 333 512.3520764   2.831775   0 #> 334 508.7675338   3.319867   0 #> 335 554.4238875   3.243225   0 #> 336 566.6996661   2.929815   0 #> 337 607.9282119   2.558837   0 #> 338 500.0990943   4.290212   0 #> 339 502.2312053   3.205745   0 #> 340 503.4496059   3.323096   0 #> 341 678.6468808   2.922622   0 #> 342 500.2225559   2.808447   0 #> 343 501.5003660   3.340545   0 #> 344 500.1273955   2.679648   0 #> 345 507.0520563   2.604402   0 #> 346 500.2475567   2.759133   0 #> 347 500.3218120   3.365848   0 #> 348 644.8624518   3.170287   0 #> 349 500.5916894   2.848748   0 #> 350 500.1840312   2.947309   0 #> 351 500.5775597   2.839004   0 #> 352 510.8399729   3.080367   0 #> 353 520.2879414   2.973910   0 #> 354 500.0075093   2.622753   0 #> 355 500.6336301   2.950347   0 #> 356 511.6612173   2.973721   0 #> 357 504.7939732   2.534038   0 #> 358 526.1837056   2.699149   0 #> 359 672.6161745   2.997165   0 #> 360 502.4155054   2.590023   0 #> 361 518.5528932   2.516853   0 #> 362 502.8151787   3.000120   0 #> 363 500.2013772   2.921010   0 #> 364 502.1010543   2.570811   0 #> 365 500.0328983   2.568316   0 #> 366 500.3454413   2.517680   0 #> 367 500.1116979   3.363871   0 #> 368 649.1744612   2.651630   0 #> 369 500.6833703   5.486318   0 #> 370 778.7678489   2.531058   0 #> 371 506.9380908   2.523914   0 #> 372 500.2369107   2.741518   0 #> 373 500.6868882   2.715831   0 #> 374 527.6135349   2.937941   0 #> 375 501.2039387   2.858479   0 #> 376 500.1640055   3.222200   0 #> 377 500.0320186   2.548414   0 #> 378 505.1830190   2.996643   0 #> 379 551.0435580   2.660935   0 #> 380 513.1023883   2.661015   0 #> 381 500.9284513   2.808671   0 #> 382 502.1381756   3.087960   0 #> 383 526.7001991   3.217831   0 #> 384 501.4746114   2.501840   0 #> 385 715.1684557   2.558870   0 #> 386 508.8087895   3.049146   0 #> 387 500.0186162   3.219151   0 #> 388 610.2374691   2.677919   0 #> 389 501.2159949   2.780881   0 #> 390 500.9650601   2.968285   0 #> 391 500.1620413   2.850069   0 #> 392 500.0152520   2.876610   0 #> 393 504.6684397   2.595925   0 #> 394 500.2241545   4.379277   0 #> 395 502.3728983   3.014139   0 #> 396 500.2627170   3.137049   0 #> 397 501.4027848   3.059711   0 #> 398 529.7490983   2.521390   0 #> 399 538.7777102   2.610496   0 #> 400 521.2081090   2.542320   0 #> 401 874.9445826   4.647718   0 #> 402 643.3659607   2.885626   0 #> 403 501.7707715   2.991364   0 #> 404 513.6232937   2.532723   0 #> 405 503.9894198   2.557889   0 #> 406 503.8174082   3.033180   0 #> 407 501.2816191   2.794717   0 #> 408 859.5410984   2.680143   0 #> 409 500.2878206   3.802896   0 #> 410 511.5244152   2.915942   0 #> 411 500.7758256   3.140165   0 #> 412 560.8811968   2.923209   0 #> 413 500.1805289   3.467871   0 #> 414 897.4259357   3.196019   0 #> 415 500.4082670   2.750869   0 #> 416 500.9465745   2.609580   0 #> 417 693.0999510   2.817982   0 #> 418 714.7005876   2.923655   0 #> 419 500.0783967   3.427348   0 #> 420 500.6205917   3.293610   0 #> 421 598.5850502   3.100736   0 #> 422 649.6426927   2.716313   0 #> 423 502.6932476   2.625884   0 #> 424 500.9293468   3.449030   0 #> 425 503.7244589   2.531745   0 #> 426 504.2928382   2.523740   0 #> 427 510.5281994   3.057149   0 #> 428 501.3010383   4.807200   0 #> 429 503.0982979   2.598453   0 #> 430 501.1199408   2.747305   0 #> 431 565.0719176   2.671552   0 #> 432 801.0576657   3.302170   0 #> 433 502.5898180   2.551115   0 #> 434 500.5575243   2.930231   0 #> 435 645.8138867   2.583816   0 #> 436 518.9352499   4.645098   0 #> 437 575.1148361   2.547335   0 #> 438 508.5297603   2.790496   0 #> 439 500.5506265   2.942063   0 #> 440 502.0792301   2.714782   0 #> 441 500.0030617   2.690367   0 #> 442 500.0392630   2.930719   0 #> 443 503.1456406   3.497197   0 #> 444 500.0826258   2.804368   0 #> 445 504.5792940   3.008731   0 #> 446 916.1515673   2.551716   0 #> 447 505.4725233   2.577267   0 #> 448 500.1855498   2.614398   0 #> 449 519.7589618   3.174511   0 #> 450 500.0881597   2.646515   0 #> 451 500.0051895   2.509163   0 #> 452 582.7837354   3.252642   0 #> 453 502.0714807   2.998805   0 #> 454 511.4073702   2.804046   0 #> 455 512.2440030   2.716468   0 #> 456 512.8500818   2.521585   0 #> 457 500.7095713   2.734177   0 #> 458 504.2335016   2.850469   0 #> 459 520.7741971   2.887171   0 #> 460 500.0044423   2.882503   0 #> 461 500.0281542   4.549815   0 #> 462 503.3977274   2.531360   0 #> 463 501.1022581   2.711074   0 #> 464 893.2066992   2.983603   0 #> 465 500.1601027   3.137757   0 #> 466 542.4440964   3.126779   0 #> 467 500.7912210   2.741992   0 #> 468 500.0625123   2.537741   0 #> 469 729.7836471   2.648301   0 #> 470 500.5754231   2.539061   0 #> 471 511.7848339   2.536274   0 #> 472 500.0075993   3.098684   0 #> 473 618.5208208   3.087424   0 #> 474 515.4253728   3.294213   0 #> 475 510.4471018   4.464578   0 #> 476 510.8076468   2.754831   0 #> 477 500.0060777   3.754057   0 #> 478 500.1130380   3.595981   0 #> 479 500.4706231   2.795071   0 #> 480 923.2921468   2.921557   0 #> 481 500.2843270   2.553951   0 #> 482 500.1488454   3.028978   0 #> 483 500.3595956   3.746711   0 #> 484 509.1530979   3.261729   0 #> 485 500.7361037   2.603800   0 #> 486 502.2468142   2.581961   0 #> 487 624.8805505   2.712802   0 #> 488 505.0222304   2.887379   0 #> 489 504.7901251   2.914684   0 #> 490 505.7777369   3.770105   0 #> 491 500.3699536   2.612953   0 #> 492 500.6190012   2.667121   0 #> 493 537.9293854   2.513167   0 #> 494 501.1327922   2.785147   0 #> 495 503.9926086   2.676232   0 #> 496 551.7500301   2.504289   0 #> 497 501.8079387   2.793040   0 #> 498 500.4227886   2.856612   0 #> 499 500.0042164   2.752238   0 #> 500 504.1563103   2.886312   0 #> 501 500.0562516   2.781068   0 #> 502 521.7725716   2.647228   0 #> 503 503.4037961   2.629377   0 #> 504 547.6384842   2.534065   0 #> 505 654.3592334   2.980187   0 #> 506 602.8242922   2.844074   0 #> 507 500.3684695   2.613631   0 #> 508 500.0127685   2.740681   0 #> 509 511.0132405   2.988462   0 #> 510 930.3997551   3.224196   0 #> 511 617.4741652   2.579624   0 #> 512 551.7754621   3.778493   0 #> 513 500.8294433   2.531642   0 #> 514 949.6666980   2.603263   0 #> 515 847.6566133   2.512499   0 #> 516 859.2919393   2.601994   0 #> 517 502.4524553   3.362587   0 #> 518 670.5086175   2.811716   0 #> 519 500.3947631   4.482476   0 #> 520 503.2797314   2.597686   0 #> 521 517.2002336   3.196744   0 #> 522 500.1567171   2.504504   0 #> 523 706.2764368   2.992121   0 #> 524 554.6269058   2.874895   0 #> 525 525.5897708   3.562886   0 #> 526 569.9972284   2.766728   0 #> 527 500.0942673   2.843873   0 #> 528 505.8565533   2.799049   0 #> 529 500.1874307   2.648010   0 #> 530 531.6309114   2.516735   0 #> 531 503.0128806   2.519497   0 #> 532 501.2375702   3.054750   0 #> 533 641.9500655   3.180591   0 #> 534 500.7376212   2.577902   0 #> 535 500.1985598   2.729171   0 #> 536 500.1952889   2.555111   0 #> 537 501.5935913   2.721055   0 #> 538 546.2901846   2.778912   0 #> 539 625.7253588   3.209681   0 #> 540 502.3842992   3.587931   0 #> 541 661.9843075   3.282417   0 #> 542 501.0545169   3.025465   0 #> 543 500.3486445   2.636971   0 #> 544 500.1952401   2.690489   0 #> 545 731.3508004   2.997764   0 #> 546 716.5148076   3.146499   0 #> 547 526.2163045   2.616426   0 #> 548 505.8023082   2.837326   0 #> 549 572.2508359   2.616925   0 #> 550 508.4689501   2.523817   0 #> 551 501.3743203   2.643843   0 #> 552 500.3030595   3.633670   0 #> 553 507.1550533   3.099963   0 #> 554 501.1140383   2.883045   0 #> 555 500.8923152   3.012734   0 #> 556 532.9158169   2.642755   0 #> 557 500.1212262   2.514388   0 #> 558 825.9419486   3.289316   0 #> 559 990.9004651   2.741172   0 #> 560 512.9830033   2.712643   0 #> 561 614.9972450   2.582226   0 #> 562 585.8627665   2.558634   0 #> 563 501.6424133   3.040603   0 #> 564 500.0959749   2.784318   0 #> 565 500.1279397   3.018839   0 #> 566 500.9596286   3.418194   0 #> 567 646.3805588   2.579207   0 #> 568 551.4090418   3.509385   0 #> 569 518.6366267   2.600505   0 #> 570 501.6085156   2.528198   0 #> 571 500.1099990   2.525230   0 #> 572 527.6713386   2.680963   0 #> 573 810.3684742   2.761098   0 #> 574 754.7946120   3.409617   0 #> 575 501.1359168   2.649590   0 #> 576 500.1610573   2.650164   0 #> 577 546.3092527   2.515166   0 #> 578 848.2421314   2.509689   0 #> 579 500.3523608   2.588755   0 #> 580 505.5075637   2.879648   0 #> 581 510.2836845   3.887811   0 #> 582 610.9943872   3.690785   0 #> 583 746.8346451   2.964986   0 #> 584 501.9342067   3.287331   0 #> 585 703.2468122   2.581174   0 #> 586 500.9163600   2.536457   0 #> 587 504.7769975   2.607078   0 #> 588 525.6068230   3.277221   0 #> 589 514.9674030   4.152275   0 #> 590 500.0862025   3.399092   0 #> 591 501.3271680   2.920604   0 #> 592 500.3325382   2.865525   0 #> 593 500.8304900   3.579912   0 #> 594 501.4994080   2.833391   0 #> 595 500.2905170   2.595052   0 #> 596 518.7272068   2.531841   0 #> 597 500.5876304   3.700501   0 #> 598 529.6514595   2.984611   0 #> 599 511.8075546   2.726818   0 #> 600 581.2674917   3.262270   0 #> 601 500.6141403   3.477937   0 #> 602 562.1082664   3.823596   0 #> 603 500.5372405   3.369848   0 #> 604 557.6621784   2.982618   0 #> 605 649.1490061   2.604825   0 #> 606 506.4082358   3.318130   0 #> 607 522.8888346   2.866513   0 #> 608 571.0959171   2.690043   0 #> 609 500.1477062   2.515038   0 #> 610 500.0573624   3.270860   0 #> 611 500.1629406   4.113946   0 #> 612 508.6947011   2.695323   0 #> 613 502.6651041   3.638722   0 #> 614 539.1706686   3.879008   0 #> 615 500.6609869   2.501780   0 #> 616 500.0816615   2.693592   0 #> 617 671.0932997   2.584365   0 #> 618 506.0658366   2.728543   0 #> 619 506.3354155   2.501992   0 #> 620 653.9867786   2.716834   0 #> 621 500.2493037   3.994980   0 #> 622 500.1080811   2.800953   0 #> 623 620.2496601   2.724742   0 #> 624 502.0173336   2.621188   0 #> 625 570.7060419   2.894024   0 #> 626 500.1128674   2.751797   0 #> 627 500.2429065   2.581139   0 #> 628 512.7480779   2.708192   0 #> 629 955.4951216   2.595739   0 #> 630 500.2257388   2.803198   0 #> 631 513.3611481   3.254044   0 #> 632 507.4892504   2.864266   0 #> 633 502.1258368   4.806172   0 #> 634 500.0554492   2.791970   0 #> 635 634.7532255   2.610573   0 #> 636 732.8893447   3.214556   0 #> 637 517.6852633   2.742488   0 #> 638 500.0034544   2.583227   0 #> 639 508.4001712   2.509526   0 #> 640 500.0492190   2.552402   0 #> 641 502.4505661   2.646908   0 #> 642 556.9367332   3.013928   0 #> 643 525.7760300   2.707602   0 #> 644 647.1520670   2.981874   0 #> 645 500.1794269   2.620984   0 #> 646 500.7371848   3.021410   0 #> 647 501.4286168   2.654231   0 #> 648 525.8354256   2.833394   0 #> 649 501.0695622   3.313280   0 #> 650 663.0295160   2.990948   0 #> 651 504.3827371   2.756984   0 #> 652 511.6599407   3.336613   0 #> 653 849.0370852   4.268370   0 #> 654 615.7464346   3.365655   0 #> 655 503.9422190   2.566005   0 #> 656 668.4368013   2.673617   0 #> 657 826.3576818   3.027491   0 #> 658 517.0939417   2.969753   0 #> 659 800.2401466   2.725701   0 #> 660 591.0189151   2.533142   0 #> 661 500.0286245   2.543085   0 #> 662 520.6453786   2.647675   0 #> 663 500.4269455   2.939815   0 #> 664 507.7130565   2.762471   0 #> 665 501.0544490   2.645179   0 #> 666 507.4207733   2.917711   0 #> 667 514.4127175   2.640912   0 #> 668 505.7542504   2.783752   0 #> 669 562.1818782   2.615079   0 #> 670 500.7910115   2.647724   0 #> 671 715.5138006   3.592197   0 #> 672 500.2239848   2.516630   0 #> 673 500.3360328   2.502503   0 #> 674 504.6295688   2.561704   0 #> 675 500.2511491   2.886007   0 #> 676 647.6380132   2.511627   0 #> 677 500.3370465   2.554231   0 #> 678 889.0771563   3.970252   0 #> 679 500.6757896   2.775209   0 #> 680 500.0469605   2.573290   0 #> 681 500.0528831   3.240965   0 #> 682 500.0092642   2.514669   0 #> 683 572.1702911   2.627502   0 #> 684 741.6087647   2.628945   0 #> 685 500.2427374   2.608002   0 #> 686 500.0053994   2.840099   0 #> 687 526.4966719   2.722591   0 #> 688 746.8428812   2.624773   0 #> 689 500.0952481   2.957640   0 #> 690 501.0925133   2.684316   0 #> 691 798.6598588   3.542197   0 #> 692 500.5429854   2.597331   0 #> 693 500.2370439   3.088922   0 #> 694 513.3306974   2.546759   0 #> 695 572.3193021   2.661391   0 #> 696 500.0853234   3.338701   0 #> 697 500.1230416   2.637717   0 #> 698 527.8384379   3.011959   0 #> 699 500.2584753   2.772122   0 #> 700 772.4961186   3.811794   0 #> 701 506.8384755   2.514635   0 #> 702 501.7948972   2.978770   0 #> 703 500.0050974   3.108793   0 #> 704 500.1379433   2.599411   0 #> 705 500.0679924   2.835299   0 #> 706 520.9995678   3.318844   0 #> 707 515.9128150   2.689500   0 #> 708 512.3300455   2.542218   0 #> 709 632.6097683   3.320476   0 #> 710 505.9590796   2.657835   0 #> 711 568.5322907   2.992017   0 #> 712 500.8657495   2.517427   0 #> 713 519.9500839   2.750990   0 #> 714 505.3622849   2.921393   0 #> 715 500.5423941   2.836111   0 #> 716 500.4887283   2.535449   0 #> 717 704.5755268   3.251793   0 #> 718 888.3618717   2.543540   0 #> 719 500.0497349   2.538080   0 #> 720 503.1905324   2.603441   0 #> 721 507.3066841   2.595518   0 #> 722 502.1251048   2.622072   0 #> 723 661.4682318   2.602700   0 #> 724 500.2137016   3.185778   0 #> 725 502.1611850   2.663948   0 #> 726 520.3748408   2.702487   0 #> 727 505.3408186   2.641594   0 #> 728 500.0117072   2.818423   0 #> 729 501.3520463   2.528485   0 #> 730 503.5481059   2.676100   0 #> 731 504.1496995   2.619659   0 #> 732 504.6965732   3.357434   0 #> 733 586.0406572   3.084163   0 #> 734 527.1359876   3.773032   0 #> 735 513.4731609   3.270389   0 #> 736 509.5459733   2.944664   0 #> 737 552.3603671   2.589235   0 #> 738 508.4462147   2.569744   0 #> 739 513.3804932   2.622644   0 #> 740 515.8121665   2.529062   0 #> 741 502.3709337   2.788741   0 #> 742 500.0660424   3.572360   0 #> 743 501.5986811   2.681143   0 #> 744 500.0138678   2.761487   0 #> 745 531.3048215   2.980260   0 #> 746 501.2605713   2.594150   0 #> 747 502.3860062   2.537528   0 #> 748 500.2630457   2.617034   0 #> 749 691.7735099   3.027773   0 #> 750 507.8045818   2.643017   0 #> 751 500.1487077   2.891792   0 #> 752 513.1233516   2.784602   0 #> 753 583.8048584   3.389241   0 #> 754 504.1675459   2.588071   0 #> 755 500.0624152   2.661378   0 #> 756 500.0268003   2.927563   0 #> 757 500.5173205   3.182891   0 #> 758 500.0708275   2.544768   0 #> 759 500.6368946   2.562860   0 #> 760 500.0313021   2.810974   0 #> 761 500.7357701   2.775474   0 #> 762 501.4342198   3.348986   0 #> 763 749.3095612   2.930785   0 #> 764 504.4735012   2.654790   0 #> 765 853.1917213   3.163292   0 #> 766 517.2452972   2.889432   0 #> 767 502.3271398   2.650945   0 #> 768 507.8817521   3.028386   0 #> 769 508.0204293   2.996056   0 #> 770 501.0264159   2.545027   0 #> 771 756.5248658   3.688118   0 #> 772 504.2506213   2.763383   0 #> 773 521.1362897   2.880315   0 #> 774 653.6112038   2.542624   0 #> 775 689.0959212   3.052166   0 #> 776 538.1697750   2.967717   0 #> 777 796.4969993   2.704226   0 #> 778 501.2371730   2.849784   0 #> 779 620.3377721   2.820436   0 #> 780 501.0375404   2.615403   0 #> 781 500.5324704   2.786973   0 #> 782 500.4350514   2.761900   0 #> 783 500.2491960   2.881731   0 #> 784 501.9903767   2.760578   0 #> 785 510.7442543   2.800653   0 #> 786 612.5628204   2.837188   0 #> 787 520.3214485   2.630377   0 #> 788 597.4025367   2.946265   0 #> 789 500.0311304   3.393460   0 #> 790 635.5899536   2.546883   0 #> 791 500.4768400   2.563363   0 #> 792 500.8607278   2.566347   0 #> 793 631.5718975   3.985346   0 #> 794 500.4102253   2.600911   0 #> 795 501.1804742   2.700122   0 #> 796 500.0110995   2.820990   0 #> 797 524.4203128   2.962278   0 #> 798 500.2263994   3.832386   0 #> 799 508.9759537   2.985426   0 #> 800 518.5391380   2.731930   0 #> 801 514.0160105   2.931542   0 #> 802 519.9141034   2.587239   0 #> 803 500.6130927   3.094904   0 #> 804 500.7297718   4.949910   0 #> 805 521.9043229   3.220128   0 #> 806 812.7116935   2.841546   0 #> 807 500.3848949   2.524054   0 #> 808 501.8267131   2.674441   0 #> 809 500.8529556   2.781553   0 #> 810 563.4361202   3.207658   0 #> 811 500.0308769   2.629589   0 #> 812 974.2117823   2.625131   0 #> 813 956.4900446   2.660637   0 #> 814 761.0028453   2.822145   0 #> 815 503.0725390   2.516502   0 #> 816 863.2844000   3.288962   0 #> 817 556.2730512   3.111270   0 #> 818 500.0528447   2.559415   0 #> 819 500.0157930   2.639912   0 #> 820 500.1625204   2.682530   0 #> 821 507.4356954   3.197461   0 #> 822 500.1230223   2.579766   0 #> 823 545.2599898   2.564285   0 #> 824 591.2010720   2.960495   0 #> 825 529.4047446   3.190681   0 #> 826 508.2594283   2.592933   0 #> 827 741.2185709   4.059948   0 #> 828 500.1461768   2.635753   0 #> 829 500.7468815   2.682225   0 #> 830 508.8926816   2.525384   0 #> 831 501.4859368   2.641634   0 #> 832 500.5738766   2.985711   0 #> 833 500.1874230   2.590877   0 #> 834 558.7863013   2.853258   0 #> 835 506.7022012   3.267852   0 #> 836 566.2535322   3.870295   0 #> 837 502.4342881   2.838449   0 #> 838 502.9963629   2.667737   0 #> 839 599.2068116   2.681497   0 #> 840 515.0714967   3.697480   0 #> 841 694.1135602   2.610359   0 #> 842 500.2820258   2.614994   0 #> 843 514.7980845   3.996756   0 #> 844 500.1922338   3.411632   0 #> 845 500.2900677   2.531573   0 #> 846 510.0580819   2.513958   0 #> 847 505.0271159   3.234059   0 #> 848 552.1629591   3.567394   0 #> 849 516.8571471   3.386889   0 #> 850 502.3266540   2.586296   0 #> 851 556.7551591   3.075310   0 #> 852 578.8486582   3.170145   0 #> 853 733.0925435   3.740803   0 #> 854 500.7646901   2.657337   0 #> 855 509.7702854   2.765638   0 #> 856 501.3576080   3.181125   0 #> 857 500.0091173   3.044090   0 #> 858 509.4968996   2.743609   0 #> 859 500.1476078   3.079433   0 #> 860 500.2045833   2.688656   0 #> 861 823.6558690   2.789773   0 #> 862 666.8515414   2.519783   0 #> 863 505.3111775   2.582006   0 #> 864 707.6545557   2.964859   0 #> 865 502.4974525   2.615130   0 #> 866 519.8032564   3.394074   0 #> 867 500.0915847   2.686460   0 #> 868 672.7431167   2.701820   0 #> 869 500.4374067   2.913869   0 #> 870 500.0128967   2.924502   0 #> 871 507.3216540   2.669145   0 #> 872 500.3133099   2.642026   0 #> 873 502.7804108   2.554934   0 #> 874 512.9245955   3.075245   0 #> 875 658.1421822   2.535780   0 #> 876 501.0157317   3.026758   0 #> 877 521.4423799   2.610487   0 #> 878 505.9870128   2.951982   0 #> 879 500.7549492   2.554274   0 #> 880 500.2732838   2.584866   0 #> 881 580.8663344   3.040608   0 #> 882 500.0407068   2.577356   0 #> 883 501.4867334   2.751839   0 #> 884 500.0497541   3.700173   0 #> 885 500.1798243   3.014892   0 #> 886 813.6229355   2.500687   0 #> 887 500.5551413   3.056434   0 #> 888 501.7304291   2.509474   0 #> 889 500.2822242   2.945490   0 #> 890 623.6193433   2.635341   0 #> 891 859.9595490   2.815541   0 #> 892 500.3248301   3.142709   0 #> 893 500.0132549   2.917444   0 #> 894 710.9226724   2.706412   1 #> 895 550.5848126   2.544613   1 #> 896 400.8526872   2.850811   1 #> 897 359.2579570   2.702232   1 #> 898 378.0689798   2.876691   1 #> 899  44.2179139   2.531054   1 #> 900 837.6078189   5.636874   1 #> 901 962.6194192   3.074911   1 #> 902 887.1973590   2.796834   1 #> 903 549.5485386   2.515192   1 #> 904 780.4575902   2.730270   1 #> 905 815.8929083   2.855586   1 #> 906  22.8101106   2.544284   1 #> 907 325.0065693   3.216115   1 #> 908 565.5104872   2.743745   1 #> 909 706.2706267   4.287532   1 #> 910 797.9248348   2.746063   1 #> 911 212.2582304   2.675327   1 #> 912 876.0482112   3.547477   1 #> 913 761.6556147   2.560757   1 #> 914 136.6786510   3.533224   1 #> 915 261.0922919   2.974728   1 #> 916  81.2207742   3.018922   1 #> 917 576.8095497   2.743661   1 #> 918 578.4545387   2.932585   1 #> 919  87.4618965   3.496858   1 #> 920 299.0575929   3.353536   1 #> 921  58.9459504   2.799323   1 #> 922 585.7188534   2.507980   1 #> 923 225.1593168   3.157823   1 #> 924 781.9378823   2.666624   1 #> 925 823.7159508   2.520808   1 #> 926 873.3333207   3.445177   1 #> 927 737.6455199   2.956094   1 #> 928 370.8142843   3.485013   1 #> 929 550.3444376   2.514999   1 #> 930 605.1605004   2.691160   1 #> 931  15.4202357   2.593563   1 #> 932 153.7030698   2.869101   1 #> 933 571.0832041   2.639702   1 #> 934  89.2029812   2.567843   1 #> 935 555.7856211   2.714635   1 #> 936 416.5038574   2.983002   1 #> 937 548.8285215   2.630892   1 #> 938 573.3489143   2.984554   1 #> 939 667.2263173   2.566467   1 #> 940 620.2702182   2.962903   1 #> 941 516.3483217   2.863479   1 #> 942 822.9643602   2.720742   1 #> 943 103.6948583   2.569199   1 #> 944 635.1215076   3.335917   1 #> 945 761.9360273   2.543539   1 #> 946 599.3349478   2.555526   1 #> 947 917.1108990   2.563620   1 #> 948 442.9249307   2.962662   1 #> 949 749.8014052   2.973605   1 #> 950 895.9976954   3.240450   1 #> 951 649.2814545   3.141640   1 #> 952 313.1695543   3.206834   1 #> 953 784.0748758   2.594834   1 #> 954 720.3666945   3.616310   1 #> 955 251.6247837   2.959113   1 #> 956  25.6614636   2.662160   1 #> 957 683.1490227   2.524566   1 #> 958 779.4947249   2.733117   1 #> 959 987.2760682   2.658861   1 #> 960 230.9101739   2.979027   1 #> 961 777.3205533   2.836666   1 #> 962 981.7560008   2.762224   1 #> 963 860.4777164   2.703011   1 #> 964 619.4056505   2.727878   1 #> 965 287.4557963   3.014453   1 #> 966 362.7214085   3.812198   1 #> 967 624.4544955   2.697775   1 #> 968 712.0710330   2.845833   1 #> 969 359.8372804   2.977460   1 #> 970 386.8202565   2.754225   1 #> 971 885.8417396   3.625103   1 #> 972 762.4334972   2.608944   1 #> 973  96.4391453   2.866829   1 #> 974 741.9208216   2.583377   1 #> 975 390.8580819   2.563783   1 #> 976 706.3230250   2.502546   1 #> 977 642.9377084   2.569298   1 #> 978 572.2135135   3.157181   1 #> 979 610.3995831   2.856298   1 #> 980 289.5524665   2.565539   1 #> 981 513.5929950   2.553431   1 #> 982 244.2954464   3.323019   1 #> 983 890.1072722   3.141846   1 #> 984 600.2790087   2.540106   1 #> 985 271.9184963   2.521942   1 #> 986 678.3370941   2.674520   1 #> 987 854.3554083   3.007173   1 #> 988 360.3710397   2.627432   1 #> 989 139.7008153   3.656451   1 #> 990 517.1688395   2.549736   1 #> 991   0.2691448   2.548754   1 #> 992 221.3113238   2.513149   1 #> 993 621.4360821   2.553747   1 #> 994 454.9035993   2.605714   1 #> 995 138.1303736   2.782234   1 #>  #> [[3]] #>            ts magnitudes gen #> 1   502.04050   2.789422   2 #> 2   502.86841   2.598773   2 #> 3   525.38101   2.555970   2 #> 4   533.56028   3.447548   2 #> 5   565.20328   2.524736   2 #> 6   508.83406   2.534772   2 #> 7   509.41470   3.306712   2 #> 8   727.96514   3.454920   2 #> 9   501.86861   2.981286   2 #> 10  522.38044   5.200240   2 #> 11  500.12795   3.228686   2 #> 12  511.83030   2.664563   2 #> 13  968.43492   2.917903   2 #> 14  500.02128   2.688575   2 #> 15  686.46978   2.561168   2 #> 16  500.82590   3.164320   2 #> 17  510.70948   3.265046   2 #> 18  500.47297   3.578692   2 #> 19  690.56330   2.545372   2 #> 20  551.84768   4.126560   2 #> 21  501.67767   2.558697   2 #> 22  501.12958   3.597436   2 #> 23  584.18446   2.841165   2 #> 24  514.50717   2.811926   2 #> 25  723.72089   2.794398   2 #> 26  500.53263   2.983617   2 #> 27  905.56061   2.760535   2 #> 28  500.60316   2.851876   2 #> 29  507.74644   2.590163   2 #> 30  506.34356   2.850600   2 #> 31  501.40756   2.534215   2 #> 32  502.40481   2.832280   2 #> 33  546.20163   3.167310   2 #> 34  522.44338   2.857682   2 #> 35  822.06818   2.662333   2 #> 36  585.33664   2.589494   2 #> 37  592.23256   3.178273   2 #> 38  585.16696   2.536064   2 #> 39  803.68581   2.558343   2 #> 40  768.33070   2.931834   2 #> 41  604.23562   2.902344   2 #> 42  639.06236   3.132805   2 #> 43  503.61227   2.548398   2 #> 44  511.97268   2.905171   2 #> 45  500.52783   2.592604   2 #> 46  501.34133   2.743675   2 #> 47  500.58027   2.645987   2 #> 48  500.63242   3.420772   2 #> 49  500.94715   2.730063   2 #> 50  507.37675   2.639452   2 #> 51  501.62972   2.637344   2 #> 52  501.08156   2.598398   2 #> 53  505.84191   3.190544   2 #> 54  511.23131   2.890026   2 #> 55  504.33623   2.802730   2 #> 56  500.30124   2.505576   2 #> 57  501.40350   3.199023   2 #> 58  524.76741   3.176797   2 #> 59  545.96382   3.864434   2 #> 60  502.01571   3.002682   2 #> 61  840.76129   2.629141   2 #> 62  596.63512   3.825353   2 #> 63  901.91586   2.653410   2 #> 64  555.67410   2.867208   2 #> 65  699.11449   2.964527   2 #> 66  680.73833   4.028413   2 #> 67  555.78466   2.724578   2 #> 68  620.47226   2.678108   2 #> 69  579.29494   2.982107   2 #> 70  551.67973   2.832122   2 #> 71  537.15658   2.980028   2 #> 72  534.27703   3.253681   2 #> 73  555.08641   2.519138   2 #> 74  801.11806   2.645180   2 #> 75  535.89209   2.543185   2 #> 76  558.04858   3.019770   2 #> 77  700.63371   3.931191   2 #> 78  500.89765   2.813984   2 #> 79  501.35933   2.509716   2 #> 80  505.41922   2.958841   2 #> 81  500.75833   2.591672   2 #> 82  502.75178   2.710443   2 #> 83  512.67724   2.817687   2 #> 84  500.81870   3.882610   2 #> 85  501.03770   2.643529   2 #> 86  593.26824   2.604930   2 #> 87  920.91454   2.624148   2 #> 88  611.38854   2.695027   2 #> 89  500.64623   2.699813   2 #> 90  599.49958   3.529867   2 #> 91  600.93733   2.845358   2 #> 92  599.77774   2.543429   2 #> 93  601.04513   2.524652   2 #> 94  599.78374   5.569576   2 #> 95  599.86128   2.588786   2 #> 96  601.37335   2.595670   2 #> 97  500.23814   2.556422   2 #> 98  968.25530   4.553755   2 #> 99  514.93341   2.518504   2 #> 100 574.63173   3.207888   2 #> 101 502.85386   2.873480   2 #> 102 603.85876   3.474468   2 #> 103 594.21982   2.581158   2 #> 104 506.32104   2.633349   2 #> 105 940.90265   2.838915   2 #> 106 561.50548   3.161539   2 #> 107 765.66999   2.532109   2 #> 108 865.60642   2.576807   2 #> 109 500.14152   2.553333   2 #> 110 591.76598   2.838380   2 #> 111 525.72817   2.819392   2 #> 112 593.42615   2.522554   2 #> 113 558.39394   2.838088   2 #> 114 554.45465   2.875021   2 #> 115 501.52286   2.565637   2 #> 116 645.01909   2.879724   2 #> 117 504.80697   3.406549   2 #> 118 791.34245   2.561157   2 #> 119 739.25774   3.038841   2 #> 120 503.74560   2.989624   2 #> 121 502.93998   2.961140   2 #> 122 501.13792   3.155138   2 #> 123 576.29888   3.793195   2 #> 124 518.61659   2.850747   2 #> 125 766.69118   2.824513   2 #> 126 544.85122   2.751769   2 #> 127 545.76364   2.832904   2 #> 128 500.81334   3.015201   2 #> 129 561.65246   3.088795   2 #> 130 502.93644   3.489568   2 #> 131 501.34380   2.844451   2 #> 132 502.48964   2.608103   2 #> 133 508.50842   2.864035   2 #> 134 549.46783   2.862657   2 #> 135 501.13181   2.517959   2 #> 136 508.47586   2.775200   2 #> 137 515.96200   2.803336   2 #> 138 673.97722   3.126570   2 #> 139 501.78311   2.969554   2 #> 140 505.36498   2.556816   2 #> 141 502.64093   2.671772   2 #> 142 500.69162   3.022727   2 #> 143 500.95587   2.553100   2 #> 144 500.88637   2.789701   2 #> 145 502.79993   2.567982   2 #> 146 500.72659   2.724270   2 #> 147 501.66762   2.847096   2 #> 148 500.81989   3.219179   2 #> 149 531.13388   2.577665   2 #> 150 500.72403   2.764307   2 #> 151 500.98356   2.549539   2 #> 152 504.85738   3.155920   2 #> 153 645.73044   2.623126   2 #> 154 500.68668   2.787708   2 #> 155 516.70707   3.294350   2 #> 156 517.59041   3.031654   2 #> 157 514.33016   2.724534   2 #> 158 503.47500   3.454295   2 #> 159 509.55163   2.619205   2 #> 160 501.33809   3.179286   2 #> 161 665.08782   3.475692   2 #> 162 510.84694   2.950540   2 #> 163 502.16313   2.510269   2 #> 164 504.16056   2.527512   2 #> 165 500.73158   4.849763   2 #> 166 600.89081   2.714683   2 #> 167 504.41670   3.627497   2 #> 168 500.76665   2.820511   2 #> 169 500.70040   2.709227   2 #> 170 501.66593   2.806979   2 #> 171 501.13398   2.944448   2 #> 172 742.75052   3.742790   2 #> 173 811.33376   2.564414   2 #> 174 501.21019   2.981720   2 #> 175 550.30943   3.146409   2 #> 176 501.39441   2.806839   2 #> 177 500.97442   2.679023   2 #> 178 505.48604   3.274768   2 #> 179 500.69719   2.818966   2 #> 180 505.65074   3.413842   2 #> 181 512.82845   3.056665   2 #> 182 524.49641   2.644307   2 #> 183 500.68416   2.696360   2 #> 184 502.23426   3.085186   2 #> 185 506.38081   2.629070   2 #> 186 641.92867   3.813253   2 #> 187 548.30517   3.393965   2 #> 188 504.18139   2.880383   2 #> 189 501.63369   2.516923   2 #> 190 505.98909   3.072637   2 #> 191 912.62877   3.043519   2 #> 192 875.18679   2.928326   2 #> 193 875.19495   3.271578   2 #> 194 882.75166   2.520981   2 #> 195 875.46806   2.664743   2 #> 196 891.04132   3.749283   2 #> 197 918.54367   2.597191   2 #> 198 874.97297   2.866982   2 #> 199 891.35084   3.301045   2 #> 200 876.37038   2.987732   2 #> 201 895.15139   3.485062   2 #> 202 530.52442   3.646895   2 #> 203 500.24652   2.538644   2 #> 204 711.13597   3.631677   2 #> 205 506.28820   3.313674   2 #> 206 501.74907   3.005267   2 #> 207 524.38559   2.772965   2 #> 208 503.28676   2.730582   2 #> 209 519.92592   2.760559   2 #> 210 501.64671   3.258139   2 #> 211 501.59865   3.037038   2 #> 212 501.42197   2.514119   2 #> 213 528.44590   3.022838   2 #> 214 694.80539   3.435443   2 #> 215 501.33945   2.548303   2 #> 216 514.85953   2.667911   2 #> 217 501.36403   2.568077   2 #> 218 502.42615   2.897814   2 #> 219 540.60893   2.609841   2 #> 220 566.54571   2.873565   2 #> 221 524.71306   3.386838   2 #> 222 519.02869   2.587426   2 #> 223 522.32399   2.755526   2 #> 224 531.07456   2.671982   2 #> 225 558.08625   3.842497   2 #> 226 526.04026   2.684908   2 #> 227 518.98726   2.594366   2 #> 228 521.42568   2.526873   2 #> 229 510.39980   3.233501   2 #> 230 812.35484   2.856165   2 #> 231 505.48112   2.882675   2 #> 232 699.60459   3.028642   2 #> 233 500.26681   2.509121   2 #> 234 500.05482   2.687879   2 #> 235 625.68820   3.444352   2 #> 236 500.59642   3.652696   2 #> 237 519.94245   3.545124   2 #> 238 780.04337   3.358826   2 #> 239 528.64267   5.006215   2 #> 240 543.82753   2.666767   2 #> 241 660.47771   2.770217   2 #> 242 513.19254   2.573277   2 #> 243 518.90821   2.848924   2 #> 244 797.04095   2.789652   2 #> 245 520.29510   2.868769   2 #> 246 687.97048   2.557656   2 #> 247 500.14510   2.973322   2 #> 248 965.18730   2.577951   2 #> 249 522.97139   2.748705   2 #> 250 508.14879   2.704072   2 #> 251 514.50167   2.843698   2 #> 252 770.38703   2.727603   2 #> 253 507.09170   3.641624   2 #> 254 506.28532   2.649371   2 #> 255 510.48071   2.606060   2 #> 256 505.79680   2.740800   2 #> 257 551.84047   2.513588   2 #> 258 553.41605   2.999259   2 #> 259 501.35259   3.812384   2 #> 260 502.88385   3.860560   2 #> 261 500.46519   2.540893   2 #> 262 773.92205   2.856449   2 #> 263 501.73911   2.712388   2 #> 264 533.70580   3.033904   2 #> 265 853.59321   2.721863   2 #> 266 502.37471   2.652567   2 #> 267 539.56678   2.928529   2 #> 268 501.70794   2.724306   2 #> 269 508.29995   2.897165   2 #> 270 588.95410   2.623427   2 #> 271 821.90581   2.756092   2 #> 272 500.25796   2.911380   2 #> 273 841.12385   2.572880   2 #> 274 501.61444   2.944780   2 #> 275 502.47655   2.553456   2 #> 276 756.74835   2.799911   2 #> 277 500.37591   2.726975   2 #> 278 555.34668   2.907382   2 #> 279 511.13785   2.856926   2 #> 280 625.99001   3.046664   2 #> 281 514.97828   3.206621   2 #> 282 620.82555   2.625932   2 #> 283 517.95654   3.018245   2 #> 284 522.49454   3.188571   2 #> 285 515.15642   2.919935   2 #> 286 506.60582   3.423045   2 #> 287 519.61221   2.766618   2 #> 288 889.35640   2.971434   2 #> 289 647.58592   2.607845   2 #> 290 651.64261   2.653979   2 #> 291 505.93017   2.701337   2 #> 292 530.76191   2.633861   2 #> 293 568.47448   2.893729   2 #> 294 667.04217   3.228102   2 #> 295 506.97634   2.696689   2 #> 296 506.44469   2.618787   2 #> 297 502.30091   2.613106   2 #> 298 542.58891   2.670522   2 #> 299 522.25047   2.678892   2 #> 300 535.94406   3.313048   2 #> 301 502.80062   2.667720   2 #> 302 541.12983   2.935050   2 #> 303 500.32822   2.686138   2 #> 304 642.74530   2.786386   2 #> 305 502.35191   3.201675   2 #> 306 618.31492   2.500767   2 #> 307 502.28037   2.810014   2 #> 308 519.55007   3.241566   2 #> 309 502.45092   2.822716   2 #> 310 504.40699   2.706905   2 #> 311 848.17884   3.638520   2 #> 312 514.99340   2.610063   2 #> 313 504.15575   2.802485   2 #> 314 503.94632   2.752203   2 #> 315 502.95187   2.632646   2 #> 316 525.17032   2.578835   2 #> 317 502.85504   2.517143   2 #> 318 617.02652   2.873437   2 #> 319 863.21106   3.187486   2 #> 320 715.51977   2.530508   2 #> 321 889.53988   2.753634   2 #> 322 502.00934   2.623590   2 #> 323 501.81057   3.014760   2 #> 324 601.52745   3.555199   2 #> 325 511.42912   3.080083   2 #> 326 799.40837   2.952069   2 #> 327 743.01548   2.507698   2 #> 328 500.44625   2.725030   2 #> 329 503.37782   2.726247   2 #> 330 563.95973   2.554321   2 #> 331 527.68753   3.514531   2 #> 332 513.51789   2.670715   2 #> 333 504.93990   2.652917   2 #> 334 500.37017   2.509054   2 #> 335 532.31973   2.542203   2 #> 336 501.63489   3.168022   2 #> 337 756.83208   2.526492   2 #> 338 501.24626   3.147453   2 #> 339 556.54829   2.658558   2 #> 340 728.17702   2.995986   2 #> 341 632.68755   2.533967   2 #> 342 538.70824   5.284445   2 #> 343 501.05435   2.687492   2 #> 344 501.90336   3.148720   2 #> 345 539.21868   3.022076   2 #> 346 560.46756   2.964742   2 #> 347 501.95027   2.819231   2 #> 348 500.76511   2.561115   2 #> 349 500.99283   2.669952   2 #> 350 502.16687   3.999963   2 #> 351 500.74932   2.568732   2 #> 352 585.17143   2.823609   2 #> 353 500.82971   2.704905   2 #> 354 500.95377   3.104430   2 #> 355 983.28170   2.861513   2 #> 356 504.38867   2.738581   2 #> 357 611.95989   2.538381   2 #> 358 516.27405   2.544195   2 #> 359 543.18264   3.842575   2 #> 360 865.42630   2.569500   2 #> 361 519.90410   2.516612   2 #> 362 502.03250   2.756707   2 #> 363 515.35786   2.634692   2 #> 364 744.48280   4.377300   2 #> 365 566.39728   2.826566   2 #> 366 521.35140   2.819346   2 #> 367 780.90312   2.976497   2 #> 368 552.22568   3.515066   2 #> 369 517.50072   2.892731   2 #> 370 764.98496   2.703216   2 #> 371 880.96444   2.802078   2 #> 372 739.95544   2.503787   2 #> 373 500.71958   2.941288   2 #> 374 503.04742   3.459958   2 #> 375 837.65729   2.731422   2 #> 376 837.61750   2.976007   2 #> 377 925.80224   2.561257   2 #> 378 866.48198   2.621145   2 #> 379 838.58959   3.851008   2 #> 380 866.86113   2.609536   2 #> 381 844.07178   2.601556   2 #> 382 837.67525   2.574396   2 #> 383 861.58478   3.570698   2 #> 384 844.83808   2.654203   2 #> 385 837.63725   2.785046   2 #> 386 873.71125   3.197032   2 #> 387 928.72818   2.876875   2 #> 388 837.79157   2.627471   2 #> 389 855.75974   2.628902   2 #> 390 869.59126   3.700494   2 #> 391 840.85500   2.624158   2 #> 392 919.00745   2.842520   2 #> 393 837.66855   2.718834   2 #> 394 839.46726   2.760850   2 #> 395 838.34093   3.650968   2 #> 396 930.14633   2.674125   2 #> 397 838.64277   2.553673   2 #> 398 843.59462   3.639696   2 #> 399 837.80106   2.548413   2 #> 400 881.59901   2.548140   2 #> 401 837.62084   3.357618   2 #> 402 845.51317   2.581010   2 #> 403 966.53244   3.374634   2 #> 404 837.97872   2.669914   2 #> 405 843.19476   3.040276   2 #> 406 838.23184   3.622793   2 #> 407 839.34391   2.759586   2 #> 408 906.43218   2.717845   2 #> 409 838.38222   2.608291   2 #> 410 840.31272   2.682176   2 #> 411 840.69485   2.518419   2 #> 412 854.01556   3.173757   2 #> 413 848.22386   2.740791   2 #> 414 850.79958   3.392706   2 #> 415 839.40070   3.132911   2 #> 416 858.86321   2.717829   2 #> 417 837.91389   2.500188   2 #> 418 847.11650   3.409324   2 #> 419 837.90046   2.855340   2 #> 420 837.88145   2.815034   2 #> 421 859.79970   2.598455   2 #> 422 910.23107   2.662302   2 #> 423 837.61124   2.816382   2 #> 424 839.45340   3.021391   2 #> 425 839.94317   2.971540   2 #> 426 838.56006   3.395383   2 #> 427 839.19132   2.919214   2 #> 428 905.32742   2.650135   2 #> 429 839.18455   2.728827   2 #> 430 837.68815   2.750681   2 #> 431 837.75337   2.537561   2 #> 432 873.74598   3.136056   2 #> 433 838.02053   3.118345   2 #> 434 837.67967   4.097282   2 #> 435 837.61713   2.626153   2 #> 436 838.25091   3.430281   2 #> 437 839.67770   3.485910   2 #> 438 837.75844   3.080161   2 #> 439 837.66488   4.753484   2 #> 440 844.35262   2.666082   2 #> 441 877.27758   2.563559   2 #> 442 874.69466   2.802597   2 #> 443 837.69031   2.584636   2 #> 444 856.98518   2.839679   2 #> 445 839.34297   2.543815   2 #> 446 902.59340   3.131546   2 #> 447 838.50133   2.522686   2 #> 448 948.45545   2.982968   2 #> 449 983.33535   2.661406   2 #> 450 948.41479   2.778761   2 #> 451 706.36043   3.339084   2 #> 452 212.85861   3.793840   2 #> 453 881.36371   2.518470   2 #> 454 304.15835   2.674222   2 #> 455 777.32779   2.789982   2 #> 456 737.86941   3.058237   2 #> 457 527.76921   2.664026   2 #> 458 104.54171   2.837296   2 #> 459 447.81763   3.211594   2 #> 460 799.18010   2.763427   2 #> 461  25.68886   3.196383   2 #> 462 287.46032   2.730208   2 #> 463 712.19059   2.904406   2 #> 464 909.52980   2.526425   2 #> 465 346.29307   3.128679   2 #> 466 893.35965   2.575845   2 #> 467 163.56431   3.113286   2 #> 468 139.91965   2.586012   2 #> 469 252.94334   2.724563   2 #>  #> [[4]] #>            ts magnitudes gen #> 1   516.32612   2.603004   3 #> 2   965.55372   2.953900   3 #> 3   523.47693   3.208784   3 #> 4   525.07081   2.742918   3 #> 5   827.71933   2.529414   3 #> 6   805.37402   2.819435   3 #> 7   523.15697   2.713373   3 #> 8   532.67880   2.613961   3 #> 9   522.81261   2.755335   3 #> 10  623.58679   2.917221   3 #> 11  540.98685   3.678606   3 #> 12  522.42593   2.890408   3 #> 13  522.41925   2.623364   3 #> 14  611.08996   2.562023   3 #> 15  526.83473   3.508475   3 #> 16  563.67395   2.561428   3 #> 17  630.78641   2.787312   3 #> 18  540.77481   2.623716   3 #> 19  845.70028   2.543635   3 #> 20  524.70934   2.604728   3 #> 21  522.79775   3.021877   3 #> 22  532.64562   2.831494   3 #> 23  522.67882   2.715939   3 #> 24  522.64817   2.806916   3 #> 25  539.10615   2.629954   3 #> 26  532.58488   3.127145   3 #> 27  533.63509   2.558714   3 #> 28  717.98350   3.320938   3 #> 29  540.73955   3.156274   3 #> 30  534.14332   2.712553   3 #> 31  546.26421   3.389852   3 #> 32  546.44727   2.855170   3 #> 33  534.29994   2.804746   3 #> 34  525.68716   2.575684   3 #> 35  523.50744   2.589351   3 #> 36  523.14958   2.655956   3 #> 37  522.68271   2.705893   3 #> 38  523.82157   2.560990   3 #> 39  526.33472   2.855273   3 #> 40  522.40922   3.161384   3 #> 41  516.01860   2.679126   3 #> 42  686.63554   2.971463   3 #> 43  501.31541   2.924739   3 #> 44  553.17415   2.743671   3 #> 45  578.36312   3.565786   3 #> 46  798.57126   2.624044   3 #> 47  723.77479   2.609371   3 #> 48  923.05639   2.976391   3 #> 49  500.62831   2.522922   3 #> 50  524.68621   2.863272   3 #> 51  723.65398   2.567625   3 #> 52  805.90822   3.852089   3 #> 53  532.87075   2.773068   3 #> 54  513.68429   2.669196   3 #> 55  579.31210   2.666982   3 #> 56  606.65066   3.143642   3 #> 57  543.94393   2.789270   3 #> 58  700.88083   2.851967   3 #> 59  558.59477   3.311956   3 #> 60  600.96222   3.221770   3 #> 61  600.54590   2.964786   3 #> 62  600.51298   2.940792   3 #> 63  599.95447   2.594468   3 #> 64  601.28776   2.810226   3 #> 65  600.18372   3.459669   3 #> 66  641.09834   2.803899   3 #> 67  601.92576   4.159590   3 #> 68  600.59289   3.797796   3 #> 69  599.80465   2.752292   3 #> 70  600.86988   3.796073   3 #> 71  603.37222   2.528866   3 #> 72  601.33228   3.171392   3 #> 73  601.39302   3.154611   3 #> 74  601.92136   2.813019   3 #> 75  604.89647   3.166418   3 #> 76  599.79371   2.681045   3 #> 77  737.17825   2.796547   3 #> 78  606.84078   2.606959   3 #> 79  604.19867   3.750116   3 #> 80  749.27034   2.713602   3 #> 81  721.53590   3.367091   3 #> 82  728.84598   2.559083   3 #> 83  611.83958   2.535526   3 #> 84  600.09668   2.514371   3 #> 85  633.78525   2.811161   3 #> 86  609.73233   2.706199   3 #> 87  600.17838   3.186991   3 #> 88  626.60778   2.678288   3 #> 89  700.72976   2.920700   3 #> 90  661.67967   3.393833   3 #> 91  620.97316   3.012375   3 #> 92  602.44671   3.048302   3 #> 93  752.62147   2.759070   3 #> 94  708.55098   2.639322   3 #> 95  601.45564   2.566267   3 #> 96  615.41675   3.455718   3 #> 97  600.63439   3.385479   3 #> 98  601.28337   2.944082   3 #> 99  600.14295   2.765091   3 #> 100 663.74548   3.125721   3 #> 101 599.94838   2.669013   3 #> 102 652.68070   2.545618   3 #> 103 600.28798   4.358844   3 #> 104 600.34672   2.535925   3 #> 105 710.41617   2.764843   3 #> 106 601.06103   2.940037   3 #> 107 600.02208   2.777697   3 #> 108 599.90178   3.566134   3 #> 109 623.53622   2.693078   3 #> 110 601.37263   2.601784   3 #> 111 754.13929   2.672676   3 #> 112 620.46299   2.525384   3 #> 113 605.75844   2.800613   3 #> 114 599.98377   2.553626   3 #> 115 601.31643   3.771394   3 #> 116 599.83366   2.718826   3 #> 117 664.08060   2.644905   3 #> 118 608.22454   2.574800   3 #> 119 599.98536   2.666764   3 #> 120 802.51149   2.924934   3 #> 121 601.51185   2.682847   3 #> 122 599.99509   3.914542   3 #> 123 601.17016   2.678829   3 #> 124 632.82614   3.346363   3 #> 125 599.93640   2.567050   3 #> 126 601.52166   3.030134   3 #> 127 600.31764   2.883643   3 #> 128 633.23285   2.542902   3 #> 129 606.43975   2.569420   3 #> 130 665.89703   3.048606   3 #> 131 968.27446   3.504462   3 #> 132 969.12252   2.944207   3 #> 133 980.98198   2.996675   3 #> 134 979.23110   3.136024   3 #> 135 971.71512   3.154401   3 #> 136 969.33568   3.031239   3 #> 137 514.11236   2.978014   3 #> 138 594.54579   2.777993   3 #> 139 576.53755   3.636243   3 #> 140 564.37547   2.601738   3 #> 141 505.34272   2.511783   3 #> 142 526.59335   2.575748   3 #> 143 516.34783   4.932559   3 #> 144 676.14469   2.783064   3 #> 145 674.05223   3.475628   3 #> 146 514.37742   3.002592   3 #> 147 556.75225   2.543628   3 #> 148 524.96974   2.573050   3 #> 149 501.14198   2.592556   3 #> 150 500.83852   3.227388   3 #> 151 500.87172   3.140044   3 #> 152 501.61506   3.015598   3 #> 153 501.77137   3.508515   3 #> 154 559.75806   3.187197   3 #> 155 554.54525   3.526576   3 #> 156 501.41961   2.611643   3 #> 157 500.81898   2.798860   3 #> 158 501.47198   2.634280   3 #> 159 503.79332   2.523308   3 #> 160 500.76904   4.246520   3 #> 161 500.75526   2.559364   3 #> 162 615.73725   3.920890   3 #> 163 642.10462   2.766017   3 #> 164 891.89070   3.098567   3 #> 165 516.43383   3.063511   3 #> 166 570.55381   2.614246   3 #> 167 566.05563   3.498549   3 #> 168 558.70149   2.578046   3 #> 169 513.55554   3.258240   3 #> 170 501.06094   4.118087   3 #> 171 500.56764   2.556148   3 #> 172 638.25367   2.872391   3 #> 173 625.72361   4.108646   3 #> 174 782.48230   2.642920   3 #> 175 529.02735   2.668471   3 #> 176 531.24217   2.584547   3 #> 177 528.66824   2.517561   3 #> 178 529.88254   2.658074   3 #> 179 667.71638   2.786128   3 #> 180 532.17693   2.620149   3 #> 181 528.85488   3.818711   3 #> 182 529.14109   2.611457   3 #> 183 528.94106   2.598956   3 #> 184 531.28934   3.024040   3 #> 185 541.67152   2.645720   3 #> 186 871.87806   2.666154   3 #> 187 531.29664   2.630281   3 #> 188 531.81816   2.768683   3 #> 189 533.10387   3.064715   3 #> 190 886.43332   2.671950   3 #> 191 529.42066   2.512848   3 #> 192 543.15419   2.896108   3 #> 193 529.75971   3.290730   3 #> 194 533.71262   3.628059   3 #> 195 528.71329   2.778488   3 #> 196 529.42742   2.669449   3 #> 197 559.82045   2.960916   3 #> 198 530.31216   2.657187   3 #> 199 799.34020   2.991085   3 #> 200 525.25529   2.556629   3 #> 201 553.53077   4.776917   3 #> 202 502.72232   2.815181   3 #> 203 503.00054   2.601840   3 #> 204 503.35254   3.811202   3 #> 205 503.36090   2.639084   3 #> 206 501.79191   2.921492   3 #> 207 531.51645   2.605008   3 #> 208 670.64269   2.521054   3 #> 209 907.96769   3.063440   3 #> 210 569.16463   2.583055   3 #> 211 504.48797   3.645769   3 #> 212 502.03213   2.718186   3 #> 213 601.79919   2.952472   3 #> 214 613.63040   2.556744   3 #> 215 701.52927   2.824633   3 #> 216 512.18601   2.717792   3 #> 217 543.00648   3.197032   3 #> 218 584.21158   2.561615   3 #> 219 541.17885   2.799803   3 #> 220 615.25207   2.884808   3 #> 221 540.17743   2.631082   3 #> 222 538.79209   2.924130   3 #> 223 538.85790   2.642609   3 #> 224 736.07947   2.510499   3 #> 225 557.40330   3.115198   3 #> 226 540.61487   3.523303   3 #> 227 538.76438   3.225037   3 #> 228 539.81194   3.235856   3 #> 229 553.85247   2.659629   3 #> 230 538.75275   2.787233   3 #> 231 682.05728   3.210040   3 #> 232 540.96795   2.624140   3 #> 233 539.32156   3.267515   3 #> 234 538.78947   2.507176   3 #> 235 559.91954   3.030020   3 #> 236 569.67936   2.574090   3 #> 237 627.10238   4.168451   3 #> 238 658.44161   2.587707   3 #> 239 538.74314   3.235744   3 #> 240 547.61243   3.518234   3 #> 241 547.17509   2.772972   3 #> 242 541.00871   2.708721   3 #> 243 541.33160   3.060155   3 #> 244 540.63579   2.792149   3 #> 245 545.30622   2.515050   3 #> 246 539.51744   2.877512   3 #> 247 538.87224   3.339154   3 #> 248 539.03242   2.996046   3 #> 249 552.83465   2.542449   3 #> 250 599.84481   3.610309   3 #> 251 549.63338   2.526630   3 #> 252 966.54536   2.545595   3 #> 253 538.72562   3.062389   3 #> 254 539.16314   2.601955   3 #> 255 571.24367   2.820225   3 #> 256 538.72691   2.551366   3 #> 257 596.02915   3.120967   3 #> 258 539.16797   3.185840   3 #> 259 539.74794   3.774171   3 #> 260 516.03999   2.569157   3 #> 261 528.76374   3.468710   3 #> 262 544.93800   2.846802   3 #> 263 933.14242   3.060519   3 #> 264 745.04026   2.532575   3 #> 265 744.82551   2.500992   3 #> 266 745.88745   3.145764   3 #> 267 780.91850   3.164463   3 #> 268 838.63129   4.646146   3 #> 269 919.24596   3.209391   3 #> 270 838.78409   3.078331   3 #> 271 868.91393   3.210952   3 #> 272 842.14666   3.433666   3 #> 273 841.29577   3.579856   3 #> 274 958.40670   2.808494   3 #> 275 855.34075   2.709961   3 #> 276 838.65172   2.684702   3 #> 277 839.27852   2.620420   3 #> 278 838.18720   2.956247   3 #> 279 837.80757   3.230707   3 #> 280 847.57283   2.731509   3 #> 281 838.21178   2.655300   3 #> 282 837.87566   3.387904   3 #> 283 837.67849   4.693340   3 #> 284 894.80972   2.714137   3 #> 285 837.92508   2.613830   3 #> 286 953.46443   2.548392   3 #> 287 874.77239   2.533620   3 #> 288 777.36147   2.562458   3 #> 289  55.43842   2.854653   3 #> 290 190.13605   2.649327   3 #> 291 317.17237   2.982911   3 #>  #> [[5]] #>          ts magnitudes gen #> 1  966.2927   2.741509   4 #> 2  965.5932   3.068375   4 #> 3  532.7552   2.653279   4 #> 4  529.2649   2.729935   4 #> 5  522.4395   3.247312   4 #> 6  807.0027   2.945323   4 #> 7  807.9018   2.550507   4 #> 8  963.3216   2.846464   4 #> 9  634.0401   2.507510   4 #> 10 603.5866   2.563413   4 #> 11 601.2771   2.588300   4 #> 12 601.2681   3.041215   4 #> 13 652.8514   2.690400   4 #> 14 616.9909   2.864916   4 #> 15 600.1543   2.574385   4 #> 16 617.5614   2.844381   4 #> 17 600.9732   3.827799   4 #> 18 602.7639   2.774041   4 #> 19 753.4807   2.531092   4 #> 20 600.7320   4.067769   4 #> 21 978.3015   2.549220   4 #> 22 600.4699   4.122180   4 #> 23 600.2990   2.726425   4 #> 24 623.1785   2.959872   4 #> 25 608.2305   2.598254   4 #> 26 605.5586   2.955251   4 #> 27 634.2450   3.074580   4 #> 28 534.8009   2.578390   4 #> 29 552.9068   3.079468   4 #> 30 546.9422   2.643796   4 #> 31 516.4977   2.879368   4 #> 32 532.4093   2.960693   4 #> 33 516.3546   2.829889   4 #> 34 519.7217   2.960954   4 #> 35 517.8427   2.986748   4 #> 36 516.6811   2.937672   4 #> 37 516.7255   2.579676   4 #> 38 739.1422   2.531295   4 #> 39 518.4136   3.263113   4 #> 40 758.3953   3.240426   4 #> 41 596.6663   2.607457   4 #> 42 595.3997   3.382584   4 #> 43 678.3301   2.578490   4 #> 44 501.5949   2.767289   4 #> 45 541.1646   2.818607   4 #> 46 616.6728   2.634547   4 #> 47 554.8790   2.526486   4 #> 48 589.9428   2.682128   4 #> 49 892.2442   2.506656   4 #> 50 570.6915   2.918136   4 #> 51 501.6229   3.053943   4 #> 52 628.8879   2.674665   4 #> 53 626.0938   2.831991   4 #> 54 530.1060   3.349706   4 #> 55 529.9978   2.736887   4 #> 56 529.6517   4.150168   4 #> 57 529.0099   2.559015   4 #> 58 535.0776   2.735544   4 #> 59 542.9718   2.817728   4 #> 60 531.3595   2.568332   4 #> 61 535.8160   2.952707   4 #> 62 530.5766   2.691795   4 #> 63 963.3633   2.531715   4 #> 64 573.9216   2.645173   4 #> 65 689.0470   3.016626   4 #> 66 553.7923   2.852670   4 #> 67 553.5544   2.748288   4 #> 68 554.6348   2.622662   4 #> 69 613.6588   2.832944   4 #> 70 512.6673   2.634946   4 #> 71 548.6648   2.827551   4 #> 72 651.3950   3.106613   4 #> 73 639.6687   2.533865   4 #> 74 547.6821   3.519069   4 #> 75 601.4710   2.630112   4 #> 76 553.4093   2.657658   4 #> 77 539.2139   2.809964   4 #> 78 540.3678   2.606708   4 #> 79 530.0758   3.616073   4 #> 80 529.2009   3.721249   4 #> 81 933.9229   2.765614   4 #> 82 933.2311   2.780568   4 #> 83 839.1952   3.388126   4 #> 84 862.6687   2.593212   4 #> 85 990.2073   2.892974   4 #> 86 988.9035   2.670871   4 #> 87 839.5632   2.694351   4 #> 88 837.7561   3.421098   4 #> 89 838.6487   2.673653   4 #> 90 860.9299   3.106244   4 #> 91 837.7237   2.519085   4 #> 92 837.7077   2.648386   4 #> 93 841.2107   2.722953   4 #>  #> [[6]] #>          ts magnitudes gen #> 1  583.4097   2.910699   5 #> 2  603.0346   2.940111   5 #> 3  601.8666   2.613354   5 #> 4  601.4341   2.821959   5 #> 5  601.0403   2.724463   5 #> 6  601.1845   3.130456   5 #> 7  640.7051   3.313265   5 #> 8  600.8932   2.515763   5 #> 9  600.4872   2.629283   5 #> 10 872.9980   2.806438   5 #> 11 890.5103   2.522611   5 #> 12 549.1833   2.516398   5 #> 13 591.5818   3.242262   5 #> 14 938.5508   2.693092   5 #> 15 670.9240   2.549759   5 #> 16 537.1963   2.577834   5 #> 17 529.6676   2.718268   5 #> 18 531.0516   2.923127   5 #> 19 571.7811   2.710284   5 #> 20 531.6406   3.095112   5 #> 21 969.1319   2.540096   5 #> 22 554.2358   2.534456   5 #> 23 517.9460   2.795344   5 #> 24 653.2421   2.650782   5 #> 25 552.8461   3.083833   5 #> 26 551.4943   3.462881   5 #> 27 629.3926   2.566465   5 #> 28 557.8666   2.655709   5 #> 29 718.6663   2.503332   5 #> 30 934.9124   3.266538   5 #> 31 990.0144   2.811208   5 #>  #> [[7]] #>         ts magnitudes gen #> 1 584.5281   3.626130   6 #> 2 658.5808   2.764323   6 #> 3 598.0662   2.625956   6 #> 4 531.9636   2.666534   6 #> 5 532.6634   2.645501   6 #> 6 531.4139   2.508849   6 #> 7 653.2525   2.794004   6 #> 8 552.0492   3.173759   6 #>  #> [[8]] #>         ts magnitudes gen #> 1 584.5506   2.641895   7 #> 2 584.8174   2.568371   7 #> 3 538.1656   2.513258   7 #>"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the posterior distribution of the expected number of events — get_posterior_N","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"Plot posterior distribution expected number events","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"","code":"get_posterior_N(input.list, domain.extension = 0.1)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"input.list combined input file (link functions) bru output (marginals) domain.extension Percentage posterior quantiles extend domain specified scalar. Default set 0.10.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_N.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the posterior distribution of the expected number of events — get_posterior_N","text":"list three objects: post.df: data.frame containing posterior informations posterior distribution number events post.plot : ggplot object showing posterior distribution expected number events post.plot.shaded : ggplot object showing posterior distribution expected number events, shaded region corresponds 0.025 0.975 quantiles distribution distribution number events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"Retrieve posterior distribution ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"","code":"get_posterior_param(input.list)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"input.list input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/get_posterior_param.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve posterior distribution of ETAS parameters — get_posterior_param","text":"list two elements: post.df : data.frame posterior distributions parameters columns x (value parameter), y (value posterior), param (parameter name) post.plot : ggplot object showing posterior distribution parameter","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":null,"dir":"Reference","previous_headings":"","what":"ETAS triggering function - used by inlabru — gt","title":"ETAS triggering function - used by inlabru — gt","text":"function returns value ETAS triggering function specified time t points history th, mh","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ETAS triggering function - used by inlabru — gt","text":"","code":"gt(theta, t, th, mh, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ETAS triggering function - used by inlabru — gt","text":"theta ETAS parameters list names K, alpha, c, p t Time function calculated, scalar vector th Time events history [days, months,...], scalar vector mh Magnitude events history, scalar vector M0 Minimum magnitude threshold, scalar","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ETAS triggering function - used by inlabru — gt","text":"value ETAS triggering function evaluated t history th, mh.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/gt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ETAS triggering function - used by inlabru — gt","text":"ETAS triggering function evaluated $$g(t - t_h | m_h) = K e^{\\alpha(m_h - M_0)} \\left( \\frac{t - t_h}{c} + 1\\right)^{-p}$$ \\(K, \\alpha, c > 0\\), \\(p \\geq 1\\) ETAS parameters, \\(t\\) (t) time function evaluated, considering past observation \\(t_h, m_h\\) (th, mh). function returns 0 \\(t_h > t\\). \\(t\\) scalar \\(t_h, m_h\\) vectors function returns vector, \\(t\\) vector \\(t_h, m_h\\) scalars, \\(t, t_h, m_h\\) vectors length. use \\(t\\) \\(t_h, m_h\\) vectors different lengths.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":null,"dir":"Reference","previous_headings":"","what":"HORUS Ita Catalogue — horus","title":"HORUS Ita Catalogue — horus","text":"HOmogenized instRUmental Seismic catalog (HORUS) Italy 1960 present, limited limited 1960-2019.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"HORUS Ita Catalogue — horus","text":"","code":"horus"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"HORUS Ita Catalogue — horus","text":"Original file format: Year: Origin Time (OT) year Mo: OT month Da: OT day Ho: OT hour Mi OT minute Se OT seconds fractions Lat epicenter N latitude (degrees) Lon epicenter E longitude (degrees) Depth hypocenter depth (km) Mw true proxy moment magnitude sigMw moment magnitude uncertainty Geo.Ita \"*\" indicates epicenter within Italian mainland territory, otherwise \" \" Geo.CPTI15 \"*\" indicates epicenter within spatial window CPTI15 catalog (Rovida et al., 2020, Bull Earth Eng, doi: 10.1007/s10518-020-00818-y) Ev..type \"x\" indicates event earthquake (e.g. explosion, eruption, landslide, ...) (since May 1st 2012) Iside.n. ISIDe id number (since April 16th 2005) ETAS.inlabru format: time_string: Data-time event, ISO 8601 format; format = \"%Y-%m-%dT%H:%M:%OS\" use .POSIXct() lon: Original Lon lat: Original Lat depth Original Depth M: Original Mw","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"HORUS Ita Catalogue — horus","text":"http://horus.bo.ingv./","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"HORUS Ita Catalogue — horus","text":"original entire HORUS catalog provided single tab separated ascii file: HORUS_Ita_Catalog.txt random second decimal digit added ML Md INGV bulletin (ISIDe) computing Mw proxies (Lolli et al., Seism. Res. Lett., 91, 3208-3222, doi: 10.1785/0220200148), HORUS_Ita_Catalog_o.txt original ML Md used compute Mw proxies. ETAS.inlabru includes reformatted version data HORUS_Ita_Catalog.txt data.frame, limited 1960-2019. data provided , express implied warranty given.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/horus.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"HORUS Ita Catalogue — horus","text":"Barbara Lolli(1), Daniele Randazzo(1), Gianfranco Vannucci(1) Paolo Gasperini (2),(1) (2020). Homogenized Instrumental Seismic Catalog (HORUS) Italy 1960 Present, Seismol. Res. Lett, doi: 10.1785/0220200148. (1) Istituto Nazionale di Geofisica e Vulcanologia, Sezione di Bologna (2) Dipartimento di Fisica e Astronomia, Università di Bologna","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"Copula transformation Exponential standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"","code":"inv_exp_t(x, rate)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"x values Exponential distribution, vector. rate rate Exponential distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_exp_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Exponential to a standard Normal distribution — inv_exp_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"Copula transformation Gamma standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"","code":"inv_gamma_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"x values Gamma distribution, vector. shape parameter Gamma distribution, scalar. b rate parameter Gamma distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_gamma_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Gamma to a standard Normal distribution — inv_gamma_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"Copula transformation Log-Normal standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"","code":"inv_loggaus_t(x, m, s)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"x values Log-Normal distribution, vector. m mean logarithm Log-Normal distribution, scalar. s standard deviation logarithm Log-Normal distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_loggaus_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Log-Normal to a standard Normal distribution — inv_loggaus_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"Copula transformation Uniform standard Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"","code":"inv_unif_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"x values Uniform distribution, vector. minimum Uniform distribution, scalar. b maximum Uniform distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/inv_unif_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from an Uniform to a standard Normal distribution — inv_unif_t","text":"values standard Normal distribution, vector length x","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the integral of the ETAS conditional intensity — lambda_N","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"Calculate number events time interval T1 T2 given imposed events ETAS","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"","code":"lambda_N(th.mu, th.K, th.alpha, th.c, th.p, T1, T2, M0, Ht, link.functions)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"th.mu Background rate, mu, internal parameter scale th.K ETAS triggering parameter K internal parameter scale th.alpha ETAS triggering parameter alpha internal parameter scale th.c ETAS triggering parameter c internal parameter scale th.p ETAS triggering parameter p internal parameter scale T1 Start temporal model domain. T2 End temporal model domain. M0 Minimum magnitude threshold Ht History process, set known events interval. must data.frame columns ts (time) magnitudes (magnitudes). link.functions list functions transform parameters internal scale ETAS scale","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/lambda_N.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the integral of the ETAS conditional intensity — lambda_N","text":"Integral ETAS conditional intensity T1 T2 minimum magnitude M0, .e. expected number events.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":null,"dir":"Reference","previous_headings":"","what":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"Logarithm integral ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"","code":"log_Lambda_h(theta, th, mh, M0, T1, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"theta ETAS parameters data.frame(mu=mu, K=K, alpha=alpha, c=c, p=p). th Time parent event. mh Magnitude parent event M0 Minimum magnitude threshold T1 Start temporal model domain. T2 End temporal model domain.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/log_Lambda_h.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logarithm of the integral of the ETAS triggering function — log_Lambda_h","text":"Logarithm integral ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"Copula transformation standard Normal distribution Log-Normal distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"","code":"loggaus_t(x, m, s)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"x values standard Normal distribution, vector. m mean logarithm Log-Normal distribution, scalar. s standard deviation logarithm Log-Normal distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/loggaus_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Log-Normal distribution — loggaus_t","text":"Values Log-Normal distribution logarithmic mean m standard deviation s, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to calculate Omori's law — omori","title":"Function to calculate Omori's law — omori","text":"Function calculate Omori's law","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to calculate Omori's law — omori","text":"","code":"omori(theta, t, ti)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to calculate Omori's law — omori","text":"theta ETAS parameters (list(mu = mu, K = K, alpha = alpha, c = c, p = p), parameters c p used t Time Omori's law evaluated ti Time event history","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to calculate Omori's law — omori","text":"Value Omori's law point t event happened ti","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"Function plot Omori's law corresponding different posterior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"","code":"omori_plot_posterior(   input.list,   post.samp = NULL,   n.samp = 10,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale post.samp data.frame containing posterior samples parameters. NULL, n.samp samples generated. n.samp different nrow(post.samp) n.samp rows uniformly sampled post.samp. Default NULL. n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot Omori's law corresponding to different posterior samples — omori_plot_posterior","text":"ggplot object","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"Function plot Omori's law corresponding different prior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"","code":"omori_plot_prior(input.list, n.samp = 10, t.end = 1, n.breaks = 100)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"input.list structured input list least one element: link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/omori_plot_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot Omori's law corresponding to different prior samples — omori_plot_prior","text":"ggplot object","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"Plot posterior densities ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"","code":"post_pairs_plot(   input.list = NULL,   n.samp = NULL,   post.samp = NULL,   max.batch = 1000 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp number samples draw posteriors plot post.samp data.frame columns mu, K, alpha, c, p rows corresponding different posterior samples. NULL function samples joint posterior distribution n.samp times. default NULL. max.batch parameter post_sampling function used case post.samp = NULL","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_pairs_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the posterior densities of the ETAS parameters — post_pairs_plot","text":"list: elements post.samp.df:data.frame posterior samples nrow = n.samp columns mu, K, alpha, c, p corresponding ETAS parameters. post.samp NULL returns post.samp pair.plot: ggplot object reporting pair plot parameters samples. obtained using ggpairs function Ggally library","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from the posterior of the ETAS parameters — post_sampling","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"Sample posterior ETAS parameters","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"","code":"post_sampling(input.list, n.samp, max.batch = 1000, ncore = NULL)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale n.samp number samples draw posteriors max.batch Maximum number posterior samples generated simultaneously. Default 1000. ncore Deprecated argument controlling parallelism. Use future::plan(future::multisession, workers = ncore) (similar) configure parallelism code instead.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/post_sampling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from the posterior of the ETAS parameters — post_sampling","text":"data.frame posterior samples nrow = n.samp columns mu, K, alpha, c, p corresponding ETAS parameters.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":null,"dir":"Reference","previous_headings":"","what":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"Return sample magnitudes drawn GR distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"","code":"sample_GR_magnitudes(n, beta.p, M0)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"n Number events sample. beta.p Related b-value via b ln(10). M0 Minimum magnitude sample.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"list magnitudes length n drawn GR distribution.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_GR_magnitudes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Return a sample of magnitudes drawn from the GR distribution — sample_GR_magnitudes","text":"","code":"sample_GR_magnitudes(n = 100, beta.p = log(10), M0 = 2.5) #>   [1] 2.687433 2.665394 2.707428 2.743306 2.551008 2.654689 3.072566 3.960987 #>   [9] 2.662423 3.284934 3.028603 2.649185 3.967426 4.254684 2.760783 2.644172 #>  [17] 2.527576 2.684055 2.549137 3.164995 2.600490 3.005816 2.551834 2.591086 #>  [25] 2.680806 2.894126 3.020164 2.674907 2.648166 2.927408 3.020654 2.677438 #>  [33] 4.882323 3.146617 2.592206 3.043437 2.591203 2.724148 3.611405 2.809368 #>  [41] 2.590840 2.900071 2.537258 4.046024 3.289491 2.595485 2.722929 2.838256 #>  [49] 4.031103 2.915920 2.703226 2.535995 3.054762 3.135609 2.860372 2.517583 #>  [57] 2.933197 3.052001 3.120861 2.735462 2.720757 2.589944 2.646811 2.701760 #>  [65] 2.721539 2.621144 3.262282 2.647235 2.506437 3.344318 3.673704 2.530679 #>  [73] 3.547526 2.930294 2.843369 2.586876 3.215715 2.620524 2.799282 2.949380 #>  [81] 3.460363 2.551549 2.535248 3.789372 2.626393 3.294434 2.688250 3.419776 #>  [89] 2.781690 2.769329 2.980950 2.623714 2.883363 2.974678 2.568269 2.517448 #>  [97] 2.557832 2.819620 2.729303 2.520301"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"Generate sample new events data.frame(t_i, M_i) length n.ev one parent event occuring time t_h using ETAS model.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"","code":"sample_temporal_ETAS_daughters(theta, beta.p, th, n.ev, M0, T1, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). th Time parent event [days]. n.ev number events placed. M0 Minimum magnitude synthetic catalogue. T1 Start time synthetic catalogue [days]. T2 End time synthetic catalogue [days].","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_daughters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a sample of new events data.frame(t_i, M_i) of length n.ev for one parent event occuring at time t_h using the ETAS model. — sample_temporal_ETAS_daughters","text":"Generate sample new events data.frame(t_i, M_i) one parent","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":null,"dir":"Reference","previous_headings":"","what":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"Take previous parent events Ht=data.frame[ts, magnitudes] generates daughters events using ETAS model","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"","code":"sample_temporal_ETAS_generation(theta, beta.p, Ht, M0, T1, T2, ncore = NULL)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). beta.p Slope GR relation: beta = b ln(10). Ht set parent events form data.frame[ts, magnitudes] M0 minimum earthquake magnitude synthetic catalogue. T1 start time synthetic catalogue [days]. T2 end time synthetic catalogue [days]. ncore Deprecated argument controlling parallelism. Use future::plan(future::multisession, workers = ncore) (similar) configure parallelism code instead.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"Return one generation daughters parents Ht form data.frame(t_i, M_i).","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_generation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Take all previous parent events from Ht=data.frame[ts, magnitudes] and generates their daughters events using the ETAS model — sample_temporal_ETAS_generation","text":"","code":"# The parents are specified in Ht Ht <- data.frame(ts = c(500), magnitudes = c(6.7)) sample_temporal_ETAS_generation(   theta = list(mu = 0.1, K = 0.089, alpha = 2.29, c = 0.11, p = 1.08),   beta.p = log(10),   M0 = 2.5,   T1 = 0, T2 = 1000,   Ht = Ht ) #>           ts magnitudes #> 1   500.0032   2.854616 #> 2   500.0655   2.780891 #> 3   713.8028   3.261780 #> 4   500.5522   2.623776 #> 5   501.1390   3.970416 #> 6   542.1219   2.850916 #> 7   500.1280   2.950413 #> 8   866.2634   2.504654 #> 9   500.0231   2.620150 #> 10  500.4643   3.257538 #> 11  532.0721   3.410215 #> 12  501.1492   2.736483 #> 13  550.6206   3.253832 #> 14  873.2340   2.881762 #> 15  500.3545   2.788701 #> 16  500.2155   3.629569 #> 17  500.8710   2.825316 #> 18  501.3197   4.472085 #> 19  787.7554   2.835625 #> 20  500.5086   2.540215 #> 21  500.0443   2.631805 #> 22  500.7057   2.505770 #> 23  508.5884   2.970961 #> 24  533.6891   2.795836 #> 25  553.1657   3.217741 #> 26  839.4900   3.340627 #> 27  500.0144   2.785300 #> 28  504.5322   3.206107 #> 29  500.3140   2.646065 #> 30  500.0308   3.967302 #> 31  500.8546   3.074422 #> 32  502.1909   2.785456 #> 33  503.8887   3.076674 #> 34  855.1528   2.654004 #> 35  501.4763   2.737228 #> 36  500.1098   3.038190 #> 37  502.7603   2.508212 #> 38  500.3024   2.535980 #> 39  582.8725   4.031959 #> 40  500.6329   2.624804 #> 41  500.3811   2.521872 #> 42  508.4905   2.678007 #> 43  568.8361   2.807217 #> 44  575.3960   2.545399 #> 45  568.5297   2.637165 #> 46  500.1665   3.316059 #> 47  504.0558   2.893835 #> 48  564.5399   2.763253 #> 49  502.0673   3.510807 #> 50  500.4579   3.024627 #> 51  500.5994   3.709169 #> 52  502.1751   3.182956 #> 53  517.5227   2.824998 #> 54  524.2643   2.883920 #> 55  500.4475   2.539232 #> 56  500.9387   2.538403 #> 57  742.8428   3.101129 #> 58  547.8998   3.090444 #> 59  870.3823   2.640910 #> 60  589.0198   3.636705 #> 61  500.0933   2.506779 #> 62  539.7389   3.211839 #> 63  500.9460   5.255884 #> 64  567.9297   2.505857 #> 65  507.8302   2.532196 #> 66  508.8259   2.554455 #> 67  503.2162   2.551838 #> 68  529.6975   2.533715 #> 69  500.0528   2.537830 #> 70  500.1183   2.801075 #> 71  886.8631   3.158906 #> 72  835.7394   3.400991 #> 73  501.4694   2.921424 #> 74  510.1971   2.717168 #> 75  502.5630   2.608587 #> 76  502.5964   2.729410 #> 77  508.3499   2.847450 #> 78  501.3239   2.803648 #> 79  542.1850   2.862290 #> 80  500.6167   3.861527 #> 81  544.6078   2.705999 #> 82  500.6747   2.851835 #> 83  500.0425   2.557596 #> 84  500.0817   2.683586 #> 85  502.0122   2.804447 #> 86  500.1303   2.517477 #> 87  504.2234   2.511644 #> 88  500.0070   2.881117 #> 89  522.9585   2.560843 #> 90  500.6196   2.840689 #> 91  503.3062   2.599428 #> 92  505.4624   3.483968 #> 93  500.0542   2.552335 #> 94  521.3262   2.788851 #> 95  510.9712   3.195284 #> 96  509.0260   2.851096 #> 97  501.5004   2.609149 #> 98  500.0686   2.863939 #> 99  500.2396   3.401764 #> 100 518.5011   2.821746 #> 101 751.0976   2.780488 #> 102 501.1338   2.775511 #> 103 513.3572   2.625854 #> 104 500.0728   2.526289 #> 105 500.0115   2.629557 #> 106 500.2932   3.056035 #> 107 530.0139   2.895211 #> 108 504.3143   2.979233 #> 109 510.2640   2.553038 #> 110 502.1753   2.935308 #> 111 610.3992   2.756230 #> 112 504.3626   2.998366 #> 113 531.0271   3.751637 #> 114 500.3029   3.267037 #> 115 500.7009   2.568039 #> 116 522.7515   2.681736 #> 117 552.1375   2.503798 #> 118 598.8892   2.666463 #> 119 507.7827   4.645108 #> 120 511.6021   2.771235 #> 121 501.6558   2.753408 #> 122 502.1336   2.959659 #> 123 528.3673   2.692991 #> 124 545.1249   2.523389 #> 125 503.4852   2.913642 #> 126 928.0368   2.609337 #> 127 506.1168   2.824679 #> 128 503.0776   2.964848 #> 129 500.8660   2.882263 #> 130 516.1435   2.541522 #> 131 500.5290   2.705078 #> 132 514.3679   2.709000 #> 133 501.1523   2.561178 #> 134 525.4111   2.719497 #> 135 585.1283   2.814874 #> 136 500.0773   2.586706 #> 137 518.7717   2.621077 #> 138 500.6757   2.723735 #> 139 500.0033   2.518941 #> 140 539.1291   2.537739 #> 141 503.6076   2.693861 #> 142 678.7806   2.731122 #> 143 500.0466   3.436384 #> 144 503.4793   2.631310 #> 145 510.3107   3.434426 #> 146 500.2444   3.199720 #> 147 507.3831   3.092660 #> 148 502.0313   2.547327 #> 149 501.1083   3.365604 #> 150 507.9164   2.710538 #> 151 500.3303   2.622885 #> 152 500.0163   2.841978 #> 153 515.4334   3.320814 #> 154 500.1260   2.902781 #> 155 500.8232   2.688602 #> 156 605.1385   2.580925 #> 157 500.0244   2.752767 #> 158 500.5522   3.400283 #> 159 521.0548   3.133270 #> 160 500.1857   3.089420 #> 161 507.6017   2.507152 #> 162 505.4870   3.046560 #> 163 524.7744   2.963047 #> 164 542.4416   2.879388 #> 165 500.3415   2.687982 #> 166 502.5181   2.682534 #> 167 500.0780   3.096202 #> 168 501.2471   2.623289 #> 169 574.7156   3.012360 #> 170 500.0083   2.723776 #> 171 500.9009   2.894095 #> 172 693.8177   3.151315 #> 173 501.6855   2.730307 #> 174 500.1250   4.031900 #> 175 501.1865   3.069321 #> 176 500.0599   3.389396 #> 177 500.0101   2.993986 #> 178 500.0573   3.096394 #> 179 506.3039   2.694912 #> 180 503.4941   3.079831 #> 181 551.2476   2.948259 #> 182 500.1751   3.081314 #> 183 501.8812   3.285649 #> 184 500.0040   2.521936 #> 185 639.9234   2.627090 #> 186 522.7442   2.871408 #> 187 807.7381   3.113380 #> 188 500.0143   2.724664 #> 189 500.0963   2.622568 #> 190 500.0003   2.969777 #> 191 523.4298   3.742565 #> 192 500.0004   2.938693 #> 193 500.3580   3.145363 #> 194 500.2085   3.316677 #> 195 501.1673   2.525906 #> 196 500.0809   2.643767 #> 197 500.7559   2.514858 #> 198 569.0511   3.314865 #> 199 541.2401   2.830343 #> 200 500.3676   2.545303 #> 201 532.0550   3.091448 #> 202 569.1797   2.918655 #> 203 590.3978   3.536539 #> 204 500.1957   2.712415 #> 205 501.3546   3.014729 #> 206 500.5008   2.651808 #> 207 547.3229   2.587205 #> 208 514.3307   2.724585 #> 209 774.3424   2.879256 #> 210 500.0525   2.644805 #> 211 501.0921   2.504739 #> 212 500.0587   3.060931 #> 213 539.5130   3.945342 #> 214 500.1221   2.746927 #> 215 687.2272   2.712561 #> 216 501.4394   2.580104 #> 217 500.2225   2.640882 #> 218 500.8665   3.040860 #> 219 506.8335   3.393350 #> 220 526.0242   2.741535 #> 221 500.0850   3.680920 #> 222 560.2019   3.008387 #> 223 821.5655   2.835977 #> 224 541.1469   2.791549 #> 225 515.6912   2.563234 #> 226 500.2249   3.270426 #> 227 500.0802   2.584837 #> 228 501.3057   2.571205 #> 229 500.7500   2.905633 #> 230 500.3187   2.592972 #> 231 500.0056   2.987409 #> 232 566.2306   2.697251 #> 233 511.6338   2.669155 #> 234 592.7353   2.970152 #> 235 502.3577   2.555644 #> 236 500.2092   2.814883 #> 237 506.8741   2.740397 #> 238 531.5993   2.808546 #> 239 501.5690   2.584216 #> 240 500.4671   2.846822 #> 241 500.1938   3.968872 #> 242 506.7649   3.517805 #> 243 518.4082   2.556841 #> 244 714.9027   3.580454 #> 245 504.4019   2.521357 #> 246 500.0621   3.389379 #> 247 504.7302   2.805492 #> 248 846.3918   2.723147 #> 249 502.5146   2.573402 #> 250 575.4934   2.891027 #> 251 500.3525   3.753055 #> 252 504.2268   3.307176 #> 253 500.9884   2.520054 #> 254 500.4787   2.634015 #> 255 517.5471   2.785688 #> 256 504.7092   2.572263 #> 257 500.1652   3.326087 #> 258 500.1444   2.946442 #> 259 562.6667   2.816536 #> 260 500.8489   3.967220 #> 261 503.4568   2.575424 #> 262 500.5408   2.712843 #> 263 535.7478   2.722871 #> 264 503.0440   2.505847 #> 265 501.6469   2.978926 #> 266 500.1914   2.549277 #> 267 500.2420   2.795765 #> 268 706.0738   2.975787 #> 269 500.2023   2.520266 #> 270 558.2244   3.270560 #> 271 502.3445   2.551288 #> 272 500.3966   4.525233 #> 273 502.3570   3.254618 #> 274 500.0570   2.958732 #> 275 500.8002   3.288178 #> 276 502.3600   3.237213 #> 277 513.4484   2.716582 #> 278 827.3388   2.514280 #> 279 514.9905   2.621376 #> 280 500.1004   2.775034 #> 281 504.8311   2.684060 #> 282 500.0851   3.316631 #> 283 530.3534   3.368967 #> 284 503.1264   2.822525 #> 285 501.6829   3.032493 #> 286 500.4978   2.753019 #> 287 500.1760   3.001477 #> 288 500.1089   3.083631 #> 289 500.4063   3.185870 #> 290 502.1292   3.501435 #> 291 500.2566   2.855497 #> 292 500.2782   2.615833 #> 293 506.2043   2.540743 #> 294 500.5786   2.532977 #> 295 835.7779   3.064024 #> 296 598.6749   2.636469 #> 297 500.1816   2.625643 #> 298 507.6586   2.630242 #> 299 500.8252   3.780653 #> 300 515.5917   3.801302 #> 301 500.8573   3.333991 #> 302 504.7317   3.494254 #> 303 525.4431   2.871331 #> 304 501.4974   3.320907 #> 305 500.1258   2.816408 #> 306 500.2580   2.607881 #> 307 517.7392   2.562927 #> 308 660.6362   2.575170 #> 309 500.2047   3.526625 #> 310 500.3326   2.505184 #> 311 500.0178   2.849576 #> 312 778.0157   2.544787 #> 313 507.2650   2.741524 #> 314 500.0245   2.574325 #> 315 500.1179   2.673075 #> 316 906.4233   2.982453 #> 317 506.4204   3.021488 #> 318 500.5300   2.560837 #> 319 544.2420   2.832285 #> 320 502.0393   2.991681 #> 321 500.1378   2.662548 #> 322 500.3980   3.049663 #> 323 547.0170   2.643111 #> 324 500.1473   3.285748 #> 325 505.9810   2.515426 #> 326 625.7603   2.535860 #> 327 545.1848   3.059854 #> 328 500.7428   2.545931 #> 329 500.1899   3.542073 #> 330 518.4442   3.182581 #> 331 500.2313   2.941554 #> 332 572.9843   2.758831 #> 333 672.9870   2.507547 #> 334 500.3483   3.723052 #> 335 500.0813   3.386005 #> 336 500.4971   2.759742 #> 337 505.1548   3.675592 #> 338 500.3093   2.560727 #> 339 500.1288   2.774823 #> 340 644.5258   2.956106 #> 341 500.0197   2.788384 #> 342 500.2406   3.308453 #> 343 506.8874   2.590092 #> 344 500.5382   2.570411 #> 345 588.2299   4.161593 #> 346 736.8495   2.650334 #> 347 502.6355   2.541604 #> 348 503.9450   2.985048 #> 349 500.0024   2.835761 #> 350 774.1793   4.111953 #> 351 533.1647   2.898557 #> 352 504.9935   2.715260 #> 353 510.2065   3.064376 #> 354 883.8320   2.876293 #> 355 500.1242   2.593084 #> 356 504.2244   2.728136 #> 357 500.5839   2.617154 #> 358 501.2064   2.537476 #> 359 520.9743   2.787368 #> 360 731.3676   2.793519 #> 361 500.2916   2.970921 #> 362 971.0284   2.635810 #> 363 513.4053   2.708095 #> 364 505.2553   2.737343 #> 365 904.2985   2.889601 #> 366 500.4550   2.523457 #> 367 507.9834   2.589059 #> 368 500.2312   2.935482 #> 369 700.1910   2.683677 #> 370 500.0885   3.273096 #> 371 786.7696   2.579414 #> 372 500.6296   2.882173 #> 373 527.7238   2.582970 #> 374 502.5844   3.111534 #> 375 500.3610   3.121150 #> 376 500.1038   3.404763 #> 377 502.5334   2.546980 #> 378 500.6668   2.779393 #> 379 508.7654   2.653602 #> 380 500.2560   2.555971 #> 381 500.1912   2.713771 #> 382 503.3527   2.926802 #> 383 524.6648   3.013091 #> 384 505.4511   4.144621 #> 385 522.7855   3.006071 #> 386 500.8417   2.558667 #> 387 531.1482   2.823112 #> 388 502.5038   2.958388 #> 389 500.0588   2.637816 #> 390 500.1674   2.752724 #> 391 500.0040   2.574439 #> 392 500.6861   3.443827 #> 393 500.7917   3.280453 #> 394 505.7334   2.641461 #> 395 500.0751   2.631777 #> 396 545.8965   3.118381 #> 397 500.7060   2.664610 #> 398 500.3191   2.522009 #> 399 501.2366   2.782657 #> 400 515.5600   2.668987 #> 401 618.1721   3.045645 #> 402 503.0257   2.648029 #> 403 526.2337   2.977131 #> 404 502.6628   4.146811 #> 405 501.5845   2.573459 #> 406 501.9862   2.562958 #> 407 602.3266   2.678375 #> 408 500.8756   2.629410 #> 409 503.9047   4.234980 #> 410 501.2380   2.581463 #> 411 520.3920   3.944090 #> 412 500.4574   4.040931 #> 413 781.8102   2.619839 #> 414 500.0963   2.787441 #> 415 503.4733   2.531377 #> 416 588.7487   2.603305 #> 417 525.5632   3.987369 #> 418 500.2115   2.649748 #> 419 501.5396   2.807262 #> 420 500.0364   2.634961 #> 421 511.4235   2.922698 #> 422 500.7583   2.801128 #> 423 868.0775   2.679985 #> 424 711.3771   2.736686 #> 425 526.4490   2.512064 #> 426 502.7284   3.876422 #> 427 649.4820   2.660135 #> 428 506.1078   2.504449 #> 429 500.3422   3.235509 #> 430 500.7444   2.788946 #> 431 500.0876   2.716372 #> 432 566.3811   2.557619 #> 433 500.1835   2.566723 #> 434 500.2916   4.312868 #> 435 506.5065   2.648122 #> 436 500.3761   2.502128 #> 437 502.8863   2.772280 #> 438 500.6096   2.904977 #> 439 500.6741   2.595527 #> 440 505.7552   2.636752 #> 441 500.5774   3.561520 #> 442 500.2155   2.510721 #> 443 504.4378   3.067478 #> 444 599.4094   2.520178 #> 445 502.2532   2.630268 #> 446 504.4861   2.588868 #> 447 500.0079   3.422162 #> 448 504.7077   2.722198 #> 449 500.0969   2.695744 #> 450 500.0109   2.560670 #> 451 500.0039   2.944633 #> 452 510.9847   2.572931 #> 453 501.0709   2.846642 #> 454 729.4269   2.733749 #> 455 500.0234   2.832548 #> 456 500.9715   2.798412 #> 457 506.0281   2.522133 #> 458 572.8562   2.844347 #> 459 723.9454   2.748720 #> 460 500.9135   2.539834 #> 461 500.0496   2.624625 #> 462 512.0231   4.042528 #> 463 500.2473   2.789424 #> 464 500.4589   2.520571 #> 465 502.6013   2.634161 #> 466 750.1773   3.052061 #> 467 504.1495   2.601230 #> 468 507.5543   2.931324 #> 469 506.3050   3.029320 #> 470 501.0762   3.369792 #> 471 511.3551   3.073782 #> 472 500.0241   3.149804 #> 473 500.2587   3.701575 #> 474 502.7998   2.908714 #> 475 600.8766   3.368129 #> 476 500.1475   2.797261 #> 477 525.1240   2.878675 #> 478 500.1271   2.544271 #> 479 649.2093   2.534993 #> 480 716.0344   3.748154 #> 481 500.0300   3.372554 #> 482 503.0773   2.538874 #> 483 501.9196   2.786577 #> 484 501.8664   2.898917 #> 485 500.2238   3.009619 #> 486 503.0977   2.768283 #> 487 500.3335   4.268717 #> 488 585.2559   3.566736 #> 489 601.2010   2.677338 #> 490 650.2500   2.651784 #> 491 500.0476   2.859774 #> 492 501.8089   3.054433 #> 493 751.1815   2.877828 #> 494 501.0314   3.076577 #> 495 500.0096   2.584713 #> 496 690.2768   2.891467 #> 497 510.5593   2.785120 #> 498 500.8462   2.871940 #> 499 530.2181   2.908518 #> 500 500.6660   3.210408 #> 501 996.7465   4.067119 #> 502 500.0222   2.963707 #> 503 500.4675   2.707036 #> 504 500.1625   2.603662 #> 505 503.8181   2.646990 #> 506 501.3357   2.859348 #> 507 500.8091   3.663410 #> 508 503.5260   2.876056 #> 509 500.1446   2.972119 #> 510 505.7593   3.034408 #> 511 628.5861   2.874796 #> 512 538.0633   3.521141 #> 513 500.2112   2.681502 #> 514 755.9096   2.907605 #> 515 506.8462   3.641870 #> 516 503.5766   2.797739 #> 517 753.8884   2.657400 #> 518 500.0065   3.176783 #> 519 500.0106   2.576056 #> 520 518.4545   2.676269 #> 521 503.9589   2.516162 #> 522 503.7785   3.415677 #> 523 501.4646   3.630600 #> 524 510.6930   2.902971 #> 525 623.2636   2.811544 #> 526 500.0529   3.000625 #> 527 976.7484   2.997646 #> 528 507.9394   3.039558 #> 529 500.8255   2.564227 #> 530 501.7190   2.646185 #> 531 716.8143   3.295284 #> 532 513.2840   2.757030 #> 533 572.3665   2.788170 #> 534 500.1018   2.655480 #> 535 501.6944   2.777410 #> 536 950.9570   3.407911 #> 537 601.1610   3.689464 #> 538 612.7866   2.627034 #> 539 520.5008   2.533506 #> 540 651.6988   2.944021 #> 541 500.1105   2.923706 #> 542 500.2902   2.770376 #> 543 500.0082   3.107920 #> 544 532.6221   2.637402 #> 545 500.2604   3.521356 #> 546 500.1159   3.143783 #> 547 523.5270   3.178059 #> 548 500.2675   2.518689 #> 549 506.2262   3.352898 #> 550 502.1750   3.490072 #> 551 501.3713   2.598800 #> 552 545.7519   3.568065 #> 553 512.3169   3.825235 #> 554 506.6720   2.596798 #> 555 500.9075   2.925320 #> 556 500.2355   2.961098 #> 557 506.6278   2.894179 #> 558 500.0412   2.806695 #> 559 500.9048   3.845740 #> 560 500.9044   2.694457 #> 561 505.8327   2.534051 #> 562 501.1962   2.680240 #> 563 704.6959   3.061817 #> 564 506.4741   2.520801 #> 565 500.6093   3.066036 #> 566 652.7297   2.655037 #> 567 600.2649   3.087987 #> 568 500.0536   3.062451 #> 569 509.3992   2.533834 #> 570 502.6996   2.699721 #> 571 660.4749   3.935060 #> 572 518.4177   2.820025 #> 573 500.3237   2.790047 #> 574 500.8445   3.106468 #> 575 508.0271   2.508937 #> 576 600.3687   2.675135 #> 577 508.7596   3.108235 #> 578 500.1698   3.626835 #> 579 717.9482   2.753670 #> 580 553.6009   3.051811 #> 581 504.0711   2.811102 #> 582 505.5888   2.767194 #> 583 500.1568   2.633738 #> 584 500.0719   3.917051 #> 585 577.0694   4.002186 #> 586 508.6204   2.700731 #> 587 500.1350   2.553956 #> 588 507.9960   2.553231 #> 589 502.2794   2.565343 #> 590 503.6889   2.509461 #> 591 511.1627   2.929874 #> 592 501.0000   2.568898 #> 593 501.0657   2.980586 #> 594 734.4215   3.316751 #> 595 500.6863   2.561413 #> 596 501.1407   2.824148 #> 597 559.4668   2.736350 #> 598 509.1547   2.520288 #> 599 500.1341   2.607661 #> 600 500.1167   2.814871 #> 601 525.4035   2.591765 #> 602 500.6402   4.280072 #> 603 502.6204   3.167679 #> 604 509.1047   3.082147 #> 605 626.0118   2.592645 #> 606 506.0022   2.530674 #> 607 500.6308   2.929611 #> 608 505.8541   3.218676 #> 609 510.7171   2.985856 #> 610 548.7607   3.375890 #> 611 500.1506   2.665792 #> 612 581.4071   3.008436 #> 613 500.5356   2.543176 #> 614 525.3829   4.140854 #> 615 500.2544   2.642114 #> 616 503.6210   2.560671 #> 617 506.9758   3.510445 #> 618 533.9881   2.984538 #> 619 500.0304   2.671789 #> 620 500.3801   2.701216 #> 621 507.0502   2.642615 #> 622 500.0018   2.716123 #> 623 500.6243   2.708173 #> 624 500.2035   3.459359 #> 625 618.7029   3.514609 #> 626 725.4935   2.660589 #> 627 534.0475   2.754634 #> 628 512.9562   2.538097 #> 629 992.9082   3.283782 #> 630 622.0021   3.301076 #> 631 500.9642   2.649195 #> 632 501.9976   2.521641 #> 633 513.8273   2.558872 #> 634 614.7213   3.030786 #> 635 500.1334   2.826492 #> 636 501.6852   3.089221 #> 637 659.5956   3.091833 #> 638 520.9635   2.784057 #> 639 548.8307   2.887638 #> 640 501.3838   2.510656 #> 641 513.0951   2.839148 #> 642 528.4752   3.428897 #> 643 508.4032   2.582323 #> 644 502.4472   2.936311 #> 645 500.0165   2.968369 #> 646 500.0338   2.724923 #> 647 805.6340   2.841571 #> 648 500.3195   4.050075 #> 649 530.4774   2.598628 #> 650 514.6941   2.732511 #> 651 934.0398   2.668700 #> 652 505.8425   3.262281 #> 653 504.1511   4.207413 #> 654 560.1548   2.866062 #> 655 500.1606   2.784904 #> 656 500.2151   3.027271 #> 657 581.8588   3.063009 #> 658 500.7235   2.752696 #> 659 526.8225   2.668467 #> 660 500.1815   2.549631 #> 661 500.2998   2.572842 #> 662 500.0626   3.149113 #> 663 568.0528   3.301383 #> 664 604.4616   3.035733 #> 665 548.8987   2.599669 #> 666 500.3209   3.703771 #> 667 500.3077   2.576963 #> 668 500.0627   2.750840 #> 669 501.3508   2.669431 #> 670 500.2140   2.724355 #> 671 511.4711   2.679164 #> 672 675.4002   2.617028 #> 673 568.0370   2.534115 #> 674 613.9328   3.316708 #> 675 500.4507   3.389093 #> 676 513.8117   3.081739 #> 677 517.9335   2.697290 #> 678 510.6642   2.508669 #> 679 775.1044   2.860631 #> 680 503.0883   2.544779 #> 681 501.7954   3.869064 #> 682 505.0770   3.690492 #> 683 502.3693   2.624973 #> 684 500.7322   2.952325 #> 685 512.9551   2.611285 #> 686 810.1535   3.419570 #> 687 519.0342   2.931639 #> 688 500.2767   3.324537 #> 689 500.2639   2.671271 #> 690 502.2894   3.632033 #> 691 515.7089   2.848431 #> 692 500.0845   3.329881 #> 693 506.1709   2.856023 #> 694 534.0601   2.560410 #> 695 574.1295   2.559997 #> 696 501.0102   2.768814 #> 697 502.0373   2.725628 #> 698 609.1318   2.541084 #> 699 502.2182   3.085702 #> 700 500.1798   2.963157 #> 701 615.6003   2.731082 #> 702 500.6219   2.742752 #> 703 714.6782   3.078958 #> 704 503.6265   2.771870 #> 705 507.1408   2.588602 #> 706 500.7895   3.229644 #> 707 536.5297   3.367354 #> 708 504.6259   2.913819 #> 709 500.7691   2.697419 #> 710 530.9963   2.939535 #> 711 500.0400   2.887545 #> 712 502.6196   2.506818 #> 713 701.9562   3.507099 #> 714 500.0497   2.637648 #> 715 501.8200   2.928218 #> 716 503.4178   2.553831 #> 717 514.5645   2.586479 #> 718 586.9798   4.038188 #> 719 501.8240   3.145555 #> 720 511.2383   3.745246 #> 721 757.3789   2.799526 #> 722 500.7862   2.863700 #> 723 500.0300   3.079229 #> 724 500.0615   2.534690 #> 725 500.6209   2.755129 #> 726 799.6679   2.519130 #> 727 500.1771   3.211573 #> 728 583.9223   4.412476 #> 729 868.5574   2.840100 #> 730 540.1110   2.847393 #> 731 962.7131   3.003989 #> 732 500.0078   3.320241 #> 733 500.0302   2.520846 #> 734 917.3508   2.933075 #> 735 515.6119   2.836764 #> 736 989.0182   3.360170 #> 737 500.0002   2.569358 #> 738 500.3080   2.729593 #> 739 500.1889   2.566850 #> 740 505.0714   3.717516 #> 741 505.5342   3.349465 #> 742 500.5668   2.813429 #> 743 697.6649   3.202997 #> 744 503.4639   3.690863 #> 745 771.8729   2.796435 #> 746 500.0060   2.585312 #> 747 551.3229   3.021414 #> 748 500.0673   3.794868 #> 749 578.5401   2.512098 #> 750 500.8097   3.082262 #> 751 500.6262   3.088649 #> 752 500.0327   3.777717 #> 753 533.0367   2.511328 #> 754 505.0205   2.566340 #> 755 531.6265   2.877161 #> 756 504.1328   3.527190 #> 757 505.4638   2.548777 #> 758 500.0172   3.114307 #> 759 507.5942   2.757571 #> 760 501.1456   3.206730 #> 761 895.0670   2.650912 #> 762 794.1680   2.932289 #> 763 500.5064   2.975327 #> 764 510.3667   2.871404 #> 765 521.4598   2.606399 #> 766 500.3359   2.807704 #> 767 518.7028   2.930600 #> 768 706.8875   2.790983 #> 769 501.7676   2.872467 #> 770 630.0094   3.135365 #> 771 500.0347   2.564334 #> 772 500.1112   3.129276 #> 773 500.9432   2.811783 #> 774 500.4939   2.573933 #> 775 507.9006   2.514985 #> 776 500.0615   3.080214 #> 777 500.2490   2.838000 #> 778 500.8469   2.842268 #> 779 502.6342   3.170063 #> 780 504.6794   2.547118 #> 781 500.0511   2.639230 #> 782 500.4415   4.127833 #> 783 503.3205   2.505293 #> 784 515.1511   2.740565 #> 785 511.4692   2.517850 #> 786 518.2649   2.626042 #> 787 511.8871   2.735897 #> 788 594.9205   2.655240 #> 789 500.0061   2.664033 #> 790 500.3927   3.991874 #> 791 929.4452   3.275436 #> 792 500.0218   3.109405 #> 793 522.3055   2.530137 #> 794 506.7493   2.531952 #> 795 500.0600   2.979972 #> 796 500.0650   2.556088 #> 797 533.9373   2.643910 #> 798 500.4323   2.506870 #> 799 579.1744   3.150980 #> 800 500.0700   2.898745 #> 801 505.6726   3.399938 #> 802 597.8628   2.727484 #> 803 610.9439   3.234368 #> 804 500.2917   2.999056 #> 805 923.9522   2.630346 #> 806 507.9634   3.298027 #> 807 752.9236   3.064728 #> 808 508.4706   3.147998 #> 809 686.0899   2.802141 #> 810 500.0917   2.779540 #> 811 576.1309   2.892352 #> 812 993.8163   3.404703 #> 813 500.1418   3.979286 #> 814 500.0592   3.125898 #> 815 504.1548   2.982973 #> 816 500.0808   2.691097 #> 817 500.2321   2.551959 #> 818 515.2581   2.797350 #> 819 500.0526   2.754944 #> 820 500.3589   2.919185 #> 821 502.0887   2.738639 #> 822 695.1368   4.355848 #> 823 930.5577   2.995662 #> 824 553.8196   2.889074 #> 825 500.1323   2.779311 #> 826 607.4561   2.650818 #> 827 500.1475   2.980337 #> 828 500.1465   2.505707 #> 829 500.1650   2.690147 #> 830 513.5959   3.117430 #> 831 516.9845   2.881953 #> 832 500.0806   2.711062 #> 833 500.5436   3.318960 #> 834 732.1927   2.880644 #> 835 500.3272   2.745749 #> 836 523.0116   2.585858 #> 837 501.1593   3.320282 #> 838 500.0381   2.701062 #> 839 500.0622   4.004593 #> 840 501.0328   2.628190 #> 841 974.3578   2.673795 #> 842 853.3719   2.903474 #> 843 505.8506   3.001119 #> 844 507.5956   3.029950 #> 845 554.6184   2.654751 #> 846 500.0577   2.656851 #> 847 625.0030   2.565871 #> 848 500.2060   3.291920 #> 849 537.2368   2.561590 #> 850 501.7311   2.671216 #> 851 500.0829   2.774002 #> 852 718.6848   2.591608 #> 853 500.7050   3.590896 #> 854 500.3628   2.736408 #> 855 500.6927   2.798212 #> 856 500.9769   2.613391 #> 857 555.3276   5.502145 #> 858 949.1582   2.514399 #> 859 500.5937   2.726254 #> 860 863.2190   2.842812 #> 861 504.3886   3.247477 #> 862 503.9278   2.710497 #> 863 773.2358   2.572321 #> 864 521.2877   3.745299 #> 865 534.2966   2.837219 #> 866 500.1008   2.504077 #> 867 500.0008   2.645580 #> 868 500.5236   2.815893 #> 869 535.1523   3.092800 #> 870 500.2529   2.734118 #> 871 511.2485   2.647994 #> 872 644.6988   2.966438 #> 873 500.9951   3.214449 #> 874 501.9475   3.288887 #> 875 507.1174   2.536887 #> 876 538.3617   3.180600 #> 877 501.3575   3.291352 #> 878 510.7562   3.102778 #> 879 500.0204   2.811362 #> 880 500.1817   2.572271 #> 881 582.5702   3.298225 #> 882 709.8207   2.716923 #> 883 500.0456   3.092432 #> 884 607.2586   3.953882 #> 885 500.2078   2.606570 #> 886 502.2577   2.520314 #> 887 500.0416   2.812530 #> 888 516.6734   4.226668 #> 889 500.0993   2.623263 #> 890 808.4391   2.919688 #> 891 505.8671   2.816136 #> 892 501.8809   2.676515 #> 893 845.7195   2.973565 #> 894 500.3507   2.712030 #> 895 500.0888   2.653761 #> 896 505.2021   2.596615 #> 897 640.7561   2.602183 #> 898 513.4276   3.312654 #> 899 573.3992   2.618855 #> 900 522.7658   2.895593"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":null,"dir":"Reference","previous_headings":"","what":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"Sampling times events triggered parent th according ETAS triggering function","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"","code":"sample_temporal_ETAS_times(theta, n.ev, th, T2)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"theta ETAS parameters list(mu=mu, K=K, alpha=alpha, c=c, p=p). n.ev Number events return sample time domain (th, T2]. th Time parent event producing n.ev daughters. T2 End time model domain.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_ETAS_times.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sampling times for events triggered by a parent at th according to the ETAS triggering function — sample_temporal_ETAS_times","text":"t.sample list times interval [0, T2] distributed according ETAS triggering function.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — sample_temporal_injection_events","title":"Title — sample_temporal_injection_events","text":"Title","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — sample_temporal_injection_events","text":"","code":"sample_temporal_injection_events(   a = 50,   V.i = 1,   tau = 10,   beta.p,   M0,   T.i,   T2 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — sample_temporal_injection_events","text":"Induced event rate per unit volume. V.Injected volume tau Decay rate [days]. beta.p Related b-value via b ln(10). M0 Minimum magnitude threshold. T.Time injection [days]. T2 End temporal model domain [days].","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/sample_temporal_injection_events.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — sample_temporal_injection_events","text":"Catalogue parent events induced injection; data.frame(times, magnitudes)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a set of time bins for a specific event. — time_grid","title":"Generate a set of time bins for a specific event. — time_grid","text":"Generate set time bins specific event.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a set of time bins for a specific event. — time_grid","text":"","code":"time_grid(data.point, coef.t, delta.t, N.exp., T1., T2.)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a set of time bins for a specific event. — time_grid","text":"data.point Point binning calculated, list elements time (ts, scalar), event index (idx.p, scalar). Names mandatory changed coef.t TimeBinning parameter: look breaks_exp() delta.t TimeBinning parameter: look breaks_exp() N.exp. TimeBinning parameter: look breaks_exp() T1. Start temporal domain, scalar T2. End temporal domain scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a set of time bins for a specific event. — time_grid","text":"data.frame many rows number bins fixed number columns. columns t.start : starting point bin (minimum = T1.). t.end : end point bin. (maximum = T2.). t.bin.name : unique bin identifier. t.ref_layer : bin identifier calculations ts : time provided data.point idx.p : identifier provided data.point bins T1. T2. containing T1.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/time_grid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a set of time bins for a specific event. — time_grid","text":"","code":"## EXAMPLE 1 event <- list(ts = 0, idx.p = 1) time_grid(data.point = event, coef.t = 1, delta.t = 0.1, N.exp. = 8, T1. = 1, T2. = 20) #>   t.start t.end t.bin.name t.ref_layer ts idx.p #> 1     1.0   1.6    0.8-1.6   between-1  0     1 #> 2     1.6   3.2    1.6-3.2           6  0     1 #> 3     3.2   6.4    3.2-6.4           7  0     1 #> 4     6.4  12.8   6.4-12.8           8  0     1 #> 5    12.8  20.0    12.8-20      last-1  0     1"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"Function plot ETAS triggering function corresponding different posterior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"","code":"triggering_fun_plot(   input.list,   post.samp = NULL,   n.samp = 10,   magnitude = 4,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"input.list structured input list least two elements: model.fit: bru object used sample posterior ETAS parameters link.functions: list functions convert ETAS parameters INLA scale ETAS scale post.samp data.frame containing posterior samples parameters. NULL, n.samp samples generated. n.samp different nrow(post.samp) n.samp rows uniformly sampled post.samp. Default NULL n.samp Number posterior samples, integer (default = 10). magnitude Magnitude event triggering function calculated, scalar (default = 4). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot the ETAS triggering function corresponding to different posterior samples — triggering_fun_plot","text":"ggplot object grey lines representing triggering function posterior sample. Black lines representing 0.025 0.975 quantiles function values calculated posterior sample. Horizontal red lines represents 0.025 0.975 quantiles sampled background rates.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"Function plot ETAS triggering function corresponding different prior samples","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"","code":"triggering_fun_plot_prior(   input.list,   magnitude = 4,   n.samp = 10,   t.end = 1,   n.breaks = 100 )"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"input.list structured input list least one element: link.functions: list functions convert ETAS parameters INLA scale ETAS scale magnitude Magnitude event triggering function calculated, scalar (default = 4). n.samp Number posterior samples, integer (default = 10). t.end Upper bound x-axis, scalar (default = 1). n.breaks Number points 0 t.end calculate function, integer (default = 100)","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/triggering_fun_plot_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot the ETAS triggering function corresponding to different prior samples — triggering_fun_plot_prior","text":"ggplot object grey lines representing triggering function posterior sample. Black lines representing 0.025 0.975 quantiles function values calculated posterior sample. Horizontal red lines represents 0.025 0.975 quantiles sampled background rates.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"Copula transformation standard Normal distribution Uniform distribution","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"","code":"unif_t(x, a, b)"},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"x values standard Normal distribution, vector. minimum value Uniform distribution, scalar. b maximum value Uniform distribution, scalar.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/reference/unif_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copula transformation from a standard Normal distribution to a Uniform distribution — unif_t","text":"values Uniform distribution b, vector length x.","code":""},{"path":[]},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/news/index.html","id":"etasinlabru-development-version","dir":"Changelog","previous_headings":"","what":"ETAS.inlabru (development version)","title":"ETAS.inlabru (development version)","text":"Add format argument generate_temporal_ETAS_synthetic() simplify conversion data.frame.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/news/index.html","id":"etasinlabru-111","dir":"Changelog","previous_headings":"","what":"ETAS.inlabru 1.1.1","title":"ETAS.inlabru 1.1.1","text":"Cleaned R package structure Added vignettes package website Renamed functions avoid “.” non-S3-method function names. Temporal.ETAS.* functions retain “.”, now.","code":""},{"path":"https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/news/index.html","id":"etasinlabru-101","dir":"Changelog","previous_headings":"","what":"ETAS.inlabru 1.0.1","title":"ETAS.inlabru 1.0.1","text":"Initial package version.","code":""}]
