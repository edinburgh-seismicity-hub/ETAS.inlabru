<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ETAS.inlabru">
<title>1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus â€¢ ETAS.inlabru</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus">
<meta property="og:description" content="ETAS.inlabru">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ETAS.inlabru</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/EDA_Italy_Horus.html">1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus</a>
    <a class="dropdown-item" href="../articles/generateSyntheticCatalogues.html">2a Temporal Model: Generating synthetic temporal ETAS catalogues</a>
    <a class="dropdown-item" href="../articles/sampleFromETASpriors.html">2b Temporal Model: Presenting samples drawn from the ETAS priors</a>
    <a class="dropdown-item" href="../articles/sensitivityToStartingPoint.html">Sensitivity to starting point</a>
    <a class="dropdown-item" href="../articles/tutorial_real.html">2d Temporal Model: Tutorial on real data</a>
    <a class="dropdown-item" href="../articles/tutorial_synth.html">2c Temporal Model: Tutorial on synthetic data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/edinburgh-seismicity-hub/ETAS.inlabru/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus</h1>
                        <h4 data-toc-skip class="author">Mark
Naylor</h4>
            
            <h4 data-toc-skip class="date">2023-06-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/edinburgh-seismicity-hub/ETAS.inlabru/blob/HEAD/vignettes/articles/EDA_Italy_Horus.Rmd" class="external-link"><code>vignettes/articles/EDA_Italy_Horus.Rmd</code></a></small>
      <div class="d-none name"><code>EDA_Italy_Horus.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="load-packages">Load Packages<a class="anchor" aria-label="anchor" href="#load-packages"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/">ETAS.inlabru</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rnaturalearth/" class="external-link">rnaturalearth</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paleolimbot.github.io/ggspatial/" class="external-link">ggspatial</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ropenscilabs/rnaturalearthdata" class="external-link">rnaturalearthdata</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## This is just the EPSG equivalent of WGS84</span></span>
<span><span class="va">crs_wgs84</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="st">'EPSG:4326'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-an-earthquake-catalogue">Load an earthquake catalogue<a class="anchor" aria-label="anchor" href="#load-an-earthquake-catalogue"></a>
</h2>
<p>Earthquake data is stored in the so-called earthquake catalogues.
Many different catalogues exists for the same region and there is no
easy way to decide which one is better. Here, we provide the HOmogenized
instRUmental Seismic (HORUS) catalogue from 1960 to 2020. It can be
downloaded from <a href="http://horus.bo.ingv.it/" class="external-link">http://horus.bo.ingv.it/</a>. A subset
(see <a href="https://github.com/edinburgh-seismicity-hub/ETAS.inlabru/blob/main/R/AnalysingPosteriors.R" class="external-link">data-raw/horus.R</a>
for how the the subset was created) of the information in the Horus
catalogue can be loaded using</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load ISIDE catalogue</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">horus</span>, package <span class="op">=</span> <span class="st">"ETAS.inlabru"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># transform time string in Date object</span></span>
<span><span class="va">horus</span><span class="op">$</span><span class="va">time_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span></span>
<span>  <span class="va">horus</span><span class="op">$</span><span class="va">time_string</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"%Y-%m-%dT%H:%M:%OS"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">horus</span><span class="op">)</span></span>
<span><span class="co">#&gt;           time_string     lon     lat depth    M           time_date</span></span>
<span><span class="co">#&gt; 1 1960-01-03T20:19:34 15.3000 39.3000   290 6.34 1960-01-03 20:19:34</span></span>
<span><span class="co">#&gt; 2 1960-01-04T09:20:00 13.1667 43.1333     0 3.94 1960-01-04 09:20:00</span></span>
<span><span class="co">#&gt; 3 1960-01-06T15:17:34 12.7000 46.4833     4 4.69 1960-01-06 15:17:34</span></span>
<span><span class="co">#&gt; 4 1960-01-06T15:20:53 12.7000 46.4667     0 4.14 1960-01-06 15:20:53</span></span>
<span><span class="co">#&gt; 5 1960-01-06T15:31:00 12.7500 46.4333     0 3.00 1960-01-06 15:31:00</span></span>
<span><span class="co">#&gt; 6 1960-01-06T15:45:00 12.7500 46.4333     0 3.00 1960-01-06 15:45:00</span></span>
<span></span>
<span><span class="va">df_cat</span> <span class="op">&lt;-</span> <span class="va">horus</span></span>
<span></span>
<span><span class="co"># add event number</span></span>
<span><span class="va">df_cat</span><span class="op">$</span><span class="va">event_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq.int</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df_cat</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sf version of the catalogue</span></span>
<span><span class="va">df_cat.sf</span><span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">df_cat</span>,</span>
<span>                     coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lon"</span>, <span class="st">"lat"</span><span class="op">)</span>,</span>
<span>                     crs <span class="op">=</span> <span class="va">crs_wgs84</span><span class="op">)</span></span></code></pre></div>
<p>The data reports for each earthquake the time as a string
(<code>time_string</code>), the longitude (<code>lon</code>) and
latitude (<code>lat</code>) of the epicentre, the depth in kilometres
(<code>depth</code>), and the moment magnitude (<code>M</code>).</p>
</div>
<div class="section level2">
<h2 id="whole-italy-eda">Whole Italy EDA<a class="anchor" aria-label="anchor" href="#whole-italy-eda"></a>
</h2>
</div>
<div class="section level2">
<h2 id="get-map-and-extract-crs-for-the-map">Get map and extract crs for the map<a class="anchor" aria-label="anchor" href="#get-map-and-extract-crs-for-the-map"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">italy.map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html" class="external-link">ne_countries</a></span><span class="op">(</span>country <span class="op">=</span> <span class="st">'Italy'</span>, returnclass <span class="op">=</span> <span class="st">"sf"</span>, scale <span class="op">=</span> <span class="st">'medium'</span><span class="op">)</span></span>
<span><span class="va">italy.crs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">italy.map</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">italy.crs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "BOUNDCRS[\n    SOURCECRS[\n        GEOGCRS[\"unknown\",\n            DATUM[\"World Geodetic System 1984\",\n                ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                    LENGTHUNIT[\"metre\",1]],\n                ID[\"EPSG\",6326]],\n            PRIMEM[\"Greenwich\",0,\n                ANGLEUNIT[\"degree\",0.0174532925199433],\n                ID[\"EPSG\",8901]],\n            CS[ellipsoidal,2],\n                AXIS[\"longitude\",east,\n                    ORDER[1],\n                    ANGLEUNIT[\"degree\",0.0174532925199433,\n                        ID[\"EPSG\",9122]]],\n                AXIS[\"latitude\",north,\n                    ORDER[2],\n                    ANGLEUNIT[\"degree\",0.0174532925199433,\n                        ID[\"EPSG\",9122]]]]],\n    TARGETCRS[\n        GEOGCRS[\"WGS 84\",\n            DATUM[\"World Geodetic System 1984\",\n                ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                    LENGTHUNIT[\"metre\",1]]],\n            PRIMEM[\"Greenwich\",0,\n                ANGLEUNIT[\"degree\",0.0174532925199433]],\n            CS[ellipsoidal,2],\n                AXIS[\"geodetic latitude (Lat)\",north,\n                    ORDER[1],\n                    ANGLEUNIT[\"degree\",0.0174532925199433]],\n                AXIS[\"geodetic longitude (Lon)\",east,\n                    ORDER[2],\n                    ANGLEUNIT[\"degree\",0.0174532925199433]],\n            ID[\"EPSG\",4326]]],\n    ABRIDGEDTRANSFORMATION[\"Transformation from unknown to WGS84\",\n        METHOD[\"Geocentric translations (geog2D domain)\",\n            ID[\"EPSG\",9603]],\n        PARAMETER[\"X-axis translation\",0,\n            ID[\"EPSG\",8605]],\n        PARAMETER[\"Y-axis translation\",0,\n            ID[\"EPSG\",8606]],\n        PARAMETER[\"Z-axis translation\",0,\n            ID[\"EPSG\",8607]]]]"</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">italy.map</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="EDA_Italy_Horus_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="eda-for-the-whole-mediteranian-catalogue">EDA for the whole Mediteranian catalogue<a class="anchor" aria-label="anchor" href="#eda-for-the-whole-mediteranian-catalogue"></a>
</h2>
<div class="section level3">
<h3 id="histogram-of-event-depths">Histogram of event depths<a class="anchor" aria-label="anchor" href="#histogram-of-event-depths"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">df_cat</span><span class="op">$</span><span class="va">depth</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">650</span>,<span class="op">-</span><span class="fl">5</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">40</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"Histogram of depths"</span> <span class="op">)</span></span></code></pre></div>
<p><img src="EDA_Italy_Horus_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="plot-of-event-magnitudes-using-natural-time">Plot of event magnitudes using natural time<a class="anchor" aria-label="anchor" href="#plot-of-event-magnitudes-using-natural-time"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_cat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">event_num</span>, y<span class="op">=</span><span class="va">M</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> </span></code></pre></div>
<p><img src="EDA_Italy_Horus_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="plot-of-event-magnitudes-using-date-time">Plot of event magnitudes using date-time<a class="anchor" aria-label="anchor" href="#plot-of-event-magnitudes-using-date-time"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_cat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time_date</span>, y<span class="op">=</span><span class="va">M</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Horus catalogue magnitude time series"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 1 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="EDA_Italy_Horus_files/figure-html/Magnitude%20natural-time%20series-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filtered for M&gt;4</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_cat</span><span class="op">[</span><span class="va">df_cat</span><span class="op">$</span><span class="va">M</span><span class="op">&gt;</span><span class="fl">4</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time_date</span>, y<span class="op">=</span><span class="va">M</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Whole catalogue magnitude timeseries for M&gt;4"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 1 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="EDA_Italy_Horus_files/figure-html/Magnitude%20time%20series-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="frequency-magnitude-analysis-for-horus-catalogue">Frequency-magnitude analysis for Horus catalogue<a class="anchor" aria-label="anchor" href="#frequency-magnitude-analysis-for-horus-catalogue"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">minMag</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">maxMag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df_cat</span><span class="op">$</span><span class="va">M</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mags</span> <span class="op">&lt;-</span> <span class="va">df_cat</span><span class="op">[</span><span class="va">df_cat</span><span class="op">$</span><span class="va">M</span><span class="op">&gt;</span><span class="va">minMag</span>,<span class="op">]</span><span class="op">$</span><span class="va">M</span></span>
<span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">mags</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">minMag</span><span class="op">-</span><span class="fl">0.05</span>,<span class="va">maxMag</span><span class="op">+</span><span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span>, plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">N.counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span> <span class="va">tmp</span><span class="op">$</span><span class="va">counts</span><span class="op">)</span></span>
<span><span class="va">tmp</span><span class="op">$</span><span class="va">cumulativeCounts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">$</span><span class="va">counts</span><span class="op">[</span><span class="va">N.counts</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="va">N.counts</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="va">m.min</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">bin_m.min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">$</span><span class="va">mids</span><span class="op">==</span><span class="va">m.min</span><span class="op">)</span></span>
<span><span class="va">freq_m.min</span> <span class="op">&lt;-</span> <span class="va">tmp</span><span class="op">$</span><span class="va">counts</span><span class="op">[</span><span class="va">bin_m.min</span><span class="op">]</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">1.1</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">tmp</span><span class="op">$</span><span class="va">mids</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">freq_m.min</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="va">b</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">m.min</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y.cum</span> <span class="op">&lt;-</span> <span class="va">tmp</span><span class="op">$</span><span class="va">cumulativeCounts</span><span class="op">[</span><span class="va">bin_m.min</span><span class="op">]</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="va">b</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">m.min</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">tmp</span><span class="op">$</span><span class="va">mids</span>, y<span class="op">=</span><span class="va">tmp</span><span class="op">$</span><span class="va">counts</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">tmp</span><span class="op">$</span><span class="va">mids</span>, y<span class="op">=</span><span class="va">tmp</span><span class="op">$</span><span class="va">cumulativeCounts</span><span class="op">)</span> , color<span class="op">=</span><span class="st">'red'</span>, pch<span class="op">=</span><span class="st">"+"</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Frequency-magnitude plot with arbitary GR dist: b ="</span>, <span class="va">b</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Magnitude"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"log10(Frequency)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y.cum</span><span class="op">)</span>, color<span class="op">=</span><span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span> xintercept<span class="op">=</span><span class="va">m.min</span>, lty<span class="op">=</span><span class="fl">2</span> <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre></div>
<p><img src="EDA_Italy_Horus_files/figure-html/National%20GR%20Plot-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="b-value-stability-plot-for-the-events-in-the-horis-catalogue">b-value stability plot for the events in the Horis catalogue<a class="anchor" aria-label="anchor" href="#b-value-stability-plot-for-the-events-in-the-horis-catalogue"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">minMag</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">maxMag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df_cat</span><span class="op">$</span><span class="va">M</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mags</span> <span class="op">&lt;-</span> <span class="va">df_cat</span><span class="op">[</span><span class="va">df_cat</span><span class="op">$</span><span class="va">M</span><span class="op">&gt;=</span><span class="va">minMag</span>,<span class="op">]</span><span class="op">$</span><span class="va">M</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">minMag</span>,<span class="va">maxMag</span>,<span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b.stability.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">b.error.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">m.mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b_utsu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">b_guttorp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">b_elst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">delta_b_utsu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">b_elst_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">b_elst_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">max.index.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">-</span><span class="fl">5</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span> <span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">max.index.x</span> <span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">mag.threshold</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">mags.subset</span> <span class="op">&lt;-</span> <span class="va">mags</span><span class="op">[</span><span class="va">mags</span> <span class="op">&gt;</span> <span class="va">mag.threshold</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mags.subset</span><span class="op">)</span></span>
<span>  <span class="va">b_utsu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mags.subset</span><span class="op">)</span><span class="op">-</span><span class="va">mag.threshold</span><span class="op">+</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">delta_b_utsu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">*</span><span class="va">b_utsu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">**</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">mags.subset</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mags.subset</span><span class="op">)</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">N</span><span class="op">*</span><span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="va">b_guttorp</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span> <span class="fl">2</span><span class="op">*</span><span class="fl">0.05</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mags.subset</span><span class="op">)</span><span class="op">-</span><span class="va">mag.threshold</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="fl">0.05</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mags.subset</span><span class="op">)</span><span class="op">-</span><span class="va">mag.threshold</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="va">deltaMags</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">mags.subset</span><span class="op">)</span></span>
<span>  <span class="va">deltaMags_p</span> <span class="op">&lt;-</span> <span class="va">deltaMags</span><span class="op">[</span><span class="va">deltaMags</span><span class="op">&gt;</span><span class="fl">0.1</span><span class="op">]</span></span>
<span>  <span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">deltaMags_p</span><span class="op">)</span></span>
<span>  <span class="va">b_elst</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fl">0.05</span><span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">deltaMags_p</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">deltaMags_p</span><span class="op">)</span><span class="op">-</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">c</span> <span class="op">=</span> <span class="fl">10</span><span class="op">**</span><span class="op">(</span><span class="fl">0.1</span><span class="op">*</span><span class="va">b_elst</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">b_elst_lower</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">0.1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">(</span><span class="va">c</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">c</span><span class="op">/</span><span class="va">N</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">c</span><span class="op">/</span><span class="va">N</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">b_elst_upper</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">0.1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">(</span><span class="va">c</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">c</span><span class="op">/</span><span class="va">N</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">c</span><span class="op">/</span><span class="va">N</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">max.index.x</span><span class="op">]</span>, y<span class="op">=</span><span class="va">b_utsu</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">max.index.x</span><span class="op">]</span>, y<span class="op">=</span><span class="va">b_utsu</span><span class="op">+</span><span class="va">delta_b_utsu</span><span class="op">)</span>, color<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">2</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">max.index.x</span><span class="op">]</span>, y<span class="op">=</span><span class="va">b_utsu</span><span class="op">-</span><span class="va">delta_b_utsu</span><span class="op">)</span>, color<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">2</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">max.index.x</span><span class="op">]</span>, y<span class="op">=</span><span class="va">b_guttorp</span><span class="op">)</span>, color<span class="op">=</span><span class="fl">3</span>, lty<span class="op">=</span><span class="fl">1</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Magnitude threshold"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"b-value estimate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.85</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"b-value stability plot for Horus catalogue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="EDA_Italy_Horus_files/figure-html/National%20b-value%20stability-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="heatmap-of-the-events-in-the-horus-catalogue">Heatmap of the events in the Horus catalogue<a class="anchor" aria-label="anchor" href="#heatmap-of-the-events-in-the-horus-catalogue"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html" class="external-link">geom_hex</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_cat</span><span class="op">[</span><span class="va">df_cat</span><span class="op">$</span><span class="va">M</span><span class="op">&gt;</span><span class="fl">3</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_fill_continuous</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"viridis"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">italy.map</span>, fill<span class="op">=</span><span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"lightgrey"</span>, <span class="fl">0</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'orange'</span>, size<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Density plot for M&gt;3 events"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Computation failed in `stat_binhex()`</span></span>
<span><span class="co">#&gt; Caused by error in `compute_group()`:</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> The package "hexbin" is required for `stat_binhex()`</span></span></code></pre></div>
<p><img src="EDA_Italy_Horus_files/figure-html/hexbin%20event%20density-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="map-of-the-events-in-the-italian-horus-catalogue">Map of the events in the Italian Horus catalogue<a class="anchor" aria-label="anchor" href="#map-of-the-events-in-the-italian-horus-catalogue"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_cat.sf</span><span class="op">[</span><span class="va">df_cat</span><span class="op">$</span><span class="va">M</span><span class="op">&gt;</span><span class="fl">3</span>,<span class="op">]</span>, size <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">italy.map</span>, fill<span class="op">=</span><span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"lightgrey"</span>, <span class="fl">0</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'green'</span>, linewidth<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_cat.sf</span><span class="op">[</span><span class="va">df_cat</span><span class="op">$</span><span class="va">M</span><span class="op">&gt;</span><span class="fl">5</span>,<span class="op">]</span>, size <span class="op">=</span> <span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'orange'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_cat.sf</span><span class="op">[</span><span class="va">df_cat</span><span class="op">$</span><span class="va">M</span><span class="op">&gt;</span><span class="fl">6</span>,<span class="op">]</span>, size <span class="op">=</span> <span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Map of event locations"</span><span class="op">)</span></span></code></pre></div>
<p><img src="EDA_Italy_Horus_files/figure-html/map%20of%20locations-1.png" width="700">
# Lâ€™Aquila Sequence</p>
<p>To focus on the L Aquila seismic sequence is sufficient to retain
only the observations in a specific space-time-magnitude region that
include the sequence of interest. For the Lâ€™Aquila sequence, we retain
all the events with magnitude greater or equal than <span class="math inline">\(2.5\)</span> happened during 2009 with longitude
in <span class="math inline">\((10.5, 16)\)</span> and latitude in <span class="math inline">\((40.5, 45)\)</span>. The Lâ€™Aquila sequence
selected in this way should be composed by 1024 events. Any other
seismic sequence can be selected similarly.</p>
<p>To do the selection is convenient to transform the time string in a
<code>Date</code> object and to select the rows of the Horus catalogue
verifying the conditions.</p>
<p>start.date = â€œ2009-04-06 00:00:00 BSTâ€ end.date = â€œ2010-01-01
00:00:00 BSTâ€ magnitude.completeness = 2.49 min.longitude = 13.00
max.longitude = 13.75 min.latitude = 42.2 max.latitude = 42.5</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eventDate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span> <span class="st">'2009-04-06 00:00:00'</span> <span class="op">)</span></span>
<span><span class="va">endDate</span> <span class="op">&lt;-</span> <span class="va">eventDate</span> <span class="op">+</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">days</a></span><span class="op">(</span><span class="fl">400</span><span class="op">)</span></span>
<span><span class="va">startDate</span> <span class="op">&lt;-</span> <span class="va">eventDate</span> <span class="op">-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">days</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">deltaLat</span> <span class="op">&lt;-</span> <span class="fl">2.4</span></span>
<span><span class="va">latLims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">42.2</span>,<span class="fl">42.5</span><span class="op">)</span></span>
<span><span class="va">longLims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">13</span>, <span class="fl">13.75</span><span class="op">)</span></span>
<span></span>
<span><span class="va">minMAG</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Subset the main catalogue</span></span>
<span><span class="va">df_cat.subset</span> <span class="op">&lt;-</span> <span class="va">df_cat</span><span class="op">[</span><span class="va">df_cat</span><span class="op">$</span><span class="va">M</span> <span class="op">&gt;=</span> <span class="va">minMAG</span>, <span class="op">]</span></span>
<span><span class="va">df_cat.subset</span> <span class="op">&lt;-</span> <span class="va">df_cat.subset</span><span class="op">[</span> <span class="op">(</span><span class="va">df_cat.subset</span><span class="op">$</span><span class="va">lat</span><span class="op">&gt;</span><span class="va">latLims</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">df_cat.subset</span> <span class="op">&lt;-</span> <span class="va">df_cat.subset</span><span class="op">[</span> <span class="op">(</span><span class="va">df_cat.subset</span><span class="op">$</span><span class="va">lat</span><span class="op">&lt;</span><span class="va">latLims</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">df_cat.subset</span> <span class="op">&lt;-</span> <span class="va">df_cat.subset</span><span class="op">[</span> <span class="op">(</span><span class="va">df_cat.subset</span><span class="op">$</span><span class="va">lon</span><span class="op">&gt;</span><span class="va">longLims</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">df_cat.subset</span> <span class="op">&lt;-</span> <span class="va">df_cat.subset</span><span class="op">[</span> <span class="op">(</span><span class="va">df_cat.subset</span><span class="op">$</span><span class="va">lon</span><span class="op">&lt;</span><span class="va">longLims</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_cat.subset</span><span class="op">)</span></span>
<span><span class="co">#&gt;             time_string     lon     lat depth    M           time_date</span></span>
<span><span class="co">#&gt; 243 1961-03-25T10:40:00 13.3167 42.4333     0 3.64 1961-03-25 10:40:00</span></span>
<span><span class="co">#&gt; 295 1961-10-05T19:59:35 13.0167 42.3500     3 0.00 1961-10-05 19:59:35</span></span>
<span><span class="co">#&gt; 302 1961-10-31T00:00:00 13.0167 42.3500    10 3.94 1961-10-31 00:00:00</span></span>
<span><span class="co">#&gt; 303 1961-10-31T00:00:00 13.0167 42.3500    10 3.94 1961-10-31 00:00:00</span></span>
<span><span class="co">#&gt; 304 1961-10-31T13:37:18 13.0833 42.4167     4 4.64 1961-10-31 13:37:18</span></span>
<span><span class="co">#&gt; 305 1961-10-31T13:41:59 13.0833 42.4167     0 4.14 1961-10-31 13:41:59</span></span>
<span><span class="co">#&gt;     event_num</span></span>
<span><span class="co">#&gt; 243       243</span></span>
<span><span class="co">#&gt; 295       295</span></span>
<span><span class="co">#&gt; 302       302</span></span>
<span><span class="co">#&gt; 303       303</span></span>
<span><span class="co">#&gt; 304       304</span></span>
<span><span class="co">#&gt; 305       305</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-of-the-event-magnitude-time-series-laquila">Plot of the event magnitude time series: lâ€™Aquila<a class="anchor" aria-label="anchor" href="#plot-of-the-event-magnitude-time-series-laquila"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">df_cat.subset</span><span class="op">[</span><span class="va">df_cat.subset</span><span class="op">$</span><span class="va">M</span><span class="op">&gt;</span><span class="fl">3</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time_date</span>, <span class="va">lat</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">df_cat.subset</span><span class="op">[</span><span class="va">df_cat.subset</span><span class="op">$</span><span class="va">M</span><span class="op">&gt;</span><span class="fl">5</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time_date</span>, <span class="va">lat</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">1.2</span>, color<span class="op">=</span><span class="st">'orange'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">df_cat.subset</span><span class="op">[</span><span class="va">df_cat.subset</span><span class="op">$</span><span class="va">M</span><span class="op">&gt;</span><span class="fl">6</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time_date</span>, <span class="va">lat</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">1.5</span>, color<span class="op">=</span><span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"L'Aquila latitude-time plot"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="va">startDate</span><span class="op">)</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="va">endDate</span><span class="op">)</span>, ymin <span class="op">=</span> <span class="va">latLims</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, ymax <span class="op">=</span> <span class="va">latLims</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.4</span>, fill<span class="op">=</span><span class="st">'blue'</span>, color<span class="op">=</span><span class="st">'blue'</span><span class="op">)</span></span></code></pre></div>
<p><img src="EDA_Italy_Horus_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">minMag</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">maxMag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df_cat.subset</span><span class="op">$</span><span class="va">M</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mags</span> <span class="op">&lt;-</span> <span class="va">df_cat.subset</span><span class="op">[</span><span class="va">df_cat.subset</span><span class="op">$</span><span class="va">M</span><span class="op">&gt;=</span><span class="va">minMag</span>,<span class="op">]</span><span class="op">$</span><span class="va">M</span></span>
<span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">mags</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">minMag</span><span class="op">-</span><span class="fl">0.05</span>,<span class="va">maxMag</span><span class="op">+</span><span class="fl">0.4</span>,<span class="fl">0.1</span><span class="op">)</span>, plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">N.counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span> <span class="va">tmp</span><span class="op">$</span><span class="va">counts</span><span class="op">)</span></span>
<span><span class="va">tmp</span><span class="op">$</span><span class="va">cumulativeCounts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">$</span><span class="va">counts</span><span class="op">[</span><span class="va">N.counts</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="va">N.counts</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="va">m.min</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">bin_m.min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">$</span><span class="va">mids</span><span class="op">==</span><span class="va">m.min</span><span class="op">)</span></span>
<span><span class="va">freq_m.min</span> <span class="op">&lt;-</span> <span class="va">tmp</span><span class="op">$</span><span class="va">counts</span><span class="op">[</span><span class="va">bin_m.min</span><span class="op">]</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">1.</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">tmp</span><span class="op">$</span><span class="va">mids</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">freq_m.min</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="va">b</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">m.min</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y.cum</span> <span class="op">&lt;-</span> <span class="va">tmp</span><span class="op">$</span><span class="va">cumulativeCounts</span><span class="op">[</span><span class="va">bin_m.min</span><span class="op">]</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="va">b</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">m.min</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">tmp</span><span class="op">$</span><span class="va">mids</span>, y<span class="op">=</span><span class="va">tmp</span><span class="op">$</span><span class="va">counts</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">tmp</span><span class="op">$</span><span class="va">mids</span>, y<span class="op">=</span><span class="va">tmp</span><span class="op">$</span><span class="va">cumulativeCounts</span><span class="op">)</span> , color<span class="op">=</span><span class="st">'red'</span>, pch<span class="op">=</span><span class="st">"+"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Frequency-magnitude plot with arbitary GR dist: b ="</span>, <span class="va">b</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Magnitude"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"log10(Frequency)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y.cum</span><span class="op">)</span>, color<span class="op">=</span><span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span> xintercept<span class="op">=</span><span class="va">m.min</span>, lty<span class="op">=</span><span class="fl">2</span> <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span><span class="co">#&gt; Transformation introduced infinite values in continuous y-axis</span></span></code></pre></div>
<p><img src="EDA_Italy_Horus_files/figure-html/regional%20GR%20Plot-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="b-value-stability-plot-laquila">b-value stability plot: lâ€™Aquila<a class="anchor" aria-label="anchor" href="#b-value-stability-plot-laquila"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">minMag</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">maxMag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df_cat.subset</span><span class="op">$</span><span class="va">M</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mags</span> <span class="op">&lt;-</span> <span class="va">df_cat.subset</span><span class="op">[</span><span class="va">df_cat.subset</span><span class="op">$</span><span class="va">M</span><span class="op">&gt;=</span><span class="va">minMag</span>,<span class="op">]</span><span class="op">$</span><span class="va">M</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">minMag</span>,<span class="va">maxMag</span>,<span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b.stability.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">b.error.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">m.mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b_utsu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">b_guttorp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">b_elst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">delta_b_utsu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">b_elst_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">b_elst_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">max.index.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">-</span><span class="fl">5</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span> <span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">max.index.x</span> <span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">mag.threshold</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">mags.subset</span> <span class="op">&lt;-</span> <span class="va">mags</span><span class="op">[</span><span class="va">mags</span> <span class="op">&gt;</span> <span class="va">mag.threshold</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mags.subset</span><span class="op">)</span></span>
<span>  <span class="va">b_utsu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mags.subset</span><span class="op">)</span><span class="op">-</span><span class="va">mag.threshold</span><span class="op">+</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">delta_b_utsu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">*</span><span class="va">b_utsu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">**</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">mags.subset</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mags.subset</span><span class="op">)</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">N</span><span class="op">*</span><span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="va">b_guttorp</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span> <span class="fl">2</span><span class="op">*</span><span class="fl">0.05</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mags.subset</span><span class="op">)</span><span class="op">-</span><span class="va">mag.threshold</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="fl">0.05</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mags.subset</span><span class="op">)</span><span class="op">-</span><span class="va">mag.threshold</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="va">deltaMags</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">mags.subset</span><span class="op">)</span></span>
<span>  <span class="va">deltaMags_p</span> <span class="op">&lt;-</span> <span class="va">deltaMags</span><span class="op">[</span><span class="va">deltaMags</span><span class="op">&gt;</span><span class="fl">0.1</span><span class="op">]</span></span>
<span>  <span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">deltaMags_p</span><span class="op">)</span></span>
<span>  <span class="va">b_elst</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fl">0.05</span><span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">deltaMags_p</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">deltaMags_p</span><span class="op">)</span><span class="op">-</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">c</span> <span class="op">=</span> <span class="fl">10</span><span class="op">**</span><span class="op">(</span><span class="fl">0.1</span><span class="op">*</span><span class="va">b_elst</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">b_elst_lower</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">0.1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">(</span><span class="va">c</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">c</span><span class="op">/</span><span class="va">N</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">c</span><span class="op">/</span><span class="va">N</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">b_elst_upper</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">0.1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">(</span><span class="va">c</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">c</span><span class="op">/</span><span class="va">N</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">c</span><span class="op">/</span><span class="va">N</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">max.index.x</span><span class="op">]</span>, y<span class="op">=</span><span class="va">b_utsu</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">max.index.x</span><span class="op">]</span>, y<span class="op">=</span><span class="va">b_utsu</span><span class="op">+</span><span class="va">delta_b_utsu</span><span class="op">)</span>, color<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">2</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">max.index.x</span><span class="op">]</span>, y<span class="op">=</span><span class="va">b_utsu</span><span class="op">-</span><span class="va">delta_b_utsu</span><span class="op">)</span>, color<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">2</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">max.index.x</span><span class="op">]</span>, y<span class="op">=</span><span class="va">b_guttorp</span><span class="op">)</span>, color<span class="op">=</span><span class="fl">3</span>, lty<span class="op">=</span><span class="fl">1</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Magnitude threshold"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"b-value estimate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.85</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"b-value stability plot for Horus catalogue"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values (`geom_line()`).</span></span>
<span><span class="co">#&gt; Removed 2 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="EDA_Italy_Horus_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Francesco Serafini, Mark Naylor, Finn Lindgren.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
