<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ETAS.inlabru">
<title>Sensitivity to starting point â€¢ ETAS.inlabru</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sensitivity to starting point">
<meta property="og:description" content="ETAS.inlabru">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ETAS.inlabru</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/EDA_Italy_Horus.html">1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus</a>
    <a class="dropdown-item" href="../articles/generateSyntheticCatalogues.html">2a Temporal Model: Generating synthetic temporal ETAS catalogues</a>
    <a class="dropdown-item" href="../articles/sampleFromETASpriors.html">2b Temporal Model: Presenting samples drawn from the ETAS priors</a>
    <a class="dropdown-item" href="../articles/sensitivityToStartingPoint.html">Sensitivity to starting point</a>
    <a class="dropdown-item" href="../articles/tutorial_real.html">2d Temporal Model: Tutorial on real data</a>
    <a class="dropdown-item" href="../articles/tutorial_synth.html">2c Temporal Model: Tutorial on synthetic data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/edinburgh-seismicity-hub/ETAS.inlabru/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Sensitivity to starting point</h1>
                        <h4 data-toc-skip class="author">Mark
Naylor</h4>
            
            <h4 data-toc-skip class="date">2022-10-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/edinburgh-seismicity-hub/ETAS.inlabru/blob/HEAD/vignettes/articles/sensitivityToStartingPoint.Rmd" class="external-link"><code>vignettes/articles/sensitivityToStartingPoint.Rmd</code></a></small>
      <div class="d-none name"><code>sensitivityToStartingPoint.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="multiple-analyses-of-two-catalogues-using-different-initial-values">Multiple analyses of two catalogues using different initial
values<a class="anchor" aria-label="anchor" href="#multiple-analyses-of-two-catalogues-using-different-initial-values"></a>
</h2>
<p>The inlabru algorithm takes an initial guess on the mode of the
parameters we are inverting for and iteratively updates this initial
guess. There is the potential that there may be bad initial conditions
such that they find different solutions and the runtime will differ
depending upon how the solution converges.</p>
<p>In this notebook, we explore the robustness of the posteriors on two
synthetic catalogues where the true parameters are known. Both
catalogues contain 2000 days of data. One catalogue does not contain a
large event and the second contains a M6.7 event on day 1000.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/">ETAS.inlabru</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/tidyquant" class="external-link">tidyquant</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stefanedwards/lemon" class="external-link">lemon</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/" class="external-link">GGally</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.inlabru.org" class="external-link">inlabru</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">INLA</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/">ETAS.inlabru</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># inla.setOption(pardiso.license="~/sys/licences/pardiso.lic")</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Increase/decrease num.cores if you have more/fewer cores on your computer.</span></span>
<span><span class="co"># future::multisession works on both Windows, MacOS, and Linux</span></span>
<span><span class="va">num.cores</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">multisession</a></span>, workers <span class="op">=</span> <span class="va">num.cores</span><span class="op">)</span></span>
<span><span class="fu">INLA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/INLA/man/options.html" class="external-link">inla.setOption</a></span><span class="op">(</span>num.threads <span class="op">=</span> <span class="va">num.cores</span><span class="op">)</span></span>
<span><span class="co"># To deactivate parallelism, run</span></span>
<span><span class="co">#   future::plan(future::sequential)</span></span>
<span><span class="co">#   INLA::inla.setOption(num.threads = 1)</span></span></code></pre></div>
<div class="section level3">
<h3 id="define-the-parameters-for-the-synthetic-catalogues-and-starting-values-for-inversion">Define the parameters for the synthetic catalogues and starting
values for inversion<a class="anchor" aria-label="anchor" href="#define-the-parameters-for-the-synthetic-catalogues-and-starting-values-for-inversion"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Parameters we use to generate synthetics, which we will refer to as the 'true' parameters</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">0.089</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">2.29</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">0.11</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1.08</span></span>
<span></span>
<span><span class="co"># Format the true ETAS parameters for code to generate the synthetics</span></span>
<span><span class="va">theta_etas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="va">mu</span>, K <span class="op">=</span> <span class="va">K</span>, alpha <span class="op">=</span> <span class="va">alpha</span>, c <span class="op">=</span> <span class="va">c</span>, p <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># A dataframe containing different starting values for the algorithm</span></span>
<span><span class="va">startingValues</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.</span>, <span class="va">mu</span><span class="op">)</span>,</span>
<span>  K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.</span>, <span class="va">K</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.</span>, <span class="va">alpha</span><span class="op">)</span>,</span>
<span>  c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="va">c</span><span class="op">)</span>,</span>
<span>  p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">nRealisations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">startingValues</span><span class="op">$</span><span class="va">mu</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Temporal duration of the synthetic catalogue in days</span></span>
<span><span class="va">modelledDuration</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># [days]</span></span>
<span></span>
<span><span class="co"># The minimum magnitude that will be modelled</span></span>
<span><span class="va">M0</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generate-new-catalogues-and-save-them">Generate new catalogues and save them<a class="anchor" aria-label="anchor" href="#generate-new-catalogues-and-save-them"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">############</span></span>
<span><span class="co">#### Generate the first catalogue with no large events</span></span>
<span></span>
<span><span class="va">samp.etas.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_temporal_ETAS_synthetic.html">generate_temporal_ETAS_synthetic</a></span><span class="op">(</span></span>
<span>  theta <span class="op">=</span> <span class="va">theta_etas</span>,</span>
<span>  beta.p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, M0 <span class="op">=</span> <span class="va">M0</span>, T1 <span class="op">=</span> <span class="fl">0</span>, T2 <span class="op">=</span> <span class="va">modelledDuration</span>, Ht <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">quiet.ETAS.cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">samp.etas.list</span><span class="op">)</span></span>
<span><span class="va">quiet.ETAS.cat</span> <span class="op">&lt;-</span> <span class="va">quiet.ETAS.cat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">quiet.ETAS.cat</span><span class="op">$</span><span class="va">ts</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co"># quiet.ETAS.cat &lt;- na.omit(quiet.ETAS.cat)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">############</span></span>
<span><span class="co">#### Generate the second catalogue with a M6.7 event on day 1000</span></span>
<span></span>
<span><span class="va">Ht</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>, magnitudes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6.7</span><span class="op">)</span><span class="op">)</span> <span class="co"># Impose a M6.7 event on day 1000</span></span>
<span></span>
<span><span class="va">samp.etas.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_temporal_ETAS_synthetic.html">generate_temporal_ETAS_synthetic</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="va">theta_etas</span>, beta.p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, M0 <span class="op">=</span> <span class="va">M0</span>, T1 <span class="op">=</span> <span class="fl">0</span>, T2 <span class="op">=</span> <span class="va">modelledDuration</span>, Ht <span class="op">=</span> <span class="va">Ht</span><span class="op">)</span></span>
<span></span>
<span><span class="va">M6p7.ETAS.cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">samp.etas.list</span><span class="op">)</span></span>
<span><span class="va">M6p7.ETAS.cat</span> <span class="op">&lt;-</span> <span class="va">M6p7.ETAS.cat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">M6p7.ETAS.cat</span><span class="op">$</span><span class="va">ts</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>In this vignette we use Rmd caching, but you can save the catalogues
in files explicitly:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># save(M6p7.ETAS.cat,file="M6p7_ETAS_cat.Rda")</span></span>
<span><span class="co"># save(quiet.ETAS.cat,file="quiet.ETAS.cat.Rda")</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="present-the-catalogues">Present the catalogues<a class="anchor" aria-label="anchor" href="#present-the-catalogues"></a>
</h2>
<div class="section level3">
<h3 id="load-the-catalogues">Load the catalogues<a class="anchor" aria-label="anchor" href="#load-the-catalogues"></a>
</h3>
<p>To read from saved object files:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load("M6p7_ETAS_cat.Rda")</span></span>
<span><span class="co"># load("quiet.ETAS.cat.Rda")</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-properties-of-the-catalogues">Plot properties of the catalogues<a class="anchor" aria-label="anchor" href="#plot-properties-of-the-catalogues"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plots</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">quiet.ETAS.cat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ts</span>, y <span class="op">=</span> <span class="va">magnitudes</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">modelledDuration</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"A.  Unseeded catalog, nEvents ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">quiet.ETAS.cat</span><span class="op">$</span><span class="va">ts</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Magnitude"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plots</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">M6p7.ETAS.cat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ts</span>, y <span class="op">=</span> <span class="va">magnitudes</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">modelledDuration</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"B.  Catalog seeded with M6.7 event on day 500, nEvents ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">M6p7.ETAS.cat</span><span class="op">$</span><span class="va">ts</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Magnitude"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">plt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">plots</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">plots</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="sensitivityToStartingPoint_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># ggsave("initialConditionCats.png", plt)</span></span>
<span><span class="co"># ggsave("initialConditionCats.pdf", plt)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="analyse-the-sensitivity-to-starting-conditions">Analyse the sensitivity to starting conditions<a class="anchor" aria-label="anchor" href="#analyse-the-sensitivity-to-starting-conditions"></a>
</h2>
<div class="section level3">
<h3 id="analysis-of-quiet-catalogue">Analysis of quiet catalogue<a class="anchor" aria-label="anchor" href="#analysis-of-quiet-catalogue"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list.output.quietScenario</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">nRealisations</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"list.input"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">remove</a></span><span class="op">(</span><span class="st">"list.input"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Load a set of parameters that we will need to tweak for this application</span></span>
<span>  <span class="va">fpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"user_input_synthetic_noCatalogue.txt"</span>, package <span class="op">=</span> <span class="st">"ETAS.inlabru"</span><span class="op">)</span></span>
<span>  <span class="va">list.input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_input_list_temporal_noCatalogue.html">create_input_list_temporal_noCatalogue</a></span><span class="op">(</span><span class="va">fpath</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">####################</span></span>
<span>  <span class="co"># Tweak the variables loaded from the input file</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">M0</span> <span class="op">&lt;-</span> <span class="va">M0</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">time.int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">modelledDuration</span><span class="op">)</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">T12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">modelledDuration</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Change the starting location, measured on the ETAS scale</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">mu.init</span> <span class="op">&lt;-</span> <span class="va">startingValues</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">alpha.init</span> <span class="op">&lt;-</span> <span class="va">startingValues</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">K.init</span> <span class="op">&lt;-</span> <span class="va">startingValues</span><span class="op">$</span><span class="va">K</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">c.init</span> <span class="op">&lt;-</span> <span class="va">startingValues</span><span class="op">$</span><span class="va">c</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">p.init</span> <span class="op">&lt;-</span> <span class="va">startingValues</span><span class="op">$</span><span class="va">p</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span></span>
<span>  <span class="va">link.f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    mu <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/gamma_t.html">gamma_t</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">a_mu</span>, <span class="va">b_mu</span><span class="op">)</span>,</span>
<span>    K <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/loggaus_t.html">loggaus_t</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">a_K</span>, <span class="va">b_K</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/unif_t.html">unif_t</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">a_alpha</span>, <span class="va">b_alpha</span><span class="op">)</span>,</span>
<span>    c_ <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/unif_t.html">unif_t</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">a_c</span>, <span class="va">b_c</span><span class="op">)</span>,</span>
<span>    p <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/unif_t.html">unif_t</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">a_p</span>, <span class="va">b_p</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># initial value - convert from ETAS scale to internal scale</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">th.init</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    th.mu <span class="op">=</span> <span class="fu"><a href="../reference/inv_gamma_t.html">inv_gamma_t</a></span><span class="op">(</span><span class="va">list.input</span><span class="op">$</span><span class="va">mu.init</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">a_mu</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">b_mu</span><span class="op">)</span>,</span>
<span>    th.K <span class="op">=</span> <span class="fu"><a href="../reference/inv_loggaus_t.html">inv_loggaus_t</a></span><span class="op">(</span><span class="va">list.input</span><span class="op">$</span><span class="va">K.init</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">a_K</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">b_K</span><span class="op">)</span>,</span>
<span>    th.alpha <span class="op">=</span> <span class="fu"><a href="../reference/inv_unif_t.html">inv_unif_t</a></span><span class="op">(</span><span class="va">list.input</span><span class="op">$</span><span class="va">alpha.init</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">a_alpha</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">b_alpha</span><span class="op">)</span>,</span>
<span>    th.c <span class="op">=</span> <span class="fu"><a href="../reference/inv_unif_t.html">inv_unif_t</a></span><span class="op">(</span><span class="va">list.input</span><span class="op">$</span><span class="va">c.init</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">a_c</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">b_c</span><span class="op">)</span>,</span>
<span>    th.p <span class="op">=</span> <span class="fu"><a href="../reference/inv_unif_t.html">inv_unif_t</a></span><span class="op">(</span><span class="va">list.input</span><span class="op">$</span><span class="va">p.init</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">a_p</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">b_p</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Define options for inlabru</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">list.input</span><span class="op">$</span><span class="va">max_step</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">list.input</span><span class="op">$</span><span class="va">bru.opt.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      bru_verbose <span class="op">=</span> <span class="fl">0</span>, <span class="co"># type of visual output</span></span>
<span>      bru_max_iter <span class="op">=</span> <span class="va">list.input</span><span class="op">$</span><span class="va">max_iter</span>, <span class="co"># maximum number of iterations</span></span>
<span>      <span class="co"># bru_method = list(max_step = 0.5),</span></span>
<span>      bru_initial <span class="op">=</span> <span class="va">list.input</span><span class="op">$</span><span class="va">th.init</span></span>
<span>    <span class="op">)</span> <span class="co"># parameters initial values</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">list.input</span><span class="op">$</span><span class="va">bru.opt.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      bru_verbose <span class="op">=</span> <span class="fl">0</span>, <span class="co"># type of visual output</span></span>
<span>      bru_max_iter <span class="op">=</span> <span class="va">list.input</span><span class="op">$</span><span class="va">max_iter</span>, <span class="co"># maximum number of iterations</span></span>
<span>      bru_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>max_step <span class="op">=</span> <span class="va">list.input</span><span class="op">$</span><span class="va">max_step</span><span class="op">)</span>,</span>
<span>      bru_initial <span class="op">=</span> <span class="va">list.input</span><span class="op">$</span><span class="va">th.init</span></span>
<span>    <span class="op">)</span> <span class="co"># parameters initial values</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co">## Add out catalogue to the input list</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">catalog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    time_diff <span class="op">=</span> <span class="va">quiet.ETAS.cat</span><span class="op">$</span><span class="va">ts</span>,</span>
<span>    magnitudes <span class="op">=</span> <span class="va">quiet.ETAS.cat</span><span class="op">$</span><span class="va">magnitudes</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co">## Add the catalogue formatted for bru</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">catalog.bru</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    ts <span class="op">=</span> <span class="va">quiet.ETAS.cat</span><span class="op">$</span><span class="va">ts</span>,</span>
<span>    magnitudes <span class="op">=</span> <span class="va">quiet.ETAS.cat</span><span class="op">$</span><span class="va">magnitudes</span>,</span>
<span>    idx.p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">quiet.ETAS.cat</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co">## Input list is now formatted</span></span>
<span>  <span class="co">####################</span></span>
<span></span>
<span>  <span class="co">## Run the model according to the input list</span></span>
<span>  <span class="va">ETAS.model.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Temporal.ETAS.fit.html">Temporal.ETAS.fit</a></span><span class="op">(</span><span class="va">list.input</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">## Small bit of post processing</span></span>
<span>  <span class="va">list.output.quietScenario</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">list.input</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>model.fit <span class="op">=</span> <span class="va">ETAS.model.fit</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">list.output.quietScenario</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">runtime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">list.output.quietScenario</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">model.fit</span><span class="op">$</span><span class="va">bru_timings</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span></span>
<span>  <span class="va">list.output.quietScenario</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nEvents</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">list.output.quietScenario</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">catalog</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Start model fitting </span></span>
<span><span class="co">#&gt; Start creating grid... </span></span>
<span><span class="co">#&gt; Finished creating grid, time  0.5432522 </span></span>
<span><span class="co">#&gt; Finish model fitting </span></span>
<span><span class="co">#&gt; Start model fitting </span></span>
<span><span class="co">#&gt; Start creating grid... </span></span>
<span><span class="co">#&gt; Finished creating grid, time  0.5450776 </span></span>
<span><span class="co">#&gt; Finish model fitting</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analysis-of-m6-7-catalogue">Analysis of M6.7 catalogue<a class="anchor" aria-label="anchor" href="#analysis-of-m6-7-catalogue"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list.output.M6p7Scenario</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">nRealisations</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"list.input"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">remove</a></span><span class="op">(</span><span class="va">list.input</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Load a set of parameters that we will need to tweak for this application</span></span>
<span>  <span class="va">fpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"user_input_synthetic_noCatalogue.txt"</span>, package <span class="op">=</span> <span class="st">"ETAS.inlabru"</span><span class="op">)</span></span>
<span>  <span class="va">list.input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_input_list_temporal_noCatalogue.html">create_input_list_temporal_noCatalogue</a></span><span class="op">(</span><span class="va">fpath</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">####################</span></span>
<span>  <span class="co"># Tweak the variables laoded from the input file</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">M0</span> <span class="op">&lt;-</span> <span class="va">M0</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">time.int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">modelledDuration</span><span class="op">)</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">T12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">modelledDuration</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Change the starting location, measured on the ETAS scale</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">mu.init</span> <span class="op">&lt;-</span> <span class="va">startingValues</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">alpha.init</span> <span class="op">&lt;-</span> <span class="va">startingValues</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">K.init</span> <span class="op">&lt;-</span> <span class="va">startingValues</span><span class="op">$</span><span class="va">K</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">c.init</span> <span class="op">&lt;-</span> <span class="va">startingValues</span><span class="op">$</span><span class="va">c</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">p.init</span> <span class="op">&lt;-</span> <span class="va">startingValues</span><span class="op">$</span><span class="va">p</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span></span>
<span>  <span class="va">link.f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    mu <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/gamma_t.html">gamma_t</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">a_mu</span>, <span class="va">b_mu</span><span class="op">)</span>,</span>
<span>    K <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/loggaus_t.html">loggaus_t</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">a_K</span>, <span class="va">b_K</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/unif_t.html">unif_t</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">a_alpha</span>, <span class="va">b_alpha</span><span class="op">)</span>,</span>
<span>    c_ <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/unif_t.html">unif_t</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">a_c</span>, <span class="va">b_c</span><span class="op">)</span>,</span>
<span>    p <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/unif_t.html">unif_t</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">a_p</span>, <span class="va">b_p</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># initial value - convert from ETAS scale to internal scale</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">th.init</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    th.mu <span class="op">=</span> <span class="fu"><a href="../reference/inv_gamma_t.html">inv_gamma_t</a></span><span class="op">(</span><span class="va">list.input</span><span class="op">$</span><span class="va">mu.init</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">a_mu</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">b_mu</span><span class="op">)</span>,</span>
<span>    th.K <span class="op">=</span> <span class="fu"><a href="../reference/inv_loggaus_t.html">inv_loggaus_t</a></span><span class="op">(</span><span class="va">list.input</span><span class="op">$</span><span class="va">K.init</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">a_K</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">b_K</span><span class="op">)</span>,</span>
<span>    th.alpha <span class="op">=</span> <span class="fu"><a href="../reference/inv_unif_t.html">inv_unif_t</a></span><span class="op">(</span><span class="va">list.input</span><span class="op">$</span><span class="va">alpha.init</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">a_alpha</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">b_alpha</span><span class="op">)</span>,</span>
<span>    th.c <span class="op">=</span> <span class="fu"><a href="../reference/inv_unif_t.html">inv_unif_t</a></span><span class="op">(</span><span class="va">list.input</span><span class="op">$</span><span class="va">c.init</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">a_c</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">b_c</span><span class="op">)</span>,</span>
<span>    th.p <span class="op">=</span> <span class="fu"><a href="../reference/inv_unif_t.html">inv_unif_t</a></span><span class="op">(</span><span class="va">list.input</span><span class="op">$</span><span class="va">p.init</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">a_p</span>, <span class="va">list.input</span><span class="op">$</span><span class="va">b_p</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Define options for inlabru</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">list.input</span><span class="op">$</span><span class="va">max_step</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">list.input</span><span class="op">$</span><span class="va">bru.opt.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      bru_verbose <span class="op">=</span> <span class="fl">4</span>, <span class="co"># type of visual output</span></span>
<span>      bru_max_iter <span class="op">=</span> <span class="va">list.input</span><span class="op">$</span><span class="va">max_iter</span>, <span class="co"># maximum number of iterations</span></span>
<span>      <span class="co"># bru_method = list(max_step = 0.5),</span></span>
<span>      bru_initial <span class="op">=</span> <span class="va">list.input</span><span class="op">$</span><span class="va">th.init</span></span>
<span>    <span class="op">)</span> <span class="co"># parameters initial values</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">list.input</span><span class="op">$</span><span class="va">bru.opt.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      bru_verbose <span class="op">=</span> <span class="fl">4</span>, <span class="co"># type of visual output</span></span>
<span>      bru_max_iter <span class="op">=</span> <span class="va">list.input</span><span class="op">$</span><span class="va">max_iter</span>, <span class="co"># maximum number of iterations</span></span>
<span>      bru_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>max_step <span class="op">=</span> <span class="va">list.input</span><span class="op">$</span><span class="va">max_step</span><span class="op">)</span>,</span>
<span>      bru_initial <span class="op">=</span> <span class="va">list.input</span><span class="op">$</span><span class="va">th.init</span></span>
<span>    <span class="op">)</span> <span class="co"># parameters initial values</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co">## Add out catalogue to the input list</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">catalog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    time_diff <span class="op">=</span> <span class="va">M6p7.ETAS.cat</span><span class="op">$</span><span class="va">ts</span>,</span>
<span>    magnitudes <span class="op">=</span> <span class="va">M6p7.ETAS.cat</span><span class="op">$</span><span class="va">magnitudes</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co">## Add the catalogue formatted for bru</span></span>
<span>  <span class="va">list.input</span><span class="op">$</span><span class="va">catalog.bru</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    ts <span class="op">=</span> <span class="va">M6p7.ETAS.cat</span><span class="op">$</span><span class="va">ts</span>,</span>
<span>    magnitudes <span class="op">=</span> <span class="va">M6p7.ETAS.cat</span><span class="op">$</span><span class="va">magnitudes</span>,</span>
<span>    idx.p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">M6p7.ETAS.cat</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co">## Input list is now formatted</span></span>
<span>  <span class="co">####################</span></span>
<span></span>
<span>  <span class="co">## Run the model according to the input list</span></span>
<span>  <span class="va">ETAS.model.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Temporal.ETAS.fit.html">Temporal.ETAS.fit</a></span><span class="op">(</span><span class="va">list.input</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">## Small bit of post processing</span></span>
<span>  <span class="va">list.output.M6p7Scenario</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">list.input</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>model.fit <span class="op">=</span> <span class="va">ETAS.model.fit</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">list.output.M6p7Scenario</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">runtime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">list.output.M6p7Scenario</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">model.fit</span><span class="op">$</span><span class="va">bru_timings</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span></span>
<span>  <span class="va">list.output.M6p7Scenario</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nEvents</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">list.output.M6p7Scenario</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">catalog</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Start model fitting </span></span>
<span><span class="co">#&gt; Start creating grid... </span></span>
<span><span class="co">#&gt; Finished creating grid, time  5.823672</span></span>
<span><span class="co">#&gt; iinla: Evaluate component inputs</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate component simplifications</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Construct inla stack</span></span>
<span><span class="co">#&gt; iinla: Model initialisation completed</span></span>
<span><span class="co">#&gt; iinla: Iteration 1 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 93.26%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 9366</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -55.58</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 336.4</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Iteration 2 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 125%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 2286</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -59.4</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 279.8</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 1520% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 3 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 61.08%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 2089</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -1130</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 141.5</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 2270% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 4 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 117%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 1524</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -7.557</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 106.7</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 1110% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 5 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 110.5%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 590.2</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -4.381</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 28.52</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 678% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 6 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 101.2%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 352.3</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.02589</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 2.191</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 261% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 7 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 103.8%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 255.5</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.5008</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 7.588</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 181% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 8 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.5%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 236.2</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.007301</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.9119</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 169% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 9 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 101%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 201.6</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.02185</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 1.455</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 144% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 10 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.7%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 183.5</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.01136</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 1.005</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 131% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 11 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.6%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 166.1</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.007638</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.7861</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 119% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 12 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.5%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 151</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.005318</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.6266</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 109% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 13 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.5%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 137.6</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.003836</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.5088</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 99.5% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 14 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.4%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 125.7</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.002836</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.4186</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 91.3% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 15 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.4%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 115.1</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.002134</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.3477</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 83.9% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 16 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.3%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 105.5</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.001626</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.2908</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 77.3% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 17 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.3%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 96.84</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.002</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.2445</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 71.2% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 18 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.3%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 89.03</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.00228</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.2063</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 65.7% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 19 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.3%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 81.95</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = 0.0008539</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.1746</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 60.7% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 20 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.2%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 75.5</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = 0.0004826</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.1482</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 56.1% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 21 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.2%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 69.63</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = 0.00019</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.126</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 51.9% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 22 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.2%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 64.26</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -3.935e-05</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.1074</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 48% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 23 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.2%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 59.36</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.0002177</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.09164</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 44.5% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 24 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.2%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 54.86</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.0003547</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.0783</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 41.2% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 25 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.2%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 50.74</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.0004583</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.06699</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 38.2% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 26 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 46.95</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.0005348</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.05738</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 35.4% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 27 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 43.47</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.0005895</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.0492</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 32.9% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 28 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 40.26</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.0006264</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.04222</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 30.5% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 29 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 37.31</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.0006492</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.03626</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 28.3% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 30 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 34.59</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.0006605</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.03117</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 26.3% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 31 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 32.07</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.0006628</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.02681</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 24.4% of SD, and line search is inactive [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 32 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 29.75</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = 0.0005509</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.02308</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 22.7% of SD, and line search is inactive [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 33 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 27.61</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = 0.0004744</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.01987</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 21.1% of SD, and line search is inactive [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 34 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 25.63</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = 0.0004087</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.01712</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 19.6% of SD, and line search is inactive [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 35 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 23.79</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = 0.0003523</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.01476</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 18.2% of SD, and line search is inactive [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 36 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 22.09</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = 0.0003038</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.01273</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 16.9% of SD, and line search is inactive [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 37 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 20.52</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = 0.0002621</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.01098</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 15.7% of SD, and line search is inactive [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 38 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 19.07</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = 0.0002262</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.009477</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 14.6% of SD, and line search is inactive [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 39 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 17.72</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = 0.0001952</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.008182</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 13.6% of SD, and line search is inactive [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 40 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 16.46</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = 0.0001686</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.007066</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 12.7% of SD, and line search is inactive [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 41 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 15.3</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = 0.0001456</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.006104</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 11.8% of SD, and line search is inactive [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 42 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 14.23</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = 0.0001258</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.005275</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 11% of SD, and line search is inactive [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 43 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 13.23</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = 0.0001087</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.004559</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 10.2% of SD, and line search is inactive [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 44 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 12.3</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = 9.398e-05</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.003941</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 9.49% of SD, and line search is inactive [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Convergence criterion met, running final INLA integration with known theta mode.</span></span>
<span><span class="co">#&gt; iinla: Iteration 45 [max:100]</span></span>
<span><span class="co">#&gt; Finish model fitting </span></span>
<span><span class="co">#&gt; Start model fitting </span></span>
<span><span class="co">#&gt; Start creating grid... </span></span>
<span><span class="co">#&gt; Finished creating grid, time  5.954548</span></span>
<span><span class="co">#&gt; iinla: Evaluate component inputs</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate component simplifications</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Construct inla stack</span></span>
<span><span class="co">#&gt; iinla: Model initialisation completed</span></span>
<span><span class="co">#&gt; iinla: Iteration 1 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 92.06%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 174.3</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -3.799</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 18.5</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Iteration 2 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 99.32%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 41.11</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.1645</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 1.838</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 42.5% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 3 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 99.99%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 10.12</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.001882</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.09727</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 16.1% of SD, and line search is inactive [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 4 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 5.642</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.0001879</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.01588</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 10.5% of SD, and line search is active [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Iteration 5 [max:100]</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 162%, Expand</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100%, Overstep</span></span>
<span><span class="co">#&gt; iinla: Step rescaling: 100.1%, Optimisation</span></span>
<span><span class="co">#&gt; iinla: |lin1-lin0| = 5.666</span></span>
<span><span class="co">#&gt;        &lt;eta-lin1,delta&gt;/|delta| = -0.0001337</span></span>
<span><span class="co">#&gt;        |eta-lin0 - delta &lt;delta,eta-lin0&gt;/&lt;delta,delta&gt;| = 0.007986</span></span>
<span><span class="co">#&gt; iinla: Evaluate component linearisations</span></span>
<span><span class="co">#&gt; iinla: Evaluate predictor linearisation</span></span>
<span><span class="co">#&gt; iinla: Max deviation from previous: 6.5% of SD, and line search is inactive [stop if: &lt;10% and line search inactive]</span></span>
<span><span class="co">#&gt; iinla: Convergence criterion met, running final INLA integration with known theta mode.</span></span>
<span><span class="co">#&gt; iinla: Iteration 6 [max:100]</span></span>
<span><span class="co">#&gt; Finish model fitting</span></span></code></pre></div>
<div class="section level4">
<h4 id="plot-posteriors-with-corresponding-starting-values">Plot posteriors with corresponding starting values<a class="anchor" aria-label="anchor" href="#plot-posteriors-with-corresponding-starting-values"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">trueParas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">K</span>, <span class="va">alpha</span>, <span class="va">c</span>, <span class="va">p</span><span class="op">)</span>, param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mu"</span>, <span class="st">"K"</span>, <span class="st">"alpha"</span>, <span class="st">"c"</span>, <span class="st">"p"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">post.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_posterior_param.html">get_posterior_param</a></span><span class="op">(</span>input.list <span class="op">=</span> <span class="va">list.output.quietScenario</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">post.df</span> <span class="op">&lt;-</span> <span class="va">post.list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">post.df</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">nRealisations</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">post.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_posterior_param.html">get_posterior_param</a></span><span class="op">(</span>input.list <span class="op">=</span> <span class="va">list.output.quietScenario</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">post.df.tmp</span> <span class="op">&lt;-</span> <span class="va">post.list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">post.df.tmp</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="va">i</span></span>
<span></span>
<span>  <span class="va">post.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">post.df</span>, <span class="va">post.df.tmp</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">plots</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">post.df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">id</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># scale_x_discrete(guide = guide_axis(check.overlap = TRUE)) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span>facets <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">param</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free"</span>, labeller <span class="op">=</span> <span class="va">label_parsed</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">value</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">trueParas</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    label <span class="op">=</span> <span class="st">"True value"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Initial ETAS Para. Set"</span>, linetype <span class="op">=</span> <span class="st">"Initial ETAS Para. Set"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"A.  Inversion of a 1000 day catalogue with no large events, nEvents ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">quiet.ETAS.cat</span><span class="op">$</span><span class="va">ts</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"ETAS Posteriors"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"hidden"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in geom_vline(aes(xintercept = value), data = trueParas, color =</span></span>
<span><span class="co">#&gt; "black", : Ignoring unknown parameters: `label`</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trueParas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">K</span>, <span class="va">alpha</span>, <span class="va">c</span>, <span class="va">p</span><span class="op">)</span>, param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mu"</span>, <span class="st">"K"</span>, <span class="st">"alpha"</span>, <span class="st">"c"</span>, <span class="st">"p"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">post.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_posterior_param.html">get_posterior_param</a></span><span class="op">(</span>input.list <span class="op">=</span> <span class="va">list.output.M6p7Scenario</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">post.df</span> <span class="op">&lt;-</span> <span class="va">post.list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">post.df</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">nRealisations</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">post.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_posterior_param.html">get_posterior_param</a></span><span class="op">(</span>input.list <span class="op">=</span> <span class="va">list.output.M6p7Scenario</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">post.df.tmp</span> <span class="op">&lt;-</span> <span class="va">post.list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">post.df.tmp</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="va">i</span></span>
<span></span>
<span>  <span class="va">post.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">post.df</span>, <span class="va">post.df.tmp</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">plots</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">post.df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">id</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># scale_x_discrete(guide = guide_axis(check.overlap = TRUE)) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span>facets <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">param</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free"</span>, labeller <span class="op">=</span> <span class="va">label_parsed</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">value</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">trueParas</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    label <span class="op">=</span> <span class="st">"True value"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Initial ETAS Para. Set"</span>, linetype <span class="op">=</span> <span class="st">"Initial ETAS Para. Set"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"B. Inversion of a 1000 day catalogue with a M6.7 on day 500, nEvents ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">M6p7.ETAS.cat</span><span class="op">$</span><span class="va">ts</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"ETAS Posteriors"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"hidden"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in geom_vline(aes(xintercept = value), data = trueParas, color =</span></span>
<span><span class="co">#&gt; "black", : Ignoring unknown parameters: `label`</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lemon/man/grid_arrange_shared_legend.html" class="external-link">grid_arrange_shared_legend</a></span><span class="op">(</span><span class="va">plots</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">plots</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">2</span>, position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sensitivityToStartingPoint_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt</span></span>
<span><span class="co">#&gt; TableGrob (2 x 1) "arrange": 2 grobs</span></span>
<span><span class="co">#&gt;   z     cells    name              grob</span></span>
<span><span class="co">#&gt; 1 1 (1-1,1-1) arrange   gtable[arrange]</span></span>
<span><span class="co">#&gt; 2 2 (2-2,1-1) arrange gtable[guide-box]</span></span>
<span><span class="co"># ggsave("initialCondition_posteriors.png", plt)</span></span>
<span><span class="co"># ggsave("initialCondition_posteriors.pdf", plt)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="explore-etas-triggering-function-using-posterior-samples">Explore ETAS triggering function using posterior samples<a class="anchor" aria-label="anchor" href="#explore-etas-triggering-function-using-posterior-samples"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_triggering</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">plot_triggering</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/triggering_fun_plot.html">triggering_fun_plot</a></span><span class="op">(</span><span class="va">list.output.quietScenario</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, magnitude <span class="op">=</span> <span class="fl">4</span>, n.samp <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"C. M4 triggering function"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_triggering</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/triggering_fun_plot.html">triggering_fun_plot</a></span><span class="op">(</span><span class="va">list.output.M6p7Scenario</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, magnitude <span class="op">=</span> <span class="fl">4</span>, n.samp <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"D. M4 triggering function"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_triggering</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/triggering_fun_plot.html">triggering_fun_plot</a></span><span class="op">(</span><span class="va">list.output.quietScenario</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, magnitude <span class="op">=</span> <span class="fl">6.7</span>, n.samp <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"E. M6.7 triggering function"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1700</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">plot_triggering</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/triggering_fun_plot.html">triggering_fun_plot</a></span><span class="op">(</span><span class="va">list.output.M6p7Scenario</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, magnitude <span class="op">=</span> <span class="fl">6.7</span>, n.samp <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"F. M6.7 triggering function"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1700</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">plt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">plot_triggering</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">plot_triggering</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="va">plot_triggering</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">plot_triggering</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span>, top <span class="op">=</span> <span class="st">"Triggering function variability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 3 rows containing missing values (`geom_line()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 29 rows containing missing values (`geom_line()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values (`geom_line()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 74 rows containing missing values (`geom_line()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="sensitivityToStartingPoint_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="co"># ggsave("trigFuncVariability_runin.png", plt)</span></span>
<span><span class="co"># ggsave("trigFuncVariability_runin.pdf", plt)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_omori</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">plot_omori</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/omori_plot_posterior.html">omori_plot_posterior</a></span><span class="op">(</span><span class="va">list.output.quietScenario</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, n.samp <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"A. Omori decay"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">plot_omori</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/omori_plot_posterior.html">omori_plot_posterior</a></span><span class="op">(</span><span class="va">list.output.M6p7Scenario</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, n.samp <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"B. Omori decay"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">plot_omori</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">plot_triggering</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">plot_triggering</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="va">plot_omori</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">plot_triggering</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">plot_triggering</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, ncol <span class="op">=</span> <span class="fl">3</span>, nrow <span class="op">=</span> <span class="fl">2</span>, top <span class="op">=</span> <span class="st">"Triggering  function variability"</span>, left <span class="op">=</span> <span class="st">"M6.7 baseline            Unseeded baseline"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 3 rows containing missing values (`geom_line()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 29 rows containing missing values (`geom_line()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values (`geom_line()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 74 rows containing missing values (`geom_line()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="sensitivityToStartingPoint_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt</span></span>
<span><span class="co">#&gt; TableGrob (3 x 4) "arrange": 8 grobs</span></span>
<span><span class="co">#&gt;   z     cells    name                 grob</span></span>
<span><span class="co">#&gt; 1 1 (2-2,2-2) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 2 2 (2-2,3-3) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 3 3 (2-2,4-4) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 4 4 (3-3,2-2) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 5 5 (3-3,3-3) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 6 6 (3-3,4-4) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 7 7 (1-1,2-4) arrange text[GRID.text.1299]</span></span>
<span><span class="co">#&gt; 8 8 (1-3,1-1) arrange text[GRID.text.1300]</span></span>
<span></span>
<span><span class="co"># ggsave("trigFuncVariability_runin.png", plt)</span></span>
<span><span class="co"># ggsave("trigFuncVariability_runin.pdf", plt)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-the-samples-from-the-joint-posteriors-as-pairs-plots">Plot the samples from the joint posteriors as pairs plots<a class="anchor" aria-label="anchor" href="#plot-the-samples-from-the-joint-posteriors-as-pairs-plots"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/post_pairs_plot.html">post_pairs_plot</a></span><span class="op">(</span><span class="va">list.output.quietScenario</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, n.samp <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">$</span><span class="va">pair.plot</span></span></code></pre></div>
<p><img src="sensitivityToStartingPoint_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/post_pairs_plot.html">post_pairs_plot</a></span><span class="op">(</span><span class="va">list.output.M6p7Scenario</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, n.samp <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">$</span><span class="va">pair_plot</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="inlabru-convergence-diagnostics">inlabru convergence diagnostics<a class="anchor" aria-label="anchor" href="#inlabru-convergence-diagnostics"></a>
</h3>
<p>We can also assess the convergence of the inlabru method itself,
using the <code><a href="https://inlabru-org.github.io/inlabru/reference/bru_convergence_plot.html" class="external-link">bru_convergence_plot()</a></code> function. This can reveal
if the starting values for the inlabru estimation are unreasonable, and
better starting values for the nonlinear iterations might speed up the
computations.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/bru_convergence_plot.html" class="external-link">bru_convergence_plot</a></span><span class="op">(</span><span class="va">list.output.quietScenario</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">model.fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="sensitivityToStartingPoint_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/bru_convergence_plot.html" class="external-link">bru_convergence_plot</a></span><span class="op">(</span><span class="va">list.output.quietScenario</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">model.fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="sensitivityToStartingPoint_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/bru_convergence_plot.html" class="external-link">bru_convergence_plot</a></span><span class="op">(</span><span class="va">list.output.M6p7Scenario</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">model.fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="sensitivityToStartingPoint_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://inlabru-org.github.io/inlabru/reference/bru_convergence_plot.html" class="external-link">bru_convergence_plot</a></span><span class="op">(</span><span class="va">list.output.M6p7Scenario</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">model.fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="sensitivityToStartingPoint_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Francesco Serafini, Mark Naylor, Finn Lindgren.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
