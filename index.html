<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bayesian ETAS model for modelling seismic sequences with inlabru • ETAS.inlabru</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Bayesian ETAS model for modelling seismic sequences with inlabru">
<meta name="description" content="Modelling and inversion of ETAS model of seismicity using inlabru The Epidemic Type Aftershock Sequence (ETAS) model is designed to model earthquakes that are triggered by previous events. In statistics, this is referred to as a Hawkes process. The code can be used to generate synthetic ETAS catalogues which can also include some seeded events to model specific sequences. We also implement a Bayesian inversion scheme using the Integrated Nested Laplace Approximation (INLA) using inlabru. For the temporal model, given a training catalogue of times and magnitudes, the code returns the joint posteriors for all the ETAS parameters. In the future roadmap, we will include tools to model the spatial distribution and spatio-temporal evolution of seismic sequences.">
<meta property="og:description" content="Modelling and inversion of ETAS model of seismicity using inlabru The Epidemic Type Aftershock Sequence (ETAS) model is designed to model earthquakes that are triggered by previous events. In statistics, this is referred to as a Hawkes process. The code can be used to generate synthetic ETAS catalogues which can also include some seeded events to model specific sequences. We also implement a Bayesian inversion scheme using the Integrated Nested Laplace Approximation (INLA) using inlabru. For the temporal model, given a training catalogue of times and magnitudes, the code returns the joint posteriors for all the ETAS parameters. In the future roadmap, we will include tools to model the spatial distribution and spatio-temporal evolution of seismic sequences.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ETAS.inlabru</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/EDA_Italy_Horus.html">1. Exploratory Data Analysis: Italian Earthquake Catalogue - Horus</a></li>
    <li><a class="dropdown-item" href="articles/generateSyntheticCatalogues.html">2a Temporal Model: Generating synthetic temporal ETAS catalogues</a></li>
    <li><a class="dropdown-item" href="articles/sampleFromETASpriors.html">2b Temporal Model: Presenting samples drawn from the ETAS priors</a></li>
    <li><a class="dropdown-item" href="articles/sensitivityToStartingPoint.html">Sensitivity to starting point</a></li>
    <li><a class="dropdown-item" href="articles/tutorial_real.html">2d Temporal Model: Tutorial on real data</a></li>
    <li><a class="dropdown-item" href="articles/tutorial_synth.html">2c Temporal Model: Tutorial on synthetic data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/edinburgh-seismicity-hub/ETAS.inlabru/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="etasinlabru">ETAS.inlabru<a class="anchor" aria-label="anchor" href="#etasinlabru"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>R package that implements the ETAS Hawkes process for modelling seismicity</p>
<p>Online documentation: <a href="https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/" class="uri">https://edinburgh-seismicity-hub.github.io/ETAS.inlabru/</a></p>
<div class="section level2">
<h2 id="authors">Authors<a class="anchor" aria-label="anchor" href="#authors"></a>
</h2>
<ul>
<li><a href="https://scholar.google.com/citations?user=NVDOxTcAAAAJ&amp;hl=en" class="external-link">Dr Francesco Serafini</a></li>
<li>
<a href="https://blogs.ed.ac.uk/mnaylor/" class="external-link">Dr Mark Naylor</a> , School of GeoSciences, University of Edinburgh</li>
<li>
<a href="https://www.maths.ed.ac.uk/~flindgre/" class="external-link">Prof Finn Lindgren</a> , School of Mathematics, University of Edinburgh</li>
<li>
<a href="https://www.linkedin.com/in/kirsty-bayliss-9a6604a1/?originalSubdomain=uk" class="external-link">Dr Kirsty Bayliss</a> , Global Earthquake Model (GEM)</li>
</ul>
</div>
<div class="section level2">
<h2 id="funding">Funding<a class="anchor" aria-label="anchor" href="#funding"></a>
</h2>
<ul>
<li>This study was funded by yhe Real-Time Earthquake Risk Reduction for a Resilient Europe <a href="http://www.rise-eu.org/home/" class="external-link">RISE project</a> , which has received funding from the European Union’s Horizon 2020 Research and Innovation Program under grant Agreement 821115.</li>
<li>Naylor was additionally funded by the NSFGEO-NERC grant NE/R000794/1.</li>
<li>Bayliss was funded by an EPSRC Studentship.</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>For ETAS.inlabru to work, we need to install both R-INLA and inlabru:</p>
<p>For inlabru (see <a href="https://inlabru-org.github.io/inlabru/" class="external-link uri">https://inlabru-org.github.io/inlabru/</a>):</p>
<ul>
<li>CRAN release,</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"inlabru"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>or development version,</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"inlabru-org/inlabru"</span><span class="op">)</span></span></code></pre></div>
<p>For R-INLA (see <a href="https://www.r-inla.org/download-install" class="external-link uri">https://www.r-inla.org/download-install</a>):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span></span>
<span>  <span class="st">"INLA"</span>,</span>
<span>  repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"repos"</span><span class="op">)</span>, INLA<span class="op">=</span><span class="st">"https://inla.r-inla-download.org/R/testing"</span><span class="op">)</span>,</span>
<span>  dep <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version of ETAS.inlabru from <a href="https://github.com/" class="external-link">GitHub</a> with</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"edinburgh-seismicity-hub/ETAS.inlabru"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="terminology-and-planning-suggestions">Terminology and planning suggestions<a class="anchor" aria-label="anchor" href="#terminology-and-planning-suggestions"></a>
</h2>
<div class="section level3">
<h3 id="file-structure-in-package">File structure in package<a class="anchor" aria-label="anchor" href="#file-structure-in-package"></a>
</h3>
<ul>
<li>ETAS.triggering.function.R : Contains the ETAS specific model functions</li>
<li>HawkesProcess.R : Generic Hawkes code that is intended for integration back into inlabru</li>
<li>generateSyntheticCatalogues.R : Contains the iterative Hawkes functions for generating triggered events but the actual triggering functions reside in the ETAS file above so we could introduce other models here</li>
<li>temporalBinning.R : Code to generate time bins to make integration scheme efficient</li>
<li>plottingFunctions.R : lets put all the standard plotting functions into here</li>
<li>setupInlabruInputs.R : Put the functions for generating input.list in here</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="terminology">Terminology<a class="anchor" aria-label="anchor" href="#terminology"></a>
</h2>
<ul>
<li>Let’s be specific about when we are doing just temporal so we have clear function names for the spatial and spatial-temporal later on</li>
<li>I changed the theta from <code>c(mu, K, ...)</code> to a <code>df &lt;- data.frame(mu=mu, K=K, alpha=alpha, c=c, p=p)</code>. This means we should refer to the values as <code>df$mu</code> which is unambiguous etc</li>
</ul>
</div>
</div>
<div class="section level1">
<h1 id="what-has-been-done">What has been done<a class="anchor" aria-label="anchor" href="#what-has-been-done"></a>
</h1>
<div class="section level2">
<h2 id="implemented">Implemented<a class="anchor" aria-label="anchor" href="#implemented"></a>
</h2>
<ul>
<li>Generation of synthetic ETAS catalogues by <code>ETAS.inlabru</code> with a demonstration in the notebook</li>
</ul>
</div>
<div class="section level2">
<h2 id="in-development">In development<a class="anchor" aria-label="anchor" href="#in-development"></a>
</h2>
<ul>
<li>Add inversion modelling based on original code</li>
<li>Modify the implementation so that the generic Hawkes code can go into inlabru and the ETAS triggering function code stay in this package</li>
</ul>
</div>
<div class="section level2">
<h2 id="roadmap">Roadmap<a class="anchor" aria-label="anchor" href="#roadmap"></a>
</h2>
<ul>
<li>Integrate spatial modelling</li>
</ul>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/edinburgh-seismicity-hub/ETAS.inlabru/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/edinburgh-seismicity-hub/ETAS.inlabru/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;=2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ETAS.inlabru</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Francesco Serafini <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-0154-6200" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Mark Naylor <br><small class="roles"> Author, thesis advisor </small> <a href="https://orcid.org/0000-0002-3761-5522" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Finn Lindgren <br><small class="roles"> Author, thesis advisor </small> <a href="https://orcid.org/0000-0002-5833-2011" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Francesco Serafini, Mark Naylor, Finn Lindgren.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
